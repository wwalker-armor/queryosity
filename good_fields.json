[
  {
    "type": "EXTEND",
    "line": "| extend Entities = parse_json(Entities)",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "entities",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttackerIP = tostring(Entities['Address']), AttackerCountry = tostring(Entities['Location']['CountryName']);",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "attackerip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttackerIP = tostring(Entities['Address']), AttackerCountry = tostring(Entities['Location']['CountryName']);",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "attackercountry",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend MaliciousFileDirectory = tostring(Entities['Directory']), MaliciousFileName = tostring(Entities['Name']), MaliciousFileHashes = tostring(Entities['FileHashes']);",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "maliciousfiledirectory",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend MaliciousFileDirectory = tostring(Entities['Directory']), MaliciousFileName = tostring(Entities['Name']), MaliciousFileHashes = tostring(Entities['FileHashes']);",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "maliciousfilename",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend MaliciousFileDirectory = tostring(Entities['Directory']), MaliciousFileName = tostring(Entities['Name']), MaliciousFileHashes = tostring(Entities['FileHashes']);",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "maliciousfilehashes",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend type = iff(DisplayName has \"file\", \"File\", \"Blob\")",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend ClientIP = tostring(split(CallerIpAddress, \":\", 0)[0])",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend FileName = extract(@\"\\/([\\w\\-. ]+)\\?\", 1, Uri)",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "filename",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "  | extend base64Char = base64_decode_toarray(ResponseMd5)",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "base64char",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend hexChar = tohex(toint(base64Char))",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "hexchar",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend hexChar = iff(strlen(hexChar) < 2, strcat(\"0\", hexChar), hexChar)",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "hexchar",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend SourceTable = iff(OperationName has \"range\", \"StorageFileLogs\", \"StorageBlobLogs\")",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "sourcetable",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize make_list(hexChar, 1000) by CorrelationId, ResponseMd5, FileName, AccountName, TimeGenerated, RequestBodySize, ClientIP, SourceTable",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize make_list(hexChar, 1000) by CorrelationId, ResponseMd5, FileName, AccountName, TimeGenerated, RequestBodySize, ClientIP, SourceTable",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "responsemd5",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize make_list(hexChar, 1000) by CorrelationId, ResponseMd5, FileName, AccountName, TimeGenerated, RequestBodySize, ClientIP, SourceTable",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "filename",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize make_list(hexChar, 1000) by CorrelationId, ResponseMd5, FileName, AccountName, TimeGenerated, RequestBodySize, ClientIP, SourceTable",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize make_list(hexChar, 1000) by CorrelationId, ResponseMd5, FileName, AccountName, TimeGenerated, RequestBodySize, ClientIP, SourceTable",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize make_list(hexChar, 1000) by CorrelationId, ResponseMd5, FileName, AccountName, TimeGenerated, RequestBodySize, ClientIP, SourceTable",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "requestbodysize",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize make_list(hexChar, 1000) by CorrelationId, ResponseMd5, FileName, AccountName, TimeGenerated, RequestBodySize, ClientIP, SourceTable",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize make_list(hexChar, 1000) by CorrelationId, ResponseMd5, FileName, AccountName, TimeGenerated, RequestBodySize, ClientIP, SourceTable",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "sourcetable",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Md5Hash = strcat_array(list_hexChar, \"\")",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "md5hash",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "  | extend p = pack(\"FileName\", FileName, \"FileSize\", RequestBodySize, \"Md5Hash\", Md5Hash, \"Time\", TimeGenerated, \"SourceTable\", SourceTable)",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "p",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize UploadedFileInfo=make_list(p, 10000), FilesUploaded=count() by ClientIP",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "uploadedfileinfo",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize UploadedFileInfo=make_list(p, 10000), FilesUploaded=count() by ClientIP",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "filesuploaded",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize UploadedFileInfo=make_list(p, 10000), FilesUploaded=count() by ClientIP",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "        | extend ClientIP = tostring(split(CallerIpAddress, \":\", 0)[0])",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "        | extend FileName = extract(@\"\\/([\\w\\-. ]+)\\?\", 1, Uri)",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "filename",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "        | extend SourceTable = iff(OperationName has \"range\", \"StorageFileLogs\", \"StorageBlobLogs\")",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "sourcetable",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "        | extend p = pack(\"FileName\", FileName, \"Time\", TimeGenerated, \"SourceTable\", SourceTable)",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "p",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "        | summarize DeletedFileInfo=make_list(p, 10000), FilesDeleted=count() by ClientIP",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "deletedfileinfo",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "        | summarize DeletedFileInfo=make_list(p, 10000), FilesDeleted=count() by ClientIP",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "filesdeleted",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "        | summarize DeletedFileInfo=make_list(p, 10000), FilesDeleted=count() by ClientIP",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend LinkedMaliciousFileName = tostring(UploadedFileInfo.FileName)",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "linkedmaliciousfilename",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend LinkedMaliciousFileHash = tostring(UploadedFileInfo.Md5Hash)",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "linkedmaliciousfilehash",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend HashAlgorithm = \"MD5\"",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "hashalgorithm",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AlertTimeGenerated = TimeGenerated, LinkedMaliciousFileName, LinkedMaliciousFileHash, HashAlgorithm, AlertType, AttackerIP, AttackerCountry, MaliciousFileDirectory, MaliciousFileName, FilesUploaded, UploadedFileInfo",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "alerttimegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AlertTimeGenerated = TimeGenerated, LinkedMaliciousFileName, LinkedMaliciousFileHash, HashAlgorithm, AlertType, AttackerIP, AttackerCountry, MaliciousFileDirectory, MaliciousFileName, FilesUploaded, UploadedFileInfo",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "linkedmaliciousfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project AlertTimeGenerated = TimeGenerated, LinkedMaliciousFileName, LinkedMaliciousFileHash, HashAlgorithm, AlertType, AttackerIP, AttackerCountry, MaliciousFileDirectory, MaliciousFileName, FilesUploaded, UploadedFileInfo",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "linkedmaliciousfilehash",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project AlertTimeGenerated = TimeGenerated, LinkedMaliciousFileName, LinkedMaliciousFileHash, HashAlgorithm, AlertType, AttackerIP, AttackerCountry, MaliciousFileDirectory, MaliciousFileName, FilesUploaded, UploadedFileInfo",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "hashalgorithm",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AlertTimeGenerated = TimeGenerated, LinkedMaliciousFileName, LinkedMaliciousFileHash, HashAlgorithm, AlertType, AttackerIP, AttackerCountry, MaliciousFileDirectory, MaliciousFileName, FilesUploaded, UploadedFileInfo",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "alerttype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AlertTimeGenerated = TimeGenerated, LinkedMaliciousFileName, LinkedMaliciousFileHash, HashAlgorithm, AlertType, AttackerIP, AttackerCountry, MaliciousFileDirectory, MaliciousFileName, FilesUploaded, UploadedFileInfo",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "attackerip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AlertTimeGenerated = TimeGenerated, LinkedMaliciousFileName, LinkedMaliciousFileHash, HashAlgorithm, AlertType, AttackerIP, AttackerCountry, MaliciousFileDirectory, MaliciousFileName, FilesUploaded, UploadedFileInfo",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "attackercountry",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AlertTimeGenerated = TimeGenerated, LinkedMaliciousFileName, LinkedMaliciousFileHash, HashAlgorithm, AlertType, AttackerIP, AttackerCountry, MaliciousFileDirectory, MaliciousFileName, FilesUploaded, UploadedFileInfo",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "maliciousfiledirectory",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project AlertTimeGenerated = TimeGenerated, LinkedMaliciousFileName, LinkedMaliciousFileHash, HashAlgorithm, AlertType, AttackerIP, AttackerCountry, MaliciousFileDirectory, MaliciousFileName, FilesUploaded, UploadedFileInfo",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "maliciousfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project AlertTimeGenerated = TimeGenerated, LinkedMaliciousFileName, LinkedMaliciousFileHash, HashAlgorithm, AlertType, AttackerIP, AttackerCountry, MaliciousFileDirectory, MaliciousFileName, FilesUploaded, UploadedFileInfo",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "filesuploaded",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project AlertTimeGenerated = TimeGenerated, LinkedMaliciousFileName, LinkedMaliciousFileHash, HashAlgorithm, AlertType, AttackerIP, AttackerCountry, MaliciousFileDirectory, MaliciousFileName, FilesUploaded, UploadedFileInfo",
    "detection": "additionalfilesuploadedbyactor.yaml",
    "field": "uploadedfileinfo",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(TimeGenerated, *) by EventId",
    "detection": "new-cybereason-malop-detected.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Total = count() by DvcHostname, SrcIpAddr, ActorUsername, Activity, Technique, FileName, FilePath, FileHash, EventMessage",
    "detection": "criticalseveritydetection.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Total = count() by DvcHostname, SrcIpAddr, ActorUsername, Activity, Technique, FileName, FilePath, FileHash, EventMessage",
    "detection": "criticalseveritydetection.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Total = count() by DvcHostname, SrcIpAddr, ActorUsername, Activity, Technique, FileName, FilePath, FileHash, EventMessage",
    "detection": "criticalseveritydetection.yaml",
    "field": "total",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Total = count() by DvcHostname, SrcIpAddr, ActorUsername, Activity, Technique, FileName, FilePath, FileHash, EventMessage",
    "detection": "criticalseveritydetection.yaml",
    "field": "dvchostname",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Total = count() by DvcHostname, SrcIpAddr, ActorUsername, Activity, Technique, FileName, FilePath, FileHash, EventMessage",
    "detection": "criticalseveritydetection.yaml",
    "field": "srcipaddr",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Total = count() by DvcHostname, SrcIpAddr, ActorUsername, Activity, Technique, FileName, FilePath, FileHash, EventMessage",
    "detection": "criticalseveritydetection.yaml",
    "field": "actorusername",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Total = count() by DvcHostname, SrcIpAddr, ActorUsername, Activity, Technique, FileName, FilePath, FileHash, EventMessage",
    "detection": "criticalseveritydetection.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Total = count() by DvcHostname, SrcIpAddr, ActorUsername, Activity, Technique, FileName, FilePath, FileHash, EventMessage",
    "detection": "criticalseveritydetection.yaml",
    "field": "technique",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Total = count() by DvcHostname, SrcIpAddr, ActorUsername, Activity, Technique, FileName, FilePath, FileHash, EventMessage",
    "detection": "criticalseveritydetection.yaml",
    "field": "filename",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Total = count() by DvcHostname, SrcIpAddr, ActorUsername, Activity, Technique, FileName, FilePath, FileHash, EventMessage",
    "detection": "criticalseveritydetection.yaml",
    "field": "filepath",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Total = count() by DvcHostname, SrcIpAddr, ActorUsername, Activity, Technique, FileName, FilePath, FileHash, EventMessage",
    "detection": "criticalseveritydetection.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Total = count() by DvcHostname, SrcIpAddr, ActorUsername, Activity, Technique, FileName, FilePath, FileHash, EventMessage",
    "detection": "criticalseveritydetection.yaml",
    "field": "eventmessage",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, AccountCustomEntity = ActorUsername, HostCustomEntity = DvcHostname, IPCustomEntity = SrcIpAddr, FileHashCustomEntity = FileHash",
    "detection": "criticalseveritydetection.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, AccountCustomEntity = ActorUsername, HostCustomEntity = DvcHostname, IPCustomEntity = SrcIpAddr, FileHashCustomEntity = FileHash",
    "detection": "criticalseveritydetection.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, AccountCustomEntity = ActorUsername, HostCustomEntity = DvcHostname, IPCustomEntity = SrcIpAddr, FileHashCustomEntity = FileHash",
    "detection": "criticalseveritydetection.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, AccountCustomEntity = ActorUsername, HostCustomEntity = DvcHostname, IPCustomEntity = SrcIpAddr, FileHashCustomEntity = FileHash",
    "detection": "criticalseveritydetection.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, AccountCustomEntity = ActorUsername, HostCustomEntity = DvcHostname, IPCustomEntity = SrcIpAddr, FileHashCustomEntity = FileHash",
    "detection": "criticalseveritydetection.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Total = count() by ActorUsername",
    "detection": "criticalorhighseveritydetectionsbyuser.yaml",
    "field": "total",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Total = count() by ActorUsername",
    "detection": "criticalorhighseveritydetectionsbyuser.yaml",
    "field": "actorusername",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Total = count() by DvcHostname, SrcIpAddr, ActorUsername, FileName, FileHash, EventMessage",
    "detection": "criticalorhighseveritydetectionsbyuser.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Total = count() by DvcHostname, SrcIpAddr, ActorUsername, FileName, FileHash, EventMessage",
    "detection": "criticalorhighseveritydetectionsbyuser.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Total = count() by DvcHostname, SrcIpAddr, ActorUsername, FileName, FileHash, EventMessage",
    "detection": "criticalorhighseveritydetectionsbyuser.yaml",
    "field": "total",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Total = count() by DvcHostname, SrcIpAddr, ActorUsername, FileName, FileHash, EventMessage",
    "detection": "criticalorhighseveritydetectionsbyuser.yaml",
    "field": "dvchostname",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Total = count() by DvcHostname, SrcIpAddr, ActorUsername, FileName, FileHash, EventMessage",
    "detection": "criticalorhighseveritydetectionsbyuser.yaml",
    "field": "srcipaddr",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Total = count() by DvcHostname, SrcIpAddr, ActorUsername, FileName, FileHash, EventMessage",
    "detection": "criticalorhighseveritydetectionsbyuser.yaml",
    "field": "actorusername",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Total = count() by DvcHostname, SrcIpAddr, ActorUsername, FileName, FileHash, EventMessage",
    "detection": "criticalorhighseveritydetectionsbyuser.yaml",
    "field": "filename",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Total = count() by DvcHostname, SrcIpAddr, ActorUsername, FileName, FileHash, EventMessage",
    "detection": "criticalorhighseveritydetectionsbyuser.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Total = count() by DvcHostname, SrcIpAddr, ActorUsername, FileName, FileHash, EventMessage",
    "detection": "criticalorhighseveritydetectionsbyuser.yaml",
    "field": "eventmessage",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, AccountCustomEntity = ActorUsername , HostCustomEntity = DvcHostname, IPCustomEntity = SrcIpAddr, FileHashCustomEntity = FileHash",
    "detection": "criticalorhighseveritydetectionsbyuser.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, AccountCustomEntity = ActorUsername , HostCustomEntity = DvcHostname, IPCustomEntity = SrcIpAddr, FileHashCustomEntity = FileHash",
    "detection": "criticalorhighseveritydetectionsbyuser.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, AccountCustomEntity = ActorUsername , HostCustomEntity = DvcHostname, IPCustomEntity = SrcIpAddr, FileHashCustomEntity = FileHash",
    "detection": "criticalorhighseveritydetectionsbyuser.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, AccountCustomEntity = ActorUsername , HostCustomEntity = DvcHostname, IPCustomEntity = SrcIpAddr, FileHashCustomEntity = FileHash",
    "detection": "criticalorhighseveritydetectionsbyuser.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, AccountCustomEntity = ActorUsername , HostCustomEntity = DvcHostname, IPCustomEntity = SrcIpAddr, FileHashCustomEntity = FileHash",
    "detection": "criticalorhighseveritydetectionsbyuser.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize PPS = 1000 * count() by destPublicIpAddress_s, sec = bin(TimeGenerated, 1s), sourcePublicIpAddress_s",
    "detection": "attacksourcesppsthreshold.yaml",
    "field": "pps",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize PPS = 1000 * count() by destPublicIpAddress_s, sec = bin(TimeGenerated, 1s), sourcePublicIpAddress_s",
    "detection": "attacksourcesppsthreshold.yaml",
    "field": "destpublicipaddress_s",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize PPS = 1000 * count() by destPublicIpAddress_s, sec = bin(TimeGenerated, 1s), sourcePublicIpAddress_s",
    "detection": "attacksourcesppsthreshold.yaml",
    "field": "sourcepublicipaddress_s",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize maxPPS = max(PPS) by destPublicIpAddress_s, sourcePublicIpAddress_s",
    "detection": "attacksourcesppsthreshold.yaml",
    "field": "maxpps",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize maxPPS = max(PPS) by destPublicIpAddress_s, sourcePublicIpAddress_s",
    "detection": "attacksourcesppsthreshold.yaml",
    "field": "destpublicipaddress_s",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize maxPPS = max(PPS) by destPublicIpAddress_s, sourcePublicIpAddress_s",
    "detection": "attacksourcesppsthreshold.yaml",
    "field": "sourcepublicipaddress_s",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize rows_count = count() by destPublicIpAddress_s, sourcePublicIpAddress_s;",
    "detection": "attacksourcespercentthreshold.yaml",
    "field": "rows_count",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize rows_count = count() by destPublicIpAddress_s, sourcePublicIpAddress_s;",
    "detection": "attacksourcespercentthreshold.yaml",
    "field": "destpublicipaddress_s",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize rows_total = count() by destPublicIpAddress_s;",
    "detection": "attacksourcespercentthreshold.yaml",
    "field": "rows_total",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project destPublicIpAddress_s, sourcePublicIpAddress_s, percent_of_traffic = 100*rows_count/rows_total",
    "detection": "attacksourcespercentthreshold.yaml",
    "field": "destpublicipaddress_s",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "  | project destPublicIpAddress_s, sourcePublicIpAddress_s, percent_of_traffic = 100*rows_count/rows_total",
    "detection": "attacksourcespercentthreshold.yaml",
    "field": "sourcepublicipaddress_s",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "  | project destPublicIpAddress_s, sourcePublicIpAddress_s, percent_of_traffic = 100*rows_count/rows_total",
    "detection": "attacksourcespercentthreshold.yaml",
    "field": "percent_of_traffic",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend HostCustomEntity = DvcHostname",
    "detection": "trend-ips-high-severity-events-detected.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by BuildParentProcess=InitiatingProcessFileName, BuildProcess=FileName, BuildAccount = AccountName, DeviceName, BuildCommand=ProcessCommandLine,",
    "detection": "potentialbuildprocesscompromisemde.yaml",
    "field": "buildprocess",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by BuildParentProcess=InitiatingProcessFileName, BuildProcess=FileName, BuildAccount = AccountName, DeviceName, BuildCommand=ProcessCommandLine,",
    "detection": "potentialbuildprocesscompromisemde.yaml",
    "field": "buildaccount",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by BuildParentProcess=InitiatingProcessFileName, BuildProcess=FileName, BuildAccount = AccountName, DeviceName, BuildCommand=ProcessCommandLine,",
    "detection": "potentialbuildprocesscompromisemde.yaml",
    "field": "buildcommand",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by FileEditParentProcess=InitiatingProcessParentFileName, FileEditAccount = InitiatingProcessAccountName, FileEditDomain = InitiatingProcessAccountDomain, FileEditUpn = InitiatingProcessAccountUpn,",
    "detection": "potentialbuildprocesscompromisemde.yaml",
    "field": "fileeditaccount",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by FileEditParentProcess=InitiatingProcessParentFileName, FileEditAccount = InitiatingProcessAccountName, FileEditDomain = InitiatingProcessAccountDomain, FileEditUpn = InitiatingProcessAccountUpn,",
    "detection": "potentialbuildprocesscompromisemde.yaml",
    "field": "fileeditdomain",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by FileEditParentProcess=InitiatingProcessParentFileName, FileEditAccount = InitiatingProcessAccountName, FileEditDomain = InitiatingProcessAccountDomain, FileEditUpn = InitiatingProcessAccountUpn,",
    "detection": "potentialbuildprocesscompromisemde.yaml",
    "field": "fileeditupn",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize make_set(FileEdited), make_set(FileEditProcess) by timekey, DeviceName, BuildParentProcess, BuildProcess, FileEditAccount, FileEditDomain, FileEditUpn",
    "detection": "potentialbuildprocesscompromisemde.yaml",
    "field": "timekey",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize make_set(FileEdited), make_set(FileEditProcess) by timekey, DeviceName, BuildParentProcess, BuildProcess, FileEditAccount, FileEditDomain, FileEditUpn",
    "detection": "potentialbuildprocesscompromisemde.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize make_set(FileEdited), make_set(FileEditProcess) by timekey, DeviceName, BuildParentProcess, BuildProcess, FileEditAccount, FileEditDomain, FileEditUpn",
    "detection": "potentialbuildprocesscompromisemde.yaml",
    "field": "buildparentprocess",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize make_set(FileEdited), make_set(FileEditProcess) by timekey, DeviceName, BuildParentProcess, BuildProcess, FileEditAccount, FileEditDomain, FileEditUpn",
    "detection": "potentialbuildprocesscompromisemde.yaml",
    "field": "buildprocess",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize make_set(FileEdited), make_set(FileEditProcess) by timekey, DeviceName, BuildParentProcess, BuildProcess, FileEditAccount, FileEditDomain, FileEditUpn",
    "detection": "potentialbuildprocesscompromisemde.yaml",
    "field": "fileeditaccount",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize make_set(FileEdited), make_set(FileEditProcess) by timekey, DeviceName, BuildParentProcess, BuildProcess, FileEditAccount, FileEditDomain, FileEditUpn",
    "detection": "potentialbuildprocesscompromisemde.yaml",
    "field": "fileeditdomain",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize make_set(FileEdited), make_set(FileEditProcess) by timekey, DeviceName, BuildParentProcess, BuildProcess, FileEditAccount, FileEditDomain, FileEditUpn",
    "detection": "potentialbuildprocesscompromisemde.yaml",
    "field": "fileeditupn",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(DeviceName, \".\")[0]), DomainIndex = toint(indexof(DeviceName, '.'))",
    "detection": "potentialbuildprocesscompromisemde.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(DeviceName, \".\")[0]), DomainIndex = toint(indexof(DeviceName, '.'))",
    "detection": "potentialbuildprocesscompromisemde.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(DeviceName, DomainIndex + 1), DeviceName)",
    "detection": "potentialbuildprocesscompromisemde.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp=TimeGenerated",
    "detection": "sunspothashes.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(DeviceName, \".\")[0]), DomainIndex = toint(indexof(DeviceName, '.'))",
    "detection": "sunspothashes.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(DeviceName, \".\")[0]), DomainIndex = toint(indexof(DeviceName, '.'))",
    "detection": "sunspothashes.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(DeviceName, DomainIndex + 1), DeviceName)",
    "detection": "sunspothashes.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = split(DeviceName, '.', 0)[0], DnsDomain = strcat_array(array_slice(split(DeviceName, '.'), 1, -1), '.'), FileHashAlgorithm = \"SHA256\"",
    "detection": "adfind-usage.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = split(DeviceName, '.', 0)[0], DnsDomain = strcat_array(array_slice(split(DeviceName, '.'), 1, -1), '.'), FileHashAlgorithm = \"SHA256\"",
    "detection": "adfind-usage.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = split(DeviceName, '.', 0)[0], DnsDomain = strcat_array(array_slice(split(DeviceName, '.'), 1, -1), '.'), FileHashAlgorithm = \"SHA256\"",
    "detection": "adfind-usage.yaml",
    "field": "filehashalgorithm",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend HashAlgorithm = \"MD5\"",
    "detection": "solarwinds-sunburst-supernova-file-iocs.yaml",
    "field": "hashalgorithm",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(DeviceName, \".\")[0]), DomainIndex = toint(indexof(DeviceName, '.'))",
    "detection": "solarwinds-sunburst-supernova-file-iocs.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(DeviceName, \".\")[0]), DomainIndex = toint(indexof(DeviceName, '.'))",
    "detection": "solarwinds-sunburst-supernova-file-iocs.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(DeviceName, DomainIndex + 1), DeviceName)",
    "detection": "solarwinds-sunburst-supernova-file-iocs.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HashAlgorithm = \"SHA1\"",
    "detection": "solarwinds-teardrop-process-iocs.yaml",
    "field": "hashalgorithm",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(DeviceName, \".\")[0]), DomainIndex = toint(indexof(DeviceName, '.'))",
    "detection": "solarwinds-teardrop-process-iocs.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(DeviceName, \".\")[0]), DomainIndex = toint(indexof(DeviceName, '.'))",
    "detection": "solarwinds-teardrop-process-iocs.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(DeviceName, DomainIndex + 1), DeviceName)",
    "detection": "solarwinds-teardrop-process-iocs.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HashAlgorithm = 'MD5'",
    "detection": "solarwinds-sunburst-network-iocs.yaml",
    "field": "hashalgorithm",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(DeviceName, \".\")[0]), DomainIndex = toint(indexof(DeviceName, '.'))",
    "detection": "solarwinds-sunburst-network-iocs.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(DeviceName, \".\")[0]), DomainIndex = toint(indexof(DeviceName, '.'))",
    "detection": "solarwinds-sunburst-network-iocs.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(DeviceName, DomainIndex + 1), DeviceName)",
    "detection": "solarwinds-sunburst-network-iocs.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend susp_ch = countof(ClientRequestURI, '%00')",
    "detection": "cloudflarexssprobingpattern.yaml",
    "field": "susp_ch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr",
    "detection": "cloudflarexssprobingpattern.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend UrlCustomEntity = ClientRequestURI",
    "detection": "cloudflarexssprobingpattern.yaml",
    "field": "urlcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr",
    "detection": "cloudflareunexpectedcountry.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend UrlCustomEntity = ClientRequestURI",
    "detection": "cloudflareunexpectedcountry.yaml",
    "field": "urlcustomentity",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize d_ua = dcount(HttpUserAgentOriginal) by SrcIpAddr, bin(TimeGenerated, 3m)",
    "detection": "cloudflaremultipleuas.yaml",
    "field": "d_ua",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize d_ua = dcount(HttpUserAgentOriginal) by SrcIpAddr, bin(TimeGenerated, 3m)",
    "detection": "cloudflaremultipleuas.yaml",
    "field": "srcipaddr",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr",
    "detection": "cloudflaremultipleuas.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr",
    "detection": "cloudflareunexpectedrequest.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr",
    "detection": "cloudflarebadclientip.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend UrlCustomEntity = ClientRequestURI",
    "detection": "cloudflarebadclientip.yaml",
    "field": "urlcustomentity",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize err_cnt = count() by SrcIpAddr, bin(TimeGenerated, 5m)",
    "detection": "cloudflaremultipleerrorssource.yaml",
    "field": "err_cnt",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize err_cnt = count() by SrcIpAddr, bin(TimeGenerated, 5m)",
    "detection": "cloudflaremultipleerrorssource.yaml",
    "field": "srcipaddr",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr",
    "detection": "cloudflaremultipleerrorssource.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr",
    "detection": "cloudflareunexpectedurl.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend fe = extract(@'.*(\\.\\w+)$', 1, ClientRequestURI)",
    "detection": "cloudflareunexpectedpost.yaml",
    "field": "fe",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr",
    "detection": "cloudflareunexpectedpost.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr",
    "detection": "cloudflarewafthreatallowed.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend UrlCustomEntity = ClientRequestURI",
    "detection": "cloudflarewafthreatallowed.yaml",
    "field": "urlcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr",
    "detection": "cloudflareemptyua.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend cat = extract(\"cat=(.+?);\", 1, AdditionalExtensions)",
    "detection": "vectradetect-behavior-reconnaissance.yaml",
    "field": "cat",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by SourceHostName, detection_name",
    "detection": "vectradetect-behavior-reconnaissance.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by SourceHostName, detection_name",
    "detection": "vectradetect-behavior-reconnaissance.yaml",
    "field": "detection_name",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-reconnaissance.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-reconnaissance.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-reconnaissance.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-reconnaissance.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-reconnaissance.yaml",
    "field": "destinationhostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-reconnaissance.yaml",
    "field": "detection_name",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-reconnaissance.yaml",
    "field": "cat",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-reconnaissance.yaml",
    "field": "threat_score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-reconnaissance.yaml",
    "field": "certainty_score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-reconnaissance.yaml",
    "field": "triaged",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-reconnaissance.yaml",
    "field": "vectra_url",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by SourceHostName",
    "detection": "vectradetect-host-high.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, TimeGenerated, SourceIP, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-host-high.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, TimeGenerated, SourceIP, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-host-high.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, TimeGenerated, SourceIP, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-host-high.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, TimeGenerated, SourceIP, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-host-high.yaml",
    "field": "threat_score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, TimeGenerated, SourceIP, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-host-high.yaml",
    "field": "certainty_score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, TimeGenerated, SourceIP, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-host-high.yaml",
    "field": "vectra_url",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend cat = extract(\"cat=(.+?);\", 1, AdditionalExtensions)",
    "detection": "vectradetect-behavior-insights.yaml",
    "field": "cat",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(TimeGenerated, *) by SourceHostName, detection_name",
    "detection": "vectradetect-behavior-insights.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(TimeGenerated, *) by SourceHostName, detection_name",
    "detection": "vectradetect-behavior-insights.yaml",
    "field": "detection_name",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, triaged, vectra_URL",
    "detection": "vectradetect-behavior-insights.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, triaged, vectra_URL",
    "detection": "vectradetect-behavior-insights.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, triaged, vectra_URL",
    "detection": "vectradetect-behavior-insights.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, triaged, vectra_URL",
    "detection": "vectradetect-behavior-insights.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, triaged, vectra_URL",
    "detection": "vectradetect-behavior-insights.yaml",
    "field": "destinationhostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, triaged, vectra_URL",
    "detection": "vectradetect-behavior-insights.yaml",
    "field": "detection_name",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, triaged, vectra_URL",
    "detection": "vectradetect-behavior-insights.yaml",
    "field": "cat",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, triaged, vectra_URL",
    "detection": "vectradetect-behavior-insights.yaml",
    "field": "triaged",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, triaged, vectra_URL",
    "detection": "vectradetect-behavior-insights.yaml",
    "field": "vectra_url",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend saccount = extract(\"saccount=(.+?);\", 1, AdditionalExtensions)",
    "detection": "vectradetect-account-low.yaml",
    "field": "saccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend type = iff(saccount matches regex upn_has_prefix, tostring(split(saccount,\":\")[0]) ,\"network\" )",
    "detection": "vectradetect-account-low.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend upn = iff(saccount matches regex upn_has_prefix, tostring(split(saccount,\":\")[1]) , saccount )",
    "detection": "vectradetect-account-low.yaml",
    "field": "upn",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by saccount",
    "detection": "vectradetect-account-low.yaml",
    "field": "saccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project saccount, upn, type, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-account-low.yaml",
    "field": "saccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project saccount, upn, type, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-account-low.yaml",
    "field": "upn",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project saccount, upn, type, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-account-low.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project saccount, upn, type, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-account-low.yaml",
    "field": "threat_score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project saccount, upn, type, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-account-low.yaml",
    "field": "certainty_score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project saccount, upn, type, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-account-low.yaml",
    "field": "vectra_url",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Category = extract(\"cat=(.+?);\", 1, AdditionalExtensions)",
    "detection": "vectradetect-highseveritydetection-lateralmovement.yaml",
    "field": "category",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by SourceHostName, Activity",
    "detection": "vectradetect-highseveritydetection-lateralmovement.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by SourceHostName, Activity",
    "detection": "vectradetect-highseveritydetection-lateralmovement.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, Category, Activity, LogSeverity",
    "detection": "vectradetect-highseveritydetection-lateralmovement.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, Category, Activity, LogSeverity",
    "detection": "vectradetect-highseveritydetection-lateralmovement.yaml",
    "field": "category",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, Category, Activity, LogSeverity",
    "detection": "vectradetect-highseveritydetection-lateralmovement.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, Category, Activity, LogSeverity",
    "detection": "vectradetect-highseveritydetection-lateralmovement.yaml",
    "field": "logseverity",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by SourceHostName",
    "detection": "vectradetect-host-critical.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, TimeGenerated, SourceIP, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-host-critical.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, TimeGenerated, SourceIP, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-host-critical.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, TimeGenerated, SourceIP, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-host-critical.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, TimeGenerated, SourceIP, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-host-critical.yaml",
    "field": "threat_score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, TimeGenerated, SourceIP, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-host-critical.yaml",
    "field": "certainty_score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, TimeGenerated, SourceIP, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-host-critical.yaml",
    "field": "vectra_url",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend cat = extract(\"cat=(.+?);\", 1, AdditionalExtensions)",
    "detection": "vectradetect-behavior-exfiltration.yaml",
    "field": "cat",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by SourceHostName, detection_name",
    "detection": "vectradetect-behavior-exfiltration.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by SourceHostName, detection_name",
    "detection": "vectradetect-behavior-exfiltration.yaml",
    "field": "detection_name",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-exfiltration.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-exfiltration.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-exfiltration.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-exfiltration.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-exfiltration.yaml",
    "field": "destinationhostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-exfiltration.yaml",
    "field": "detection_name",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-exfiltration.yaml",
    "field": "cat",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-exfiltration.yaml",
    "field": "threat_score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-exfiltration.yaml",
    "field": "certainty_score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-exfiltration.yaml",
    "field": "triaged",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-exfiltration.yaml",
    "field": "vectra_url",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by SourceHostName",
    "detection": "vectradetect-host-low.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, TimeGenerated, SourceIP, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-host-low.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, TimeGenerated, SourceIP, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-host-low.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, TimeGenerated, SourceIP, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-host-low.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, TimeGenerated, SourceIP, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-host-low.yaml",
    "field": "threat_score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, TimeGenerated, SourceIP, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-host-low.yaml",
    "field": "certainty_score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, TimeGenerated, SourceIP, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-host-low.yaml",
    "field": "vectra_url",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend cat = extract(\"cat=(.+?);\", 1, AdditionalExtensions)",
    "detection": "vectradetect-behavior-botnetactivity.yaml",
    "field": "cat",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by SourceHostName, detection_name",
    "detection": "vectradetect-behavior-botnetactivity.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by SourceHostName, detection_name",
    "detection": "vectradetect-behavior-botnetactivity.yaml",
    "field": "detection_name",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-botnetactivity.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-botnetactivity.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-botnetactivity.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-botnetactivity.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-botnetactivity.yaml",
    "field": "destinationhostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-botnetactivity.yaml",
    "field": "detection_name",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-botnetactivity.yaml",
    "field": "cat",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-botnetactivity.yaml",
    "field": "threat_score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-botnetactivity.yaml",
    "field": "certainty_score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-botnetactivity.yaml",
    "field": "triaged",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-botnetactivity.yaml",
    "field": "vectra_url",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Category = extract(\"cat=(.+?);\", 1, AdditionalExtensions)",
    "detection": "vectradetect-highseveritydetection-botnetactivity.yaml",
    "field": "category",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by SourceHostName, Activity",
    "detection": "vectradetect-highseveritydetection-botnetactivity.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by SourceHostName, Activity",
    "detection": "vectradetect-highseveritydetection-botnetactivity.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, Category, Activity, LogSeverity",
    "detection": "vectradetect-highseveritydetection-botnetactivity.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, Category, Activity, LogSeverity",
    "detection": "vectradetect-highseveritydetection-botnetactivity.yaml",
    "field": "category",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, Category, Activity, LogSeverity",
    "detection": "vectradetect-highseveritydetection-botnetactivity.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, Category, Activity, LogSeverity",
    "detection": "vectradetect-highseveritydetection-botnetactivity.yaml",
    "field": "logseverity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend saccount = extract(\"saccount=(.+?);\", 1, AdditionalExtensions)",
    "detection": "vectradetect-account-high.yaml",
    "field": "saccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend type = iff(saccount matches regex upn_has_prefix, tostring(split(saccount,\":\")[0]) ,\"network\" )",
    "detection": "vectradetect-account-high.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend upn = iff(saccount matches regex upn_has_prefix, tostring(split(saccount,\":\")[1]) , saccount )",
    "detection": "vectradetect-account-high.yaml",
    "field": "upn",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by saccount",
    "detection": "vectradetect-account-high.yaml",
    "field": "saccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project saccount, upn, type, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-account-high.yaml",
    "field": "saccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project saccount, upn, type, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-account-high.yaml",
    "field": "upn",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project saccount, upn, type, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-account-high.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project saccount, upn, type, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-account-high.yaml",
    "field": "threat_score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project saccount, upn, type, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-account-high.yaml",
    "field": "certainty_score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project saccount, upn, type, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-account-high.yaml",
    "field": "vectra_url",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend reason = coalesce(",
    "detection": "vectradetect-newcampaign.yaml",
    "field": "reason",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend cat = extract(\"cat=(.+?);\", 1, AdditionalExtensions)",
    "detection": "vectradetect-behavior-commandandcontrol.yaml",
    "field": "cat",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by SourceHostName, detection_name",
    "detection": "vectradetect-behavior-commandandcontrol.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by SourceHostName, detection_name",
    "detection": "vectradetect-behavior-commandandcontrol.yaml",
    "field": "detection_name",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-commandandcontrol.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-commandandcontrol.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-commandandcontrol.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-commandandcontrol.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-commandandcontrol.yaml",
    "field": "destinationhostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-commandandcontrol.yaml",
    "field": "detection_name",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-commandandcontrol.yaml",
    "field": "cat",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-commandandcontrol.yaml",
    "field": "threat_score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-commandandcontrol.yaml",
    "field": "certainty_score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-commandandcontrol.yaml",
    "field": "triaged",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-commandandcontrol.yaml",
    "field": "vectra_url",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Category = extract(\"cat=(.+?);\", 1, AdditionalExtensions)",
    "detection": "vectradetect-highseveritydetection-commandandcontrol.yaml",
    "field": "category",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by SourceHostName, Activity",
    "detection": "vectradetect-highseveritydetection-commandandcontrol.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by SourceHostName, Activity",
    "detection": "vectradetect-highseveritydetection-commandandcontrol.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, Category, Activity, LogSeverity",
    "detection": "vectradetect-highseveritydetection-commandandcontrol.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, Category, Activity, LogSeverity",
    "detection": "vectradetect-highseveritydetection-commandandcontrol.yaml",
    "field": "category",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, Category, Activity, LogSeverity",
    "detection": "vectradetect-highseveritydetection-commandandcontrol.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, Category, Activity, LogSeverity",
    "detection": "vectradetect-highseveritydetection-commandandcontrol.yaml",
    "field": "logseverity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend cat = extract(\"cat=(.+?);\", 1, AdditionalExtensions)",
    "detection": "vectradetect-behavior-lateralmovement.yaml",
    "field": "cat",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by SourceHostName, detection_name",
    "detection": "vectradetect-behavior-lateralmovement.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by SourceHostName, detection_name",
    "detection": "vectradetect-behavior-lateralmovement.yaml",
    "field": "detection_name",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-lateralmovement.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-lateralmovement.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-lateralmovement.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-lateralmovement.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-lateralmovement.yaml",
    "field": "destinationhostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-lateralmovement.yaml",
    "field": "detection_name",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-lateralmovement.yaml",
    "field": "cat",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-lateralmovement.yaml",
    "field": "threat_score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-lateralmovement.yaml",
    "field": "certainty_score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-lateralmovement.yaml",
    "field": "triaged",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  SourceHostName, SourceIP, DestinationIP, DestinationPort, DestinationHostName, detection_name, cat, threat_score, certainty_score, triaged, vectra_URL",
    "detection": "vectradetect-behavior-lateralmovement.yaml",
    "field": "vectra_url",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend saccount = extract(\"saccount=(.+?);\", 1, AdditionalExtensions)",
    "detection": "vectradetect-account-critical.yaml",
    "field": "saccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend type = iff(saccount matches regex upn_has_prefix, tostring(split(saccount,\":\")[0]) ,\"network\" )",
    "detection": "vectradetect-account-critical.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend upn = iff(saccount matches regex upn_has_prefix, tostring(split(saccount,\":\")[1]) , saccount )",
    "detection": "vectradetect-account-critical.yaml",
    "field": "upn",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by saccount",
    "detection": "vectradetect-account-critical.yaml",
    "field": "saccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project saccount, upn, type, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-account-critical.yaml",
    "field": "saccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project saccount, upn, type, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-account-critical.yaml",
    "field": "upn",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project saccount, upn, type, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-account-critical.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project saccount, upn, type, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-account-critical.yaml",
    "field": "threat_score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project saccount, upn, type, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-account-critical.yaml",
    "field": "certainty_score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project saccount, upn, type, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-account-critical.yaml",
    "field": "vectra_url",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Category = extract(\"cat=(.+?);\", 1, AdditionalExtensions)",
    "detection": "vectradetect-highseveritydetection-reconnaissance.yaml",
    "field": "category",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by SourceHostName, Activity",
    "detection": "vectradetect-highseveritydetection-reconnaissance.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by SourceHostName, Activity",
    "detection": "vectradetect-highseveritydetection-reconnaissance.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, Category, Activity, LogSeverity",
    "detection": "vectradetect-highseveritydetection-reconnaissance.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, Category, Activity, LogSeverity",
    "detection": "vectradetect-highseveritydetection-reconnaissance.yaml",
    "field": "category",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, Category, Activity, LogSeverity",
    "detection": "vectradetect-highseveritydetection-reconnaissance.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, Category, Activity, LogSeverity",
    "detection": "vectradetect-highseveritydetection-reconnaissance.yaml",
    "field": "logseverity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Category = extract(\"cat=(.+?);\", 1, AdditionalExtensions)",
    "detection": "vectradetect-highseveritydetection-exfiltration.yaml",
    "field": "category",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by SourceHostName, Activity",
    "detection": "vectradetect-highseveritydetection-exfiltration.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by SourceHostName, Activity",
    "detection": "vectradetect-highseveritydetection-exfiltration.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, Category, Activity, LogSeverity",
    "detection": "vectradetect-highseveritydetection-exfiltration.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, Category, Activity, LogSeverity",
    "detection": "vectradetect-highseveritydetection-exfiltration.yaml",
    "field": "category",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, Category, Activity, LogSeverity",
    "detection": "vectradetect-highseveritydetection-exfiltration.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, Category, Activity, LogSeverity",
    "detection": "vectradetect-highseveritydetection-exfiltration.yaml",
    "field": "logseverity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend saccount = extract(\"saccount=(.+?);\", 1, AdditionalExtensions)",
    "detection": "vectradetect-account-medium.yaml",
    "field": "saccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend type = iff(saccount matches regex upn_has_prefix, tostring(split(saccount,\":\")[0]) ,\"network\" )",
    "detection": "vectradetect-account-medium.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend upn = iff(saccount matches regex upn_has_prefix, tostring(split(saccount,\":\")[1]) , saccount )",
    "detection": "vectradetect-account-medium.yaml",
    "field": "upn",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(threat_score, *) by saccount",
    "detection": "vectradetect-account-medium.yaml",
    "field": "saccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project saccount, upn, type, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-account-medium.yaml",
    "field": "saccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project saccount, upn, type, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-account-medium.yaml",
    "field": "upn",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project saccount, upn, type, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-account-medium.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project saccount, upn, type, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-account-medium.yaml",
    "field": "threat_score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project saccount, upn, type, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-account-medium.yaml",
    "field": "certainty_score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project saccount, upn, type, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-account-medium.yaml",
    "field": "vectra_url",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(certainty_score, *) by SourceHostName",
    "detection": "vectradetect-host-medium.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, TimeGenerated, SourceIP, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-host-medium.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, TimeGenerated, SourceIP, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-host-medium.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, TimeGenerated, SourceIP, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-host-medium.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, TimeGenerated, SourceIP, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-host-medium.yaml",
    "field": "threat_score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, TimeGenerated, SourceIP, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-host-medium.yaml",
    "field": "certainty_score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SourceHostName, TimeGenerated, SourceIP, threat_score, certainty_score, vectra_URL",
    "detection": "vectradetect-host-medium.yaml",
    "field": "vectra_url",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize Rejection=countif(type_s == \"gd_auth_rejected\"),",
    "detection": "potential-account-takeover.yaml",
    "field": "rejection",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend session_start_time = row_window_session(date_t, 30m, 30m, user_id_s != prev(user_id_s))",
    "detection": "potential-account-takeover.yaml",
    "field": "session_start_time",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend FailureRatio=todouble(failureCount) / todouble(TotalEvents)",
    "detection": "potential-account-takeover.yaml",
    "field": "failureratio",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "successful-action-in-auth0-by-suspicious-ip-from-ti.yaml",
    "field": "latestindicatortime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "successful-action-in-auth0-by-suspicious-ip-from-ti.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TI_ipEntity = coalesce(NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress)",
    "detection": "successful-action-in-auth0-by-suspicious-ip-from-ti.yaml",
    "field": "ti_ipentity",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "      | summarize FailedLoginsCounts = count(),",
    "detection": "multiple-failed-logins-with-suspicious-attribute.yaml",
    "field": "failedloginscounts",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend FilteredCommand = replace_regex(TargetProcessCommandLine, @\":\\S+ --\", \"**** --\")",
    "detection": "password-exposure-through-curl-commandline.yaml",
    "field": "filteredcommand",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventData = parse_xml(EventData).DataItem.EventData.Data",
    "detection": "adfsdbnamedpipeconnection.yaml",
    "field": "eventdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key = tostring(column_ifexists('@Name', \"\")), Value = column_ifexists('#text', \"\")",
    "detection": "adfsdbnamedpipeconnection.yaml",
    "field": "key",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key = tostring(column_ifexists('@Name', \"\")), Value = column_ifexists('#text', \"\")",
    "detection": "adfsdbnamedpipeconnection.yaml",
    "field": "value",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Image = column_ifexists(\"Image\", \"\")",
    "detection": "adfsdbnamedpipeconnection.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend process = split(Image, '\\\\', -1)[-1]",
    "detection": "adfsdbnamedpipeconnection.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend RenderedDescription = tostring(split(RenderedDescription, \":\")[0])",
    "detection": "adfsdbnamedpipeconnection.yaml",
    "field": "rendereddescription",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventData = parse_xml(EventData).DataItem.EventData.Data",
    "detection": "adfsdbnamedpipeconnection.yaml",
    "field": "eventdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key = tostring(column_ifexists('@Name', \"\")), Value = column_ifexists('#text', \"\")",
    "detection": "adfsdbnamedpipeconnection.yaml",
    "field": "key",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key = tostring(column_ifexists('@Name', \"\")), Value = column_ifexists('#text', \"\")",
    "detection": "adfsdbnamedpipeconnection.yaml",
    "field": "value",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend RuleName = column_ifexists(\"RuleName\", \"\"),",
    "detection": "adfsdbnamedpipeconnection.yaml",
    "field": "rulename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend process = split(Image, '\\\\', -1)[-1]",
    "detection": "adfsdbnamedpipeconnection.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Operation = RenderedDescription",
    "detection": "adfsdbnamedpipeconnection.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "adfsdbnamedpipeconnection.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "adfsdbnamedpipeconnection.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "adfsdbnamedpipeconnection.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(UserName, @'\\')[1]), AccountNTDomain = tostring(split(UserName, @'\\')[0])",
    "detection": "adfsdbnamedpipeconnection.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(UserName, @'\\')[1]), AccountNTDomain = tostring(split(UserName, @'\\')[0])",
    "detection": "adfsdbnamedpipeconnection.yaml",
    "field": "accountntdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend md5 = replace_string(md5_g, \"-\" ,\"\")",
    "detection": "possible-malicious-file-detected.yaml",
    "field": "md5",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend HashAlgo = iff(md5 <> \"\", \"MD5\", \"SHA256\")",
    "detection": "possible-malicious-file-detected.yaml",
    "field": "hashalgo",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Extprop = parse_json(ExtendedProperties)",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "extprop",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = iff(isnotempty(tostring(Extprop[\"Compromised Host\"])), tolower(tostring(Extprop[\"Compromised Host\"])), tolower(tostring(parse_json(Entities).HostName)))",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend DnsDomain = iff(isnotempty(tostring(Extprop[\"Machine Domain\"])), tostring(Extprop[\"Machine Domain\"]), tostring(parse_json(Entities).DnsDomain))",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = iff(isnotempty(tostring(Extprop[\"User Name\"])), tostring(Extprop[\"User Name\"]), iff(tostring(parse_json(Entities).Type) == 'account', tostring(parse_json(Entities).Name), ''))",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend NTDomain = iff(isnotempty(tostring(Extprop[\"User Domain\"])), tostring(Extprop[\"User Domain\"]), tostring(parse_json(Entities).NTDomain))",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "ntdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IpAddress = iff(tostring(parse_json(Entities).Type) == 'ip', tostring(parse_json(Entities).Address), tostring(parse_json(Extprop).[\"IpAddress\"]))",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize timestamp = arg_max(TimeGenerated, *) by AlertName, tostring(HostName)",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize timestamp = arg_max(TimeGenerated, *) by AlertName, tostring(HostName)",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "alertname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, AlertName, UserName, NTDomain, tostring(HostName), DnsDomain, IpAddress",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, AlertName, UserName, NTDomain, tostring(HostName), DnsDomain, IpAddress",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "alertname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, AlertName, UserName, NTDomain, tostring(HostName), DnsDomain, IpAddress",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, AlertName, UserName, NTDomain, tostring(HostName), DnsDomain, IpAddress",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "ntdomain",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, AlertName, UserName, NTDomain, tostring(HostName), DnsDomain, IpAddress",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, AlertName, UserName, NTDomain, tostring(HostName), DnsDomain, IpAddress",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend data = split(BackupItemUniqueId, \";\")",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "data",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AzureLocation = data[0], VaultId=data[1], HostName=tolower(tostring(data[2])), DrivesBackedUp=data[3]",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "azurelocation",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AzureLocation = data[0], VaultId=data[1], HostName=tolower(tostring(data[2])), DrivesBackedUp=data[3]",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "vaultid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AzureLocation = data[0], VaultId=data[1], HostName=tolower(tostring(data[2])), DrivesBackedUp=data[3]",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend AzureLocation = data[0], VaultId=data[1], HostName=tolower(tostring(data[2])), DrivesBackedUp=data[3]",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "drivesbackedup",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, AzureLocation, VaultId, HostName, DrivesBackedUp, State, BackupItemUniqueId, _ResourceId, OperationName, BackupItemFriendlyName",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, AzureLocation, VaultId, HostName, DrivesBackedUp, State, BackupItemUniqueId, _ResourceId, OperationName, BackupItemFriendlyName",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "azurelocation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, AzureLocation, VaultId, HostName, DrivesBackedUp, State, BackupItemUniqueId, _ResourceId, OperationName, BackupItemFriendlyName",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "vaultid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, AzureLocation, VaultId, HostName, DrivesBackedUp, State, BackupItemUniqueId, _ResourceId, OperationName, BackupItemFriendlyName",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, AzureLocation, VaultId, HostName, DrivesBackedUp, State, BackupItemUniqueId, _ResourceId, OperationName, BackupItemFriendlyName",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "drivesbackedup",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, AzureLocation, VaultId, HostName, DrivesBackedUp, State, BackupItemUniqueId, _ResourceId, OperationName, BackupItemFriendlyName",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "state",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, AzureLocation, VaultId, HostName, DrivesBackedUp, State, BackupItemUniqueId, _ResourceId, OperationName, BackupItemFriendlyName",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "backupitemuniqueid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, AzureLocation, VaultId, HostName, DrivesBackedUp, State, BackupItemUniqueId, _ResourceId, OperationName, BackupItemFriendlyName",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "_resourceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, AzureLocation, VaultId, HostName, DrivesBackedUp, State, BackupItemUniqueId, _ResourceId, OperationName, BackupItemFriendlyName",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, AzureLocation, VaultId, HostName, DrivesBackedUp, State, BackupItemUniqueId, _ResourceId, OperationName, BackupItemFriendlyName",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "backupitemfriendlyname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, AlertName, HostName, DnsDomain, UserName, NTDomain, _ResourceId, IpAddress, VaultId, AzureLocation, DrivesBackedUp, State, BackupItemUniqueId, OperationName, BackupItemFriendlyName",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, AlertName, HostName, DnsDomain, UserName, NTDomain, _ResourceId, IpAddress, VaultId, AzureLocation, DrivesBackedUp, State, BackupItemUniqueId, OperationName, BackupItemFriendlyName",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "alertname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, AlertName, HostName, DnsDomain, UserName, NTDomain, _ResourceId, IpAddress, VaultId, AzureLocation, DrivesBackedUp, State, BackupItemUniqueId, OperationName, BackupItemFriendlyName",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, AlertName, HostName, DnsDomain, UserName, NTDomain, _ResourceId, IpAddress, VaultId, AzureLocation, DrivesBackedUp, State, BackupItemUniqueId, OperationName, BackupItemFriendlyName",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, AlertName, HostName, DnsDomain, UserName, NTDomain, _ResourceId, IpAddress, VaultId, AzureLocation, DrivesBackedUp, State, BackupItemUniqueId, OperationName, BackupItemFriendlyName",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, AlertName, HostName, DnsDomain, UserName, NTDomain, _ResourceId, IpAddress, VaultId, AzureLocation, DrivesBackedUp, State, BackupItemUniqueId, OperationName, BackupItemFriendlyName",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "ntdomain",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, AlertName, HostName, DnsDomain, UserName, NTDomain, _ResourceId, IpAddress, VaultId, AzureLocation, DrivesBackedUp, State, BackupItemUniqueId, OperationName, BackupItemFriendlyName",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "_resourceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, AlertName, HostName, DnsDomain, UserName, NTDomain, _ResourceId, IpAddress, VaultId, AzureLocation, DrivesBackedUp, State, BackupItemUniqueId, OperationName, BackupItemFriendlyName",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, AlertName, HostName, DnsDomain, UserName, NTDomain, _ResourceId, IpAddress, VaultId, AzureLocation, DrivesBackedUp, State, BackupItemUniqueId, OperationName, BackupItemFriendlyName",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "vaultid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, AlertName, HostName, DnsDomain, UserName, NTDomain, _ResourceId, IpAddress, VaultId, AzureLocation, DrivesBackedUp, State, BackupItemUniqueId, OperationName, BackupItemFriendlyName",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "azurelocation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, AlertName, HostName, DnsDomain, UserName, NTDomain, _ResourceId, IpAddress, VaultId, AzureLocation, DrivesBackedUp, State, BackupItemUniqueId, OperationName, BackupItemFriendlyName",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "drivesbackedup",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, AlertName, HostName, DnsDomain, UserName, NTDomain, _ResourceId, IpAddress, VaultId, AzureLocation, DrivesBackedUp, State, BackupItemUniqueId, OperationName, BackupItemFriendlyName",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "state",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, AlertName, HostName, DnsDomain, UserName, NTDomain, _ResourceId, IpAddress, VaultId, AzureLocation, DrivesBackedUp, State, BackupItemUniqueId, OperationName, BackupItemFriendlyName",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "backupitemuniqueid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, AlertName, HostName, DnsDomain, UserName, NTDomain, _ResourceId, IpAddress, VaultId, AzureLocation, DrivesBackedUp, State, BackupItemUniqueId, OperationName, BackupItemFriendlyName",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, AlertName, HostName, DnsDomain, UserName, NTDomain, _ResourceId, IpAddress, VaultId, AzureLocation, DrivesBackedUp, State, BackupItemUniqueId, OperationName, BackupItemFriendlyName",
    "detection": "corebackupdeletionwithsecurityalert.yaml",
    "field": "backupitemfriendlyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend DNSName = set_union(todynamic(RemoteDnsCanonicalNames),todynamic(RemoteDnsQuestions))",
    "detection": "solorigate-vm-network.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend IPCustomEntity = RemoteIp",
    "detection": "solorigate-vm-network.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize TimeGenerated = arg_min(TimeGenerated, *), requests = count() by IPCustomEntity, DNSName = tostring(DNSName), AgentId, Machine, Process;",
    "detection": "solorigate-vm-network.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize TimeGenerated = arg_min(TimeGenerated, *), requests = count() by IPCustomEntity, DNSName = tostring(DNSName), AgentId, Machine, Process;",
    "detection": "solorigate-vm-network.yaml",
    "field": "requests",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize TimeGenerated = arg_min(TimeGenerated, *), requests = count() by IPCustomEntity, DNSName = tostring(DNSName), AgentId, Machine, Process;",
    "detection": "solorigate-vm-network.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize TimeGenerated = arg_min(TimeGenerated, *), requests = count() by IPCustomEntity, DNSName = tostring(DNSName), AgentId, Machine, Process;",
    "detection": "solorigate-vm-network.yaml",
    "field": "agentid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize TimeGenerated = arg_min(TimeGenerated, *), requests = count() by IPCustomEntity, DNSName = tostring(DNSName), AgentId, Machine, Process;",
    "detection": "solorigate-vm-network.yaml",
    "field": "machine",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project AgentId, Machine, Process, UserName, UserDomain, ExecutablePath, CommandLine, FirstPid",
    "detection": "solorigate-vm-network.yaml",
    "field": "agentid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project AgentId, Machine, Process, UserName, UserDomain, ExecutablePath, CommandLine, FirstPid",
    "detection": "solorigate-vm-network.yaml",
    "field": "machine",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project AgentId, Machine, Process, UserName, UserDomain, ExecutablePath, CommandLine, FirstPid",
    "detection": "solorigate-vm-network.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "    | project AgentId, Machine, Process, UserName, UserDomain, ExecutablePath, CommandLine, FirstPid",
    "detection": "solorigate-vm-network.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project AgentId, Machine, Process, UserName, UserDomain, ExecutablePath, CommandLine, FirstPid",
    "detection": "solorigate-vm-network.yaml",
    "field": "userdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project AgentId, Machine, Process, UserName, UserDomain, ExecutablePath, CommandLine, FirstPid",
    "detection": "solorigate-vm-network.yaml",
    "field": "executablepath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "    | project AgentId, Machine, Process, UserName, UserDomain, ExecutablePath, CommandLine, FirstPid",
    "detection": "solorigate-vm-network.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "    | project AgentId, Machine, Process, UserName, UserDomain, ExecutablePath, CommandLine, FirstPid",
    "detection": "solorigate-vm-network.yaml",
    "field": "firstpid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend exePathArr = split(ExecutablePath, \"\\\\\")",
    "detection": "solorigate-vm-network.yaml",
    "field": "exepatharr",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "    | extend DirectoryName = array_strcat(array_slice(exePathArr, 0, array_length(exePathArr) - 2), \"\\\\\")",
    "detection": "solorigate-vm-network.yaml",
    "field": "directoryname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend Filename = array_strcat(array_slice(exePathArr, array_length(exePathArr) - 1, array_length(exePathArr)), \"\\\\\")",
    "detection": "solorigate-vm-network.yaml",
    "field": "filename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "    | project HostCustomEntity = HostName, AzureResourceId = _ResourceId, AgentId, Machine;",
    "detection": "solorigate-vm-network.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "    | project HostCustomEntity = HostName, AzureResourceId = _ResourceId, AgentId, Machine;",
    "detection": "solorigate-vm-network.yaml",
    "field": "azureresourceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project HostCustomEntity = HostName, AzureResourceId = _ResourceId, AgentId, Machine;",
    "detection": "solorigate-vm-network.yaml",
    "field": "agentid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Entities = parse_json(Entities)",
    "detection": "a-file-with-uncommon-file-extension-was-uploaded.yaml",
    "field": "entities",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend MaliciousFileDirectory = tostring(Entities['Directory']), MaliciousFileName = tostring(Entities['Name']), MaliciousFileHashes = tostring(Entities['FileHashes']);",
    "detection": "a-file-with-uncommon-file-extension-was-uploaded.yaml",
    "field": "maliciousfiledirectory",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend MaliciousFileDirectory = tostring(Entities['Directory']), MaliciousFileName = tostring(Entities['Name']), MaliciousFileHashes = tostring(Entities['FileHashes']);",
    "detection": "a-file-with-uncommon-file-extension-was-uploaded.yaml",
    "field": "maliciousfilename",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend MaliciousFileDirectory = tostring(Entities['Directory']), MaliciousFileName = tostring(Entities['Name']), MaliciousFileHashes = tostring(Entities['FileHashes']);",
    "detection": "a-file-with-uncommon-file-extension-was-uploaded.yaml",
    "field": "maliciousfilehashes",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttackerIP = tostring(Entities['Address']), AttackerCountry = tostring(Entities['Location']['CountryName'])",
    "detection": "a-file-with-uncommon-file-extension-was-uploaded.yaml",
    "field": "attackerip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttackerIP = tostring(Entities['Address']), AttackerCountry = tostring(Entities['Location']['CountryName'])",
    "detection": "a-file-with-uncommon-file-extension-was-uploaded.yaml",
    "field": "attackercountry",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend type = iff(DisplayName has \"file\", \"File\", \"Blob\");",
    "detection": "a-file-with-uncommon-file-extension-was-uploaded.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend uri_path=tostring(parse_path(tostring(Uri)))",
    "detection": "a-file-with-uncommon-file-extension-was-uploaded.yaml",
    "field": "uri_path",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend file_ext=split(tostring((parse_json(uri_path).Extension)),\"?\", 0)[0]",
    "detection": "a-file-with-uncommon-file-extension-was-uploaded.yaml",
    "field": "file_ext",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend ClientIP = tostring(split(CallerIpAddress, \":\", 0)[0])",
    "detection": "a-file-with-uncommon-file-extension-was-uploaded.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend FileName = extract(@\"\\/([\\w\\-. ]+)\\?\", 1, Uri)",
    "detection": "a-file-with-uncommon-file-extension-was-uploaded.yaml",
    "field": "filename",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountCustomEntity = AccountName, IPCustomEntity = ClientIP, URLCustomEntity = Uri, FileCustomEntity = FileName",
    "detection": "a-file-with-uncommon-file-extension-was-uploaded.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountCustomEntity = AccountName, IPCustomEntity = ClientIP, URLCustomEntity = Uri, FileCustomEntity = FileName",
    "detection": "a-file-with-uncommon-file-extension-was-uploaded.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountCustomEntity = AccountName, IPCustomEntity = ClientIP, URLCustomEntity = Uri, FileCustomEntity = FileName",
    "detection": "a-file-with-uncommon-file-extension-was-uploaded.yaml",
    "field": "urlcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountCustomEntity = AccountName, IPCustomEntity = ClientIP, URLCustomEntity = Uri, FileCustomEntity = FileName",
    "detection": "a-file-with-uncommon-file-extension-was-uploaded.yaml",
    "field": "filecustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "hafniumsuspiciousexchangerequestpattern.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "hafniumsuspiciousexchangerequestpattern.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "hafniumsuspiciousexchangerequestpattern.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(csUserName, \"@\")[0]), AccountUPNSuffix = tostring(split(csUserName, \"@\")[1])",
    "detection": "hafniumsuspiciousexchangerequestpattern.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(csUserName, \"@\")[0]), AccountUPNSuffix = tostring(split(csUserName, \"@\")[1])",
    "detection": "hafniumsuspiciousexchangerequestpattern.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend csUriQuery = iff(csUriQuery startswith \"MailboxId=\", tostring(split(csUriQuery, \"&\")[0]) , csUriQuery )",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "csuriquery",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend csUriQuery = iff(csUriQuery startswith \"X-ARR-CACHE-HIT=\", strcat(tostring(split(csUriQuery, \"&\")[0]),tostring(split(csUriQuery, \"&\")[1])) , csUriQuery )",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "csuriquery",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend scStatusFull = strcat(scStatus, \".\",scSubStatus)",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "scstatusfull",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend scStatusFull_Friendly = case(",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "scstatusfull_friendly",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend scWin32Status_Hex = tohex(tolong(scWin32Status))",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "scwin32status_hex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend scWin32Status_Friendly = case(",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "scwin32status_friendly",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend decodedUriQuery = url_decode(csUriQuery)",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "decodeduriquery",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize makeset(decodedUriQuery), makeset(cIP), makeset(sSiteName), makeset(sPort), makeset(csUserAgent), makeset(csMethod), makeset(csUriQuery), makeset(scStatusFull), makeset(scStatusFull_Friendly), makeset(scWin32Status_Hex), makeset(scWin32Status_Friendly), FailedConnectionsCount = count() by bin(TimeGenerated, timeBin), csUserName, Computer, sIP",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "failedconnectionscount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize makeset(decodedUriQuery), makeset(cIP), makeset(sSiteName), makeset(sPort), makeset(csUserAgent), makeset(csMethod), makeset(csUriQuery), makeset(scStatusFull), makeset(scStatusFull_Friendly), makeset(scWin32Status_Hex), makeset(scWin32Status_Friendly), FailedConnectionsCount = count() by bin(TimeGenerated, timeBin), csUserName, Computer, sIP",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "csusername",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize makeset(decodedUriQuery), makeset(cIP), makeset(sSiteName), makeset(sPort), makeset(csUserAgent), makeset(csMethod), makeset(csUriQuery), makeset(scStatusFull), makeset(scStatusFull_Friendly), makeset(scWin32Status_Hex), makeset(scWin32Status_Friendly), FailedConnectionsCount = count() by bin(TimeGenerated, timeBin), csUserName, Computer, sIP",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize makeset(decodedUriQuery), makeset(cIP), makeset(sSiteName), makeset(sPort), makeset(csUserAgent), makeset(csMethod), makeset(csUriQuery), makeset(scStatusFull), makeset(scStatusFull_Friendly), makeset(scWin32Status_Hex), makeset(scWin32Status_Friendly), FailedConnectionsCount = count() by bin(TimeGenerated, timeBin), csUserName, Computer, sIP",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "sip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_cIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_cIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "csusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_cIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "set_decodeduriquery",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_cIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_cIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "set_ssitename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_cIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "sip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_cIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "set_cip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_cIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "set_sport",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_cIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "set_csuseragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_cIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "set_csmethod",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_cIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "set_scstatusfull",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_cIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "set_scstatusfull_friendly",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_cIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "set_scwin32status_hex",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_cIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "set_scwin32status_friendly",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_cIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "failedconnectionscount",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(csUserName, \"@\")[0]), AccountUPNSuffix = tostring(split(csUserName, \"@\")[1])",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(csUserName, \"@\")[0]), AccountUPNSuffix = tostring(split(csUserName, \"@\")[1])",
    "detection": "highfailedlogoncountbyuser.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend scStatusFull = strcat(scStatus, \".\",scSubStatus)",
    "detection": "highportcountbyclientip.yaml",
    "field": "scstatusfull",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend scStatusFull_Friendly = case(",
    "detection": "highportcountbyclientip.yaml",
    "field": "scstatusfull_friendly",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend scWin32Status_Hex = tohex(tolong(scWin32Status))",
    "detection": "highportcountbyclientip.yaml",
    "field": "scwin32status_hex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend scWin32Status_Friendly = case(",
    "detection": "highportcountbyclientip.yaml",
    "field": "scwin32status_friendly",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend decodedUriQuery = url_decode(csUriQuery)",
    "detection": "highportcountbyclientip.yaml",
    "field": "decodeduriquery",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize makeset(sPort), makeset(decodedUriQuery), makeset(csUserName), makeset(sSiteName), makeset(sPort), makeset(csUserAgent), makeset(csMethod), makeset(csUriQuery), makeset(scStatusFull), makeset(scStatusFull_Friendly), makeset(scWin32Status_Hex), makeset(scWin32Status_Friendly), ConnectionsCount = count() by bin(TimeGenerated, timeBin), cIP, Computer, sIP",
    "detection": "highportcountbyclientip.yaml",
    "field": "connectionscount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize makeset(sPort), makeset(decodedUriQuery), makeset(csUserName), makeset(sSiteName), makeset(sPort), makeset(csUserAgent), makeset(csMethod), makeset(csUriQuery), makeset(scStatusFull), makeset(scStatusFull_Friendly), makeset(scWin32Status_Hex), makeset(scWin32Status_Friendly), ConnectionsCount = count() by bin(TimeGenerated, timeBin), cIP, Computer, sIP",
    "detection": "highportcountbyclientip.yaml",
    "field": "cip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize makeset(sPort), makeset(decodedUriQuery), makeset(csUserName), makeset(sSiteName), makeset(sPort), makeset(csUserAgent), makeset(csMethod), makeset(csUriQuery), makeset(scStatusFull), makeset(scStatusFull_Friendly), makeset(scWin32Status_Hex), makeset(scWin32Status_Friendly), ConnectionsCount = count() by bin(TimeGenerated, timeBin), cIP, Computer, sIP",
    "detection": "highportcountbyclientip.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize makeset(sPort), makeset(decodedUriQuery), makeset(csUserName), makeset(sSiteName), makeset(sPort), makeset(csUserAgent), makeset(csMethod), makeset(csUriQuery), makeset(scStatusFull), makeset(scStatusFull_Friendly), makeset(scWin32Status_Hex), makeset(scWin32Status_Friendly), ConnectionsCount = count() by bin(TimeGenerated, timeBin), cIP, Computer, sIP",
    "detection": "highportcountbyclientip.yaml",
    "field": "sip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend portCount = arraylength(set_sPort)",
    "detection": "highportcountbyclientip.yaml",
    "field": "portcount",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_sPort, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, ConnectionsCount, portCount",
    "detection": "highportcountbyclientip.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_sPort, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, ConnectionsCount, portCount",
    "detection": "highportcountbyclientip.yaml",
    "field": "cip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_sPort, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, ConnectionsCount, portCount",
    "detection": "highportcountbyclientip.yaml",
    "field": "set_sport",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_sPort, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, ConnectionsCount, portCount",
    "detection": "highportcountbyclientip.yaml",
    "field": "set_csusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_sPort, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, ConnectionsCount, portCount",
    "detection": "highportcountbyclientip.yaml",
    "field": "set_decodeduriquery",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_sPort, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, ConnectionsCount, portCount",
    "detection": "highportcountbyclientip.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_sPort, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, ConnectionsCount, portCount",
    "detection": "highportcountbyclientip.yaml",
    "field": "set_ssitename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_sPort, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, ConnectionsCount, portCount",
    "detection": "highportcountbyclientip.yaml",
    "field": "sip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_sPort, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, ConnectionsCount, portCount",
    "detection": "highportcountbyclientip.yaml",
    "field": "set_csuseragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_sPort, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, ConnectionsCount, portCount",
    "detection": "highportcountbyclientip.yaml",
    "field": "set_csmethod",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_sPort, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, ConnectionsCount, portCount",
    "detection": "highportcountbyclientip.yaml",
    "field": "set_scstatusfull",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_sPort, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, ConnectionsCount, portCount",
    "detection": "highportcountbyclientip.yaml",
    "field": "set_scstatusfull_friendly",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_sPort, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, ConnectionsCount, portCount",
    "detection": "highportcountbyclientip.yaml",
    "field": "set_scwin32status_hex",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_sPort, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, ConnectionsCount, portCount",
    "detection": "highportcountbyclientip.yaml",
    "field": "set_scwin32status_friendly",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_sPort, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, ConnectionsCount, portCount",
    "detection": "highportcountbyclientip.yaml",
    "field": "connectionscount",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_sPort, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, ConnectionsCount, portCount",
    "detection": "highportcountbyclientip.yaml",
    "field": "portcount",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend scStatusFull = strcat(scStatus, \".\",scSubStatus)",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "scstatusfull",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend scStatusFull_Friendly = case(",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "scstatusfull_friendly",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend scWin32Status_Hex = tohex(tolong(scWin32Status))",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "scwin32status_hex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend scWin32Status_Friendly = case(",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "scwin32status_friendly",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend decodedUriQuery = url_decode(csUriQuery)",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "decodeduriquery",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize makeset(decodedUriQuery), makeset(csUserName), makeset(sSiteName), makeset(sPort), makeset(csUserAgent), makeset(csMethod), makeset(csUriQuery), makeset(scStatusFull), makeset(scStatusFull_Friendly), makeset(scWin32Status_Hex), makeset(scWin32Status_Friendly), FailedConnectionsCount = count() by bin(TimeGenerated, timeBin), cIP, Computer, sIP",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "failedconnectionscount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize makeset(decodedUriQuery), makeset(csUserName), makeset(sSiteName), makeset(sPort), makeset(csUserAgent), makeset(csMethod), makeset(csUriQuery), makeset(scStatusFull), makeset(scStatusFull_Friendly), makeset(scWin32Status_Hex), makeset(scWin32Status_Friendly), FailedConnectionsCount = count() by bin(TimeGenerated, timeBin), cIP, Computer, sIP",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "cip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize makeset(decodedUriQuery), makeset(csUserName), makeset(sSiteName), makeset(sPort), makeset(csUserAgent), makeset(csMethod), makeset(csUriQuery), makeset(scStatusFull), makeset(scStatusFull_Friendly), makeset(scWin32Status_Hex), makeset(scWin32Status_Friendly), FailedConnectionsCount = count() by bin(TimeGenerated, timeBin), cIP, Computer, sIP",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize makeset(decodedUriQuery), makeset(csUserName), makeset(sSiteName), makeset(sPort), makeset(csUserAgent), makeset(csMethod), makeset(csUriQuery), makeset(scStatusFull), makeset(scStatusFull_Friendly), makeset(scWin32Status_Hex), makeset(scWin32Status_Friendly), FailedConnectionsCount = count() by bin(TimeGenerated, timeBin), cIP, Computer, sIP",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "sip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "cip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "set_csusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "set_decodeduriquery",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "set_ssitename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "sip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "set_sport",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "set_csuseragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "set_csmethod",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "set_scstatusfull",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "set_scstatusfull_friendly",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "set_scwin32status_hex",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "set_scwin32status_friendly",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, set_csUserName, set_decodedUriQuery, Computer, set_sSiteName, sIP, set_sPort, set_csUserAgent, set_csMethod, set_scStatusFull, set_scStatusFull_Friendly, set_scWin32Status_Hex, set_scWin32Status_Friendly, FailedConnectionsCount",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "failedconnectionscount",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "highfailedlogoncountbyclientip.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "supernovawebshell.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "supernovawebshell.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "supernovawebshell.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "supernovawebshell.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(csUserName, \"@\")[0]), AccountUPNSuffix = tostring(split(csUserName, \"@\")[1])",
    "detection": "supernovawebshell.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(csUserName, \"@\")[0]), AccountUPNSuffix = tostring(split(csUserName, \"@\")[1])",
    "detection": "supernovawebshell.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, sIP, sSiteName, csUriStem, csUriQuery, Computer, csUserName, _ResourceId, FileUri",
    "detection": "proxyshellpwn2own.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, sIP, sSiteName, csUriStem, csUriQuery, Computer, csUserName, _ResourceId, FileUri",
    "detection": "proxyshellpwn2own.yaml",
    "field": "cip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, sIP, sSiteName, csUriStem, csUriQuery, Computer, csUserName, _ResourceId, FileUri",
    "detection": "proxyshellpwn2own.yaml",
    "field": "sip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, sIP, sSiteName, csUriStem, csUriQuery, Computer, csUserName, _ResourceId, FileUri",
    "detection": "proxyshellpwn2own.yaml",
    "field": "ssitename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, sIP, sSiteName, csUriStem, csUriQuery, Computer, csUserName, _ResourceId, FileUri",
    "detection": "proxyshellpwn2own.yaml",
    "field": "csuristem",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, sIP, sSiteName, csUriStem, csUriQuery, Computer, csUserName, _ResourceId, FileUri",
    "detection": "proxyshellpwn2own.yaml",
    "field": "csuriquery",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, sIP, sSiteName, csUriStem, csUriQuery, Computer, csUserName, _ResourceId, FileUri",
    "detection": "proxyshellpwn2own.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, sIP, sSiteName, csUriStem, csUriQuery, Computer, csUserName, _ResourceId, FileUri",
    "detection": "proxyshellpwn2own.yaml",
    "field": "csusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, sIP, sSiteName, csUriStem, csUriQuery, Computer, csUserName, _ResourceId, FileUri",
    "detection": "proxyshellpwn2own.yaml",
    "field": "_resourceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, cIP, sIP, sSiteName, csUriStem, csUriQuery, Computer, csUserName, _ResourceId, FileUri",
    "detection": "proxyshellpwn2own.yaml",
    "field": "fileuri",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "proxyshellpwn2own.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "proxyshellpwn2own.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "proxyshellpwn2own.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(csUserName, \"@\")[0]), AccountUPNSuffix = tostring(split(csUserName, \"@\")[1])",
    "detection": "proxyshellpwn2own.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(csUserName, \"@\")[0]), AccountUPNSuffix = tostring(split(csUserName, \"@\")[1])",
    "detection": "proxyshellpwn2own.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend csUserAgent_size = string_size(csUserAgent)",
    "detection": "anomaloususeragentconnection.yaml",
    "field": "csuseragent_size",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ConnectionCount = count() by Computer, sSiteName, sPort, csUserAgent, csUserAgent_size, csUserName , csMethod, csUriStem, sIP, cIP, scStatus, scSubStatus, scWin32Status",
    "detection": "anomaloususeragentconnection.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ConnectionCount = count() by Computer, sSiteName, sPort, csUserAgent, csUserAgent_size, csUserName , csMethod, csUriStem, sIP, cIP, scStatus, scSubStatus, scWin32Status",
    "detection": "anomaloususeragentconnection.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ConnectionCount = count() by Computer, sSiteName, sPort, csUserAgent, csUserAgent_size, csUserName , csMethod, csUriStem, sIP, cIP, scStatus, scSubStatus, scWin32Status",
    "detection": "anomaloususeragentconnection.yaml",
    "field": "connectioncount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ConnectionCount = count() by Computer, sSiteName, sPort, csUserAgent, csUserAgent_size, csUserName , csMethod, csUriStem, sIP, cIP, scStatus, scSubStatus, scWin32Status",
    "detection": "anomaloususeragentconnection.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ConnectionCount = count() by Computer, sSiteName, sPort, csUserAgent, csUserAgent_size, csUserName , csMethod, csUriStem, sIP, cIP, scStatus, scSubStatus, scWin32Status",
    "detection": "anomaloususeragentconnection.yaml",
    "field": "ssitename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ConnectionCount = count() by Computer, sSiteName, sPort, csUserAgent, csUserAgent_size, csUserName , csMethod, csUriStem, sIP, cIP, scStatus, scSubStatus, scWin32Status",
    "detection": "anomaloususeragentconnection.yaml",
    "field": "sport",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ConnectionCount = count() by Computer, sSiteName, sPort, csUserAgent, csUserAgent_size, csUserName , csMethod, csUriStem, sIP, cIP, scStatus, scSubStatus, scWin32Status",
    "detection": "anomaloususeragentconnection.yaml",
    "field": "csuseragent",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ConnectionCount = count() by Computer, sSiteName, sPort, csUserAgent, csUserAgent_size, csUserName , csMethod, csUriStem, sIP, cIP, scStatus, scSubStatus, scWin32Status",
    "detection": "anomaloususeragentconnection.yaml",
    "field": "csuseragent_size",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ConnectionCount = count() by Computer, sSiteName, sPort, csUserAgent, csUserAgent_size, csUserName , csMethod, csUriStem, sIP, cIP, scStatus, scSubStatus, scWin32Status",
    "detection": "anomaloususeragentconnection.yaml",
    "field": "csusername",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ConnectionCount = count() by Computer, sSiteName, sPort, csUserAgent, csUserAgent_size, csUserName , csMethod, csUriStem, sIP, cIP, scStatus, scSubStatus, scWin32Status",
    "detection": "anomaloususeragentconnection.yaml",
    "field": "csmethod",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ConnectionCount = count() by Computer, sSiteName, sPort, csUserAgent, csUserAgent_size, csUserName , csMethod, csUriStem, sIP, cIP, scStatus, scSubStatus, scWin32Status",
    "detection": "anomaloususeragentconnection.yaml",
    "field": "csuristem",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ConnectionCount = count() by Computer, sSiteName, sPort, csUserAgent, csUserAgent_size, csUserName , csMethod, csUriStem, sIP, cIP, scStatus, scSubStatus, scWin32Status",
    "detection": "anomaloususeragentconnection.yaml",
    "field": "sip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ConnectionCount = count() by Computer, sSiteName, sPort, csUserAgent, csUserAgent_size, csUserName , csMethod, csUriStem, sIP, cIP, scStatus, scSubStatus, scWin32Status",
    "detection": "anomaloususeragentconnection.yaml",
    "field": "cip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ConnectionCount = count() by Computer, sSiteName, sPort, csUserAgent, csUserAgent_size, csUserName , csMethod, csUriStem, sIP, cIP, scStatus, scSubStatus, scWin32Status",
    "detection": "anomaloususeragentconnection.yaml",
    "field": "scstatus",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ConnectionCount = count() by Computer, sSiteName, sPort, csUserAgent, csUserAgent_size, csUserName , csMethod, csUriStem, sIP, cIP, scStatus, scSubStatus, scWin32Status",
    "detection": "anomaloususeragentconnection.yaml",
    "field": "scsubstatus",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ConnectionCount = count() by Computer, sSiteName, sPort, csUserAgent, csUserAgent_size, csUserName , csMethod, csUriStem, sIP, cIP, scStatus, scSubStatus, scWin32Status",
    "detection": "anomaloususeragentconnection.yaml",
    "field": "scwin32status",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "anomaloususeragentconnection.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "anomaloususeragentconnection.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "anomaloususeragentconnection.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(csUserName, \"@\")[0]), AccountUPNSuffix = tostring(split(csUserName, \"@\")[1])",
    "detection": "anomaloususeragentconnection.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(csUserName, \"@\")[0]), AccountUPNSuffix = tostring(split(csUserName, \"@\")[1])",
    "detection": "anomaloususeragentconnection.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend ResultType = column_ifexists(\"ResultType\", \"None\"), CallerIPAddress = column_ifexists(\"CallerIPAddress\", \"None\")",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "resulttype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ResultType = column_ifexists(\"ResultType\", \"None\"), CallerIPAddress = column_ifexists(\"CallerIPAddress\", \"None\")",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "calleripaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationName, Resource, CallerIPAddress",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationName, Resource, CallerIPAddress",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationName, Resource, CallerIPAddress",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationName, Resource, CallerIPAddress",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "calleripaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project CallerIPAddress, AnomalyHour, TimeGenerated, HourlyCount, baseline, anomalies, score;",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "calleripaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project CallerIPAddress, AnomalyHour, TimeGenerated, HourlyCount, baseline, anomalies, score;",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "anomalyhour",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project CallerIPAddress, AnomalyHour, TimeGenerated, HourlyCount, baseline, anomalies, score;",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project CallerIPAddress, AnomalyHour, TimeGenerated, HourlyCount, baseline, anomalies, score;",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "hourlycount",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project CallerIPAddress, AnomalyHour, TimeGenerated, HourlyCount, baseline, anomalies, score;",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "baseline",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project CallerIPAddress, AnomalyHour, TimeGenerated, HourlyCount, baseline, anomalies, score;",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "anomalies",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DateHour = bin(TimeGenerated, 1h) // create a new column and round to hour",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "datehour",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ResultType = column_ifexists(\"ResultType\", \"NoResultType\")",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "resulttype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend requestUri_s = column_ifexists(\"requestUri_s\", \"None\"), identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g = column_ifexists(\"identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g\", \"None\"),identity_claim_oid_g = column_ifexists(\"identity_claim_oid_g\", \"\"),",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "requesturi_s",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend requestUri_s = column_ifexists(\"requestUri_s\", \"None\"), identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g = column_ifexists(\"identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g\", \"None\"),identity_claim_oid_g = column_ifexists(\"identity_claim_oid_g\", \"\"),",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend requestUri_s = column_ifexists(\"requestUri_s\", \"None\"), identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g = column_ifexists(\"identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g\", \"None\"),identity_claim_oid_g = column_ifexists(\"identity_claim_oid_g\", \"\"),",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "identity_claim_oid_g",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend id_s = column_ifexists(\"id_s\", \"None\"), CallerIPAddress = column_ifexists(\"CallerIPAddress\", \"None\"), clientInfo_s = column_ifexists(\"clientInfo_s\", \"None\")",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "id_s",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend id_s = column_ifexists(\"id_s\", \"None\"), CallerIPAddress = column_ifexists(\"CallerIPAddress\", \"None\"), clientInfo_s = column_ifexists(\"clientInfo_s\", \"None\")",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "calleripaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend id_s = column_ifexists(\"id_s\", \"None\"), CallerIPAddress = column_ifexists(\"CallerIPAddress\", \"None\"), clientInfo_s = column_ifexists(\"clientInfo_s\", \"None\")",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "clientinfo_s",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize PerOperationCount=count(), LatestAnomalyTime = arg_max(TimeGenerated,*) by bin(TimeGenerated,1h), Resource, OperationName, id_s, CallerIPAddress, identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g, identity_claim_oid_g, requestUri_s, clientInfo_s",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "peroperationcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize PerOperationCount=count(), LatestAnomalyTime = arg_max(TimeGenerated,*) by bin(TimeGenerated,1h), Resource, OperationName, id_s, CallerIPAddress, identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g, identity_claim_oid_g, requestUri_s, clientInfo_s",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "latestanomalytime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize PerOperationCount=count(), LatestAnomalyTime = arg_max(TimeGenerated,*) by bin(TimeGenerated,1h), Resource, OperationName, id_s, CallerIPAddress, identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g, identity_claim_oid_g, requestUri_s, clientInfo_s",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize PerOperationCount=count(), LatestAnomalyTime = arg_max(TimeGenerated,*) by bin(TimeGenerated,1h), Resource, OperationName, id_s, CallerIPAddress, identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g, identity_claim_oid_g, requestUri_s, clientInfo_s",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize PerOperationCount=count(), LatestAnomalyTime = arg_max(TimeGenerated,*) by bin(TimeGenerated,1h), Resource, OperationName, id_s, CallerIPAddress, identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g, identity_claim_oid_g, requestUri_s, clientInfo_s",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "id_s",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize PerOperationCount=count(), LatestAnomalyTime = arg_max(TimeGenerated,*) by bin(TimeGenerated,1h), Resource, OperationName, id_s, CallerIPAddress, identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g, identity_claim_oid_g, requestUri_s, clientInfo_s",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "calleripaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize PerOperationCount=count(), LatestAnomalyTime = arg_max(TimeGenerated,*) by bin(TimeGenerated,1h), Resource, OperationName, id_s, CallerIPAddress, identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g, identity_claim_oid_g, requestUri_s, clientInfo_s",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize PerOperationCount=count(), LatestAnomalyTime = arg_max(TimeGenerated,*) by bin(TimeGenerated,1h), Resource, OperationName, id_s, CallerIPAddress, identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g, identity_claim_oid_g, requestUri_s, clientInfo_s",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "identity_claim_oid_g",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize PerOperationCount=count(), LatestAnomalyTime = arg_max(TimeGenerated,*) by bin(TimeGenerated,1h), Resource, OperationName, id_s, CallerIPAddress, identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g, identity_claim_oid_g, requestUri_s, clientInfo_s",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "requesturi_s",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize PerOperationCount=count(), LatestAnomalyTime = arg_max(TimeGenerated,*) by bin(TimeGenerated,1h), Resource, OperationName, id_s, CallerIPAddress, identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g, identity_claim_oid_g, requestUri_s, clientInfo_s",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "clientinfo_s",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount=count(), OperationNameList = make_set(OperationName,1000), RequestURLList = make_set(requestUri_s, 100), AccountList = make_set(CallerObjectId, 100), AccountMax = arg_max(CallerObjectId,*) by Resource, id_s, clientInfo_s, LatestAnomalyTime",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "eventcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount=count(), OperationNameList = make_set(OperationName,1000), RequestURLList = make_set(requestUri_s, 100), AccountList = make_set(CallerObjectId, 100), AccountMax = arg_max(CallerObjectId,*) by Resource, id_s, clientInfo_s, LatestAnomalyTime",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "operationnamelist",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount=count(), OperationNameList = make_set(OperationName,1000), RequestURLList = make_set(requestUri_s, 100), AccountList = make_set(CallerObjectId, 100), AccountMax = arg_max(CallerObjectId,*) by Resource, id_s, clientInfo_s, LatestAnomalyTime",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "requesturllist",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount=count(), OperationNameList = make_set(OperationName,1000), RequestURLList = make_set(requestUri_s, 100), AccountList = make_set(CallerObjectId, 100), AccountMax = arg_max(CallerObjectId,*) by Resource, id_s, clientInfo_s, LatestAnomalyTime",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "accountlist",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount=count(), OperationNameList = make_set(OperationName,1000), RequestURLList = make_set(requestUri_s, 100), AccountList = make_set(CallerObjectId, 100), AccountMax = arg_max(CallerObjectId,*) by Resource, id_s, clientInfo_s, LatestAnomalyTime",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "accountmax",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount=count(), OperationNameList = make_set(OperationName,1000), RequestURLList = make_set(requestUri_s, 100), AccountList = make_set(CallerObjectId, 100), AccountMax = arg_max(CallerObjectId,*) by Resource, id_s, clientInfo_s, LatestAnomalyTime",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount=count(), OperationNameList = make_set(OperationName,1000), RequestURLList = make_set(requestUri_s, 100), AccountList = make_set(CallerObjectId, 100), AccountMax = arg_max(CallerObjectId,*) by Resource, id_s, clientInfo_s, LatestAnomalyTime",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "id_s",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount=count(), OperationNameList = make_set(OperationName,1000), RequestURLList = make_set(requestUri_s, 100), AccountList = make_set(CallerObjectId, 100), AccountMax = arg_max(CallerObjectId,*) by Resource, id_s, clientInfo_s, LatestAnomalyTime",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "clientinfo_s",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount=count(), OperationNameList = make_set(OperationName,1000), RequestURLList = make_set(requestUri_s, 100), AccountList = make_set(CallerObjectId, 100), AccountMax = arg_max(CallerObjectId,*) by Resource, id_s, clientInfo_s, LatestAnomalyTime",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "latestanomalytime",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = LatestAnomalyTime",
    "detection": "timeserieskeyvaultaccessanomaly.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize Count = dcount(requestUri_s) by OperationName, CallerObjectId",
    "detection": "keyvaultmasssecretretrieval.yaml",
    "field": "count",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize Count = dcount(requestUri_s) by OperationName, CallerObjectId",
    "detection": "keyvaultmasssecretretrieval.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize Count = dcount(requestUri_s) by OperationName, CallerObjectId",
    "detection": "keyvaultmasssecretretrieval.yaml",
    "field": "callerobjectid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = EndTime",
    "detection": "keyvaultmasssecretretrieval.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend CallerObjectUPN = coalesce(CallerObjectUPN, ServicePrincipalName)",
    "detection": "keyvaultmasssecretretrieval.yaml",
    "field": "callerobjectupn",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ResultType = column_ifexists(\"ResultType\", \"NoResultType\"),",
    "detection": "keyvaultsensitiveoperations.yaml",
    "field": "resulttype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount=count(), StartTimeUtc=min(TimeGenerated), EndTimeUtc=max(TimeGenerated), TimeTriggered=make_list(TimeGenerated),OperationNameList=make_set(OperationName), RequestURLList=make_set(requestUri_s), CallerIPList = make_set(CallerIPAddress),  CallerIPMax= arg_max(CallerIPAddress,*) by ResourceType, ResultType, Resource, identity_claim_upn_s, clientInfo_s, identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g",
    "detection": "keyvaultsensitiveoperations.yaml",
    "field": "eventcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount=count(), StartTimeUtc=min(TimeGenerated), EndTimeUtc=max(TimeGenerated), TimeTriggered=make_list(TimeGenerated),OperationNameList=make_set(OperationName), RequestURLList=make_set(requestUri_s), CallerIPList = make_set(CallerIPAddress),  CallerIPMax= arg_max(CallerIPAddress,*) by ResourceType, ResultType, Resource, identity_claim_upn_s, clientInfo_s, identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g",
    "detection": "keyvaultsensitiveoperations.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount=count(), StartTimeUtc=min(TimeGenerated), EndTimeUtc=max(TimeGenerated), TimeTriggered=make_list(TimeGenerated),OperationNameList=make_set(OperationName), RequestURLList=make_set(requestUri_s), CallerIPList = make_set(CallerIPAddress),  CallerIPMax= arg_max(CallerIPAddress,*) by ResourceType, ResultType, Resource, identity_claim_upn_s, clientInfo_s, identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g",
    "detection": "keyvaultsensitiveoperations.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount=count(), StartTimeUtc=min(TimeGenerated), EndTimeUtc=max(TimeGenerated), TimeTriggered=make_list(TimeGenerated),OperationNameList=make_set(OperationName), RequestURLList=make_set(requestUri_s), CallerIPList = make_set(CallerIPAddress),  CallerIPMax= arg_max(CallerIPAddress,*) by ResourceType, ResultType, Resource, identity_claim_upn_s, clientInfo_s, identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g",
    "detection": "keyvaultsensitiveoperations.yaml",
    "field": "timetriggered",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount=count(), StartTimeUtc=min(TimeGenerated), EndTimeUtc=max(TimeGenerated), TimeTriggered=make_list(TimeGenerated),OperationNameList=make_set(OperationName), RequestURLList=make_set(requestUri_s), CallerIPList = make_set(CallerIPAddress),  CallerIPMax= arg_max(CallerIPAddress,*) by ResourceType, ResultType, Resource, identity_claim_upn_s, clientInfo_s, identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g",
    "detection": "keyvaultsensitiveoperations.yaml",
    "field": "operationnamelist",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount=count(), StartTimeUtc=min(TimeGenerated), EndTimeUtc=max(TimeGenerated), TimeTriggered=make_list(TimeGenerated),OperationNameList=make_set(OperationName), RequestURLList=make_set(requestUri_s), CallerIPList = make_set(CallerIPAddress),  CallerIPMax= arg_max(CallerIPAddress,*) by ResourceType, ResultType, Resource, identity_claim_upn_s, clientInfo_s, identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g",
    "detection": "keyvaultsensitiveoperations.yaml",
    "field": "requesturllist",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount=count(), StartTimeUtc=min(TimeGenerated), EndTimeUtc=max(TimeGenerated), TimeTriggered=make_list(TimeGenerated),OperationNameList=make_set(OperationName), RequestURLList=make_set(requestUri_s), CallerIPList = make_set(CallerIPAddress),  CallerIPMax= arg_max(CallerIPAddress,*) by ResourceType, ResultType, Resource, identity_claim_upn_s, clientInfo_s, identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g",
    "detection": "keyvaultsensitiveoperations.yaml",
    "field": "calleriplist",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount=count(), StartTimeUtc=min(TimeGenerated), EndTimeUtc=max(TimeGenerated), TimeTriggered=make_list(TimeGenerated),OperationNameList=make_set(OperationName), RequestURLList=make_set(requestUri_s), CallerIPList = make_set(CallerIPAddress),  CallerIPMax= arg_max(CallerIPAddress,*) by ResourceType, ResultType, Resource, identity_claim_upn_s, clientInfo_s, identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g",
    "detection": "keyvaultsensitiveoperations.yaml",
    "field": "calleripmax",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount=count(), StartTimeUtc=min(TimeGenerated), EndTimeUtc=max(TimeGenerated), TimeTriggered=make_list(TimeGenerated),OperationNameList=make_set(OperationName), RequestURLList=make_set(requestUri_s), CallerIPList = make_set(CallerIPAddress),  CallerIPMax= arg_max(CallerIPAddress,*) by ResourceType, ResultType, Resource, identity_claim_upn_s, clientInfo_s, identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g",
    "detection": "keyvaultsensitiveoperations.yaml",
    "field": "resourcetype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount=count(), StartTimeUtc=min(TimeGenerated), EndTimeUtc=max(TimeGenerated), TimeTriggered=make_list(TimeGenerated),OperationNameList=make_set(OperationName), RequestURLList=make_set(requestUri_s), CallerIPList = make_set(CallerIPAddress),  CallerIPMax= arg_max(CallerIPAddress,*) by ResourceType, ResultType, Resource, identity_claim_upn_s, clientInfo_s, identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g",
    "detection": "keyvaultsensitiveoperations.yaml",
    "field": "resulttype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount=count(), StartTimeUtc=min(TimeGenerated), EndTimeUtc=max(TimeGenerated), TimeTriggered=make_list(TimeGenerated),OperationNameList=make_set(OperationName), RequestURLList=make_set(requestUri_s), CallerIPList = make_set(CallerIPAddress),  CallerIPMax= arg_max(CallerIPAddress,*) by ResourceType, ResultType, Resource, identity_claim_upn_s, clientInfo_s, identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g",
    "detection": "keyvaultsensitiveoperations.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount=count(), StartTimeUtc=min(TimeGenerated), EndTimeUtc=max(TimeGenerated), TimeTriggered=make_list(TimeGenerated),OperationNameList=make_set(OperationName), RequestURLList=make_set(requestUri_s), CallerIPList = make_set(CallerIPAddress),  CallerIPMax= arg_max(CallerIPAddress,*) by ResourceType, ResultType, Resource, identity_claim_upn_s, clientInfo_s, identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g",
    "detection": "keyvaultsensitiveoperations.yaml",
    "field": "identity_claim_upn_s",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount=count(), StartTimeUtc=min(TimeGenerated), EndTimeUtc=max(TimeGenerated), TimeTriggered=make_list(TimeGenerated),OperationNameList=make_set(OperationName), RequestURLList=make_set(requestUri_s), CallerIPList = make_set(CallerIPAddress),  CallerIPMax= arg_max(CallerIPAddress,*) by ResourceType, ResultType, Resource, identity_claim_upn_s, clientInfo_s, identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g",
    "detection": "keyvaultsensitiveoperations.yaml",
    "field": "clientinfo_s",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount=count(), StartTimeUtc=min(TimeGenerated), EndTimeUtc=max(TimeGenerated), TimeTriggered=make_list(TimeGenerated),OperationNameList=make_set(OperationName), RequestURLList=make_set(requestUri_s), CallerIPList = make_set(CallerIPAddress),  CallerIPMax= arg_max(CallerIPAddress,*) by ResourceType, ResultType, Resource, identity_claim_upn_s, clientInfo_s, identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g",
    "detection": "keyvaultsensitiveoperations.yaml",
    "field": "identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc",
    "detection": "keyvaultsensitiveoperations.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(identity_claim_upn_s,'@',0)[0]), UPNSuffix = tostring(split(identity_claim_upn_s,'@',1)[0]), AadUserId = identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g",
    "detection": "keyvaultsensitiveoperations.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(identity_claim_upn_s,'@',0)[0]), UPNSuffix = tostring(split(identity_claim_upn_s,'@',1)[0]), AadUserId = identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g",
    "detection": "keyvaultsensitiveoperations.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(identity_claim_upn_s,'@',0)[0]), UPNSuffix = tostring(split(identity_claim_upn_s,'@',1)[0]), AadUserId = identity_claim_http_schemas_microsoft_com_identity_claims_objectidentifier_g",
    "detection": "keyvaultsensitiveoperations.yaml",
    "field": "aaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Properties_d = coalesce(parse_json(Properties), Properties_d)",
    "detection": "subscriptionmigration.yaml",
    "field": "properties_d",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Summary = tostring(Properties_d.message)",
    "detection": "subscriptionmigration.yaml",
    "field": "summary",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventCapture = extract_all(eventCapture, Summary)",
    "detection": "subscriptionmigration.yaml",
    "field": "eventcapture",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceTenantId = iff(isnotempty(EventCapture), EventCapture[0][0], \"\")",
    "detection": "subscriptionmigration.yaml",
    "field": "sourcetenantid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationTenantId = iff(isnotempty(EventCapture), EventCapture[0][1], \"\")",
    "detection": "subscriptionmigration.yaml",
    "field": "destinationtenantid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend parsed_property= parse_json(tostring((parse_json(Properties).responseBody))).properties",
    "detection": "creation-of-expensive-computes-in-azure.yaml",
    "field": "parsed_property",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend vmSize = tostring((parsed_property.hardwareProfile).vmSize)",
    "detection": "creation-of-expensive-computes-in-azure.yaml",
    "field": "vmsize",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ComputerName = tostring((parsed_property.osProfile).computerName)",
    "detection": "creation-of-expensive-computes-in-azure.yaml",
    "field": "computername",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationNameValue, ActivityStatusValue, Caller, CallerIpAddress, ComputerName, vmSize",
    "detection": "creation-of-expensive-computes-in-azure.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationNameValue, ActivityStatusValue, Caller, CallerIpAddress, ComputerName, vmSize",
    "detection": "creation-of-expensive-computes-in-azure.yaml",
    "field": "operationnamevalue",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationNameValue, ActivityStatusValue, Caller, CallerIpAddress, ComputerName, vmSize",
    "detection": "creation-of-expensive-computes-in-azure.yaml",
    "field": "activitystatusvalue",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationNameValue, ActivityStatusValue, Caller, CallerIpAddress, ComputerName, vmSize",
    "detection": "creation-of-expensive-computes-in-azure.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationNameValue, ActivityStatusValue, Caller, CallerIpAddress, ComputerName, vmSize",
    "detection": "creation-of-expensive-computes-in-azure.yaml",
    "field": "calleripaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationNameValue, ActivityStatusValue, Caller, CallerIpAddress, ComputerName, vmSize",
    "detection": "creation-of-expensive-computes-in-azure.yaml",
    "field": "computername",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationNameValue, ActivityStatusValue, Caller, CallerIpAddress, ComputerName, vmSize",
    "detection": "creation-of-expensive-computes-in-azure.yaml",
    "field": "vmsize",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(Caller,'@',0)[0]), UPNSuffix = tostring(split(Caller,'@',1)[0])",
    "detection": "creation-of-expensive-computes-in-azure.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(Caller,'@',0)[0]), UPNSuffix = tostring(split(Caller,'@',1)[0])",
    "detection": "creation-of-expensive-computes-in-azure.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), max(CallerIpAddress), make_list(ActivityStatusValue) by CorrelationId, Authorization, Caller",
    "detection": "runcommanduebabreach.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), max(CallerIpAddress), make_list(ActivityStatusValue) by CorrelationId, Authorization, Caller",
    "detection": "runcommanduebabreach.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), max(CallerIpAddress), make_list(ActivityStatusValue) by CorrelationId, Authorization, Caller",
    "detection": "runcommanduebabreach.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), max(CallerIpAddress), make_list(ActivityStatusValue) by CorrelationId, Authorization, Caller",
    "detection": "runcommanduebabreach.yaml",
    "field": "authorization",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), max(CallerIpAddress), make_list(ActivityStatusValue) by CorrelationId, Authorization, Caller",
    "detection": "runcommanduebabreach.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Authorization_d = parse_json(Authorization)",
    "detection": "runcommanduebabreach.yaml",
    "field": "authorization_d",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Scope = Authorization_d.scope",
    "detection": "runcommanduebabreach.yaml",
    "field": "scope",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Scope_s = split(Scope, \"/\")",
    "detection": "runcommanduebabreach.yaml",
    "field": "scope_s",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Subscription = tostring(Scope_s[2])",
    "detection": "runcommanduebabreach.yaml",
    "field": "subscription",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend VirtualMachineName = tostring(Scope_s[-1])",
    "detection": "runcommanduebabreach.yaml",
    "field": "virtualmachinename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Subscription, VirtualMachineName, CorrelationId, Caller, CallerIpAddress=max_CallerIpAddress",
    "detection": "runcommanduebabreach.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Subscription, VirtualMachineName, CorrelationId, Caller, CallerIpAddress=max_CallerIpAddress",
    "detection": "runcommanduebabreach.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Subscription, VirtualMachineName, CorrelationId, Caller, CallerIpAddress=max_CallerIpAddress",
    "detection": "runcommanduebabreach.yaml",
    "field": "subscription",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Subscription, VirtualMachineName, CorrelationId, Caller, CallerIpAddress=max_CallerIpAddress",
    "detection": "runcommanduebabreach.yaml",
    "field": "virtualmachinename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Subscription, VirtualMachineName, CorrelationId, Caller, CallerIpAddress=max_CallerIpAddress",
    "detection": "runcommanduebabreach.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Subscription, VirtualMachineName, CorrelationId, Caller, CallerIpAddress=max_CallerIpAddress",
    "detection": "runcommanduebabreach.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Subscription, VirtualMachineName, CorrelationId, Caller, CallerIpAddress=max_CallerIpAddress",
    "detection": "runcommanduebabreach.yaml",
    "field": "calleripaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend joinkey = tolower(Caller)",
    "detection": "runcommanduebabreach.yaml",
    "field": "joinkey",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project UEBAEventTime=TimeGenerated, UEBAActionType=ActionType, UserPrincipalName, UEBASourceIPLocation=SourceIPLocation, UEBAActivityInsights=ActivityInsights, UEBAUsersInsights=UsersInsights",
    "detection": "runcommanduebabreach.yaml",
    "field": "uebaeventtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project UEBAEventTime=TimeGenerated, UEBAActionType=ActionType, UserPrincipalName, UEBASourceIPLocation=SourceIPLocation, UEBAActivityInsights=ActivityInsights, UEBAUsersInsights=UsersInsights",
    "detection": "runcommanduebabreach.yaml",
    "field": "uebaactiontype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project UEBAEventTime=TimeGenerated, UEBAActionType=ActionType, UserPrincipalName, UEBASourceIPLocation=SourceIPLocation, UEBAActivityInsights=ActivityInsights, UEBAUsersInsights=UsersInsights",
    "detection": "runcommanduebabreach.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project UEBAEventTime=TimeGenerated, UEBAActionType=ActionType, UserPrincipalName, UEBASourceIPLocation=SourceIPLocation, UEBAActivityInsights=ActivityInsights, UEBAUsersInsights=UsersInsights",
    "detection": "runcommanduebabreach.yaml",
    "field": "uebasourceiplocation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project UEBAEventTime=TimeGenerated, UEBAActionType=ActionType, UserPrincipalName, UEBASourceIPLocation=SourceIPLocation, UEBAActivityInsights=ActivityInsights, UEBAUsersInsights=UsersInsights",
    "detection": "runcommanduebabreach.yaml",
    "field": "uebaactivityinsights",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project UEBAEventTime=TimeGenerated, UEBAActionType=ActionType, UserPrincipalName, UEBASourceIPLocation=SourceIPLocation, UEBAActivityInsights=ActivityInsights, UEBAUsersInsights=UsersInsights",
    "detection": "runcommanduebabreach.yaml",
    "field": "uebausersinsights",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend joinkey = tolower(UserPrincipalName)",
    "detection": "runcommanduebabreach.yaml",
    "field": "joinkey",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UEBAWindowStart = UEBAEventTime - 1h, UEBAWindowEnd = UEBAEventTime + 6h",
    "detection": "runcommanduebabreach.yaml",
    "field": "uebawindowstart",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UEBAWindowStart = UEBAEventTime - 1h, UEBAWindowEnd = UEBAEventTime + 6h",
    "detection": "runcommanduebabreach.yaml",
    "field": "uebawindowend",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Subscription, VirtualMachineName, Caller, CallerIpAddress, UEBAEventTime, UEBAActionType, UEBASourceIPLocation, UEBAActivityInsights, UEBAUsersInsights",
    "detection": "runcommanduebabreach.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Subscription, VirtualMachineName, Caller, CallerIpAddress, UEBAEventTime, UEBAActionType, UEBASourceIPLocation, UEBAActivityInsights, UEBAUsersInsights",
    "detection": "runcommanduebabreach.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Subscription, VirtualMachineName, Caller, CallerIpAddress, UEBAEventTime, UEBAActionType, UEBASourceIPLocation, UEBAActivityInsights, UEBAUsersInsights",
    "detection": "runcommanduebabreach.yaml",
    "field": "subscription",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Subscription, VirtualMachineName, Caller, CallerIpAddress, UEBAEventTime, UEBAActionType, UEBASourceIPLocation, UEBAActivityInsights, UEBAUsersInsights",
    "detection": "runcommanduebabreach.yaml",
    "field": "virtualmachinename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Subscription, VirtualMachineName, Caller, CallerIpAddress, UEBAEventTime, UEBAActionType, UEBASourceIPLocation, UEBAActivityInsights, UEBAUsersInsights",
    "detection": "runcommanduebabreach.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Subscription, VirtualMachineName, Caller, CallerIpAddress, UEBAEventTime, UEBAActionType, UEBASourceIPLocation, UEBAActivityInsights, UEBAUsersInsights",
    "detection": "runcommanduebabreach.yaml",
    "field": "calleripaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Subscription, VirtualMachineName, Caller, CallerIpAddress, UEBAEventTime, UEBAActionType, UEBASourceIPLocation, UEBAActivityInsights, UEBAUsersInsights",
    "detection": "runcommanduebabreach.yaml",
    "field": "uebaeventtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Subscription, VirtualMachineName, Caller, CallerIpAddress, UEBAEventTime, UEBAActionType, UEBASourceIPLocation, UEBAActivityInsights, UEBAUsersInsights",
    "detection": "runcommanduebabreach.yaml",
    "field": "uebaactiontype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Subscription, VirtualMachineName, Caller, CallerIpAddress, UEBAEventTime, UEBAActionType, UEBASourceIPLocation, UEBAActivityInsights, UEBAUsersInsights",
    "detection": "runcommanduebabreach.yaml",
    "field": "uebasourceiplocation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Subscription, VirtualMachineName, Caller, CallerIpAddress, UEBAEventTime, UEBAActionType, UEBASourceIPLocation, UEBAActivityInsights, UEBAUsersInsights",
    "detection": "runcommanduebabreach.yaml",
    "field": "uebaactivityinsights",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Subscription, VirtualMachineName, Caller, CallerIpAddress, UEBAEventTime, UEBAActionType, UEBASourceIPLocation, UEBAActivityInsights, UEBAUsersInsights",
    "detection": "runcommanduebabreach.yaml",
    "field": "uebausersinsights",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Caller, \"@\")[0]), AccountUPNSuffix = tostring(split(Caller, \"@\")[1])",
    "detection": "runcommanduebabreach.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Caller, \"@\")[0]), AccountUPNSuffix = tostring(split(Caller, \"@\")[1])",
    "detection": "runcommanduebabreach.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by CallerIpAddress, Caller, OperationNameValue, bin(TimeGenerated,1d)",
    "detection": "rareoperations.yaml",
    "field": "calleripaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by CallerIpAddress, Caller, OperationNameValue, bin(TimeGenerated,1d)",
    "detection": "rareoperations.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by CallerIpAddress, Caller, OperationNameValue, bin(TimeGenerated,1d)",
    "detection": "rareoperations.yaml",
    "field": "operationnamevalue",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ActivityTimeStamp = make_list(TimeGenerated), ActivityStatusValue = make_list(ActivityStatusValue), CorrelationIds = make_list(CorrelationId), ResourceGroups = make_list(ResourceGroup), ResourceIds = make_list(_ResourceId), ActivityCountByCallerIPAddress = count()",
    "detection": "rareoperations.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ActivityTimeStamp = make_list(TimeGenerated), ActivityStatusValue = make_list(ActivityStatusValue), CorrelationIds = make_list(CorrelationId), ResourceGroups = make_list(ResourceGroup), ResourceIds = make_list(_ResourceId), ActivityCountByCallerIPAddress = count()",
    "detection": "rareoperations.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ActivityTimeStamp = make_list(TimeGenerated), ActivityStatusValue = make_list(ActivityStatusValue), CorrelationIds = make_list(CorrelationId), ResourceGroups = make_list(ResourceGroup), ResourceIds = make_list(_ResourceId), ActivityCountByCallerIPAddress = count()",
    "detection": "rareoperations.yaml",
    "field": "activitytimestamp",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ActivityTimeStamp = make_list(TimeGenerated), ActivityStatusValue = make_list(ActivityStatusValue), CorrelationIds = make_list(CorrelationId), ResourceGroups = make_list(ResourceGroup), ResourceIds = make_list(_ResourceId), ActivityCountByCallerIPAddress = count()",
    "detection": "rareoperations.yaml",
    "field": "activitystatusvalue",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ActivityTimeStamp = make_list(TimeGenerated), ActivityStatusValue = make_list(ActivityStatusValue), CorrelationIds = make_list(CorrelationId), ResourceGroups = make_list(ResourceGroup), ResourceIds = make_list(_ResourceId), ActivityCountByCallerIPAddress = count()",
    "detection": "rareoperations.yaml",
    "field": "correlationids",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ActivityTimeStamp = make_list(TimeGenerated), ActivityStatusValue = make_list(ActivityStatusValue), CorrelationIds = make_list(CorrelationId), ResourceGroups = make_list(ResourceGroup), ResourceIds = make_list(_ResourceId), ActivityCountByCallerIPAddress = count()",
    "detection": "rareoperations.yaml",
    "field": "resourcegroups",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ActivityTimeStamp = make_list(TimeGenerated), ActivityStatusValue = make_list(ActivityStatusValue), CorrelationIds = make_list(CorrelationId), ResourceGroups = make_list(ResourceGroup), ResourceIds = make_list(_ResourceId), ActivityCountByCallerIPAddress = count()",
    "detection": "rareoperations.yaml",
    "field": "resourceids",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ActivityTimeStamp = make_list(TimeGenerated), ActivityStatusValue = make_list(ActivityStatusValue), CorrelationIds = make_list(CorrelationId), ResourceGroups = make_list(ResourceGroup), ResourceIds = make_list(_ResourceId), ActivityCountByCallerIPAddress = count()",
    "detection": "rareoperations.yaml",
    "field": "activitycountbycalleripaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(Caller,'@',0)[0]), UPNSuffix = tostring(split(Caller,'@',1)[0])",
    "detection": "rareoperations.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(Caller,'@',0)[0]), UPNSuffix = tostring(split(Caller,'@',1)[0])",
    "detection": "rareoperations.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Caller",
    "detection": "creating-anomalous-number-of-resources-detection.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Caller",
    "detection": "creating-anomalous-number-of-resources-detection.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Caller, TimeGenerated, Total, baseline, anomalies, score",
    "detection": "creating-anomalous-number-of-resources-detection.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Caller, TimeGenerated, Total, baseline, anomalies, score",
    "detection": "creating-anomalous-number-of-resources-detection.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Caller, TimeGenerated, Total, baseline, anomalies, score",
    "detection": "creating-anomalous-number-of-resources-detection.yaml",
    "field": "total",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Caller, TimeGenerated, Total, baseline, anomalies, score",
    "detection": "creating-anomalous-number-of-resources-detection.yaml",
    "field": "baseline",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Caller, TimeGenerated, Total, baseline, anomalies, score",
    "detection": "creating-anomalous-number-of-resources-detection.yaml",
    "field": "anomalies",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Caller, TimeGenerated, Total, baseline, anomalies, score",
    "detection": "creating-anomalous-number-of-resources-detection.yaml",
    "field": "score",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize make_set(OperationNameValue,100), make_set(_ResourceId,100), make_set(CallerIpAddress,100) by bin(TimeGenerated, timeframe), Caller",
    "detection": "creating-anomalous-number-of-resources-detection.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = iif(Caller has '@',tostring(split(Caller,'@',0)[0]),\"\")",
    "detection": "creating-anomalous-number-of-resources-detection.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UPNSuffix = iif(Caller has '@',tostring(split(Caller,'@',1)[0]),\"\")",
    "detection": "creating-anomalous-number-of-resources-detection.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AadUserId = iif(Caller !has '@',Caller,\"\")",
    "detection": "creating-anomalous-number-of-resources-detection.yaml",
    "field": "aaduserid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by CallerIpAddress, Caller, OperationNameValue, bin(TimeGenerated,1d)",
    "detection": "newresourcegroupsdeployedto.yaml",
    "field": "calleripaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by CallerIpAddress, Caller, OperationNameValue, bin(TimeGenerated,1d)",
    "detection": "newresourcegroupsdeployedto.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by CallerIpAddress, Caller, OperationNameValue, bin(TimeGenerated,1d)",
    "detection": "newresourcegroupsdeployedto.yaml",
    "field": "operationnamevalue",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ActivityTimeStamp = make_set(TimeGenerated,100), ActivityStatusValue = make_set(ActivityStatusValue,100), CorrelationIds = make_set(CorrelationId,100), ResourceGroups = make_set(ResourceGroup,100), ResourceIds = make_set(_ResourceId,100), ActivityCountByCallerIPAddress = count()",
    "detection": "newresourcegroupsdeployedto.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ActivityTimeStamp = make_set(TimeGenerated,100), ActivityStatusValue = make_set(ActivityStatusValue,100), CorrelationIds = make_set(CorrelationId,100), ResourceGroups = make_set(ResourceGroup,100), ResourceIds = make_set(_ResourceId,100), ActivityCountByCallerIPAddress = count()",
    "detection": "newresourcegroupsdeployedto.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ActivityTimeStamp = make_set(TimeGenerated,100), ActivityStatusValue = make_set(ActivityStatusValue,100), CorrelationIds = make_set(CorrelationId,100), ResourceGroups = make_set(ResourceGroup,100), ResourceIds = make_set(_ResourceId,100), ActivityCountByCallerIPAddress = count()",
    "detection": "newresourcegroupsdeployedto.yaml",
    "field": "activitytimestamp",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ActivityTimeStamp = make_set(TimeGenerated,100), ActivityStatusValue = make_set(ActivityStatusValue,100), CorrelationIds = make_set(CorrelationId,100), ResourceGroups = make_set(ResourceGroup,100), ResourceIds = make_set(_ResourceId,100), ActivityCountByCallerIPAddress = count()",
    "detection": "newresourcegroupsdeployedto.yaml",
    "field": "activitystatusvalue",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ActivityTimeStamp = make_set(TimeGenerated,100), ActivityStatusValue = make_set(ActivityStatusValue,100), CorrelationIds = make_set(CorrelationId,100), ResourceGroups = make_set(ResourceGroup,100), ResourceIds = make_set(_ResourceId,100), ActivityCountByCallerIPAddress = count()",
    "detection": "newresourcegroupsdeployedto.yaml",
    "field": "correlationids",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ActivityTimeStamp = make_set(TimeGenerated,100), ActivityStatusValue = make_set(ActivityStatusValue,100), CorrelationIds = make_set(CorrelationId,100), ResourceGroups = make_set(ResourceGroup,100), ResourceIds = make_set(_ResourceId,100), ActivityCountByCallerIPAddress = count()",
    "detection": "newresourcegroupsdeployedto.yaml",
    "field": "resourcegroups",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ActivityTimeStamp = make_set(TimeGenerated,100), ActivityStatusValue = make_set(ActivityStatusValue,100), CorrelationIds = make_set(CorrelationId,100), ResourceGroups = make_set(ResourceGroup,100), ResourceIds = make_set(_ResourceId,100), ActivityCountByCallerIPAddress = count()",
    "detection": "newresourcegroupsdeployedto.yaml",
    "field": "resourceids",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ActivityTimeStamp = make_set(TimeGenerated,100), ActivityStatusValue = make_set(ActivityStatusValue,100), CorrelationIds = make_set(CorrelationId,100), ResourceGroups = make_set(ResourceGroup,100), ResourceIds = make_set(_ResourceId,100), ActivityCountByCallerIPAddress = count()",
    "detection": "newresourcegroupsdeployedto.yaml",
    "field": "activitycountbycalleripaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = iif(Caller has '@',tostring(split(Caller,'@',0)[0]),\"\")",
    "detection": "newresourcegroupsdeployedto.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UPNSuffix = iif(Caller has '@',tostring(split(Caller,'@',1)[0]),\"\")",
    "detection": "newresourcegroupsdeployedto.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AadUserId = iif(Caller !has '@',Caller,\"\")",
    "detection": "newresourcegroupsdeployedto.yaml",
    "field": "aaduserid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Caller",
    "detection": "timeseriesanomaly-mass-cloud-resource-deletions.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Caller",
    "detection": "timeseriesanomaly-mass-cloud-resource-deletions.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Caller, TimeGenerated, Total, baseline, anomalies, score",
    "detection": "timeseriesanomaly-mass-cloud-resource-deletions.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Caller, TimeGenerated, Total, baseline, anomalies, score",
    "detection": "timeseriesanomaly-mass-cloud-resource-deletions.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Caller, TimeGenerated, Total, baseline, anomalies, score",
    "detection": "timeseriesanomaly-mass-cloud-resource-deletions.yaml",
    "field": "total",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Caller, TimeGenerated, Total, baseline, anomalies, score",
    "detection": "timeseriesanomaly-mass-cloud-resource-deletions.yaml",
    "field": "baseline",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Caller, TimeGenerated, Total, baseline, anomalies, score",
    "detection": "timeseriesanomaly-mass-cloud-resource-deletions.yaml",
    "field": "anomalies",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Caller, TimeGenerated, Total, baseline, anomalies, score",
    "detection": "timeseriesanomaly-mass-cloud-resource-deletions.yaml",
    "field": "score",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), make_set(OperationNameValue,100), make_set(_ResourceId,100) by bin(TimeGenerated, timeframe), Caller ) on TimeGenerated, Caller",
    "detection": "timeseriesanomaly-mass-cloud-resource-deletions.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = iif(Caller has '@',tostring(split(Caller,'@',0)[0]),\"\")",
    "detection": "timeseriesanomaly-mass-cloud-resource-deletions.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UPNSuffix = iif(Caller has '@',tostring(split(Caller,'@',1)[0]),\"\")",
    "detection": "timeseriesanomaly-mass-cloud-resource-deletions.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AadUserId = iif(Caller !has '@',Caller,\"\")",
    "detection": "timeseriesanomaly-mass-cloud-resource-deletions.yaml",
    "field": "aaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend claimsJson = parse_json(Claims)",
    "detection": "aadhybridhealthadfsservicedelete.yaml",
    "field": "claimsjson",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AppId = tostring(claimsJson.appid), AccountName = tostring(claimsJson.name), Name = tostring(split(Caller,'@',0)[0]), UPNSuffix = tostring(split(Caller,'@',1)[0])",
    "detection": "aadhybridhealthadfsservicedelete.yaml",
    "field": "appid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AppId = tostring(claimsJson.appid), AccountName = tostring(claimsJson.name), Name = tostring(split(Caller,'@',0)[0]), UPNSuffix = tostring(split(Caller,'@',1)[0])",
    "detection": "aadhybridhealthadfsservicedelete.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AppId = tostring(claimsJson.appid), AccountName = tostring(claimsJson.name), Name = tostring(split(Caller,'@',0)[0]), UPNSuffix = tostring(split(Caller,'@',1)[0])",
    "detection": "aadhybridhealthadfsservicedelete.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AppId = tostring(claimsJson.appid), AccountName = tostring(claimsJson.name), Name = tostring(split(Caller,'@',0)[0]), UPNSuffix = tostring(split(Caller,'@',1)[0])",
    "detection": "aadhybridhealthadfsservicedelete.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend claimsJson = parse_json(Claims)",
    "detection": "aadhybridhealthadfsnewserver.yaml",
    "field": "claimsjson",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AppId = tostring(claimsJson.appid), AccountName = tostring(claimsJson.name), Name = tostring(split(Caller,'@',0)[0]), UPNSuffix = tostring(split(Caller,'@',1)[0])",
    "detection": "aadhybridhealthadfsnewserver.yaml",
    "field": "appid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AppId = tostring(claimsJson.appid), AccountName = tostring(claimsJson.name), Name = tostring(split(Caller,'@',0)[0]), UPNSuffix = tostring(split(Caller,'@',1)[0])",
    "detection": "aadhybridhealthadfsnewserver.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AppId = tostring(claimsJson.appid), AccountName = tostring(claimsJson.name), Name = tostring(split(Caller,'@',0)[0]), UPNSuffix = tostring(split(Caller,'@',1)[0])",
    "detection": "aadhybridhealthadfsnewserver.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AppId = tostring(claimsJson.appid), AccountName = tostring(claimsJson.name), Name = tostring(split(Caller,'@',0)[0]), UPNSuffix = tostring(split(Caller,'@',1)[0])",
    "detection": "aadhybridhealthadfsnewserver.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by CallerIpAddress, Caller, bin(TimeGenerated, 1d)",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "calleripaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by CallerIpAddress, Caller, bin(TimeGenerated, 1d)",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend parsed_property = tostring(parse_json(Properties).requestbody)",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "parsed_property",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend PrincipalId = case(parsed_property has_cs 'PrincipalId',parse_json(parsed_property).Properties.PrincipalId, parsed_property has_cs 'principalId',parse_json(parsed_property).properties.principalId,\"\")",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "principalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend PrincipalType = case(parsed_property has_cs 'PrincipalType',parse_json(parsed_property).Properties.PrincipalType, parsed_property has_cs 'principalType',parse_json(parsed_property).properties.principalType, \"\")",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "principaltype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Scope = case(parsed_property has_cs 'Scope',parse_json(parsed_property).Properties.Scope, parsed_property has_cs 'scope',parse_json(parsed_property).properties.scope,\"\")",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "scope",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend RoleAddedDetails = case(parsed_property has_cs 'RoleDefinitionId',parse_json(parsed_property).Properties.RoleDefinitionId,parsed_property has_cs 'roleDefinitionId',parse_json(parsed_property).properties.roleDefinitionId,\"\")",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "roleaddeddetails",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ActivityTimeStamp = make_set(TimeGenerated), ActivityStatusValue = make_set(ActivityStatusValue), CorrelationId = make_set(CorrelationId), ActivityCountByCallerIPAddress = count()",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ActivityTimeStamp = make_set(TimeGenerated), ActivityStatusValue = make_set(ActivityStatusValue), CorrelationId = make_set(CorrelationId), ActivityCountByCallerIPAddress = count()",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ActivityTimeStamp = make_set(TimeGenerated), ActivityStatusValue = make_set(ActivityStatusValue), CorrelationId = make_set(CorrelationId), ActivityCountByCallerIPAddress = count()",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "activitytimestamp",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ActivityTimeStamp = make_set(TimeGenerated), ActivityStatusValue = make_set(ActivityStatusValue), CorrelationId = make_set(CorrelationId), ActivityCountByCallerIPAddress = count()",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "activitystatusvalue",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ActivityTimeStamp = make_set(TimeGenerated), ActivityStatusValue = make_set(ActivityStatusValue), CorrelationId = make_set(CorrelationId), ActivityCountByCallerIPAddress = count()",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ActivityTimeStamp = make_set(TimeGenerated), ActivityStatusValue = make_set(ActivityStatusValue), CorrelationId = make_set(CorrelationId), ActivityCountByCallerIPAddress = count()",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "activitycountbycalleripaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, AccountCustomEntity = Caller, IPCustomEntity = CallerIpAddress;",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, AccountCustomEntity = Caller, IPCustomEntity = CallerIpAddress;",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, AccountCustomEntity = Caller, IPCustomEntity = CallerIpAddress;",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend RoleAssignedID = tostring(split(RoleAddedDetails, \"/\")[-1])",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "roleassignedid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(StartTimeUtc, *) by PrincipalId, RoleAssignedID",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "principalid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(StartTimeUtc, *) by PrincipalId, RoleAssignedID",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "roleassignedid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(TimeGenerated, *) by AccountObjectId",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "accountobjectid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project ActivityTimeStamp, OperationNameValue, Caller, CallerIpAddress, PrincipalId, RoleAssignedID, RoleAddedDetails, Role, RoleDescription, AccountUPN, AccountCreationTime, GroupMembership, UserType, ActivityStatusValue, ResourceGroup, PrincipalType, Scope, CorrelationId, timestamp, AccountCustomEntity, IPCustomEntity, AssignmentCountbyCaller",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "activitytimestamp",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project ActivityTimeStamp, OperationNameValue, Caller, CallerIpAddress, PrincipalId, RoleAssignedID, RoleAddedDetails, Role, RoleDescription, AccountUPN, AccountCreationTime, GroupMembership, UserType, ActivityStatusValue, ResourceGroup, PrincipalType, Scope, CorrelationId, timestamp, AccountCustomEntity, IPCustomEntity, AssignmentCountbyCaller",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "operationnamevalue",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project ActivityTimeStamp, OperationNameValue, Caller, CallerIpAddress, PrincipalId, RoleAssignedID, RoleAddedDetails, Role, RoleDescription, AccountUPN, AccountCreationTime, GroupMembership, UserType, ActivityStatusValue, ResourceGroup, PrincipalType, Scope, CorrelationId, timestamp, AccountCustomEntity, IPCustomEntity, AssignmentCountbyCaller",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project ActivityTimeStamp, OperationNameValue, Caller, CallerIpAddress, PrincipalId, RoleAssignedID, RoleAddedDetails, Role, RoleDescription, AccountUPN, AccountCreationTime, GroupMembership, UserType, ActivityStatusValue, ResourceGroup, PrincipalType, Scope, CorrelationId, timestamp, AccountCustomEntity, IPCustomEntity, AssignmentCountbyCaller",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "calleripaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project ActivityTimeStamp, OperationNameValue, Caller, CallerIpAddress, PrincipalId, RoleAssignedID, RoleAddedDetails, Role, RoleDescription, AccountUPN, AccountCreationTime, GroupMembership, UserType, ActivityStatusValue, ResourceGroup, PrincipalType, Scope, CorrelationId, timestamp, AccountCustomEntity, IPCustomEntity, AssignmentCountbyCaller",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "principalid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project ActivityTimeStamp, OperationNameValue, Caller, CallerIpAddress, PrincipalId, RoleAssignedID, RoleAddedDetails, Role, RoleDescription, AccountUPN, AccountCreationTime, GroupMembership, UserType, ActivityStatusValue, ResourceGroup, PrincipalType, Scope, CorrelationId, timestamp, AccountCustomEntity, IPCustomEntity, AssignmentCountbyCaller",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "roleassignedid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project ActivityTimeStamp, OperationNameValue, Caller, CallerIpAddress, PrincipalId, RoleAssignedID, RoleAddedDetails, Role, RoleDescription, AccountUPN, AccountCreationTime, GroupMembership, UserType, ActivityStatusValue, ResourceGroup, PrincipalType, Scope, CorrelationId, timestamp, AccountCustomEntity, IPCustomEntity, AssignmentCountbyCaller",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "roleaddeddetails",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project ActivityTimeStamp, OperationNameValue, Caller, CallerIpAddress, PrincipalId, RoleAssignedID, RoleAddedDetails, Role, RoleDescription, AccountUPN, AccountCreationTime, GroupMembership, UserType, ActivityStatusValue, ResourceGroup, PrincipalType, Scope, CorrelationId, timestamp, AccountCustomEntity, IPCustomEntity, AssignmentCountbyCaller",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "role",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project ActivityTimeStamp, OperationNameValue, Caller, CallerIpAddress, PrincipalId, RoleAssignedID, RoleAddedDetails, Role, RoleDescription, AccountUPN, AccountCreationTime, GroupMembership, UserType, ActivityStatusValue, ResourceGroup, PrincipalType, Scope, CorrelationId, timestamp, AccountCustomEntity, IPCustomEntity, AssignmentCountbyCaller",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "roledescription",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project ActivityTimeStamp, OperationNameValue, Caller, CallerIpAddress, PrincipalId, RoleAssignedID, RoleAddedDetails, Role, RoleDescription, AccountUPN, AccountCreationTime, GroupMembership, UserType, ActivityStatusValue, ResourceGroup, PrincipalType, Scope, CorrelationId, timestamp, AccountCustomEntity, IPCustomEntity, AssignmentCountbyCaller",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "accountupn",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project ActivityTimeStamp, OperationNameValue, Caller, CallerIpAddress, PrincipalId, RoleAssignedID, RoleAddedDetails, Role, RoleDescription, AccountUPN, AccountCreationTime, GroupMembership, UserType, ActivityStatusValue, ResourceGroup, PrincipalType, Scope, CorrelationId, timestamp, AccountCustomEntity, IPCustomEntity, AssignmentCountbyCaller",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "accountcreationtime",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project ActivityTimeStamp, OperationNameValue, Caller, CallerIpAddress, PrincipalId, RoleAssignedID, RoleAddedDetails, Role, RoleDescription, AccountUPN, AccountCreationTime, GroupMembership, UserType, ActivityStatusValue, ResourceGroup, PrincipalType, Scope, CorrelationId, timestamp, AccountCustomEntity, IPCustomEntity, AssignmentCountbyCaller",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "groupmembership",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project ActivityTimeStamp, OperationNameValue, Caller, CallerIpAddress, PrincipalId, RoleAssignedID, RoleAddedDetails, Role, RoleDescription, AccountUPN, AccountCreationTime, GroupMembership, UserType, ActivityStatusValue, ResourceGroup, PrincipalType, Scope, CorrelationId, timestamp, AccountCustomEntity, IPCustomEntity, AssignmentCountbyCaller",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "usertype",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project ActivityTimeStamp, OperationNameValue, Caller, CallerIpAddress, PrincipalId, RoleAssignedID, RoleAddedDetails, Role, RoleDescription, AccountUPN, AccountCreationTime, GroupMembership, UserType, ActivityStatusValue, ResourceGroup, PrincipalType, Scope, CorrelationId, timestamp, AccountCustomEntity, IPCustomEntity, AssignmentCountbyCaller",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "activitystatusvalue",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project ActivityTimeStamp, OperationNameValue, Caller, CallerIpAddress, PrincipalId, RoleAssignedID, RoleAddedDetails, Role, RoleDescription, AccountUPN, AccountCreationTime, GroupMembership, UserType, ActivityStatusValue, ResourceGroup, PrincipalType, Scope, CorrelationId, timestamp, AccountCustomEntity, IPCustomEntity, AssignmentCountbyCaller",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "resourcegroup",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project ActivityTimeStamp, OperationNameValue, Caller, CallerIpAddress, PrincipalId, RoleAssignedID, RoleAddedDetails, Role, RoleDescription, AccountUPN, AccountCreationTime, GroupMembership, UserType, ActivityStatusValue, ResourceGroup, PrincipalType, Scope, CorrelationId, timestamp, AccountCustomEntity, IPCustomEntity, AssignmentCountbyCaller",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "principaltype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project ActivityTimeStamp, OperationNameValue, Caller, CallerIpAddress, PrincipalId, RoleAssignedID, RoleAddedDetails, Role, RoleDescription, AccountUPN, AccountCreationTime, GroupMembership, UserType, ActivityStatusValue, ResourceGroup, PrincipalType, Scope, CorrelationId, timestamp, AccountCustomEntity, IPCustomEntity, AssignmentCountbyCaller",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "scope",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project ActivityTimeStamp, OperationNameValue, Caller, CallerIpAddress, PrincipalId, RoleAssignedID, RoleAddedDetails, Role, RoleDescription, AccountUPN, AccountCreationTime, GroupMembership, UserType, ActivityStatusValue, ResourceGroup, PrincipalType, Scope, CorrelationId, timestamp, AccountCustomEntity, IPCustomEntity, AssignmentCountbyCaller",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project ActivityTimeStamp, OperationNameValue, Caller, CallerIpAddress, PrincipalId, RoleAssignedID, RoleAddedDetails, Role, RoleDescription, AccountUPN, AccountCreationTime, GroupMembership, UserType, ActivityStatusValue, ResourceGroup, PrincipalType, Scope, CorrelationId, timestamp, AccountCustomEntity, IPCustomEntity, AssignmentCountbyCaller",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project ActivityTimeStamp, OperationNameValue, Caller, CallerIpAddress, PrincipalId, RoleAssignedID, RoleAddedDetails, Role, RoleDescription, AccountUPN, AccountCreationTime, GroupMembership, UserType, ActivityStatusValue, ResourceGroup, PrincipalType, Scope, CorrelationId, timestamp, AccountCustomEntity, IPCustomEntity, AssignmentCountbyCaller",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project ActivityTimeStamp, OperationNameValue, Caller, CallerIpAddress, PrincipalId, RoleAssignedID, RoleAddedDetails, Role, RoleDescription, AccountUPN, AccountCreationTime, GroupMembership, UserType, ActivityStatusValue, ResourceGroup, PrincipalType, Scope, CorrelationId, timestamp, AccountCustomEntity, IPCustomEntity, AssignmentCountbyCaller",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project ActivityTimeStamp, OperationNameValue, Caller, CallerIpAddress, PrincipalId, RoleAssignedID, RoleAddedDetails, Role, RoleDescription, AccountUPN, AccountCreationTime, GroupMembership, UserType, ActivityStatusValue, ResourceGroup, PrincipalType, Scope, CorrelationId, timestamp, AccountCustomEntity, IPCustomEntity, AssignmentCountbyCaller",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "assignmentcountbycaller",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(Caller,'@',0)[0]), UPNSuffix = tostring(split(Caller,'@',1)[0])",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(Caller,'@',0)[0]), UPNSuffix = tostring(split(Caller,'@',1)[0])",
    "detection": "granting-permissions-to-account-detection.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend claimsJson = parse_json(Claims)",
    "detection": "aadhybridhealthadfssuspapp.yaml",
    "field": "claimsjson",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AppId = tostring(claimsJson.appid), AccountName = tostring(claimsJson.name), Name = tostring(split(Caller,'@',0)[0]), UPNSuffix = tostring(split(Caller,'@',1)[0])",
    "detection": "aadhybridhealthadfssuspapp.yaml",
    "field": "appid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AppId = tostring(claimsJson.appid), AccountName = tostring(claimsJson.name), Name = tostring(split(Caller,'@',0)[0]), UPNSuffix = tostring(split(Caller,'@',1)[0])",
    "detection": "aadhybridhealthadfssuspapp.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AppId = tostring(claimsJson.appid), AccountName = tostring(claimsJson.name), Name = tostring(split(Caller,'@',0)[0]), UPNSuffix = tostring(split(Caller,'@',1)[0])",
    "detection": "aadhybridhealthadfssuspapp.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AppId = tostring(claimsJson.appid), AccountName = tostring(claimsJson.name), Name = tostring(split(Caller,'@',0)[0]), UPNSuffix = tostring(split(Caller,'@',1)[0])",
    "detection": "aadhybridhealthadfssuspapp.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TI_ipEntity = NetworkIP",
    "detection": "recordedfutureipmalwarec2inazureactivityevents.yaml",
    "field": "ti_ipentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AzureActivity_TimeGenerated = TimeGenerated",
    "detection": "recordedfutureipmalwarec2inazureactivityevents.yaml",
    "field": "azureactivity_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "recordedfutureipmalwarec2inazureactivityevents.yaml",
    "field": "latestindicatortime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "recordedfutureipmalwarec2inazureactivityevents.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, AzureActivity_TimeGenerated, TI_ipEntity, CallerIpAddress, Caller, OperationNameValue, ActivityStatusValue, CategoryValue, ResourceId, NetworkIP, Description, AdditionalInformation",
    "detection": "recordedfutureipmalwarec2inazureactivityevents.yaml",
    "field": "latestindicatortime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, AzureActivity_TimeGenerated, TI_ipEntity, CallerIpAddress, Caller, OperationNameValue, ActivityStatusValue, CategoryValue, ResourceId, NetworkIP, Description, AdditionalInformation",
    "detection": "recordedfutureipmalwarec2inazureactivityevents.yaml",
    "field": "activitygroupnames",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, AzureActivity_TimeGenerated, TI_ipEntity, CallerIpAddress, Caller, OperationNameValue, ActivityStatusValue, CategoryValue, ResourceId, NetworkIP, Description, AdditionalInformation",
    "detection": "recordedfutureipmalwarec2inazureactivityevents.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, AzureActivity_TimeGenerated, TI_ipEntity, CallerIpAddress, Caller, OperationNameValue, ActivityStatusValue, CategoryValue, ResourceId, NetworkIP, Description, AdditionalInformation",
    "detection": "recordedfutureipmalwarec2inazureactivityevents.yaml",
    "field": "threattype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, AzureActivity_TimeGenerated, TI_ipEntity, CallerIpAddress, Caller, OperationNameValue, ActivityStatusValue, CategoryValue, ResourceId, NetworkIP, Description, AdditionalInformation",
    "detection": "recordedfutureipmalwarec2inazureactivityevents.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, AzureActivity_TimeGenerated, TI_ipEntity, CallerIpAddress, Caller, OperationNameValue, ActivityStatusValue, CategoryValue, ResourceId, NetworkIP, Description, AdditionalInformation",
    "detection": "recordedfutureipmalwarec2inazureactivityevents.yaml",
    "field": "expirationdatetime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, AzureActivity_TimeGenerated, TI_ipEntity, CallerIpAddress, Caller, OperationNameValue, ActivityStatusValue, CategoryValue, ResourceId, NetworkIP, Description, AdditionalInformation",
    "detection": "recordedfutureipmalwarec2inazureactivityevents.yaml",
    "field": "confidencescore",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, AzureActivity_TimeGenerated, TI_ipEntity, CallerIpAddress, Caller, OperationNameValue, ActivityStatusValue, CategoryValue, ResourceId, NetworkIP, Description, AdditionalInformation",
    "detection": "recordedfutureipmalwarec2inazureactivityevents.yaml",
    "field": "azureactivity_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, AzureActivity_TimeGenerated, TI_ipEntity, CallerIpAddress, Caller, OperationNameValue, ActivityStatusValue, CategoryValue, ResourceId, NetworkIP, Description, AdditionalInformation",
    "detection": "recordedfutureipmalwarec2inazureactivityevents.yaml",
    "field": "ti_ipentity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, AzureActivity_TimeGenerated, TI_ipEntity, CallerIpAddress, Caller, OperationNameValue, ActivityStatusValue, CategoryValue, ResourceId, NetworkIP, Description, AdditionalInformation",
    "detection": "recordedfutureipmalwarec2inazureactivityevents.yaml",
    "field": "calleripaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, AzureActivity_TimeGenerated, TI_ipEntity, CallerIpAddress, Caller, OperationNameValue, ActivityStatusValue, CategoryValue, ResourceId, NetworkIP, Description, AdditionalInformation",
    "detection": "recordedfutureipmalwarec2inazureactivityevents.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, AzureActivity_TimeGenerated, TI_ipEntity, CallerIpAddress, Caller, OperationNameValue, ActivityStatusValue, CategoryValue, ResourceId, NetworkIP, Description, AdditionalInformation",
    "detection": "recordedfutureipmalwarec2inazureactivityevents.yaml",
    "field": "operationnamevalue",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, AzureActivity_TimeGenerated, TI_ipEntity, CallerIpAddress, Caller, OperationNameValue, ActivityStatusValue, CategoryValue, ResourceId, NetworkIP, Description, AdditionalInformation",
    "detection": "recordedfutureipmalwarec2inazureactivityevents.yaml",
    "field": "activitystatusvalue",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, AzureActivity_TimeGenerated, TI_ipEntity, CallerIpAddress, Caller, OperationNameValue, ActivityStatusValue, CategoryValue, ResourceId, NetworkIP, Description, AdditionalInformation",
    "detection": "recordedfutureipmalwarec2inazureactivityevents.yaml",
    "field": "categoryvalue",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, AzureActivity_TimeGenerated, TI_ipEntity, CallerIpAddress, Caller, OperationNameValue, ActivityStatusValue, CategoryValue, ResourceId, NetworkIP, Description, AdditionalInformation",
    "detection": "recordedfutureipmalwarec2inazureactivityevents.yaml",
    "field": "resourceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, AzureActivity_TimeGenerated, TI_ipEntity, CallerIpAddress, Caller, OperationNameValue, ActivityStatusValue, CategoryValue, ResourceId, NetworkIP, Description, AdditionalInformation",
    "detection": "recordedfutureipmalwarec2inazureactivityevents.yaml",
    "field": "networkip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, AzureActivity_TimeGenerated, TI_ipEntity, CallerIpAddress, Caller, OperationNameValue, ActivityStatusValue, CategoryValue, ResourceId, NetworkIP, Description, AdditionalInformation",
    "detection": "recordedfutureipmalwarec2inazureactivityevents.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, AzureActivity_TimeGenerated, TI_ipEntity, CallerIpAddress, Caller, OperationNameValue, ActivityStatusValue, CategoryValue, ResourceId, NetworkIP, Description, AdditionalInformation",
    "detection": "recordedfutureipmalwarec2inazureactivityevents.yaml",
    "field": "additionalinformation",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Caller, \"@\")[0]), AccountUPNSuffix = tostring(split(Caller, \"@\")[1])",
    "detection": "recordedfutureipmalwarec2inazureactivityevents.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Caller, \"@\")[0]), AccountUPNSuffix = tostring(split(Caller, \"@\")[1])",
    "detection": "recordedfutureipmalwarec2inazureactivityevents.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Caller",
    "detection": "threat-essentials-timeseriesanomaly-mass-cloud-resource-deletions.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Caller",
    "detection": "threat-essentials-timeseriesanomaly-mass-cloud-resource-deletions.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Caller, TimeGenerated, Total, baseline, anomalies, score",
    "detection": "threat-essentials-timeseriesanomaly-mass-cloud-resource-deletions.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Caller, TimeGenerated, Total, baseline, anomalies, score",
    "detection": "threat-essentials-timeseriesanomaly-mass-cloud-resource-deletions.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Caller, TimeGenerated, Total, baseline, anomalies, score",
    "detection": "threat-essentials-timeseriesanomaly-mass-cloud-resource-deletions.yaml",
    "field": "total",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Caller, TimeGenerated, Total, baseline, anomalies, score",
    "detection": "threat-essentials-timeseriesanomaly-mass-cloud-resource-deletions.yaml",
    "field": "baseline",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Caller, TimeGenerated, Total, baseline, anomalies, score",
    "detection": "threat-essentials-timeseriesanomaly-mass-cloud-resource-deletions.yaml",
    "field": "anomalies",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Caller, TimeGenerated, Total, baseline, anomalies, score",
    "detection": "threat-essentials-timeseriesanomaly-mass-cloud-resource-deletions.yaml",
    "field": "score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Caller",
    "detection": "threat-essentials-timeseriesanomaly-mass-cloud-resource-deletions.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Caller",
    "detection": "threat-essentials-timeseriesanomaly-mass-cloud-resource-deletions.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), make_set(OperationNameValue), make_set(Resource) by bin(TimeGenerated, 1h), Caller) on TimeGenerated, Caller",
    "detection": "threat-essentials-timeseriesanomaly-mass-cloud-resource-deletions.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = iif(Caller has '@',tostring(split(Caller,'@',0)[0]),\"\")",
    "detection": "threat-essentials-timeseriesanomaly-mass-cloud-resource-deletions.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UPNSuffix = iif(Caller has '@',tostring(split(Caller,'@',1)[0]),\"\")",
    "detection": "threat-essentials-timeseriesanomaly-mass-cloud-resource-deletions.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AadUserId = iif(Caller !has '@',Caller,\"\")",
    "detection": "threat-essentials-timeseriesanomaly-mass-cloud-resource-deletions.yaml",
    "field": "aaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend SrcIpAddr = parse_json(HTTPRequest).clientIpAddress, UserPrincipalName = Caller",
    "detection": "azure-blob-public-container-access-level-modification.yaml",
    "field": "srcipaddr",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SrcIpAddr = parse_json(HTTPRequest).clientIpAddress, UserPrincipalName = Caller",
    "detection": "azure-blob-public-container-access-level-modification.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AuthMethod = parse_json(Claims).[\"http://schemas.microsoft.com/claims/authnmethodsreferences\"]",
    "detection": "azure-blob-public-container-access-level-modification.yaml",
    "field": "authmethod",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project UserPrincipalName, SrcIpAddr, IsInteractive, ClientAppUsed, AccessedResource, AuthStepResultDetail, AuthMethod,ResourceProviderValue, OperationNameValue, LocationDetails",
    "detection": "azure-blob-public-container-access-level-modification.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project UserPrincipalName, SrcIpAddr, IsInteractive, ClientAppUsed, AccessedResource, AuthStepResultDetail, AuthMethod,ResourceProviderValue, OperationNameValue, LocationDetails",
    "detection": "azure-blob-public-container-access-level-modification.yaml",
    "field": "srcipaddr",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project UserPrincipalName, SrcIpAddr, IsInteractive, ClientAppUsed, AccessedResource, AuthStepResultDetail, AuthMethod,ResourceProviderValue, OperationNameValue, LocationDetails",
    "detection": "azure-blob-public-container-access-level-modification.yaml",
    "field": "isinteractive",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project UserPrincipalName, SrcIpAddr, IsInteractive, ClientAppUsed, AccessedResource, AuthStepResultDetail, AuthMethod,ResourceProviderValue, OperationNameValue, LocationDetails",
    "detection": "azure-blob-public-container-access-level-modification.yaml",
    "field": "clientappused",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project UserPrincipalName, SrcIpAddr, IsInteractive, ClientAppUsed, AccessedResource, AuthStepResultDetail, AuthMethod,ResourceProviderValue, OperationNameValue, LocationDetails",
    "detection": "azure-blob-public-container-access-level-modification.yaml",
    "field": "accessedresource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project UserPrincipalName, SrcIpAddr, IsInteractive, ClientAppUsed, AccessedResource, AuthStepResultDetail, AuthMethod,ResourceProviderValue, OperationNameValue, LocationDetails",
    "detection": "azure-blob-public-container-access-level-modification.yaml",
    "field": "authstepresultdetail",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project UserPrincipalName, SrcIpAddr, IsInteractive, ClientAppUsed, AccessedResource, AuthStepResultDetail, AuthMethod,ResourceProviderValue, OperationNameValue, LocationDetails",
    "detection": "azure-blob-public-container-access-level-modification.yaml",
    "field": "authmethod",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project UserPrincipalName, SrcIpAddr, IsInteractive, ClientAppUsed, AccessedResource, AuthStepResultDetail, AuthMethod,ResourceProviderValue, OperationNameValue, LocationDetails",
    "detection": "azure-blob-public-container-access-level-modification.yaml",
    "field": "resourceprovidervalue",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project UserPrincipalName, SrcIpAddr, IsInteractive, ClientAppUsed, AccessedResource, AuthStepResultDetail, AuthMethod,ResourceProviderValue, OperationNameValue, LocationDetails",
    "detection": "azure-blob-public-container-access-level-modification.yaml",
    "field": "operationnamevalue",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project UserPrincipalName, SrcIpAddr, IsInteractive, ClientAppUsed, AccessedResource, AuthStepResultDetail, AuthMethod,ResourceProviderValue, OperationNameValue, LocationDetails",
    "detection": "azure-blob-public-container-access-level-modification.yaml",
    "field": "locationdetails",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TimeKey = bin(TimeGenerated, match_window), AzureIP = CallerIpAddress",
    "detection": "new-cloudshell-user.yaml",
    "field": "timekey",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TimeKey = bin(TimeGenerated, match_window), AzureIP = CallerIpAddress",
    "detection": "new-cloudshell-user.yaml",
    "field": "azureip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TimeKey = bin(TimeGenerated, match_window), UserIP = CallerIpAddress",
    "detection": "new-cloudshell-user.yaml",
    "field": "timekey",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TimeKey = bin(TimeGenerated, match_window), UserIP = CallerIpAddress",
    "detection": "new-cloudshell-user.yaml",
    "field": "userip",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by TimeKey, Caller, ResourceGroup, SubscriptionId, TenantId, AzureIP, UserIP, HTTPRequest, Type, Properties, CategoryValue, OperationList = strcat(OperationNameValue, ' , ', OperationNameValue1)",
    "detection": "new-cloudshell-user.yaml",
    "field": "timekey",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by TimeKey, Caller, ResourceGroup, SubscriptionId, TenantId, AzureIP, UserIP, HTTPRequest, Type, Properties, CategoryValue, OperationList = strcat(OperationNameValue, ' , ', OperationNameValue1)",
    "detection": "new-cloudshell-user.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by TimeKey, Caller, ResourceGroup, SubscriptionId, TenantId, AzureIP, UserIP, HTTPRequest, Type, Properties, CategoryValue, OperationList = strcat(OperationNameValue, ' , ', OperationNameValue1)",
    "detection": "new-cloudshell-user.yaml",
    "field": "resourcegroup",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by TimeKey, Caller, ResourceGroup, SubscriptionId, TenantId, AzureIP, UserIP, HTTPRequest, Type, Properties, CategoryValue, OperationList = strcat(OperationNameValue, ' , ', OperationNameValue1)",
    "detection": "new-cloudshell-user.yaml",
    "field": "subscriptionid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by TimeKey, Caller, ResourceGroup, SubscriptionId, TenantId, AzureIP, UserIP, HTTPRequest, Type, Properties, CategoryValue, OperationList = strcat(OperationNameValue, ' , ', OperationNameValue1)",
    "detection": "new-cloudshell-user.yaml",
    "field": "tenantid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by TimeKey, Caller, ResourceGroup, SubscriptionId, TenantId, AzureIP, UserIP, HTTPRequest, Type, Properties, CategoryValue, OperationList = strcat(OperationNameValue, ' , ', OperationNameValue1)",
    "detection": "new-cloudshell-user.yaml",
    "field": "azureip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by TimeKey, Caller, ResourceGroup, SubscriptionId, TenantId, AzureIP, UserIP, HTTPRequest, Type, Properties, CategoryValue, OperationList = strcat(OperationNameValue, ' , ', OperationNameValue1)",
    "detection": "new-cloudshell-user.yaml",
    "field": "userip",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by TimeKey, Caller, ResourceGroup, SubscriptionId, TenantId, AzureIP, UserIP, HTTPRequest, Type, Properties, CategoryValue, OperationList = strcat(OperationNameValue, ' , ', OperationNameValue1)",
    "detection": "new-cloudshell-user.yaml",
    "field": "httprequest",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by TimeKey, Caller, ResourceGroup, SubscriptionId, TenantId, AzureIP, UserIP, HTTPRequest, Type, Properties, CategoryValue, OperationList = strcat(OperationNameValue, ' , ', OperationNameValue1)",
    "detection": "new-cloudshell-user.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by TimeKey, Caller, ResourceGroup, SubscriptionId, TenantId, AzureIP, UserIP, HTTPRequest, Type, Properties, CategoryValue, OperationList = strcat(OperationNameValue, ' , ', OperationNameValue1)",
    "detection": "new-cloudshell-user.yaml",
    "field": "properties",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by TimeKey, Caller, ResourceGroup, SubscriptionId, TenantId, AzureIP, UserIP, HTTPRequest, Type, Properties, CategoryValue, OperationList = strcat(OperationNameValue, ' , ', OperationNameValue1)",
    "detection": "new-cloudshell-user.yaml",
    "field": "categoryvalue",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(Caller,'@',0)[0]), UPNSuffix = tostring(split(Caller,'@',1)[0])",
    "detection": "new-cloudshell-user.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(Caller,'@',0)[0]), UPNSuffix = tostring(split(Caller,'@',1)[0])",
    "detection": "new-cloudshell-user.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ResourceHierarchy = split(_ResourceId, \"/\")",
    "detection": "azdiagsettingsdeleted.yaml",
    "field": "resourcehierarchy",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend MonitoredResourcePath = strcat_array(array_slice(ResourceHierarchy, 0, array_length(ResourceHierarchy)-5), \"/\")",
    "detection": "azdiagsettingsdeleted.yaml",
    "field": "monitoredresourcepath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "    | project _ResourceId",
    "detection": "azdiagsettingsdeleted.yaml",
    "field": "_resourceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Caller, CallerIpAddress, OperationNameValue, OperationName, ActivityStatusValue, ResourceGroup, MonitoredResourcePath, Resource, Properties, Name, UPNSuffix, AadUserId, _ResourceId, CorrelationId",
    "detection": "azdiagsettingsdeleted.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Caller, CallerIpAddress, OperationNameValue, OperationName, ActivityStatusValue, ResourceGroup, MonitoredResourcePath, Resource, Properties, Name, UPNSuffix, AadUserId, _ResourceId, CorrelationId",
    "detection": "azdiagsettingsdeleted.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Caller, CallerIpAddress, OperationNameValue, OperationName, ActivityStatusValue, ResourceGroup, MonitoredResourcePath, Resource, Properties, Name, UPNSuffix, AadUserId, _ResourceId, CorrelationId",
    "detection": "azdiagsettingsdeleted.yaml",
    "field": "calleripaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Caller, CallerIpAddress, OperationNameValue, OperationName, ActivityStatusValue, ResourceGroup, MonitoredResourcePath, Resource, Properties, Name, UPNSuffix, AadUserId, _ResourceId, CorrelationId",
    "detection": "azdiagsettingsdeleted.yaml",
    "field": "operationnamevalue",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Caller, CallerIpAddress, OperationNameValue, OperationName, ActivityStatusValue, ResourceGroup, MonitoredResourcePath, Resource, Properties, Name, UPNSuffix, AadUserId, _ResourceId, CorrelationId",
    "detection": "azdiagsettingsdeleted.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Caller, CallerIpAddress, OperationNameValue, OperationName, ActivityStatusValue, ResourceGroup, MonitoredResourcePath, Resource, Properties, Name, UPNSuffix, AadUserId, _ResourceId, CorrelationId",
    "detection": "azdiagsettingsdeleted.yaml",
    "field": "activitystatusvalue",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Caller, CallerIpAddress, OperationNameValue, OperationName, ActivityStatusValue, ResourceGroup, MonitoredResourcePath, Resource, Properties, Name, UPNSuffix, AadUserId, _ResourceId, CorrelationId",
    "detection": "azdiagsettingsdeleted.yaml",
    "field": "resourcegroup",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Caller, CallerIpAddress, OperationNameValue, OperationName, ActivityStatusValue, ResourceGroup, MonitoredResourcePath, Resource, Properties, Name, UPNSuffix, AadUserId, _ResourceId, CorrelationId",
    "detection": "azdiagsettingsdeleted.yaml",
    "field": "monitoredresourcepath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Caller, CallerIpAddress, OperationNameValue, OperationName, ActivityStatusValue, ResourceGroup, MonitoredResourcePath, Resource, Properties, Name, UPNSuffix, AadUserId, _ResourceId, CorrelationId",
    "detection": "azdiagsettingsdeleted.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Caller, CallerIpAddress, OperationNameValue, OperationName, ActivityStatusValue, ResourceGroup, MonitoredResourcePath, Resource, Properties, Name, UPNSuffix, AadUserId, _ResourceId, CorrelationId",
    "detection": "azdiagsettingsdeleted.yaml",
    "field": "properties",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Caller, CallerIpAddress, OperationNameValue, OperationName, ActivityStatusValue, ResourceGroup, MonitoredResourcePath, Resource, Properties, Name, UPNSuffix, AadUserId, _ResourceId, CorrelationId",
    "detection": "azdiagsettingsdeleted.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Caller, CallerIpAddress, OperationNameValue, OperationName, ActivityStatusValue, ResourceGroup, MonitoredResourcePath, Resource, Properties, Name, UPNSuffix, AadUserId, _ResourceId, CorrelationId",
    "detection": "azdiagsettingsdeleted.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Caller, CallerIpAddress, OperationNameValue, OperationName, ActivityStatusValue, ResourceGroup, MonitoredResourcePath, Resource, Properties, Name, UPNSuffix, AadUserId, _ResourceId, CorrelationId",
    "detection": "azdiagsettingsdeleted.yaml",
    "field": "aaduserid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Caller, CallerIpAddress, OperationNameValue, OperationName, ActivityStatusValue, ResourceGroup, MonitoredResourcePath, Resource, Properties, Name, UPNSuffix, AadUserId, _ResourceId, CorrelationId",
    "detection": "azdiagsettingsdeleted.yaml",
    "field": "_resourceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Caller, CallerIpAddress, OperationNameValue, OperationName, ActivityStatusValue, ResourceGroup, MonitoredResourcePath, Resource, Properties, Name, UPNSuffix, AadUserId, _ResourceId, CorrelationId",
    "detection": "azdiagsettingsdeleted.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend Target = tostring(TargetResource.userPrincipalName),",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "target",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "          | extend RoleName = trim('\"',tostring(Property.oldValue))",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "rolename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingIpAddress = tostring(iff(isnotempty(InitiatedBy.user.ipAddress), InitiatedBy.user.ipAddress, InitiatedBy.app.ipAddress))",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Initiator = iif(isnotempty(InitiatingAppName), InitiatingAppName, InitiatingUserPrincipalName)",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiator",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize RemovedGlobalAdminTime = max(TimeGenerated), TargetAdmins = make_set(Target,100) by OperationName, RoleName, Initiator, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingIpAddress, Result;",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "removedglobaladmintime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize RemovedGlobalAdminTime = max(TimeGenerated), TargetAdmins = make_set(Target,100) by OperationName, RoleName, Initiator, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingIpAddress, Result;",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "targetadmins",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize RemovedGlobalAdminTime = max(TimeGenerated), TargetAdmins = make_set(Target,100) by OperationName, RoleName, Initiator, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingIpAddress, Result;",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize RemovedGlobalAdminTime = max(TimeGenerated), TargetAdmins = make_set(Target,100) by OperationName, RoleName, Initiator, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingIpAddress, Result;",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "rolename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize RemovedGlobalAdminTime = max(TimeGenerated), TargetAdmins = make_set(Target,100) by OperationName, RoleName, Initiator, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingIpAddress, Result;",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiator",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize RemovedGlobalAdminTime = max(TimeGenerated), TargetAdmins = make_set(Target,100) by OperationName, RoleName, Initiator, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingIpAddress, Result;",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize RemovedGlobalAdminTime = max(TimeGenerated), TargetAdmins = make_set(Target,100) by OperationName, RoleName, Initiator, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingIpAddress, Result;",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize RemovedGlobalAdminTime = max(TimeGenerated), TargetAdmins = make_set(Target,100) by OperationName, RoleName, Initiator, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingIpAddress, Result;",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize RemovedGlobalAdminTime = max(TimeGenerated), TargetAdmins = make_set(Target,100) by OperationName, RoleName, Initiator, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingIpAddress, Result;",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize RemovedGlobalAdminTime = max(TimeGenerated), TargetAdmins = make_set(Target,100) by OperationName, RoleName, Initiator, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingIpAddress, Result;",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "      | extend Target = tostring(TargetResource.userPrincipalName),",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "target",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "          | extend RoleName = trim('\"',tostring(Property.newValue))",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "rolename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Initiator = iif(isnotempty(InitiatingAppName), InitiatingAppName, tostring(InitiatedBy.user.userPrincipalName))",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiator",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AddedGlobalAdminTime = max(TimeGenerated) by OperationName, RoleName, Target, Initiator, Result;",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "addedglobaladmintime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AddedGlobalAdminTime = max(TimeGenerated) by OperationName, RoleName, Target, Initiator, Result;",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AddedGlobalAdminTime = max(TimeGenerated) by OperationName, RoleName, Target, Initiator, Result;",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "rolename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AddedGlobalAdminTime = max(TimeGenerated) by OperationName, RoleName, Target, Initiator, Result;",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "target",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AddedGlobalAdminTime = max(TimeGenerated) by OperationName, RoleName, Target, Initiator, Result;",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiator",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend NoofAdminsRemoved = array_length(TargetAdmins)",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "noofadminsremoved",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AddedGlobalAdminTime, Initiator, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingIpAddress, Target, RemovedGlobalAdminTime, TargetAdmins, NoofAdminsRemoved",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "addedglobaladmintime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AddedGlobalAdminTime, Initiator, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingIpAddress, Target, RemovedGlobalAdminTime, TargetAdmins, NoofAdminsRemoved",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiator",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AddedGlobalAdminTime, Initiator, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingIpAddress, Target, RemovedGlobalAdminTime, TargetAdmins, NoofAdminsRemoved",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AddedGlobalAdminTime, Initiator, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingIpAddress, Target, RemovedGlobalAdminTime, TargetAdmins, NoofAdminsRemoved",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AddedGlobalAdminTime, Initiator, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingIpAddress, Target, RemovedGlobalAdminTime, TargetAdmins, NoofAdminsRemoved",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AddedGlobalAdminTime, Initiator, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingIpAddress, Target, RemovedGlobalAdminTime, TargetAdmins, NoofAdminsRemoved",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AddedGlobalAdminTime, Initiator, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingIpAddress, Target, RemovedGlobalAdminTime, TargetAdmins, NoofAdminsRemoved",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project AddedGlobalAdminTime, Initiator, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingIpAddress, Target, RemovedGlobalAdminTime, TargetAdmins, NoofAdminsRemoved",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "target",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AddedGlobalAdminTime, Initiator, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingIpAddress, Target, RemovedGlobalAdminTime, TargetAdmins, NoofAdminsRemoved",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "removedglobaladmintime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AddedGlobalAdminTime, Initiator, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingIpAddress, Target, RemovedGlobalAdminTime, TargetAdmins, NoofAdminsRemoved",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "targetadmins",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AddedGlobalAdminTime, Initiator, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingIpAddress, Target, RemovedGlobalAdminTime, TargetAdmins, NoofAdminsRemoved",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "noofadminsremoved",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetName = tostring(split(Target,'@',0)[0]), TargetUPNSuffix = tostring(split(Target,'@',1)[0])",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "targetname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetName = tostring(split(Target,'@',0)[0]), TargetUPNSuffix = tostring(split(Target,'@',1)[0])",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "targetupnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatedByName = tostring(split(InitiatingUserPrincipalName,'@',0)[0]), InitiatedByUPNSuffix = tostring(split(InitiatingUserPrincipalName,'@',1)[0])",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiatedbyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatedByName = tostring(split(InitiatingUserPrincipalName,'@',0)[0]), InitiatedByUPNSuffix = tostring(split(InitiatingUserPrincipalName,'@',1)[0])",
    "detection": "multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiatedbyupnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend FailureOrSuccess = iff(ResultType in (\"0\", \"50125\", \"50140\", \"70043\", \"70044\"), \"Success\", \"Failure\")",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "failureorsuccess",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend SessionStartedUtc = row_window_session(TimeGenerated, timeRange, authenticationWindow, UserPrincipalName != prev(UserPrincipalName) or prev(FailureOrSuccess) == \"Success\")",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "sessionstartedutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FailureOrSuccessCount = count() by  FailureOrSuccess, UserId, UserDisplayName, AppDisplayName, IPAddress, Browser, OS, State, City, Region, Type, CorrelationId, bin(TimeGenerated, authenticationWindow), ResultType, UserPrincipalName, SessionStartedUtc",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "failureorsuccesscount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FailureOrSuccessCount = count() by  FailureOrSuccess, UserId, UserDisplayName, AppDisplayName, IPAddress, Browser, OS, State, City, Region, Type, CorrelationId, bin(TimeGenerated, authenticationWindow), ResultType, UserPrincipalName, SessionStartedUtc",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "failureorsuccess",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FailureOrSuccessCount = count() by  FailureOrSuccess, UserId, UserDisplayName, AppDisplayName, IPAddress, Browser, OS, State, City, Region, Type, CorrelationId, bin(TimeGenerated, authenticationWindow), ResultType, UserPrincipalName, SessionStartedUtc",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FailureOrSuccessCount = count() by  FailureOrSuccess, UserId, UserDisplayName, AppDisplayName, IPAddress, Browser, OS, State, City, Region, Type, CorrelationId, bin(TimeGenerated, authenticationWindow), ResultType, UserPrincipalName, SessionStartedUtc",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "userdisplayname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FailureOrSuccessCount = count() by  FailureOrSuccess, UserId, UserDisplayName, AppDisplayName, IPAddress, Browser, OS, State, City, Region, Type, CorrelationId, bin(TimeGenerated, authenticationWindow), ResultType, UserPrincipalName, SessionStartedUtc",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FailureOrSuccessCount = count() by  FailureOrSuccess, UserId, UserDisplayName, AppDisplayName, IPAddress, Browser, OS, State, City, Region, Type, CorrelationId, bin(TimeGenerated, authenticationWindow), ResultType, UserPrincipalName, SessionStartedUtc",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FailureOrSuccessCount = count() by  FailureOrSuccess, UserId, UserDisplayName, AppDisplayName, IPAddress, Browser, OS, State, City, Region, Type, CorrelationId, bin(TimeGenerated, authenticationWindow), ResultType, UserPrincipalName, SessionStartedUtc",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "browser",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FailureOrSuccessCount = count() by  FailureOrSuccess, UserId, UserDisplayName, AppDisplayName, IPAddress, Browser, OS, State, City, Region, Type, CorrelationId, bin(TimeGenerated, authenticationWindow), ResultType, UserPrincipalName, SessionStartedUtc",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "os",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FailureOrSuccessCount = count() by  FailureOrSuccess, UserId, UserDisplayName, AppDisplayName, IPAddress, Browser, OS, State, City, Region, Type, CorrelationId, bin(TimeGenerated, authenticationWindow), ResultType, UserPrincipalName, SessionStartedUtc",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "state",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FailureOrSuccessCount = count() by  FailureOrSuccess, UserId, UserDisplayName, AppDisplayName, IPAddress, Browser, OS, State, City, Region, Type, CorrelationId, bin(TimeGenerated, authenticationWindow), ResultType, UserPrincipalName, SessionStartedUtc",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "city",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FailureOrSuccessCount = count() by  FailureOrSuccess, UserId, UserDisplayName, AppDisplayName, IPAddress, Browser, OS, State, City, Region, Type, CorrelationId, bin(TimeGenerated, authenticationWindow), ResultType, UserPrincipalName, SessionStartedUtc",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "region",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FailureOrSuccessCount = count() by  FailureOrSuccess, UserId, UserDisplayName, AppDisplayName, IPAddress, Browser, OS, State, City, Region, Type, CorrelationId, bin(TimeGenerated, authenticationWindow), ResultType, UserPrincipalName, SessionStartedUtc",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FailureOrSuccessCount = count() by  FailureOrSuccess, UserId, UserDisplayName, AppDisplayName, IPAddress, Browser, OS, State, City, Region, Type, CorrelationId, bin(TimeGenerated, authenticationWindow), ResultType, UserPrincipalName, SessionStartedUtc",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FailureOrSuccessCount = count() by  FailureOrSuccess, UserId, UserDisplayName, AppDisplayName, IPAddress, Browser, OS, State, City, Region, Type, CorrelationId, bin(TimeGenerated, authenticationWindow), ResultType, UserPrincipalName, SessionStartedUtc",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "resulttype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FailureOrSuccessCount = count() by  FailureOrSuccess, UserId, UserDisplayName, AppDisplayName, IPAddress, Browser, OS, State, City, Region, Type, CorrelationId, bin(TimeGenerated, authenticationWindow), ResultType, UserPrincipalName, SessionStartedUtc",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FailureOrSuccessCount = count() by  FailureOrSuccess, UserId, UserDisplayName, AppDisplayName, IPAddress, Browser, OS, State, City, Region, Type, CorrelationId, bin(TimeGenerated, authenticationWindow), ResultType, UserPrincipalName, SessionStartedUtc",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "sessionstartedutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FailureCountBeforeSuccess = sumif(FailureOrSuccessCount, FailureOrSuccess == \"Failure\"), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), makelist(FailureOrSuccess), IPAddress = make_set(IPAddress, 15), make_set(Browser, 15), make_set(City, 15), make_set(State, 15), make_set(Region, 15), make_set(ResultType, 15) by SessionStartedUtc, UserPrincipalName, CorrelationId, AppDisplayName, UserId, Type",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "failurecountbeforesuccess",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FailureCountBeforeSuccess = sumif(FailureOrSuccessCount, FailureOrSuccess == \"Failure\"), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), makelist(FailureOrSuccess), IPAddress = make_set(IPAddress, 15), make_set(Browser, 15), make_set(City, 15), make_set(State, 15), make_set(Region, 15), make_set(ResultType, 15) by SessionStartedUtc, UserPrincipalName, CorrelationId, AppDisplayName, UserId, Type",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FailureCountBeforeSuccess = sumif(FailureOrSuccessCount, FailureOrSuccess == \"Failure\"), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), makelist(FailureOrSuccess), IPAddress = make_set(IPAddress, 15), make_set(Browser, 15), make_set(City, 15), make_set(State, 15), make_set(Region, 15), make_set(ResultType, 15) by SessionStartedUtc, UserPrincipalName, CorrelationId, AppDisplayName, UserId, Type",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FailureCountBeforeSuccess = sumif(FailureOrSuccessCount, FailureOrSuccess == \"Failure\"), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), makelist(FailureOrSuccess), IPAddress = make_set(IPAddress, 15), make_set(Browser, 15), make_set(City, 15), make_set(State, 15), make_set(Region, 15), make_set(ResultType, 15) by SessionStartedUtc, UserPrincipalName, CorrelationId, AppDisplayName, UserId, Type",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FailureCountBeforeSuccess = sumif(FailureOrSuccessCount, FailureOrSuccess == \"Failure\"), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), makelist(FailureOrSuccess), IPAddress = make_set(IPAddress, 15), make_set(Browser, 15), make_set(City, 15), make_set(State, 15), make_set(Region, 15), make_set(ResultType, 15) by SessionStartedUtc, UserPrincipalName, CorrelationId, AppDisplayName, UserId, Type",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "sessionstartedutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FailureCountBeforeSuccess = sumif(FailureOrSuccessCount, FailureOrSuccess == \"Failure\"), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), makelist(FailureOrSuccess), IPAddress = make_set(IPAddress, 15), make_set(Browser, 15), make_set(City, 15), make_set(State, 15), make_set(Region, 15), make_set(ResultType, 15) by SessionStartedUtc, UserPrincipalName, CorrelationId, AppDisplayName, UserId, Type",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FailureCountBeforeSuccess = sumif(FailureOrSuccessCount, FailureOrSuccess == \"Failure\"), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), makelist(FailureOrSuccess), IPAddress = make_set(IPAddress, 15), make_set(Browser, 15), make_set(City, 15), make_set(State, 15), make_set(Region, 15), make_set(ResultType, 15) by SessionStartedUtc, UserPrincipalName, CorrelationId, AppDisplayName, UserId, Type",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FailureCountBeforeSuccess = sumif(FailureOrSuccessCount, FailureOrSuccess == \"Failure\"), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), makelist(FailureOrSuccess), IPAddress = make_set(IPAddress, 15), make_set(Browser, 15), make_set(City, 15), make_set(State, 15), make_set(Region, 15), make_set(ResultType, 15) by SessionStartedUtc, UserPrincipalName, CorrelationId, AppDisplayName, UserId, Type",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FailureCountBeforeSuccess = sumif(FailureOrSuccessCount, FailureOrSuccess == \"Failure\"), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), makelist(FailureOrSuccess), IPAddress = make_set(IPAddress, 15), make_set(Browser, 15), make_set(City, 15), make_set(State, 15), make_set(Region, 15), make_set(ResultType, 15) by SessionStartedUtc, UserPrincipalName, CorrelationId, AppDisplayName, UserId, Type",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FailureCountBeforeSuccess = sumif(FailureOrSuccessCount, FailureOrSuccess == \"Failure\"), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), makelist(FailureOrSuccess), IPAddress = make_set(IPAddress, 15), make_set(Browser, 15), make_set(City, 15), make_set(State, 15), make_set(Region, 15), make_set(ResultType, 15) by SessionStartedUtc, UserPrincipalName, CorrelationId, AppDisplayName, UserId, Type",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend FailureOrSuccess = iff(ResultType in (\"0\", \"50125\", \"50140\", \"70043\", \"70044\"), \"Success\", \"Failure\")",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "failureorsuccess",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "      | summarize avgFailures = avg(todouble(FailureOrSuccess == \"Failure\")) by UserPrincipalName",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "avgfailures",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "      | summarize avgFailures = avg(todouble(FailureOrSuccess == \"Failure\")) by UserPrincipalName",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Deviation = abs(FailureCountBeforeSuccess - avgFailures) / avgFailures",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "deviation",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend IPAddress = tostring(IPAddress)",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend timestamp = StartTime",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "signinbruteforce-azureportal.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "end-userconsentstoppedduetorisk-basedconsent.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "end-userconsentstoppedduetorisk-basedconsent.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingIPAddress = tostring(InitiatedBy.user.ipAddress)",
    "detection": "end-userconsentstoppedduetorisk-basedconsent.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend userAgent = iif(AdditionalDetails[0].key == \"User-Agent\", tostring(AdditionalDetails[0].value), tostring(AdditionalDetails[1].value))",
    "detection": "end-userconsentstoppedduetorisk-basedconsent.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetAppName = tostring(TargetResources[0].displayName)",
    "detection": "end-userconsentstoppedduetorisk-basedconsent.yaml",
    "field": "targetappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetAppId = tostring(TargetResources[0].id)",
    "detection": "end-userconsentstoppedduetorisk-basedconsent.yaml",
    "field": "targetappid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetResources_0_modifiedProperties = columnifexists(\"TargetResources_0_modifiedProperties\", '')",
    "detection": "end-userconsentstoppedduetorisk-basedconsent.yaml",
    "field": "targetresources_0_modifiedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetPropertyDisplayName = tostring(TargetResources_0_modifiedProperties.displayName)",
    "detection": "end-userconsentstoppedduetorisk-basedconsent.yaml",
    "field": "targetpropertydisplayname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend FailureReason = tostring(parse_json(tostring(TargetResources_0_modifiedProperties.newValue)))",
    "detection": "end-userconsentstoppedduetorisk-basedconsent.yaml",
    "field": "failurereason",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "end-userconsentstoppedduetorisk-basedconsent.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "end-userconsentstoppedduetorisk-basedconsent.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Unresolved = iff(Identity matches regex isGUID, true, false)",
    "detection": "failedlogontoazureportal.yaml",
    "field": "unresolved",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by UserId, lu_UserDisplayName = UserDisplayName, lu_UserPrincipalName = UserPrincipalName;",
    "detection": "failedlogontoazureportal.yaml",
    "field": "lu_userdisplayname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by UserId, lu_UserDisplayName = UserDisplayName, lu_UserPrincipalName = UserPrincipalName;",
    "detection": "failedlogontoazureportal.yaml",
    "field": "lu_userprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserDisplayName = lu_UserDisplayName, UserPrincipalName = lu_UserPrincipalName",
    "detection": "failedlogontoazureportal.yaml",
    "field": "userdisplayname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserDisplayName = lu_UserDisplayName, UserPrincipalName = lu_UserPrincipalName",
    "detection": "failedlogontoazureportal.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceDetail = todynamic(DeviceDetail), Status = todynamic(DeviceDetail), LocationDetails = todynamic(LocationDetails)",
    "detection": "failedlogontoazureportal.yaml",
    "field": "devicedetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceDetail = todynamic(DeviceDetail), Status = todynamic(DeviceDetail), LocationDetails = todynamic(LocationDetails)",
    "detection": "failedlogontoazureportal.yaml",
    "field": "status",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceDetail = todynamic(DeviceDetail), Status = todynamic(DeviceDetail), LocationDetails = todynamic(LocationDetails)",
    "detection": "failedlogontoazureportal.yaml",
    "field": "locationdetails",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Status = strcat(ResultType, \": \", ResultDescription), OS = tostring(DeviceDetail.operatingSystem), Browser = tostring(DeviceDetail.browser)",
    "detection": "failedlogontoazureportal.yaml",
    "field": "status",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Status = strcat(ResultType, \": \", ResultDescription), OS = tostring(DeviceDetail.operatingSystem), Browser = tostring(DeviceDetail.browser)",
    "detection": "failedlogontoazureportal.yaml",
    "field": "os",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Status = strcat(ResultType, \": \", ResultDescription), OS = tostring(DeviceDetail.operatingSystem), Browser = tostring(DeviceDetail.browser)",
    "detection": "failedlogontoazureportal.yaml",
    "field": "browser",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend State = tostring(LocationDetails.state), City = tostring(LocationDetails.city), Region = tostring(LocationDetails.countryOrRegion)",
    "detection": "failedlogontoazureportal.yaml",
    "field": "state",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend State = tostring(LocationDetails.state), City = tostring(LocationDetails.city), Region = tostring(LocationDetails.countryOrRegion)",
    "detection": "failedlogontoazureportal.yaml",
    "field": "city",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend State = tostring(LocationDetails.state), City = tostring(LocationDetails.city), Region = tostring(LocationDetails.countryOrRegion)",
    "detection": "failedlogontoazureportal.yaml",
    "field": "region",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend FullLocation = strcat(Region,'|', State, '|', City)",
    "detection": "failedlogontoazureportal.yaml",
    "field": "fulllocation",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize TimeGenerated = make_list(TimeGenerated,100), Status = make_list(Status,100), IPAddresses = make_list(IPAddress,100), IPAddressCount = dcount(IPAddress), FailedLogonCount = count()",
    "detection": "failedlogontoazureportal.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize TimeGenerated = make_list(TimeGenerated,100), Status = make_list(Status,100), IPAddresses = make_list(IPAddress,100), IPAddressCount = dcount(IPAddress), FailedLogonCount = count()",
    "detection": "failedlogontoazureportal.yaml",
    "field": "status",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize TimeGenerated = make_list(TimeGenerated,100), Status = make_list(Status,100), IPAddresses = make_list(IPAddress,100), IPAddressCount = dcount(IPAddress), FailedLogonCount = count()",
    "detection": "failedlogontoazureportal.yaml",
    "field": "ipaddresses",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize TimeGenerated = make_list(TimeGenerated,100), Status = make_list(Status,100), IPAddresses = make_list(IPAddress,100), IPAddressCount = dcount(IPAddress), FailedLogonCount = count()",
    "detection": "failedlogontoazureportal.yaml",
    "field": "ipaddresscount",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize TimeGenerated = make_list(TimeGenerated,100), Status = make_list(Status,100), IPAddresses = make_list(IPAddress,100), IPAddressCount = dcount(IPAddress), FailedLogonCount = count()",
    "detection": "failedlogontoazureportal.yaml",
    "field": "failedlogoncount",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TimeGenerated = todatetime(tostring(TimeGenerated)), IPAddress = tostring(IPAddresses), Status = tostring(Status)",
    "detection": "failedlogontoazureportal.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TimeGenerated = todatetime(tostring(TimeGenerated)), IPAddress = tostring(IPAddresses), Status = tostring(Status)",
    "detection": "failedlogontoazureportal.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend TimeGenerated = todatetime(tostring(TimeGenerated)), IPAddress = tostring(IPAddresses), Status = tostring(Status)",
    "detection": "failedlogontoazureportal.yaml",
    "field": "status",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserPrincipalName, UserId, UserDisplayName, Status, FailedLogonCount, IPAddress, IPAddressCount, AppDisplayName, Browser, OS, FullLocation, Type",
    "detection": "failedlogontoazureportal.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserPrincipalName, UserId, UserDisplayName, Status, FailedLogonCount, IPAddress, IPAddressCount, AppDisplayName, Browser, OS, FullLocation, Type",
    "detection": "failedlogontoazureportal.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserPrincipalName, UserId, UserDisplayName, Status, FailedLogonCount, IPAddress, IPAddressCount, AppDisplayName, Browser, OS, FullLocation, Type",
    "detection": "failedlogontoazureportal.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserPrincipalName, UserId, UserDisplayName, Status, FailedLogonCount, IPAddress, IPAddressCount, AppDisplayName, Browser, OS, FullLocation, Type",
    "detection": "failedlogontoazureportal.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserPrincipalName, UserId, UserDisplayName, Status, FailedLogonCount, IPAddress, IPAddressCount, AppDisplayName, Browser, OS, FullLocation, Type",
    "detection": "failedlogontoazureportal.yaml",
    "field": "userdisplayname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserPrincipalName, UserId, UserDisplayName, Status, FailedLogonCount, IPAddress, IPAddressCount, AppDisplayName, Browser, OS, FullLocation, Type",
    "detection": "failedlogontoazureportal.yaml",
    "field": "status",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserPrincipalName, UserId, UserDisplayName, Status, FailedLogonCount, IPAddress, IPAddressCount, AppDisplayName, Browser, OS, FullLocation, Type",
    "detection": "failedlogontoazureportal.yaml",
    "field": "failedlogoncount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserPrincipalName, UserId, UserDisplayName, Status, FailedLogonCount, IPAddress, IPAddressCount, AppDisplayName, Browser, OS, FullLocation, Type",
    "detection": "failedlogontoazureportal.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserPrincipalName, UserId, UserDisplayName, Status, FailedLogonCount, IPAddress, IPAddressCount, AppDisplayName, Browser, OS, FullLocation, Type",
    "detection": "failedlogontoazureportal.yaml",
    "field": "ipaddresscount",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserPrincipalName, UserId, UserDisplayName, Status, FailedLogonCount, IPAddress, IPAddressCount, AppDisplayName, Browser, OS, FullLocation, Type",
    "detection": "failedlogontoazureportal.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserPrincipalName, UserId, UserDisplayName, Status, FailedLogonCount, IPAddress, IPAddressCount, AppDisplayName, Browser, OS, FullLocation, Type",
    "detection": "failedlogontoazureportal.yaml",
    "field": "browser",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserPrincipalName, UserId, UserDisplayName, Status, FailedLogonCount, IPAddress, IPAddressCount, AppDisplayName, Browser, OS, FullLocation, Type",
    "detection": "failedlogontoazureportal.yaml",
    "field": "os",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserPrincipalName, UserId, UserDisplayName, Status, FailedLogonCount, IPAddress, IPAddressCount, AppDisplayName, Browser, OS, FullLocation, Type",
    "detection": "failedlogontoazureportal.yaml",
    "field": "fulllocation",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserPrincipalName, UserId, UserDisplayName, Status, FailedLogonCount, IPAddress, IPAddressCount, AppDisplayName, Browser, OS, FullLocation, Type",
    "detection": "failedlogontoazureportal.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "failedlogontoazureportal.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "failedlogontoazureportal.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IpAddress = case(",
    "detection": "detectpimalertdisablingactivity.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatedBy = iff(isnotempty(tostring(parse_json(tostring(InitiatedBy.user)).userPrincipalName)),",
    "detection": "detectpimalertdisablingactivity.yaml",
    "field": "initiatedby",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project InitiatedBy, ActivityDateTime, ActivityDisplayName, IpAddress, AADOperationType, AADTenantId, ResourceId, CorrelationId, Identity",
    "detection": "detectpimalertdisablingactivity.yaml",
    "field": "initiatedby",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project InitiatedBy, ActivityDateTime, ActivityDisplayName, IpAddress, AADOperationType, AADTenantId, ResourceId, CorrelationId, Identity",
    "detection": "detectpimalertdisablingactivity.yaml",
    "field": "activitydatetime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project InitiatedBy, ActivityDateTime, ActivityDisplayName, IpAddress, AADOperationType, AADTenantId, ResourceId, CorrelationId, Identity",
    "detection": "detectpimalertdisablingactivity.yaml",
    "field": "activitydisplayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project InitiatedBy, ActivityDateTime, ActivityDisplayName, IpAddress, AADOperationType, AADTenantId, ResourceId, CorrelationId, Identity",
    "detection": "detectpimalertdisablingactivity.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project InitiatedBy, ActivityDateTime, ActivityDisplayName, IpAddress, AADOperationType, AADTenantId, ResourceId, CorrelationId, Identity",
    "detection": "detectpimalertdisablingactivity.yaml",
    "field": "aadoperationtype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project InitiatedBy, ActivityDateTime, ActivityDisplayName, IpAddress, AADOperationType, AADTenantId, ResourceId, CorrelationId, Identity",
    "detection": "detectpimalertdisablingactivity.yaml",
    "field": "aadtenantid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project InitiatedBy, ActivityDateTime, ActivityDisplayName, IpAddress, AADOperationType, AADTenantId, ResourceId, CorrelationId, Identity",
    "detection": "detectpimalertdisablingactivity.yaml",
    "field": "resourceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project InitiatedBy, ActivityDateTime, ActivityDisplayName, IpAddress, AADOperationType, AADTenantId, ResourceId, CorrelationId, Identity",
    "detection": "detectpimalertdisablingactivity.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project InitiatedBy, ActivityDateTime, ActivityDisplayName, IpAddress, AADOperationType, AADTenantId, ResourceId, CorrelationId, Identity",
    "detection": "detectpimalertdisablingactivity.yaml",
    "field": "identity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(InitiatedBy, \"@\")[0]), AccountUPNSuffix = tostring(split(InitiatedBy, \"@\")[1])",
    "detection": "detectpimalertdisablingactivity.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(InitiatedBy, \"@\")[0]), AccountUPNSuffix = tostring(split(InitiatedBy, \"@\")[1])",
    "detection": "detectpimalertdisablingactivity.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project UserPrincipalName, Location, AppDisplayName, RiskState",
    "detection": "insiderriskyaccessbyapplication.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project UserPrincipalName, Location, AppDisplayName, RiskState",
    "detection": "insiderriskyaccessbyapplication.yaml",
    "field": "location",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project UserPrincipalName, Location, AppDisplayName, RiskState",
    "detection": "insiderriskyaccessbyapplication.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project UserPrincipalName, Location, AppDisplayName, RiskState",
    "detection": "insiderriskyaccessbyapplication.yaml",
    "field": "riskstate",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Percent, UserPrincipalName, Location, AppDisplayName, RiskState",
    "detection": "insiderriskyaccessbyapplication.yaml",
    "field": "percent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Percent, UserPrincipalName, Location, AppDisplayName, RiskState",
    "detection": "insiderriskyaccessbyapplication.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Percent, UserPrincipalName, Location, AppDisplayName, RiskState",
    "detection": "insiderriskyaccessbyapplication.yaml",
    "field": "location",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Percent, UserPrincipalName, Location, AppDisplayName, RiskState",
    "detection": "insiderriskyaccessbyapplication.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Percent, UserPrincipalName, Location, AppDisplayName, RiskState",
    "detection": "insiderriskyaccessbyapplication.yaml",
    "field": "riskstate",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(UserPrincipalName, \"@\")[0]), AccountUPNSuffix = tostring(split(UserPrincipalName, \"@\")[1])",
    "detection": "insiderriskyaccessbyapplication.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(UserPrincipalName, \"@\")[0]), AccountUPNSuffix = tostring(split(UserPrincipalName, \"@\")[1])",
    "detection": "insiderriskyaccessbyapplication.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "      | extend Target = tostring(TargetResource.userPrincipalName),",
    "detection": "useraddedtoadminrole.yaml",
    "field": "target",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend RoleName = trim('\"',tostring(Property.newValue))",
    "detection": "useraddedtoadminrole.yaml",
    "field": "rolename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "useraddedtoadminrole.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "useraddedtoadminrole.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "useraddedtoadminrole.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "useraddedtoadminrole.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingIPAddress = tostring(InitiatedBy.user.ipAddress)",
    "detection": "useraddedtoadminrole.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatedBy = iif(isnotempty(InitiatingAppName), InitiatingAppName, InitiatingUserPrincipalName)",
    "detection": "useraddedtoadminrole.yaml",
    "field": "initiatedby",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetUserPrincipalName = iff(OperationName==\"Add member to role\",tostring(TargetResources[0].userPrincipalName),tostring(TargetResources[2].userPrincipalName))",
    "detection": "useraddedtoadminrole.yaml",
    "field": "targetuserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetAadUserId = iff(OperationName==\"Add member to role\", tostring(TargetResources[0].id), tostring(TargetResources[2].id))",
    "detection": "useraddedtoadminrole.yaml",
    "field": "targetaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AddedUser = TargetUserPrincipalName",
    "detection": "useraddedtoadminrole.yaml",
    "field": "addeduser",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetAccountName = tostring(split(TargetUserPrincipalName, \"@\")[0]), TargetAccountUPNSuffix = tostring(split(TargetUserPrincipalName, \"@\")[1])",
    "detection": "useraddedtoadminrole.yaml",
    "field": "targetaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetAccountName = tostring(split(TargetUserPrincipalName, \"@\")[0]), TargetAccountUPNSuffix = tostring(split(TargetUserPrincipalName, \"@\")[1])",
    "detection": "useraddedtoadminrole.yaml",
    "field": "targetaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "useraddedtoadminrole.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "useraddedtoadminrole.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatedBy = iff(isnotempty(tostring(InitiatedBy.user.userPrincipalName)),",
    "detection": "rareapplicationconsent.yaml",
    "field": "initiatedby",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend TargetResourceName = tolower(tostring(TargetResource.displayName))",
    "detection": "rareapplicationconsent.yaml",
    "field": "targetresourcename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize max(TimeGenerated), OperationCount = count() by OperationName, InitiatedBy, TargetResourceName",
    "detection": "rareapplicationconsent.yaml",
    "field": "operationcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize max(TimeGenerated), OperationCount = count() by OperationName, InitiatedBy, TargetResourceName",
    "detection": "rareapplicationconsent.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize max(TimeGenerated), OperationCount = count() by OperationName, InitiatedBy, TargetResourceName",
    "detection": "rareapplicationconsent.yaml",
    "field": "initiatedby",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize max(TimeGenerated), OperationCount = count() by OperationName, InitiatedBy, TargetResourceName",
    "detection": "rareapplicationconsent.yaml",
    "field": "targetresourcename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IpAddress = case(",
    "detection": "rareapplicationconsent.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatedBy = iff(isnotempty(tostring(InitiatedBy.user.userPrincipalName)),",
    "detection": "rareapplicationconsent.yaml",
    "field": "initiatedby",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend TargetResourceName = tolower(tostring(TargetResource.displayName)),",
    "detection": "rareapplicationconsent.yaml",
    "field": "targetresourcename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend UserAgent = tostring(AdditionalDetail.value)",
    "detection": "rareapplicationconsent.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, InitiatedBy, IpAddress, TargetResourceName, Category, OperationName, ConsentType, UserAgent, CorrelationId, Type;",
    "detection": "rareapplicationconsent.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, InitiatedBy, IpAddress, TargetResourceName, Category, OperationName, ConsentType, UserAgent, CorrelationId, Type;",
    "detection": "rareapplicationconsent.yaml",
    "field": "initiatedby",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, InitiatedBy, IpAddress, TargetResourceName, Category, OperationName, ConsentType, UserAgent, CorrelationId, Type;",
    "detection": "rareapplicationconsent.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, InitiatedBy, IpAddress, TargetResourceName, Category, OperationName, ConsentType, UserAgent, CorrelationId, Type;",
    "detection": "rareapplicationconsent.yaml",
    "field": "targetresourcename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, InitiatedBy, IpAddress, TargetResourceName, Category, OperationName, ConsentType, UserAgent, CorrelationId, Type;",
    "detection": "rareapplicationconsent.yaml",
    "field": "category",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, InitiatedBy, IpAddress, TargetResourceName, Category, OperationName, ConsentType, UserAgent, CorrelationId, Type;",
    "detection": "rareapplicationconsent.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, InitiatedBy, IpAddress, TargetResourceName, Category, OperationName, ConsentType, UserAgent, CorrelationId, Type;",
    "detection": "rareapplicationconsent.yaml",
    "field": "consenttype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, InitiatedBy, IpAddress, TargetResourceName, Category, OperationName, ConsentType, UserAgent, CorrelationId, Type;",
    "detection": "rareapplicationconsent.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, InitiatedBy, IpAddress, TargetResourceName, Category, OperationName, ConsentType, UserAgent, CorrelationId, Type;",
    "detection": "rareapplicationconsent.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Reason = \"Previously unseen user consenting\";",
    "detection": "rareapplicationconsent.yaml",
    "field": "reason",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Reason = \"Previously unseen app granted consent\";",
    "detection": "rareapplicationconsent.yaml",
    "field": "reason",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Reason = make_set(Reason,100) by TimeGenerated, InitiatedBy, IpAddress, TargetResourceName, Category, OperationName, ConsentType, UserAgent, CorrelationId, Type",
    "detection": "rareapplicationconsent.yaml",
    "field": "reason",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Reason = make_set(Reason,100) by TimeGenerated, InitiatedBy, IpAddress, TargetResourceName, Category, OperationName, ConsentType, UserAgent, CorrelationId, Type",
    "detection": "rareapplicationconsent.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Reason = make_set(Reason,100) by TimeGenerated, InitiatedBy, IpAddress, TargetResourceName, Category, OperationName, ConsentType, UserAgent, CorrelationId, Type",
    "detection": "rareapplicationconsent.yaml",
    "field": "initiatedby",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Reason = make_set(Reason,100) by TimeGenerated, InitiatedBy, IpAddress, TargetResourceName, Category, OperationName, ConsentType, UserAgent, CorrelationId, Type",
    "detection": "rareapplicationconsent.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Reason = make_set(Reason,100) by TimeGenerated, InitiatedBy, IpAddress, TargetResourceName, Category, OperationName, ConsentType, UserAgent, CorrelationId, Type",
    "detection": "rareapplicationconsent.yaml",
    "field": "targetresourcename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Reason = make_set(Reason,100) by TimeGenerated, InitiatedBy, IpAddress, TargetResourceName, Category, OperationName, ConsentType, UserAgent, CorrelationId, Type",
    "detection": "rareapplicationconsent.yaml",
    "field": "category",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Reason = make_set(Reason,100) by TimeGenerated, InitiatedBy, IpAddress, TargetResourceName, Category, OperationName, ConsentType, UserAgent, CorrelationId, Type",
    "detection": "rareapplicationconsent.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Reason = make_set(Reason,100) by TimeGenerated, InitiatedBy, IpAddress, TargetResourceName, Category, OperationName, ConsentType, UserAgent, CorrelationId, Type",
    "detection": "rareapplicationconsent.yaml",
    "field": "consenttype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Reason = make_set(Reason,100) by TimeGenerated, InitiatedBy, IpAddress, TargetResourceName, Category, OperationName, ConsentType, UserAgent, CorrelationId, Type",
    "detection": "rareapplicationconsent.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Reason = make_set(Reason,100) by TimeGenerated, InitiatedBy, IpAddress, TargetResourceName, Category, OperationName, ConsentType, UserAgent, CorrelationId, Type",
    "detection": "rareapplicationconsent.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Reason = make_set(Reason,100) by TimeGenerated, InitiatedBy, IpAddress, TargetResourceName, Category, OperationName, ConsentType, UserAgent, CorrelationId, Type",
    "detection": "rareapplicationconsent.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, Name = tolower(tostring(split(InitiatedBy,'@',0)[0])), UPNSuffix = tolower(tostring(split(InitiatedBy,'@',1)[0]))",
    "detection": "rareapplicationconsent.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, Name = tolower(tostring(split(InitiatedBy,'@',0)[0])), UPNSuffix = tolower(tostring(split(InitiatedBy,'@',1)[0]))",
    "detection": "rareapplicationconsent.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, Name = tolower(tostring(split(InitiatedBy,'@',0)[0])), UPNSuffix = tolower(tostring(split(InitiatedBy,'@',1)[0]))",
    "detection": "rareapplicationconsent.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "applicationidurichanged.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "applicationidurichanged.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "applicationidurichanged.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "applicationidurichanged.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingIPAddress = tostring(InitiatedBy.user.ipAddress)",
    "detection": "applicationidurichanged.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend mod_props = TargetResources[0].modifiedProperties",
    "detection": "applicationidurichanged.yaml",
    "field": "mod_props",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetAppName = tostring(TargetResources[0].displayName)",
    "detection": "applicationidurichanged.yaml",
    "field": "targetappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend OldURI = tostring(mod_props.oldValue)",
    "detection": "applicationidurichanged.yaml",
    "field": "olduri",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend NewURI = tostring(mod_props.newValue)",
    "detection": "applicationidurichanged.yaml",
    "field": "newuri",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UpdatedBy = iif(isnotempty(InitiatingAppName), InitiatingAppName, InitiatingUserPrincipalName)",
    "detection": "applicationidurichanged.yaml",
    "field": "updatedby",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "applicationidurichanged.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "applicationidurichanged.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceDetail = todynamic(DeviceDetail), Status = todynamic(Status), LocationDetails = todynamic(LocationDetails)",
    "detection": "bypasscondaccessrule.yaml",
    "field": "devicedetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceDetail = todynamic(DeviceDetail), Status = todynamic(Status), LocationDetails = todynamic(LocationDetails)",
    "detection": "bypasscondaccessrule.yaml",
    "field": "status",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceDetail = todynamic(DeviceDetail), Status = todynamic(Status), LocationDetails = todynamic(LocationDetails)",
    "detection": "bypasscondaccessrule.yaml",
    "field": "locationdetails",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend OS = DeviceDetail.operatingSystem, Browser = DeviceDetail.browser",
    "detection": "bypasscondaccessrule.yaml",
    "field": "os",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend OS = DeviceDetail.operatingSystem, Browser = DeviceDetail.browser",
    "detection": "bypasscondaccessrule.yaml",
    "field": "browser",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend State = tostring(LocationDetails.state), City = tostring(LocationDetails.city), Region = tostring(LocationDetails.countryOrRegion)",
    "detection": "bypasscondaccessrule.yaml",
    "field": "state",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend State = tostring(LocationDetails.state), City = tostring(LocationDetails.city), Region = tostring(LocationDetails.countryOrRegion)",
    "detection": "bypasscondaccessrule.yaml",
    "field": "city",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend State = tostring(LocationDetails.state), City = tostring(LocationDetails.city), Region = tostring(LocationDetails.countryOrRegion)",
    "detection": "bypasscondaccessrule.yaml",
    "field": "region",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend StatusCode = tostring(Status.errorCode), StatusDetails = tostring(Status.additionalDetails)",
    "detection": "bypasscondaccessrule.yaml",
    "field": "statuscode",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend StatusCode = tostring(Status.errorCode), StatusDetails = tostring(Status.additionalDetails)",
    "detection": "bypasscondaccessrule.yaml",
    "field": "statusdetails",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Status = strcat(StatusCode, \": \", ResultDescription)",
    "detection": "bypasscondaccessrule.yaml",
    "field": "status",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), Status = make_list(Status,10), StatusDetails = make_list(StatusDetails,50), IPAddresses = make_list(IPAddress,100), IPAddressCount = dcount(IPAddress), CorrelationIds = make_list(CorrelationId,100), ConditionalAccessPoliciesName = make_list(ConditionalAccessPoliciesName,100)",
    "detection": "bypasscondaccessrule.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), Status = make_list(Status,10), StatusDetails = make_list(StatusDetails,50), IPAddresses = make_list(IPAddress,100), IPAddressCount = dcount(IPAddress), CorrelationIds = make_list(CorrelationId,100), ConditionalAccessPoliciesName = make_list(ConditionalAccessPoliciesName,100)",
    "detection": "bypasscondaccessrule.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), Status = make_list(Status,10), StatusDetails = make_list(StatusDetails,50), IPAddresses = make_list(IPAddress,100), IPAddressCount = dcount(IPAddress), CorrelationIds = make_list(CorrelationId,100), ConditionalAccessPoliciesName = make_list(ConditionalAccessPoliciesName,100)",
    "detection": "bypasscondaccessrule.yaml",
    "field": "status",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), Status = make_list(Status,10), StatusDetails = make_list(StatusDetails,50), IPAddresses = make_list(IPAddress,100), IPAddressCount = dcount(IPAddress), CorrelationIds = make_list(CorrelationId,100), ConditionalAccessPoliciesName = make_list(ConditionalAccessPoliciesName,100)",
    "detection": "bypasscondaccessrule.yaml",
    "field": "statusdetails",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), Status = make_list(Status,10), StatusDetails = make_list(StatusDetails,50), IPAddresses = make_list(IPAddress,100), IPAddressCount = dcount(IPAddress), CorrelationIds = make_list(CorrelationId,100), ConditionalAccessPoliciesName = make_list(ConditionalAccessPoliciesName,100)",
    "detection": "bypasscondaccessrule.yaml",
    "field": "ipaddresses",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), Status = make_list(Status,10), StatusDetails = make_list(StatusDetails,50), IPAddresses = make_list(IPAddress,100), IPAddressCount = dcount(IPAddress), CorrelationIds = make_list(CorrelationId,100), ConditionalAccessPoliciesName = make_list(ConditionalAccessPoliciesName,100)",
    "detection": "bypasscondaccessrule.yaml",
    "field": "ipaddresscount",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), Status = make_list(Status,10), StatusDetails = make_list(StatusDetails,50), IPAddresses = make_list(IPAddress,100), IPAddressCount = dcount(IPAddress), CorrelationIds = make_list(CorrelationId,100), ConditionalAccessPoliciesName = make_list(ConditionalAccessPoliciesName,100)",
    "detection": "bypasscondaccessrule.yaml",
    "field": "correlationids",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), Status = make_list(Status,10), StatusDetails = make_list(StatusDetails,50), IPAddresses = make_list(IPAddress,100), IPAddressCount = dcount(IPAddress), CorrelationIds = make_list(CorrelationId,100), ConditionalAccessPoliciesName = make_list(ConditionalAccessPoliciesName,100)",
    "detection": "bypasscondaccessrule.yaml",
    "field": "conditionalaccesspoliciesname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Status = strcat(Status, \" \", StatusDetails)",
    "detection": "bypasscondaccessrule.yaml",
    "field": "status",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize IPAddresses = make_set(IPAddresses,100), Status = make_set(Status,10), CorrelationIds = make_set(CorrelationIds,100), ConditionalAccessPoliciesName = make_set(ConditionalAccessPoliciesName,100)",
    "detection": "bypasscondaccessrule.yaml",
    "field": "ipaddresses",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize IPAddresses = make_set(IPAddresses,100), Status = make_set(Status,10), CorrelationIds = make_set(CorrelationIds,100), ConditionalAccessPoliciesName = make_set(ConditionalAccessPoliciesName,100)",
    "detection": "bypasscondaccessrule.yaml",
    "field": "status",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize IPAddresses = make_set(IPAddresses,100), Status = make_set(Status,10), CorrelationIds = make_set(CorrelationIds,100), ConditionalAccessPoliciesName = make_set(ConditionalAccessPoliciesName,100)",
    "detection": "bypasscondaccessrule.yaml",
    "field": "correlationids",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize IPAddresses = make_set(IPAddresses,100), Status = make_set(Status,10), CorrelationIds = make_set(CorrelationIds,100), ConditionalAccessPoliciesName = make_set(ConditionalAccessPoliciesName,100)",
    "detection": "bypasscondaccessrule.yaml",
    "field": "conditionalaccesspoliciesname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPAddressFirst = tostring(IPAddresses[0]), Name = tostring(split(UserPrincipalName, \"@\")[0]), UPNSuffix = tostring(split(UserPrincipalName, \"@\")[1])",
    "detection": "bypasscondaccessrule.yaml",
    "field": "ipaddressfirst",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPAddressFirst = tostring(IPAddresses[0]), Name = tostring(split(UserPrincipalName, \"@\")[0]), UPNSuffix = tostring(split(UserPrincipalName, \"@\")[1])",
    "detection": "bypasscondaccessrule.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPAddressFirst = tostring(IPAddresses[0]), Name = tostring(split(UserPrincipalName, \"@\")[0]), UPNSuffix = tostring(split(UserPrincipalName, \"@\")[1])",
    "detection": "bypasscondaccessrule.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend domain = split(UserPrincipalName, \"@\")[1]",
    "detection": "urladdedtoapplicationfromunknowndomain.yaml",
    "field": "domain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend domain = tostring(split(UserPrincipalName, \"@\")[1])",
    "detection": "urladdedtoapplicationfromunknowndomain.yaml",
    "field": "domain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Key = tostring(TargetResources_modifiedProperties.displayName)",
    "detection": "urladdedtoapplicationfromunknowndomain.yaml",
    "field": "key",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend NewValue = TargetResources_modifiedProperties.newValue",
    "detection": "urladdedtoapplicationfromunknowndomain.yaml",
    "field": "newvalue",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend OldValue = TargetResources_modifiedProperties.oldValue",
    "detection": "urladdedtoapplicationfromunknowndomain.yaml",
    "field": "oldvalue",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend NewUrls = extract_all('\"Address\":([^,]*)', tostring(NewValue))",
    "detection": "urladdedtoapplicationfromunknowndomain.yaml",
    "field": "newurls",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend OldUrls = extract_all('\"Address\":([^,]*)', tostring(OldValue))",
    "detection": "urladdedtoapplicationfromunknowndomain.yaml",
    "field": "oldurls",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AddedUrls = set_difference(NewUrls, OldUrls)",
    "detection": "urladdedtoapplicationfromunknowndomain.yaml",
    "field": "addedurls",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UserAgent = iif(tostring(AdditionalDetails[0].key) == \"User-Agent\", tostring(AdditionalDetails[0].value), \"\")",
    "detection": "urladdedtoapplicationfromunknowndomain.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "urladdedtoapplicationfromunknowndomain.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "urladdedtoapplicationfromunknowndomain.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "urladdedtoapplicationfromunknowndomain.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "urladdedtoapplicationfromunknowndomain.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingIPAddress = tostring(InitiatedBy.user.ipAddress)",
    "detection": "urladdedtoapplicationfromunknowndomain.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatedBy = tostring(iff(isnotempty(InitiatingUserPrincipalName),InitiatingUserPrincipalName, InitiatingAppName))",
    "detection": "urladdedtoapplicationfromunknowndomain.yaml",
    "field": "initiatedby",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AppDisplayName = tostring(TargetResources.displayName)",
    "detection": "urladdedtoapplicationfromunknowndomain.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AddedUrls = trim(@'\"', tostring(AddedUrls))",
    "detection": "urladdedtoapplicationfromunknowndomain.yaml",
    "field": "addedurls",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Domain = extract(\"^(?:https?:\\\\/\\\\/)?(?:[^@\\\\/\\\\n]+@)?(?:www\\\\.)?([^:\\\\/?\\\\n]+)/\", 1, replace_string(tolower(AddedUrls), '\"', \"\"))",
    "detection": "urladdedtoapplicationfromunknowndomain.yaml",
    "field": "domain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Domain = strcat(split(Domain, \".\")[-2], \".\", split(Domain, \".\")[-1])",
    "detection": "urladdedtoapplicationfromunknowndomain.yaml",
    "field": "domain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "urladdedtoapplicationfromunknowndomain.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "urladdedtoapplicationfromunknowndomain.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize arg_max(TimeGenerated, *) by AccountUPN",
    "detection": "additionofatemporaryaccesspasstoaprivilegedaccount.yaml",
    "field": "accountupn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetUserPrincipalName = tostring(TargetResources[0].userPrincipalName)",
    "detection": "additionofatemporaryaccesspasstoaprivilegedaccount.yaml",
    "field": "targetuserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetAadUserId = tostring(TargetResources[0].id)",
    "detection": "additionofatemporaryaccesspasstoaprivilegedaccount.yaml",
    "field": "targetaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "additionofatemporaryaccesspasstoaprivilegedaccount.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "additionofatemporaryaccesspasstoaprivilegedaccount.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingIPAddress = tostring(InitiatedBy.user.ipAddress)",
    "detection": "additionofatemporaryaccesspasstoaprivilegedaccount.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetAccountName = tostring(split(TargetUserPrincipalName, \"@\")[0]), TargetAccountUPNSuffix = tostring(split(TargetUserPrincipalName, \"@\")[1])",
    "detection": "additionofatemporaryaccesspasstoaprivilegedaccount.yaml",
    "field": "targetaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetAccountName = tostring(split(TargetUserPrincipalName, \"@\")[0]), TargetAccountUPNSuffix = tostring(split(TargetUserPrincipalName, \"@\")[1])",
    "detection": "additionofatemporaryaccesspasstoaprivilegedaccount.yaml",
    "field": "targetaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "additionofatemporaryaccesspasstoaprivilegedaccount.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "additionofatemporaryaccesspasstoaprivilegedaccount.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by UserId, lu_UserDisplayName = UserDisplayName, lu_UserPrincipalName = UserPrincipalName, Type;",
    "detection": "signinpasswordspray.yaml",
    "field": "lu_userdisplayname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by UserId, lu_UserDisplayName = UserDisplayName, lu_UserPrincipalName = UserPrincipalName, Type;",
    "detection": "signinpasswordspray.yaml",
    "field": "lu_userprincipalname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailedPrincipalCount = dcount(UserPrincipalName) by bin(TimeGenerated, authenticationWindow), IPAddress, AppDisplayName, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "failedprincipalcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailedPrincipalCount = dcount(UserPrincipalName) by bin(TimeGenerated, authenticationWindow), IPAddress, AppDisplayName, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailedPrincipalCount = dcount(UserPrincipalName) by bin(TimeGenerated, authenticationWindow), IPAddress, AppDisplayName, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailedPrincipalCount = dcount(UserPrincipalName) by bin(TimeGenerated, authenticationWindow), IPAddress, AppDisplayName, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize WindowThresholdBreaches = count() by IPAddress, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "windowthresholdbreaches",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize WindowThresholdBreaches = count() by IPAddress, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize WindowThresholdBreaches = count() by IPAddress, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend LocationDetails = todynamic(LocationDetails)",
    "detection": "signinpasswordspray.yaml",
    "field": "locationdetails",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend FullLocation = strcat(LocationDetails.countryOrRegion,'|', LocationDetails.state, '|', LocationDetails.city)",
    "detection": "signinpasswordspray.yaml",
    "field": "fulllocation",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), make_set(ClientAppUsed,20), make_set(FullLocation,20), FailureCount = count() by IPAddress, AppDisplayName, UserPrincipalName, UserDisplayName, Identity, UserId, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), make_set(ClientAppUsed,20), make_set(FullLocation,20), FailureCount = count() by IPAddress, AppDisplayName, UserPrincipalName, UserDisplayName, Identity, UserId, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), make_set(ClientAppUsed,20), make_set(FullLocation,20), FailureCount = count() by IPAddress, AppDisplayName, UserPrincipalName, UserDisplayName, Identity, UserId, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "failurecount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), make_set(ClientAppUsed,20), make_set(FullLocation,20), FailureCount = count() by IPAddress, AppDisplayName, UserPrincipalName, UserDisplayName, Identity, UserId, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), make_set(ClientAppUsed,20), make_set(FullLocation,20), FailureCount = count() by IPAddress, AppDisplayName, UserPrincipalName, UserDisplayName, Identity, UserId, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), make_set(ClientAppUsed,20), make_set(FullLocation,20), FailureCount = count() by IPAddress, AppDisplayName, UserPrincipalName, UserDisplayName, Identity, UserId, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), make_set(ClientAppUsed,20), make_set(FullLocation,20), FailureCount = count() by IPAddress, AppDisplayName, UserPrincipalName, UserDisplayName, Identity, UserId, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "userdisplayname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), make_set(ClientAppUsed,20), make_set(FullLocation,20), FailureCount = count() by IPAddress, AppDisplayName, UserPrincipalName, UserDisplayName, Identity, UserId, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "identity",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), make_set(ClientAppUsed,20), make_set(FullLocation,20), FailureCount = count() by IPAddress, AppDisplayName, UserPrincipalName, UserDisplayName, Identity, UserId, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), make_set(ClientAppUsed,20), make_set(FullLocation,20), FailureCount = count() by IPAddress, AppDisplayName, UserPrincipalName, UserDisplayName, Identity, UserId, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UnresolvedUserId = iff(Identity matches regex isGUID, UserId, \"\")",
    "detection": "signinpasswordspray.yaml",
    "field": "unresolveduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserDisplayName=iff(isempty(lu_UserDisplayName), UserDisplayName, lu_UserDisplayName)",
    "detection": "signinpasswordspray.yaml",
    "field": "userdisplayname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserPrincipalName=iff(isempty(lu_UserPrincipalName), UserPrincipalName, lu_UserPrincipalName)",
    "detection": "signinpasswordspray.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(StartTime), EndTime = max(EndTime), make_set(UserPrincipalName,20), make_set(UserDisplayName,20), make_set(set_ClientAppUsed,20), make_set(set_FullLocation,20), make_list(FailureCount,20) by IPAddress, AppDisplayName, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(StartTime), EndTime = max(EndTime), make_set(UserPrincipalName,20), make_set(UserDisplayName,20), make_set(set_ClientAppUsed,20), make_set(set_FullLocation,20), make_list(FailureCount,20) by IPAddress, AppDisplayName, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(StartTime), EndTime = max(EndTime), make_set(UserPrincipalName,20), make_set(UserDisplayName,20), make_set(set_ClientAppUsed,20), make_set(set_FullLocation,20), make_list(FailureCount,20) by IPAddress, AppDisplayName, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(StartTime), EndTime = max(EndTime), make_set(UserPrincipalName,20), make_set(UserDisplayName,20), make_set(set_ClientAppUsed,20), make_set(set_FullLocation,20), make_list(FailureCount,20) by IPAddress, AppDisplayName, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(StartTime), EndTime = max(EndTime), make_set(UserPrincipalName,20), make_set(UserDisplayName,20), make_set(set_ClientAppUsed,20), make_set(set_FullLocation,20), make_list(FailureCount,20) by IPAddress, AppDisplayName, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend FailedPrincipalCount = array_length(set_UserPrincipalName)",
    "detection": "signinpasswordspray.yaml",
    "field": "failedprincipalcount",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project IPAddress, StartTime, EndTime, TargetedApplication=AppDisplayName, FailedPrincipalCount, UserPrincipalNames=set_UserPrincipalName, UserDisplayNames=set_UserDisplayName, ClientAppsUsed=set_set_ClientAppUsed, Locations=set_set_FullLocation, FailureCountByPrincipal=list_FailureCount, WindowThresholdBreaches, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project IPAddress, StartTime, EndTime, TargetedApplication=AppDisplayName, FailedPrincipalCount, UserPrincipalNames=set_UserPrincipalName, UserDisplayNames=set_UserDisplayName, ClientAppsUsed=set_set_ClientAppUsed, Locations=set_set_FullLocation, FailureCountByPrincipal=list_FailureCount, WindowThresholdBreaches, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project IPAddress, StartTime, EndTime, TargetedApplication=AppDisplayName, FailedPrincipalCount, UserPrincipalNames=set_UserPrincipalName, UserDisplayNames=set_UserDisplayName, ClientAppsUsed=set_set_ClientAppUsed, Locations=set_set_FullLocation, FailureCountByPrincipal=list_FailureCount, WindowThresholdBreaches, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project IPAddress, StartTime, EndTime, TargetedApplication=AppDisplayName, FailedPrincipalCount, UserPrincipalNames=set_UserPrincipalName, UserDisplayNames=set_UserDisplayName, ClientAppsUsed=set_set_ClientAppUsed, Locations=set_set_FullLocation, FailureCountByPrincipal=list_FailureCount, WindowThresholdBreaches, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "targetedapplication",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project IPAddress, StartTime, EndTime, TargetedApplication=AppDisplayName, FailedPrincipalCount, UserPrincipalNames=set_UserPrincipalName, UserDisplayNames=set_UserDisplayName, ClientAppsUsed=set_set_ClientAppUsed, Locations=set_set_FullLocation, FailureCountByPrincipal=list_FailureCount, WindowThresholdBreaches, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "failedprincipalcount",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project IPAddress, StartTime, EndTime, TargetedApplication=AppDisplayName, FailedPrincipalCount, UserPrincipalNames=set_UserPrincipalName, UserDisplayNames=set_UserDisplayName, ClientAppsUsed=set_set_ClientAppUsed, Locations=set_set_FullLocation, FailureCountByPrincipal=list_FailureCount, WindowThresholdBreaches, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "userprincipalnames",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project IPAddress, StartTime, EndTime, TargetedApplication=AppDisplayName, FailedPrincipalCount, UserPrincipalNames=set_UserPrincipalName, UserDisplayNames=set_UserDisplayName, ClientAppsUsed=set_set_ClientAppUsed, Locations=set_set_FullLocation, FailureCountByPrincipal=list_FailureCount, WindowThresholdBreaches, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "userdisplaynames",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project IPAddress, StartTime, EndTime, TargetedApplication=AppDisplayName, FailedPrincipalCount, UserPrincipalNames=set_UserPrincipalName, UserDisplayNames=set_UserDisplayName, ClientAppsUsed=set_set_ClientAppUsed, Locations=set_set_FullLocation, FailureCountByPrincipal=list_FailureCount, WindowThresholdBreaches, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "clientappsused",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project IPAddress, StartTime, EndTime, TargetedApplication=AppDisplayName, FailedPrincipalCount, UserPrincipalNames=set_UserPrincipalName, UserDisplayNames=set_UserDisplayName, ClientAppsUsed=set_set_ClientAppUsed, Locations=set_set_FullLocation, FailureCountByPrincipal=list_FailureCount, WindowThresholdBreaches, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "locations",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project IPAddress, StartTime, EndTime, TargetedApplication=AppDisplayName, FailedPrincipalCount, UserPrincipalNames=set_UserPrincipalName, UserDisplayNames=set_UserDisplayName, ClientAppsUsed=set_set_ClientAppUsed, Locations=set_set_FullLocation, FailureCountByPrincipal=list_FailureCount, WindowThresholdBreaches, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "failurecountbyprincipal",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project IPAddress, StartTime, EndTime, TargetedApplication=AppDisplayName, FailedPrincipalCount, UserPrincipalNames=set_UserPrincipalName, UserDisplayNames=set_UserDisplayName, ClientAppsUsed=set_set_ClientAppUsed, Locations=set_set_FullLocation, FailureCountByPrincipal=list_FailureCount, WindowThresholdBreaches, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "windowthresholdbreaches",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project IPAddress, StartTime, EndTime, TargetedApplication=AppDisplayName, FailedPrincipalCount, UserPrincipalNames=set_UserPrincipalName, UserDisplayNames=set_UserDisplayName, ClientAppsUsed=set_set_ClientAppUsed, Locations=set_set_FullLocation, FailureCountByPrincipal=list_FailureCount, WindowThresholdBreaches, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize GlobalSuccessPrincipalCount = dcountif(UserPrincipalName, (ResultType in (successCodes))), ResultTypeSuccesses = make_set_if(ResultType, (ResultType in (successCodes))), GlobalFailPrincipalCount = dcountif(UserPrincipalName, (ResultType in (failureCodes))), ResultTypeFailures = make_set_if(ResultType, (ResultType in (failureCodes))) by IPAddress, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "globalsuccessprincipalcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize GlobalSuccessPrincipalCount = dcountif(UserPrincipalName, (ResultType in (successCodes))), ResultTypeSuccesses = make_set_if(ResultType, (ResultType in (successCodes))), GlobalFailPrincipalCount = dcountif(UserPrincipalName, (ResultType in (failureCodes))), ResultTypeFailures = make_set_if(ResultType, (ResultType in (failureCodes))) by IPAddress, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "resulttypesuccesses",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize GlobalSuccessPrincipalCount = dcountif(UserPrincipalName, (ResultType in (successCodes))), ResultTypeSuccesses = make_set_if(ResultType, (ResultType in (successCodes))), GlobalFailPrincipalCount = dcountif(UserPrincipalName, (ResultType in (failureCodes))), ResultTypeFailures = make_set_if(ResultType, (ResultType in (failureCodes))) by IPAddress, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "globalfailprincipalcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize GlobalSuccessPrincipalCount = dcountif(UserPrincipalName, (ResultType in (successCodes))), ResultTypeSuccesses = make_set_if(ResultType, (ResultType in (successCodes))), GlobalFailPrincipalCount = dcountif(UserPrincipalName, (ResultType in (failureCodes))), ResultTypeFailures = make_set_if(ResultType, (ResultType in (failureCodes))) by IPAddress, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "resulttypefailures",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize GlobalSuccessPrincipalCount = dcountif(UserPrincipalName, (ResultType in (successCodes))), ResultTypeSuccesses = make_set_if(ResultType, (ResultType in (successCodes))), GlobalFailPrincipalCount = dcountif(UserPrincipalName, (ResultType in (failureCodes))), ResultTypeFailures = make_set_if(ResultType, (ResultType in (failureCodes))) by IPAddress, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize GlobalSuccessPrincipalCount = dcountif(UserPrincipalName, (ResultType in (successCodes))), ResultTypeSuccesses = make_set_if(ResultType, (ResultType in (successCodes))), GlobalFailPrincipalCount = dcountif(UserPrincipalName, (ResultType in (failureCodes))), ResultTypeFailures = make_set_if(ResultType, (ResultType in (failureCodes))) by IPAddress, Type",
    "detection": "signinpasswordspray.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp=StartTime",
    "detection": "signinpasswordspray.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceDetail = todynamic(DeviceDetail), Status = todynamic(DeviceDetail), LocationDetails = todynamic(LocationDetails)",
    "detection": "distribpasscrackattempt.yaml",
    "field": "devicedetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceDetail = todynamic(DeviceDetail), Status = todynamic(DeviceDetail), LocationDetails = todynamic(LocationDetails)",
    "detection": "distribpasscrackattempt.yaml",
    "field": "status",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceDetail = todynamic(DeviceDetail), Status = todynamic(DeviceDetail), LocationDetails = todynamic(LocationDetails)",
    "detection": "distribpasscrackattempt.yaml",
    "field": "locationdetails",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend OS = DeviceDetail.operatingSystem, Browser = DeviceDetail.browser",
    "detection": "distribpasscrackattempt.yaml",
    "field": "os",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend OS = DeviceDetail.operatingSystem, Browser = DeviceDetail.browser",
    "detection": "distribpasscrackattempt.yaml",
    "field": "browser",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend StatusCode = tostring(Status.errorCode), StatusDetails = tostring(Status.additionalDetails)",
    "detection": "distribpasscrackattempt.yaml",
    "field": "statuscode",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend StatusCode = tostring(Status.errorCode), StatusDetails = tostring(Status.additionalDetails)",
    "detection": "distribpasscrackattempt.yaml",
    "field": "statusdetails",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend LocationString = strcat(tostring(LocationDetails.countryOrRegion), \"/\", tostring(LocationDetails.state), \"/\", tostring(LocationDetails.city))",
    "detection": "distribpasscrackattempt.yaml",
    "field": "locationstring",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), LocationCount=dcount(LocationString), Location = make_set(LocationString,100),",
    "detection": "distribpasscrackattempt.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), LocationCount=dcount(LocationString), Location = make_set(LocationString,100),",
    "detection": "distribpasscrackattempt.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), LocationCount=dcount(LocationString), Location = make_set(LocationString,100),",
    "detection": "distribpasscrackattempt.yaml",
    "field": "locationcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), LocationCount=dcount(LocationString), Location = make_set(LocationString,100),",
    "detection": "distribpasscrackattempt.yaml",
    "field": "location",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Location = tostring(Location), IPAddress = tostring(IPAddress), AppDisplayName = tostring(AppDisplayName), ResultDescription = tostring(ResultDescription), Browser = tostring(Browser), OS = tostring(OS)",
    "detection": "distribpasscrackattempt.yaml",
    "field": "location",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Location = tostring(Location), IPAddress = tostring(IPAddress), AppDisplayName = tostring(AppDisplayName), ResultDescription = tostring(ResultDescription), Browser = tostring(Browser), OS = tostring(OS)",
    "detection": "distribpasscrackattempt.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Location = tostring(Location), IPAddress = tostring(IPAddress), AppDisplayName = tostring(AppDisplayName), ResultDescription = tostring(ResultDescription), Browser = tostring(Browser), OS = tostring(OS)",
    "detection": "distribpasscrackattempt.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Location = tostring(Location), IPAddress = tostring(IPAddress), AppDisplayName = tostring(AppDisplayName), ResultDescription = tostring(ResultDescription), Browser = tostring(Browser), OS = tostring(OS)",
    "detection": "distribpasscrackattempt.yaml",
    "field": "resultdescription",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Location = tostring(Location), IPAddress = tostring(IPAddress), AppDisplayName = tostring(AppDisplayName), ResultDescription = tostring(ResultDescription), Browser = tostring(Browser), OS = tostring(OS)",
    "detection": "distribpasscrackattempt.yaml",
    "field": "browser",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Location = tostring(Location), IPAddress = tostring(IPAddress), AppDisplayName = tostring(AppDisplayName), ResultDescription = tostring(ResultDescription), Browser = tostring(Browser), OS = tostring(OS)",
    "detection": "distribpasscrackattempt.yaml",
    "field": "os",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])};",
    "detection": "distribpasscrackattempt.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])};",
    "detection": "distribpasscrackattempt.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetResources_0_modifiedProperties = column_ifexists(\"TargetResources_0_modifiedProperties\", '')",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "targetresources_0_modifiedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Permissions = split((parse_json(tostring(TargetResources_0_modifiedProperties.newValue))), \" \")",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "permissions",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AddedPermissions=make_set(Permissions,200) by CorrelationId",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "addedpermissions",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AddedPermissions=make_set(Permissions,200) by CorrelationId",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingIPAddress = tostring(InitiatedBy.user.ipAddress)",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatedBy = tostring(iff(isnotempty(InitiatingUserPrincipalName),InitiatingUserPrincipalName, InitiatingAppName))",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "initiatedby",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend displayName = tostring(TargetResources_0_modifiedProperties.displayName), newValue = tostring(parse_json(tostring(TargetResources_0_modifiedProperties.newValue)))",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "displayname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend displayName = tostring(TargetResources_0_modifiedProperties.displayName), newValue = tostring(parse_json(tostring(TargetResources_0_modifiedProperties.newValue)))",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "newvalue",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend displayName = case(displayName == \"ServicePrincipal.ObjectID\", \"ServicePrincipalObjectID\", displayName == \"ServicePrincipal.DisplayName\", \"ServicePrincipalDisplayName\", displayName)",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "displayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, CorrelationId, Id, AddedPermissions = tostring(AddedPermissions), InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIPAddress, InitiatingUserPrincipalName, InitiatedBy, displayName, newValue",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, CorrelationId, Id, AddedPermissions = tostring(AddedPermissions), InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIPAddress, InitiatingUserPrincipalName, InitiatedBy, displayName, newValue",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, CorrelationId, Id, AddedPermissions = tostring(AddedPermissions), InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIPAddress, InitiatingUserPrincipalName, InitiatedBy, displayName, newValue",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "id",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, CorrelationId, Id, AddedPermissions = tostring(AddedPermissions), InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIPAddress, InitiatingUserPrincipalName, InitiatedBy, displayName, newValue",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "addedpermissions",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, CorrelationId, Id, AddedPermissions = tostring(AddedPermissions), InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIPAddress, InitiatingUserPrincipalName, InitiatedBy, displayName, newValue",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, CorrelationId, Id, AddedPermissions = tostring(AddedPermissions), InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIPAddress, InitiatingUserPrincipalName, InitiatedBy, displayName, newValue",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, CorrelationId, Id, AddedPermissions = tostring(AddedPermissions), InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIPAddress, InitiatingUserPrincipalName, InitiatedBy, displayName, newValue",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, CorrelationId, Id, AddedPermissions = tostring(AddedPermissions), InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIPAddress, InitiatingUserPrincipalName, InitiatedBy, displayName, newValue",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, CorrelationId, Id, AddedPermissions = tostring(AddedPermissions), InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIPAddress, InitiatingUserPrincipalName, InitiatedBy, displayName, newValue",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, CorrelationId, Id, AddedPermissions = tostring(AddedPermissions), InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIPAddress, InitiatingUserPrincipalName, InitiatedBy, displayName, newValue",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "initiatedby",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, CorrelationId, Id, AddedPermissions = tostring(AddedPermissions), InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIPAddress, InitiatingUserPrincipalName, InitiatedBy, displayName, newValue",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "displayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, CorrelationId, Id, AddedPermissions = tostring(AddedPermissions), InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIPAddress, InitiatingUserPrincipalName, InitiatedBy, displayName, newValue",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "newvalue",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ServicePrincipalObjectID = todynamic(column_ifexists(\"ServicePrincipalObjectID\", \"\")), ServicePrincipalDisplayName = todynamic(column_ifexists(\"ServicePrincipalDisplayName\", \"\"))",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "serviceprincipalobjectid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ServicePrincipalObjectID = todynamic(column_ifexists(\"ServicePrincipalObjectID\", \"\")), ServicePrincipalDisplayName = todynamic(column_ifexists(\"ServicePrincipalDisplayName\", \"\"))",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "serviceprincipaldisplayname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ServicePrincipalObjectID = tostring(ServicePrincipalObjectID), ServicePrincipalDisplayName = tostring(ServicePrincipalDisplayName)",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "serviceprincipalobjectid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ServicePrincipalObjectID = tostring(ServicePrincipalObjectID), ServicePrincipalDisplayName = tostring(ServicePrincipalDisplayName)",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "serviceprincipaldisplayname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstSeen = min(TimeGenerated), LastSeen = max(TimeGenerated), EventIds = make_set(Id,200) by CorrelationId, AddedPermissions, InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIPAddress, InitiatingUserPrincipalName, InitiatedBy, ServicePrincipalDisplayName, ServicePrincipalObjectID",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "firstseen",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstSeen = min(TimeGenerated), LastSeen = max(TimeGenerated), EventIds = make_set(Id,200) by CorrelationId, AddedPermissions, InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIPAddress, InitiatingUserPrincipalName, InitiatedBy, ServicePrincipalDisplayName, ServicePrincipalObjectID",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "lastseen",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstSeen = min(TimeGenerated), LastSeen = max(TimeGenerated), EventIds = make_set(Id,200) by CorrelationId, AddedPermissions, InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIPAddress, InitiatingUserPrincipalName, InitiatedBy, ServicePrincipalDisplayName, ServicePrincipalObjectID",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "eventids",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstSeen = min(TimeGenerated), LastSeen = max(TimeGenerated), EventIds = make_set(Id,200) by CorrelationId, AddedPermissions, InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIPAddress, InitiatingUserPrincipalName, InitiatedBy, ServicePrincipalDisplayName, ServicePrincipalObjectID",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstSeen = min(TimeGenerated), LastSeen = max(TimeGenerated), EventIds = make_set(Id,200) by CorrelationId, AddedPermissions, InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIPAddress, InitiatingUserPrincipalName, InitiatedBy, ServicePrincipalDisplayName, ServicePrincipalObjectID",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "addedpermissions",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstSeen = min(TimeGenerated), LastSeen = max(TimeGenerated), EventIds = make_set(Id,200) by CorrelationId, AddedPermissions, InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIPAddress, InitiatingUserPrincipalName, InitiatedBy, ServicePrincipalDisplayName, ServicePrincipalObjectID",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstSeen = min(TimeGenerated), LastSeen = max(TimeGenerated), EventIds = make_set(Id,200) by CorrelationId, AddedPermissions, InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIPAddress, InitiatingUserPrincipalName, InitiatedBy, ServicePrincipalDisplayName, ServicePrincipalObjectID",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstSeen = min(TimeGenerated), LastSeen = max(TimeGenerated), EventIds = make_set(Id,200) by CorrelationId, AddedPermissions, InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIPAddress, InitiatingUserPrincipalName, InitiatedBy, ServicePrincipalDisplayName, ServicePrincipalObjectID",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstSeen = min(TimeGenerated), LastSeen = max(TimeGenerated), EventIds = make_set(Id,200) by CorrelationId, AddedPermissions, InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIPAddress, InitiatingUserPrincipalName, InitiatedBy, ServicePrincipalDisplayName, ServicePrincipalObjectID",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstSeen = min(TimeGenerated), LastSeen = max(TimeGenerated), EventIds = make_set(Id,200) by CorrelationId, AddedPermissions, InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIPAddress, InitiatingUserPrincipalName, InitiatedBy, ServicePrincipalDisplayName, ServicePrincipalObjectID",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstSeen = min(TimeGenerated), LastSeen = max(TimeGenerated), EventIds = make_set(Id,200) by CorrelationId, AddedPermissions, InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIPAddress, InitiatingUserPrincipalName, InitiatedBy, ServicePrincipalDisplayName, ServicePrincipalObjectID",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "initiatedby",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstSeen = min(TimeGenerated), LastSeen = max(TimeGenerated), EventIds = make_set(Id,200) by CorrelationId, AddedPermissions, InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIPAddress, InitiatingUserPrincipalName, InitiatedBy, ServicePrincipalDisplayName, ServicePrincipalObjectID",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "serviceprincipaldisplayname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstSeen = min(TimeGenerated), LastSeen = max(TimeGenerated), EventIds = make_set(Id,200) by CorrelationId, AddedPermissions, InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIPAddress, InitiatingUserPrincipalName, InitiatedBy, ServicePrincipalDisplayName, ServicePrincipalObjectID",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "serviceprincipalobjectid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "serviceprincipalassignedapprolewithsensitiveaccess.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "      | extend Properties = TargetResource.modifiedProperties",
    "detection": "cross-tenantaccesssettingsorganizationinbounddirectsettingschanged.yaml",
    "field": "properties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend PremodifiedInboundSettings = trim('\"',tostring(Property.oldValue)),",
    "detection": "cross-tenantaccesssettingsorganizationinbounddirectsettingschanged.yaml",
    "field": "premodifiedinboundsettings",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "cross-tenantaccesssettingsorganizationinbounddirectsettingschanged.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "cross-tenantaccesssettingsorganizationinbounddirectsettingschanged.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "cross-tenantaccesssettingsorganizationinbounddirectsettingschanged.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "cross-tenantaccesssettingsorganizationinbounddirectsettingschanged.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingIpAddress = tostring(iff(isnotempty(InitiatedBy.user.ipAddress), InitiatedBy.user.ipAddress, InitiatedBy.app.ipAddress))",
    "detection": "cross-tenantaccesssettingsorganizationinbounddirectsettingschanged.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "cross-tenantaccesssettingsorganizationinbounddirectsettingschanged.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "cross-tenantaccesssettingsorganizationinbounddirectsettingschanged.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "conditionalaccesspolicymodifiedbynewuser.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "conditionalaccesspolicymodifiedbynewuser.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAppId = tostring(InitiatedBy.app.appId)",
    "detection": "conditionalaccesspolicymodifiedbynewuser.yaml",
    "field": "initiatingappid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "conditionalaccesspolicymodifiedbynewuser.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "conditionalaccesspolicymodifiedbynewuser.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "conditionalaccesspolicymodifiedbynewuser.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingIPAddress = tostring(InitiatedBy.user.ipAddress)",
    "detection": "conditionalaccesspolicymodifiedbynewuser.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend CAPolicyName = tostring(TargetResources[0].displayName)",
    "detection": "conditionalaccesspolicymodifiedbynewuser.yaml",
    "field": "capolicyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend NewPolicyValues = TargetResources[0].modifiedProperties[0].newValue",
    "detection": "conditionalaccesspolicymodifiedbynewuser.yaml",
    "field": "newpolicyvalues",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend OldPolicyValues = TargetResources[0].modifiedProperties[0].oldValue",
    "detection": "conditionalaccesspolicymodifiedbynewuser.yaml",
    "field": "oldpolicyvalues",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "conditionalaccesspolicymodifiedbynewuser.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "conditionalaccesspolicymodifiedbynewuser.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "      | extend targetDisplayName = tostring(TargetResource.displayName),",
    "detection": "firstapporserviceprincipalcredential.yaml",
    "field": "targetdisplayname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend new_value_set = parse_json(tostring(Property.newValue)),",
    "detection": "firstapporserviceprincipalcredential.yaml",
    "field": "new_value_set",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend InitiatingUserAgent = tostring(AdditionalDetail.value)",
    "detection": "firstapporserviceprincipalcredential.yaml",
    "field": "initiatinguseragent",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "firstapporserviceprincipalcredential.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "firstapporserviceprincipalcredential.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "firstapporserviceprincipalcredential.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "firstapporserviceprincipalcredential.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingIpAddress = tostring(iff(isnotempty(InitiatedBy.user.ipAddress), InitiatedBy.user.ipAddress, InitiatedBy.app.ipAddress))",
    "detection": "firstapporserviceprincipalcredential.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = split(InitiatingUserPrincipalName, \"@\")[0], UPNSuffix = split(InitiatingUserPrincipalName, \"@\")[1]",
    "detection": "firstapporserviceprincipalcredential.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = split(InitiatingUserPrincipalName, \"@\")[0], UPNSuffix = split(InitiatingUserPrincipalName, \"@\")[1]",
    "detection": "firstapporserviceprincipalcredential.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetUserPrincipalName = tostring(TargetResources[0].userPrincipalName)",
    "detection": "authenticationmethodchangedforprivilegedaccount.yaml",
    "field": "targetuserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetAadUserId = tostring(TargetResources[0].id)",
    "detection": "authenticationmethodchangedforprivilegedaccount.yaml",
    "field": "targetaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "authenticationmethodchangedforprivilegedaccount.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "authenticationmethodchangedforprivilegedaccount.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingIPAddress = tostring(InitiatedBy.user.ipAddress)",
    "detection": "authenticationmethodchangedforprivilegedaccount.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetAccountName = tostring(split(TargetUserPrincipalName, \"@\")[0]), TargetAccountUPNSuffix = tostring(split(TargetUserPrincipalName, \"@\")[1])",
    "detection": "authenticationmethodchangedforprivilegedaccount.yaml",
    "field": "targetaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetAccountName = tostring(split(TargetUserPrincipalName, \"@\")[0]), TargetAccountUPNSuffix = tostring(split(TargetUserPrincipalName, \"@\")[1])",
    "detection": "authenticationmethodchangedforprivilegedaccount.yaml",
    "field": "targetaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "authenticationmethodchangedforprivilegedaccount.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "authenticationmethodchangedforprivilegedaccount.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend displayName = tostring(TargetResources_modifiedProperties.displayName),",
    "detection": "suspiciouslinkingofexternalidtoexistingusers.yaml",
    "field": "displayname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "suspiciouslinkingofexternalidtoexistingusers.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "suspiciouslinkingofexternalidtoexistingusers.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "suspiciouslinkingofexternalidtoexistingusers.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "suspiciouslinkingofexternalidtoexistingusers.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingIPAddress = tostring(InitiatedBy.user.ipAddress)",
    "detection": "suspiciouslinkingofexternalidtoexistingusers.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatedBy = tostring(iff(isnotempty(InitiatingUserPrincipalName),InitiatingUserPrincipalName, InitiatingAppName))",
    "detection": "suspiciouslinkingofexternalidtoexistingusers.yaml",
    "field": "initiatedby",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(TimeGenerated, *) by CorrelationId",
    "detection": "suspiciouslinkingofexternalidtoexistingusers.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "suspiciouslinkingofexternalidtoexistingusers.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "suspiciouslinkingofexternalidtoexistingusers.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetAccountName = tostring(split(TargetUPN_oldValue, \"@\")[0]), TargetUPNSuffix = tostring(split(TargetUPN_oldValue, \"@\")[1])",
    "detection": "suspiciouslinkingofexternalidtoexistingusers.yaml",
    "field": "targetaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetAccountName = tostring(split(TargetUPN_oldValue, \"@\")[0]), TargetUPNSuffix = tostring(split(TargetUPN_oldValue, \"@\")[1])",
    "detection": "suspiciouslinkingofexternalidtoexistingusers.yaml",
    "field": "targetupnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "changestoapplicationlogouturl.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "changestoapplicationlogouturl.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "changestoapplicationlogouturl.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "changestoapplicationlogouturl.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingIPAddress = tostring(InitiatedBy.user.ipAddress)",
    "detection": "changestoapplicationlogouturl.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetAppName = tostring(TargetResources[0].displayName)",
    "detection": "changestoapplicationlogouturl.yaml",
    "field": "targetappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend mod_props = TargetResources[0].modifiedProperties",
    "detection": "changestoapplicationlogouturl.yaml",
    "field": "mod_props",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = tostring(mod_props.displayName)",
    "detection": "changestoapplicationlogouturl.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UpdatedBy = iif(isnotempty(InitiatingAppName), InitiatingAppName, InitiatingUserPrincipalName)",
    "detection": "changestoapplicationlogouturl.yaml",
    "field": "updatedby",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend OldURL = tostring(mod_props.oldValue)",
    "detection": "changestoapplicationlogouturl.yaml",
    "field": "oldurl",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend NewURL = tostring(mod_props.newValue)",
    "detection": "changestoapplicationlogouturl.yaml",
    "field": "newurl",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "changestoapplicationlogouturl.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "changestoapplicationlogouturl.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend OAuthAppName = TargetResources.displayName",
    "detection": "exchangefullaccessgrantedtoapp.yaml",
    "field": "oauthappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ModifiedProperties = TargetResources.modifiedProperties",
    "detection": "exchangefullaccessgrantedtoapp.yaml",
    "field": "modifiedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend AdminConsent = tostring(Property.newValue)",
    "detection": "exchangefullaccessgrantedtoapp.yaml",
    "field": "adminconsent",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend Permissions = tostring(Property.newValue)",
    "detection": "exchangefullaccessgrantedtoapp.yaml",
    "field": "permissions",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend AppId = tostring(Property.newValue)",
    "detection": "exchangefullaccessgrantedtoapp.yaml",
    "field": "appid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend InitiatingUserAgent = replace('\"', '', tostring(Property.value))",
    "detection": "exchangefullaccessgrantedtoapp.yaml",
    "field": "initiatinguseragent",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "exchangefullaccessgrantedtoapp.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "exchangefullaccessgrantedtoapp.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "exchangefullaccessgrantedtoapp.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "exchangefullaccessgrantedtoapp.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingIpAddress = tostring(iff(isnotempty(InitiatedBy.user.ipAddress), InitiatedBy.user.ipAddress, InitiatedBy.app.ipAddress))",
    "detection": "exchangefullaccessgrantedtoapp.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend GrantInitiatedBy = tostring(iff(isnotempty(InitiatingUserPrincipalName), InitiatingUserPrincipalName, InitiatingAppName))",
    "detection": "exchangefullaccessgrantedtoapp.yaml",
    "field": "grantinitiatedby",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = split(InitiatingUserPrincipalName, \"@\")[0], UPNSuffix = split(InitiatingUserPrincipalName, \"@\")[1]",
    "detection": "exchangefullaccessgrantedtoapp.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = split(InitiatingUserPrincipalName, \"@\")[0], UPNSuffix = split(InitiatingUserPrincipalName, \"@\")[1]",
    "detection": "exchangefullaccessgrantedtoapp.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetUserPrincipalName = tostring(TargetResources[2].userPrincipalName)",
    "detection": "accountelevatedtonewrole.yaml",
    "field": "targetuserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend displayName = tostring(TargetResources[0].displayName)",
    "detection": "accountelevatedtonewrole.yaml",
    "field": "displayname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend displayName2 = tostring(TargetResources[3].displayName)",
    "detection": "accountelevatedtonewrole.yaml",
    "field": "displayname2",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ElevatedRole = iif(displayName =~ \"Member\", displayName2, displayName)",
    "detection": "accountelevatedtonewrole.yaml",
    "field": "elevatedrole",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend key = column_ifexists(\"key\", ''), value = column_ifexists(\"value\", '')",
    "detection": "accountelevatedtonewrole.yaml",
    "field": "key",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend key = column_ifexists(\"key\", ''), value = column_ifexists(\"value\", '')",
    "detection": "accountelevatedtonewrole.yaml",
    "field": "value",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ipaddr = todynamic(column_ifexists(\"ipaddr\", \"\"))",
    "detection": "accountelevatedtonewrole.yaml",
    "field": "ipaddr",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Id, InitiatingIPAddress = tostring(ipaddr)",
    "detection": "accountelevatedtonewrole.yaml",
    "field": "id",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Id, InitiatingIPAddress = tostring(ipaddr)",
    "detection": "accountelevatedtonewrole.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "accountelevatedtonewrole.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "accountelevatedtonewrole.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "accountelevatedtonewrole.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "accountelevatedtonewrole.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingIPAddress = iff(isnotempty(tostring(InitiatedBy.user.ipAddress)), tostring(InitiatedBy.user.ipAddress), InitiatingIPAddress)",
    "detection": "accountelevatedtonewrole.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend ElevatedBy = iff(isnotempty(InitiatingUserPrincipalName), InitiatingUserPrincipalName, InitiatingAppName)",
    "detection": "accountelevatedtonewrole.yaml",
    "field": "elevatedby",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ElevatedUser = TargetUserPrincipalName",
    "detection": "accountelevatedtonewrole.yaml",
    "field": "elevateduser",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "accountelevatedtonewrole.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "accountelevatedtonewrole.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetAccountName = tostring(split(TargetUserPrincipalName, \"@\")[0]), TargetAccountUPNSuffix = tostring(split(TargetUserPrincipalName, \"@\")[1])",
    "detection": "accountelevatedtonewrole.yaml",
    "field": "targetaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetAccountName = tostring(split(TargetUserPrincipalName, \"@\")[0]), TargetAccountUPNSuffix = tostring(split(TargetUserPrincipalName, \"@\")[1])",
    "detection": "accountelevatedtonewrole.yaml",
    "field": "targetaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend PermissionGrant = tostring(modifiedProperty[\"newValue\"])",
    "detection": "adminpromoafterrolemgmtapppermissiongrant.yaml",
    "field": "permissiongrant",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend RoleAssignment = tostring(modifiedProperty[\"newValue\"])",
    "detection": "adminpromoafterrolemgmtapppermissiongrant.yaml",
    "field": "roleassignment",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project PermissionGrant_TimeGenerated, PermissionGrant_OperationName, PermissionGrant_Result, PermissionGrant, AppDisplayName, AppServicePrincipalId, PermissionGrant_InitiatedBy, PermissionGrant_TargetResources, PermissionGrant_AdditionalDetails, PermissionGrant_CorrelationId, RoleAssignment_TimeGenerated, RoleAssignment_OperationName, RoleAssignment_Result, RoleAssignment, TargetType, Target, TargetName, TargetUPNSuffix, TargetId, RoleAssignment_InitiatedBy, RoleAssignment_TargetResources, RoleAssignment_AdditionalDetails, RoleAssignment_CorrelationId",
    "detection": "adminpromoafterrolemgmtapppermissiongrant.yaml",
    "field": "permissiongrant_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project PermissionGrant_TimeGenerated, PermissionGrant_OperationName, PermissionGrant_Result, PermissionGrant, AppDisplayName, AppServicePrincipalId, PermissionGrant_InitiatedBy, PermissionGrant_TargetResources, PermissionGrant_AdditionalDetails, PermissionGrant_CorrelationId, RoleAssignment_TimeGenerated, RoleAssignment_OperationName, RoleAssignment_Result, RoleAssignment, TargetType, Target, TargetName, TargetUPNSuffix, TargetId, RoleAssignment_InitiatedBy, RoleAssignment_TargetResources, RoleAssignment_AdditionalDetails, RoleAssignment_CorrelationId",
    "detection": "adminpromoafterrolemgmtapppermissiongrant.yaml",
    "field": "permissiongrant_operationname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project PermissionGrant_TimeGenerated, PermissionGrant_OperationName, PermissionGrant_Result, PermissionGrant, AppDisplayName, AppServicePrincipalId, PermissionGrant_InitiatedBy, PermissionGrant_TargetResources, PermissionGrant_AdditionalDetails, PermissionGrant_CorrelationId, RoleAssignment_TimeGenerated, RoleAssignment_OperationName, RoleAssignment_Result, RoleAssignment, TargetType, Target, TargetName, TargetUPNSuffix, TargetId, RoleAssignment_InitiatedBy, RoleAssignment_TargetResources, RoleAssignment_AdditionalDetails, RoleAssignment_CorrelationId",
    "detection": "adminpromoafterrolemgmtapppermissiongrant.yaml",
    "field": "permissiongrant_result",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project PermissionGrant_TimeGenerated, PermissionGrant_OperationName, PermissionGrant_Result, PermissionGrant, AppDisplayName, AppServicePrincipalId, PermissionGrant_InitiatedBy, PermissionGrant_TargetResources, PermissionGrant_AdditionalDetails, PermissionGrant_CorrelationId, RoleAssignment_TimeGenerated, RoleAssignment_OperationName, RoleAssignment_Result, RoleAssignment, TargetType, Target, TargetName, TargetUPNSuffix, TargetId, RoleAssignment_InitiatedBy, RoleAssignment_TargetResources, RoleAssignment_AdditionalDetails, RoleAssignment_CorrelationId",
    "detection": "adminpromoafterrolemgmtapppermissiongrant.yaml",
    "field": "permissiongrant",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project PermissionGrant_TimeGenerated, PermissionGrant_OperationName, PermissionGrant_Result, PermissionGrant, AppDisplayName, AppServicePrincipalId, PermissionGrant_InitiatedBy, PermissionGrant_TargetResources, PermissionGrant_AdditionalDetails, PermissionGrant_CorrelationId, RoleAssignment_TimeGenerated, RoleAssignment_OperationName, RoleAssignment_Result, RoleAssignment, TargetType, Target, TargetName, TargetUPNSuffix, TargetId, RoleAssignment_InitiatedBy, RoleAssignment_TargetResources, RoleAssignment_AdditionalDetails, RoleAssignment_CorrelationId",
    "detection": "adminpromoafterrolemgmtapppermissiongrant.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project PermissionGrant_TimeGenerated, PermissionGrant_OperationName, PermissionGrant_Result, PermissionGrant, AppDisplayName, AppServicePrincipalId, PermissionGrant_InitiatedBy, PermissionGrant_TargetResources, PermissionGrant_AdditionalDetails, PermissionGrant_CorrelationId, RoleAssignment_TimeGenerated, RoleAssignment_OperationName, RoleAssignment_Result, RoleAssignment, TargetType, Target, TargetName, TargetUPNSuffix, TargetId, RoleAssignment_InitiatedBy, RoleAssignment_TargetResources, RoleAssignment_AdditionalDetails, RoleAssignment_CorrelationId",
    "detection": "adminpromoafterrolemgmtapppermissiongrant.yaml",
    "field": "appserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project PermissionGrant_TimeGenerated, PermissionGrant_OperationName, PermissionGrant_Result, PermissionGrant, AppDisplayName, AppServicePrincipalId, PermissionGrant_InitiatedBy, PermissionGrant_TargetResources, PermissionGrant_AdditionalDetails, PermissionGrant_CorrelationId, RoleAssignment_TimeGenerated, RoleAssignment_OperationName, RoleAssignment_Result, RoleAssignment, TargetType, Target, TargetName, TargetUPNSuffix, TargetId, RoleAssignment_InitiatedBy, RoleAssignment_TargetResources, RoleAssignment_AdditionalDetails, RoleAssignment_CorrelationId",
    "detection": "adminpromoafterrolemgmtapppermissiongrant.yaml",
    "field": "permissiongrant_initiatedby",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project PermissionGrant_TimeGenerated, PermissionGrant_OperationName, PermissionGrant_Result, PermissionGrant, AppDisplayName, AppServicePrincipalId, PermissionGrant_InitiatedBy, PermissionGrant_TargetResources, PermissionGrant_AdditionalDetails, PermissionGrant_CorrelationId, RoleAssignment_TimeGenerated, RoleAssignment_OperationName, RoleAssignment_Result, RoleAssignment, TargetType, Target, TargetName, TargetUPNSuffix, TargetId, RoleAssignment_InitiatedBy, RoleAssignment_TargetResources, RoleAssignment_AdditionalDetails, RoleAssignment_CorrelationId",
    "detection": "adminpromoafterrolemgmtapppermissiongrant.yaml",
    "field": "permissiongrant_targetresources",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project PermissionGrant_TimeGenerated, PermissionGrant_OperationName, PermissionGrant_Result, PermissionGrant, AppDisplayName, AppServicePrincipalId, PermissionGrant_InitiatedBy, PermissionGrant_TargetResources, PermissionGrant_AdditionalDetails, PermissionGrant_CorrelationId, RoleAssignment_TimeGenerated, RoleAssignment_OperationName, RoleAssignment_Result, RoleAssignment, TargetType, Target, TargetName, TargetUPNSuffix, TargetId, RoleAssignment_InitiatedBy, RoleAssignment_TargetResources, RoleAssignment_AdditionalDetails, RoleAssignment_CorrelationId",
    "detection": "adminpromoafterrolemgmtapppermissiongrant.yaml",
    "field": "permissiongrant_additionaldetails",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project PermissionGrant_TimeGenerated, PermissionGrant_OperationName, PermissionGrant_Result, PermissionGrant, AppDisplayName, AppServicePrincipalId, PermissionGrant_InitiatedBy, PermissionGrant_TargetResources, PermissionGrant_AdditionalDetails, PermissionGrant_CorrelationId, RoleAssignment_TimeGenerated, RoleAssignment_OperationName, RoleAssignment_Result, RoleAssignment, TargetType, Target, TargetName, TargetUPNSuffix, TargetId, RoleAssignment_InitiatedBy, RoleAssignment_TargetResources, RoleAssignment_AdditionalDetails, RoleAssignment_CorrelationId",
    "detection": "adminpromoafterrolemgmtapppermissiongrant.yaml",
    "field": "permissiongrant_correlationid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project PermissionGrant_TimeGenerated, PermissionGrant_OperationName, PermissionGrant_Result, PermissionGrant, AppDisplayName, AppServicePrincipalId, PermissionGrant_InitiatedBy, PermissionGrant_TargetResources, PermissionGrant_AdditionalDetails, PermissionGrant_CorrelationId, RoleAssignment_TimeGenerated, RoleAssignment_OperationName, RoleAssignment_Result, RoleAssignment, TargetType, Target, TargetName, TargetUPNSuffix, TargetId, RoleAssignment_InitiatedBy, RoleAssignment_TargetResources, RoleAssignment_AdditionalDetails, RoleAssignment_CorrelationId",
    "detection": "adminpromoafterrolemgmtapppermissiongrant.yaml",
    "field": "roleassignment_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project PermissionGrant_TimeGenerated, PermissionGrant_OperationName, PermissionGrant_Result, PermissionGrant, AppDisplayName, AppServicePrincipalId, PermissionGrant_InitiatedBy, PermissionGrant_TargetResources, PermissionGrant_AdditionalDetails, PermissionGrant_CorrelationId, RoleAssignment_TimeGenerated, RoleAssignment_OperationName, RoleAssignment_Result, RoleAssignment, TargetType, Target, TargetName, TargetUPNSuffix, TargetId, RoleAssignment_InitiatedBy, RoleAssignment_TargetResources, RoleAssignment_AdditionalDetails, RoleAssignment_CorrelationId",
    "detection": "adminpromoafterrolemgmtapppermissiongrant.yaml",
    "field": "roleassignment_operationname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project PermissionGrant_TimeGenerated, PermissionGrant_OperationName, PermissionGrant_Result, PermissionGrant, AppDisplayName, AppServicePrincipalId, PermissionGrant_InitiatedBy, PermissionGrant_TargetResources, PermissionGrant_AdditionalDetails, PermissionGrant_CorrelationId, RoleAssignment_TimeGenerated, RoleAssignment_OperationName, RoleAssignment_Result, RoleAssignment, TargetType, Target, TargetName, TargetUPNSuffix, TargetId, RoleAssignment_InitiatedBy, RoleAssignment_TargetResources, RoleAssignment_AdditionalDetails, RoleAssignment_CorrelationId",
    "detection": "adminpromoafterrolemgmtapppermissiongrant.yaml",
    "field": "roleassignment_result",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project PermissionGrant_TimeGenerated, PermissionGrant_OperationName, PermissionGrant_Result, PermissionGrant, AppDisplayName, AppServicePrincipalId, PermissionGrant_InitiatedBy, PermissionGrant_TargetResources, PermissionGrant_AdditionalDetails, PermissionGrant_CorrelationId, RoleAssignment_TimeGenerated, RoleAssignment_OperationName, RoleAssignment_Result, RoleAssignment, TargetType, Target, TargetName, TargetUPNSuffix, TargetId, RoleAssignment_InitiatedBy, RoleAssignment_TargetResources, RoleAssignment_AdditionalDetails, RoleAssignment_CorrelationId",
    "detection": "adminpromoafterrolemgmtapppermissiongrant.yaml",
    "field": "roleassignment",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project PermissionGrant_TimeGenerated, PermissionGrant_OperationName, PermissionGrant_Result, PermissionGrant, AppDisplayName, AppServicePrincipalId, PermissionGrant_InitiatedBy, PermissionGrant_TargetResources, PermissionGrant_AdditionalDetails, PermissionGrant_CorrelationId, RoleAssignment_TimeGenerated, RoleAssignment_OperationName, RoleAssignment_Result, RoleAssignment, TargetType, Target, TargetName, TargetUPNSuffix, TargetId, RoleAssignment_InitiatedBy, RoleAssignment_TargetResources, RoleAssignment_AdditionalDetails, RoleAssignment_CorrelationId",
    "detection": "adminpromoafterrolemgmtapppermissiongrant.yaml",
    "field": "targettype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project PermissionGrant_TimeGenerated, PermissionGrant_OperationName, PermissionGrant_Result, PermissionGrant, AppDisplayName, AppServicePrincipalId, PermissionGrant_InitiatedBy, PermissionGrant_TargetResources, PermissionGrant_AdditionalDetails, PermissionGrant_CorrelationId, RoleAssignment_TimeGenerated, RoleAssignment_OperationName, RoleAssignment_Result, RoleAssignment, TargetType, Target, TargetName, TargetUPNSuffix, TargetId, RoleAssignment_InitiatedBy, RoleAssignment_TargetResources, RoleAssignment_AdditionalDetails, RoleAssignment_CorrelationId",
    "detection": "adminpromoafterrolemgmtapppermissiongrant.yaml",
    "field": "target",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project PermissionGrant_TimeGenerated, PermissionGrant_OperationName, PermissionGrant_Result, PermissionGrant, AppDisplayName, AppServicePrincipalId, PermissionGrant_InitiatedBy, PermissionGrant_TargetResources, PermissionGrant_AdditionalDetails, PermissionGrant_CorrelationId, RoleAssignment_TimeGenerated, RoleAssignment_OperationName, RoleAssignment_Result, RoleAssignment, TargetType, Target, TargetName, TargetUPNSuffix, TargetId, RoleAssignment_InitiatedBy, RoleAssignment_TargetResources, RoleAssignment_AdditionalDetails, RoleAssignment_CorrelationId",
    "detection": "adminpromoafterrolemgmtapppermissiongrant.yaml",
    "field": "targetname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project PermissionGrant_TimeGenerated, PermissionGrant_OperationName, PermissionGrant_Result, PermissionGrant, AppDisplayName, AppServicePrincipalId, PermissionGrant_InitiatedBy, PermissionGrant_TargetResources, PermissionGrant_AdditionalDetails, PermissionGrant_CorrelationId, RoleAssignment_TimeGenerated, RoleAssignment_OperationName, RoleAssignment_Result, RoleAssignment, TargetType, Target, TargetName, TargetUPNSuffix, TargetId, RoleAssignment_InitiatedBy, RoleAssignment_TargetResources, RoleAssignment_AdditionalDetails, RoleAssignment_CorrelationId",
    "detection": "adminpromoafterrolemgmtapppermissiongrant.yaml",
    "field": "targetupnsuffix",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project PermissionGrant_TimeGenerated, PermissionGrant_OperationName, PermissionGrant_Result, PermissionGrant, AppDisplayName, AppServicePrincipalId, PermissionGrant_InitiatedBy, PermissionGrant_TargetResources, PermissionGrant_AdditionalDetails, PermissionGrant_CorrelationId, RoleAssignment_TimeGenerated, RoleAssignment_OperationName, RoleAssignment_Result, RoleAssignment, TargetType, Target, TargetName, TargetUPNSuffix, TargetId, RoleAssignment_InitiatedBy, RoleAssignment_TargetResources, RoleAssignment_AdditionalDetails, RoleAssignment_CorrelationId",
    "detection": "adminpromoafterrolemgmtapppermissiongrant.yaml",
    "field": "targetid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project PermissionGrant_TimeGenerated, PermissionGrant_OperationName, PermissionGrant_Result, PermissionGrant, AppDisplayName, AppServicePrincipalId, PermissionGrant_InitiatedBy, PermissionGrant_TargetResources, PermissionGrant_AdditionalDetails, PermissionGrant_CorrelationId, RoleAssignment_TimeGenerated, RoleAssignment_OperationName, RoleAssignment_Result, RoleAssignment, TargetType, Target, TargetName, TargetUPNSuffix, TargetId, RoleAssignment_InitiatedBy, RoleAssignment_TargetResources, RoleAssignment_AdditionalDetails, RoleAssignment_CorrelationId",
    "detection": "adminpromoafterrolemgmtapppermissiongrant.yaml",
    "field": "roleassignment_initiatedby",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project PermissionGrant_TimeGenerated, PermissionGrant_OperationName, PermissionGrant_Result, PermissionGrant, AppDisplayName, AppServicePrincipalId, PermissionGrant_InitiatedBy, PermissionGrant_TargetResources, PermissionGrant_AdditionalDetails, PermissionGrant_CorrelationId, RoleAssignment_TimeGenerated, RoleAssignment_OperationName, RoleAssignment_Result, RoleAssignment, TargetType, Target, TargetName, TargetUPNSuffix, TargetId, RoleAssignment_InitiatedBy, RoleAssignment_TargetResources, RoleAssignment_AdditionalDetails, RoleAssignment_CorrelationId",
    "detection": "adminpromoafterrolemgmtapppermissiongrant.yaml",
    "field": "roleassignment_targetresources",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project PermissionGrant_TimeGenerated, PermissionGrant_OperationName, PermissionGrant_Result, PermissionGrant, AppDisplayName, AppServicePrincipalId, PermissionGrant_InitiatedBy, PermissionGrant_TargetResources, PermissionGrant_AdditionalDetails, PermissionGrant_CorrelationId, RoleAssignment_TimeGenerated, RoleAssignment_OperationName, RoleAssignment_Result, RoleAssignment, TargetType, Target, TargetName, TargetUPNSuffix, TargetId, RoleAssignment_InitiatedBy, RoleAssignment_TargetResources, RoleAssignment_AdditionalDetails, RoleAssignment_CorrelationId",
    "detection": "adminpromoafterrolemgmtapppermissiongrant.yaml",
    "field": "roleassignment_additionaldetails",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project PermissionGrant_TimeGenerated, PermissionGrant_OperationName, PermissionGrant_Result, PermissionGrant, AppDisplayName, AppServicePrincipalId, PermissionGrant_InitiatedBy, PermissionGrant_TargetResources, PermissionGrant_AdditionalDetails, PermissionGrant_CorrelationId, RoleAssignment_TimeGenerated, RoleAssignment_OperationName, RoleAssignment_Result, RoleAssignment, TargetType, Target, TargetName, TargetUPNSuffix, TargetId, RoleAssignment_InitiatedBy, RoleAssignment_TargetResources, RoleAssignment_AdditionalDetails, RoleAssignment_CorrelationId",
    "detection": "adminpromoafterrolemgmtapppermissiongrant.yaml",
    "field": "roleassignment_correlationid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend displayName_ = tostring(TargetResources_modifiedProperties.displayName)",
    "detection": "threat-essentials-userassignedprivilegedrole.yaml",
    "field": "displayname_",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend RoleName = tostring(parse_json(tostring(TargetResources_modifiedProperties.newValue)))",
    "detection": "threat-essentials-userassignedprivilegedrole.yaml",
    "field": "rolename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingApp = tostring(parse_json(tostring(InitiatedBy.app)).displayName)",
    "detection": "threat-essentials-userassignedprivilegedrole.yaml",
    "field": "initiatingapp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Initiator = iif(isnotempty(InitiatingApp), InitiatingApp, tostring(parse_json(tostring(InitiatedBy.user)).userPrincipalName))",
    "detection": "threat-essentials-userassignedprivilegedrole.yaml",
    "field": "initiator",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Target = tostring(TargetResources.userPrincipalName)",
    "detection": "threat-essentials-userassignedprivilegedrole.yaml",
    "field": "target",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatorName=split(Initiator, \"@\")[0], InitiatorUPNSuffix=split(Initiator, \"@\")[1]",
    "detection": "threat-essentials-userassignedprivilegedrole.yaml",
    "field": "initiatorname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatorName=split(Initiator, \"@\")[0], InitiatorUPNSuffix=split(Initiator, \"@\")[1]",
    "detection": "threat-essentials-userassignedprivilegedrole.yaml",
    "field": "initiatorupnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetName=split(Target, \"@\")[0], TargetUPNSuffix=split(Target, \"@\")[1]",
    "detection": "threat-essentials-userassignedprivilegedrole.yaml",
    "field": "targetname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetName=split(Target, \"@\")[0], TargetUPNSuffix=split(Target, \"@\")[1]",
    "detection": "threat-essentials-userassignedprivilegedrole.yaml",
    "field": "targetupnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AccountName = tostring(split(UserPrincipalName, \"@\")[0]), AccountUPNSuffix = tostring(split(UserPrincipalName, \"@\")[1])",
    "detection": "privilegeduserlogonfromnewasn.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AccountName = tostring(split(UserPrincipalName, \"@\")[0]), AccountUPNSuffix = tostring(split(UserPrincipalName, \"@\")[1])",
    "detection": "privilegeduserlogonfromnewasn.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceDetail = todynamic(DeviceDetail), LocationDetails = todynamic(LocationDetails)",
    "detection": "mfaspammingfollowedbysuccessfullogin.yaml",
    "field": "devicedetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceDetail = todynamic(DeviceDetail), LocationDetails = todynamic(LocationDetails)",
    "detection": "mfaspammingfollowedbysuccessfullogin.yaml",
    "field": "locationdetails",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AuthResult = tostring(parse_json(AuthenticationDetails).authenticationStepResultDetail)",
    "detection": "mfaspammingfollowedbysuccessfullogin.yaml",
    "field": "authresult",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailedAttempts = countif(AuthResult == \"MFA denied; user declined the authentication\" or AuthResult == \"MFA denied; user did not respond to mobile app notification\"), SuccessfulAttempts = countif(AuthResult == \"MFA successfully completed\"), InvolvedOS = make_set(OS, 5), InvolvedBrowser = make_set(Browser), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserPrincipalName, IPAddress, State, City, Region",
    "detection": "mfaspammingfollowedbysuccessfullogin.yaml",
    "field": "failedattempts",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailedAttempts = countif(AuthResult == \"MFA denied; user declined the authentication\" or AuthResult == \"MFA denied; user did not respond to mobile app notification\"), SuccessfulAttempts = countif(AuthResult == \"MFA successfully completed\"), InvolvedOS = make_set(OS, 5), InvolvedBrowser = make_set(Browser), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserPrincipalName, IPAddress, State, City, Region",
    "detection": "mfaspammingfollowedbysuccessfullogin.yaml",
    "field": "successfulattempts",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailedAttempts = countif(AuthResult == \"MFA denied; user declined the authentication\" or AuthResult == \"MFA denied; user did not respond to mobile app notification\"), SuccessfulAttempts = countif(AuthResult == \"MFA successfully completed\"), InvolvedOS = make_set(OS, 5), InvolvedBrowser = make_set(Browser), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserPrincipalName, IPAddress, State, City, Region",
    "detection": "mfaspammingfollowedbysuccessfullogin.yaml",
    "field": "involvedos",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailedAttempts = countif(AuthResult == \"MFA denied; user declined the authentication\" or AuthResult == \"MFA denied; user did not respond to mobile app notification\"), SuccessfulAttempts = countif(AuthResult == \"MFA successfully completed\"), InvolvedOS = make_set(OS, 5), InvolvedBrowser = make_set(Browser), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserPrincipalName, IPAddress, State, City, Region",
    "detection": "mfaspammingfollowedbysuccessfullogin.yaml",
    "field": "involvedbrowser",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailedAttempts = countif(AuthResult == \"MFA denied; user declined the authentication\" or AuthResult == \"MFA denied; user did not respond to mobile app notification\"), SuccessfulAttempts = countif(AuthResult == \"MFA successfully completed\"), InvolvedOS = make_set(OS, 5), InvolvedBrowser = make_set(Browser), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserPrincipalName, IPAddress, State, City, Region",
    "detection": "mfaspammingfollowedbysuccessfullogin.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailedAttempts = countif(AuthResult == \"MFA denied; user declined the authentication\" or AuthResult == \"MFA denied; user did not respond to mobile app notification\"), SuccessfulAttempts = countif(AuthResult == \"MFA successfully completed\"), InvolvedOS = make_set(OS, 5), InvolvedBrowser = make_set(Browser), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserPrincipalName, IPAddress, State, City, Region",
    "detection": "mfaspammingfollowedbysuccessfullogin.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailedAttempts = countif(AuthResult == \"MFA denied; user declined the authentication\" or AuthResult == \"MFA denied; user did not respond to mobile app notification\"), SuccessfulAttempts = countif(AuthResult == \"MFA successfully completed\"), InvolvedOS = make_set(OS, 5), InvolvedBrowser = make_set(Browser), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserPrincipalName, IPAddress, State, City, Region",
    "detection": "mfaspammingfollowedbysuccessfullogin.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailedAttempts = countif(AuthResult == \"MFA denied; user declined the authentication\" or AuthResult == \"MFA denied; user did not respond to mobile app notification\"), SuccessfulAttempts = countif(AuthResult == \"MFA successfully completed\"), InvolvedOS = make_set(OS, 5), InvolvedBrowser = make_set(Browser), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserPrincipalName, IPAddress, State, City, Region",
    "detection": "mfaspammingfollowedbysuccessfullogin.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailedAttempts = countif(AuthResult == \"MFA denied; user declined the authentication\" or AuthResult == \"MFA denied; user did not respond to mobile app notification\"), SuccessfulAttempts = countif(AuthResult == \"MFA successfully completed\"), InvolvedOS = make_set(OS, 5), InvolvedBrowser = make_set(Browser), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserPrincipalName, IPAddress, State, City, Region",
    "detection": "mfaspammingfollowedbysuccessfullogin.yaml",
    "field": "state",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailedAttempts = countif(AuthResult == \"MFA denied; user declined the authentication\" or AuthResult == \"MFA denied; user did not respond to mobile app notification\"), SuccessfulAttempts = countif(AuthResult == \"MFA successfully completed\"), InvolvedOS = make_set(OS, 5), InvolvedBrowser = make_set(Browser), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserPrincipalName, IPAddress, State, City, Region",
    "detection": "mfaspammingfollowedbysuccessfullogin.yaml",
    "field": "city",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailedAttempts = countif(AuthResult == \"MFA denied; user declined the authentication\" or AuthResult == \"MFA denied; user did not respond to mobile app notification\"), SuccessfulAttempts = countif(AuthResult == \"MFA successfully completed\"), InvolvedOS = make_set(OS, 5), InvolvedBrowser = make_set(Browser), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserPrincipalName, IPAddress, State, City, Region",
    "detection": "mfaspammingfollowedbysuccessfullogin.yaml",
    "field": "region",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AuthenticationWindow = (EndTime - StartTime)",
    "detection": "mfaspammingfollowedbysuccessfullogin.yaml",
    "field": "authenticationwindow",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserPrincipalName, '@', 0)[0]), UPNSuffix = tostring(split(UserPrincipalName, '@', 1)[0])",
    "detection": "mfaspammingfollowedbysuccessfullogin.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserPrincipalName, '@', 0)[0]), UPNSuffix = tostring(split(UserPrincipalName, '@', 1)[0])",
    "detection": "mfaspammingfollowedbysuccessfullogin.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "changestoapplicationownership.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "changestoapplicationownership.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "changestoapplicationownership.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "changestoapplicationownership.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingIPAddress = tostring(InitiatedBy.user.ipAddress)",
    "detection": "changestoapplicationownership.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetUserPrincipalName = TargetResources[0].userPrincipalName",
    "detection": "changestoapplicationownership.yaml",
    "field": "targetuserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetAadUserId = tostring(TargetResources[0].id)",
    "detection": "changestoapplicationownership.yaml",
    "field": "targetaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend mod_props = TargetResources[0].modifiedProperties",
    "detection": "changestoapplicationownership.yaml",
    "field": "mod_props",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetAppName = tostring(parse_json(tostring(mod_props.newValue)))",
    "detection": "changestoapplicationownership.yaml",
    "field": "targetappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AddedUser = TargetUserPrincipalName",
    "detection": "changestoapplicationownership.yaml",
    "field": "addeduser",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UpdatedBy = iif(isnotempty(InitiatingAppName), InitiatingAppName, InitiatingUserPrincipalName)",
    "detection": "changestoapplicationownership.yaml",
    "field": "updatedby",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "changestoapplicationownership.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "changestoapplicationownership.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetAccountName = tostring(split(TargetUserPrincipalName, \"@\")[0]), TargetAccountUPNSuffix = tostring(split(TargetUserPrincipalName, \"@\")[1])",
    "detection": "changestoapplicationownership.yaml",
    "field": "targetaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetAccountName = tostring(split(TargetUserPrincipalName, \"@\")[0]), TargetAccountUPNSuffix = tostring(split(TargetUserPrincipalName, \"@\")[1])",
    "detection": "changestoapplicationownership.yaml",
    "field": "targetaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InvitedUser = TargetResources[0].userPrincipalName",
    "detection": "guestschangedusertypetomember.yaml",
    "field": "inviteduser",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatedByActionUserInformation = iff(isnotempty(InitiatedBy.user.userPrincipalName), InitiatedBy.user.userPrincipalName, InitiatedBy.app.displayName)",
    "detection": "guestschangedusertypetomember.yaml",
    "field": "initiatedbyactionuserinformation",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatedByIPAdress = InitiatedBy.user.ipAddress",
    "detection": "guestschangedusertypetomember.yaml",
    "field": "initiatedbyipadress",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend OldUserType = tostring(TargetResources[0].modifiedProperties[-1].oldValue)",
    "detection": "guestschangedusertypetomember.yaml",
    "field": "oldusertype",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend NewUserType = tostring(TargetResources[0].modifiedProperties[-1].newValue)",
    "detection": "guestschangedusertypetomember.yaml",
    "field": "newusertype",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Status = todynamic(Status)",
    "detection": "azureaadpowershellanomaly.yaml",
    "field": "status",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "azureaadpowershellanomaly.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "azureaadpowershellanomaly.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Name = values.name, AddressPrefixes = tostring(values.properties.addressPrefixes);",
    "detection": "authenticationattemptfromnewcountry.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Name = values.name, AddressPrefixes = tostring(values.properties.addressPrefixes);",
    "detection": "authenticationattemptfromnewcountry.yaml",
    "field": "addressprefixes",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend LocationDetails_dynamic = column_ifexists(\"LocationDetails_dynamic\", \"\")",
    "detection": "authenticationattemptfromnewcountry.yaml",
    "field": "locationdetails_dynamic",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend DeviceDetail_dynamic = column_ifexists(\"DeviceDetail_dynamic\", \"\")",
    "detection": "authenticationattemptfromnewcountry.yaml",
    "field": "devicedetail_dynamic",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend LocationDetails = iif(isnotempty(LocationDetails_dynamic), LocationDetails_dynamic, parse_json(LocationDetails_string))",
    "detection": "authenticationattemptfromnewcountry.yaml",
    "field": "locationdetails",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend DeviceDetail = iif(isnotempty(DeviceDetail_dynamic), DeviceDetail_dynamic, parse_json(DeviceDetail_string))",
    "detection": "authenticationattemptfromnewcountry.yaml",
    "field": "devicedetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend City = tostring(LocationDetails.city)",
    "detection": "authenticationattemptfromnewcountry.yaml",
    "field": "city",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend State = tostring(LocationDetails.state)",
    "detection": "authenticationattemptfromnewcountry.yaml",
    "field": "state",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Place = strcat(City, \" - \", State)",
    "detection": "authenticationattemptfromnewcountry.yaml",
    "field": "place",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend DeviceId = tostring(DeviceDetail.deviceId)",
    "detection": "authenticationattemptfromnewcountry.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Result = strcat(tostring(ResultType), \" - \", ResultDescription)",
    "detection": "authenticationattemptfromnewcountry.yaml",
    "field": "result",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FirstSeen=min(TimeGenerated), LastSeen=max(TimeGenerated),",
    "detection": "authenticationattemptfromnewcountry.yaml",
    "field": "firstseen",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FirstSeen=min(TimeGenerated), LastSeen=max(TimeGenerated),",
    "detection": "authenticationattemptfromnewcountry.yaml",
    "field": "lastseen",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0]);",
    "detection": "authenticationattemptfromnewcountry.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0]);",
    "detection": "authenticationattemptfromnewcountry.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend IP = set_IPAddress[0]",
    "detection": "authenticationattemptfromnewcountry.yaml",
    "field": "ip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize CountOfLocations = dcount(Location), Locations = make_set(Location,100), BurstStartTime = min(TimeGenerated), BurstEndTime = max(TimeGenerated) by UserPrincipalName, Type",
    "detection": "sign-in-burst-from-multiple-locations.yaml",
    "field": "countoflocations",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize CountOfLocations = dcount(Location), Locations = make_set(Location,100), BurstStartTime = min(TimeGenerated), BurstEndTime = max(TimeGenerated) by UserPrincipalName, Type",
    "detection": "sign-in-burst-from-multiple-locations.yaml",
    "field": "locations",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize CountOfLocations = dcount(Location), Locations = make_set(Location,100), BurstStartTime = min(TimeGenerated), BurstEndTime = max(TimeGenerated) by UserPrincipalName, Type",
    "detection": "sign-in-burst-from-multiple-locations.yaml",
    "field": "burststarttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize CountOfLocations = dcount(Location), Locations = make_set(Location,100), BurstStartTime = min(TimeGenerated), BurstEndTime = max(TimeGenerated) by UserPrincipalName, Type",
    "detection": "sign-in-burst-from-multiple-locations.yaml",
    "field": "burstendtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize CountOfLocations = dcount(Location), Locations = make_set(Location,100), BurstStartTime = min(TimeGenerated), BurstEndTime = max(TimeGenerated) by UserPrincipalName, Type",
    "detection": "sign-in-burst-from-multiple-locations.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize CountOfLocations = dcount(Location), Locations = make_set(Location,100), BurstStartTime = min(TimeGenerated), BurstEndTime = max(TimeGenerated) by UserPrincipalName, Type",
    "detection": "sign-in-burst-from-multiple-locations.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = BurstStartTime",
    "detection": "sign-in-burst-from-multiple-locations.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "sign-in-burst-from-multiple-locations.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "sign-in-burst-from-multiple-locations.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountProperties = TargetResources[0].modifiedProperties",
    "detection": "useraccountcreatedwithoutexpectedattributesdefined.yaml",
    "field": "accountproperties",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend displayName = column_ifexists(\"displayName\", \"Unknown Value\")",
    "detection": "useraccountcreatedwithoutexpectedattributesdefined.yaml",
    "field": "displayname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by displayName, TenantId",
    "detection": "useraccountcreatedwithoutexpectedattributesdefined.yaml",
    "field": "displayname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by displayName, TenantId",
    "detection": "useraccountcreatedwithoutexpectedattributesdefined.yaml",
    "field": "tenantid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize make_set(displayName) by TenantId",
    "detection": "useraccountcreatedwithoutexpectedattributesdefined.yaml",
    "field": "tenantid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend CreatingUserPrincipalName = tostring(parse_json(tostring(InitiatedBy.user)).userPrincipalName)",
    "detection": "useraccountcreatedwithoutexpectedattributesdefined.yaml",
    "field": "creatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend CreatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "useraccountcreatedwithoutexpectedattributesdefined.yaml",
    "field": "creatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend CreatingUserIPAddress = tostring(InitiatedBy.user.ipAddress)",
    "detection": "useraccountcreatedwithoutexpectedattributesdefined.yaml",
    "field": "creatinguseripaddress",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend CreatedUserPrincipalName = tostring(TargetResources[0].userPrincipalName)",
    "detection": "useraccountcreatedwithoutexpectedattributesdefined.yaml",
    "field": "createduserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend PropName = tostring(AccountProperties.displayName))",
    "detection": "useraccountcreatedwithoutexpectedattributesdefined.yaml",
    "field": "propname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize makeset(PropName) by TimeGenerated, CorrelationId, CreatedUserPrincipalName, CreatingUserPrincipalName, CreatingAadUserId, CreatingUserIPAddress, tostring(set_displayName)",
    "detection": "useraccountcreatedwithoutexpectedattributesdefined.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize makeset(PropName) by TimeGenerated, CorrelationId, CreatedUserPrincipalName, CreatingUserPrincipalName, CreatingAadUserId, CreatingUserIPAddress, tostring(set_displayName)",
    "detection": "useraccountcreatedwithoutexpectedattributesdefined.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize makeset(PropName) by TimeGenerated, CorrelationId, CreatedUserPrincipalName, CreatingUserPrincipalName, CreatingAadUserId, CreatingUserIPAddress, tostring(set_displayName)",
    "detection": "useraccountcreatedwithoutexpectedattributesdefined.yaml",
    "field": "createduserprincipalname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize makeset(PropName) by TimeGenerated, CorrelationId, CreatedUserPrincipalName, CreatingUserPrincipalName, CreatingAadUserId, CreatingUserIPAddress, tostring(set_displayName)",
    "detection": "useraccountcreatedwithoutexpectedattributesdefined.yaml",
    "field": "creatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize makeset(PropName) by TimeGenerated, CorrelationId, CreatedUserPrincipalName, CreatingUserPrincipalName, CreatingAadUserId, CreatingUserIPAddress, tostring(set_displayName)",
    "detection": "useraccountcreatedwithoutexpectedattributesdefined.yaml",
    "field": "creatingaaduserid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize makeset(PropName) by TimeGenerated, CorrelationId, CreatedUserPrincipalName, CreatingUserPrincipalName, CreatingAadUserId, CreatingUserIPAddress, tostring(set_displayName)",
    "detection": "useraccountcreatedwithoutexpectedattributesdefined.yaml",
    "field": "creatinguseripaddress",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend missing_props = set_difference(todynamic(set_displayName), set_PropName)",
    "detection": "useraccountcreatedwithoutexpectedattributesdefined.yaml",
    "field": "missing_props",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend CreatedUserPrincipalName = tostring(TargetResources[0].userPrincipalName))",
    "detection": "useraccountcreatedwithoutexpectedattributesdefined.yaml",
    "field": "createduserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend ExpectedProperties = set_displayName",
    "detection": "useraccountcreatedwithoutexpectedattributesdefined.yaml",
    "field": "expectedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(CreatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(CreatingUserPrincipalName, \"@\")[1])",
    "detection": "useraccountcreatedwithoutexpectedattributesdefined.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(CreatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(CreatingUserPrincipalName, \"@\")[1])",
    "detection": "useraccountcreatedwithoutexpectedattributesdefined.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetAccountName = tostring(split(CreatedUserPrincipalName, \"@\")[0]), TargetAccountUPNSuffix = tostring(split(CreatedUserPrincipalName, \"@\")[1])",
    "detection": "useraccountcreatedwithoutexpectedattributesdefined.yaml",
    "field": "targetaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetAccountName = tostring(split(CreatedUserPrincipalName, \"@\")[0]), TargetAccountUPNSuffix = tostring(split(CreatedUserPrincipalName, \"@\")[1])",
    "detection": "useraccountcreatedwithoutexpectedattributesdefined.yaml",
    "field": "targetaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "      | extend TargetUserPrincipalName = tostring(TargetResource.userPrincipalName),",
    "detection": "bulkchangestoprivilegedaccountpermissions.yaml",
    "field": "targetuserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "      | extend RoleName = trim('\"',tostring(Property.newValue))",
    "detection": "bulkchangestoprivilegedaccountpermissions.yaml",
    "field": "rolename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TimeWindow = bin(TimeGenerated, 1h)",
    "detection": "bulkchangestoprivilegedaccountpermissions.yaml",
    "field": "timewindow",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatedByUser = iff(isnotempty(InitiatedBy.user.userPrincipalName), tostring(InitiatedBy.user.userPrincipalName), \"\")",
    "detection": "bulkchangestoprivilegedaccountpermissions.yaml",
    "field": "initiatedbyuser",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "bulkchangestoprivilegedaccountpermissions.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "bulkchangestoprivilegedaccountpermissions.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "bulkchangestoprivilegedaccountpermissions.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "bulkchangestoprivilegedaccountpermissions.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingIpAddress = tostring(iff(isnotempty(InitiatedBy.user.ipAddress), InitiatedBy.user.ipAddress, InitiatedBy.app.ipAddress))",
    "detection": "bulkchangestoprivilegedaccountpermissions.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetName = tostring(split(TargetUserPrincipalName,'@',0)[0]), TargetUPNSuffix = tostring(split(TargetUserPrincipalName,'@',1)[0])",
    "detection": "bulkchangestoprivilegedaccountpermissions.yaml",
    "field": "targetname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetName = tostring(split(TargetUserPrincipalName,'@',0)[0]), TargetUPNSuffix = tostring(split(TargetUserPrincipalName,'@',1)[0])",
    "detection": "bulkchangestoprivilegedaccountpermissions.yaml",
    "field": "targetupnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "bulkchangestoprivilegedaccountpermissions.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "bulkchangestoprivilegedaccountpermissions.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend City = tostring(parse_json(LocationDetails).city)",
    "detection": "serviceprincipalauthenticationattemptfromnewcountry.yaml",
    "field": "city",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend State = tostring(parse_json(LocationDetails).state)",
    "detection": "serviceprincipalauthenticationattemptfromnewcountry.yaml",
    "field": "state",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Place = strcat(City, \" - \", State)",
    "detection": "serviceprincipalauthenticationattemptfromnewcountry.yaml",
    "field": "place",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Result = strcat(tostring(ResultType), \" - \", ResultDescription)",
    "detection": "serviceprincipalauthenticationattemptfromnewcountry.yaml",
    "field": "result",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FirstSeen=min(TimeGenerated), LastSeen=max(TimeGenerated), make_set(Result), make_set(IPAddress), make_set(Place) by ServicePrincipalName, Location",
    "detection": "serviceprincipalauthenticationattemptfromnewcountry.yaml",
    "field": "firstseen",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FirstSeen=min(TimeGenerated), LastSeen=max(TimeGenerated), make_set(Result), make_set(IPAddress), make_set(Place) by ServicePrincipalName, Location",
    "detection": "serviceprincipalauthenticationattemptfromnewcountry.yaml",
    "field": "lastseen",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FirstSeen=min(TimeGenerated), LastSeen=max(TimeGenerated), make_set(Result), make_set(IPAddress), make_set(Place) by ServicePrincipalName, Location",
    "detection": "serviceprincipalauthenticationattemptfromnewcountry.yaml",
    "field": "serviceprincipalname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize FirstSeen=min(TimeGenerated), LastSeen=max(TimeGenerated), make_set(Result), make_set(IPAddress), make_set(Place) by ServicePrincipalName, Location",
    "detection": "serviceprincipalauthenticationattemptfromnewcountry.yaml",
    "field": "location",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend Properties = TargetResource.modifiedProperties",
    "detection": "cross-tenantaccesssettingsorganizationdeleted.yaml",
    "field": "properties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend ExtTenantDeleted = trim('\"',tostring(Property.oldValue))",
    "detection": "cross-tenantaccesssettingsorganizationdeleted.yaml",
    "field": "exttenantdeleted",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "cross-tenantaccesssettingsorganizationdeleted.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "cross-tenantaccesssettingsorganizationdeleted.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "cross-tenantaccesssettingsorganizationdeleted.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "cross-tenantaccesssettingsorganizationdeleted.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingIpAddress = tostring(iff(isnotempty(InitiatedBy.user.ipAddress), InitiatedBy.user.ipAddress, InitiatedBy.app.ipAddress))",
    "detection": "cross-tenantaccesssettingsorganizationdeleted.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "cross-tenantaccesssettingsorganizationdeleted.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "cross-tenantaccesssettingsorganizationdeleted.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "authenticationmethodschangedforprivilegedaccount.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "authenticationmethodschangedforprivilegedaccount.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "authenticationmethodschangedforprivilegedaccount.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "authenticationmethodschangedforprivilegedaccount.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingIpAddress = tostring(iff(isnotempty(InitiatedBy.user.ipAddress), InitiatedBy.user.ipAddress, InitiatedBy.app.ipAddress))",
    "detection": "authenticationmethodschangedforprivilegedaccount.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "      | extend TargetUserPrincipalName = tostring(TargetResource.userPrincipalName)",
    "detection": "authenticationmethodschangedforprivilegedaccount.yaml",
    "field": "targetuserprincipalname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Start=min(TimeGenerated), End=max(TimeGenerated), Actions = make_set(ResultReason, MaxSize=8) by InitiatingAppName, InitiatingAppServicePrincipalId,",
    "detection": "authenticationmethodschangedforprivilegedaccount.yaml",
    "field": "start",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Start=min(TimeGenerated), End=max(TimeGenerated), Actions = make_set(ResultReason, MaxSize=8) by InitiatingAppName, InitiatingAppServicePrincipalId,",
    "detection": "authenticationmethodschangedforprivilegedaccount.yaml",
    "field": "end",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Start=min(TimeGenerated), End=max(TimeGenerated), Actions = make_set(ResultReason, MaxSize=8) by InitiatingAppName, InitiatingAppServicePrincipalId,",
    "detection": "authenticationmethodschangedforprivilegedaccount.yaml",
    "field": "actions",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Start=min(TimeGenerated), End=max(TimeGenerated), Actions = make_set(ResultReason, MaxSize=8) by InitiatingAppName, InitiatingAppServicePrincipalId,",
    "detection": "authenticationmethodschangedforprivilegedaccount.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Start=min(TimeGenerated), End=max(TimeGenerated), Actions = make_set(ResultReason, MaxSize=8) by InitiatingAppName, InitiatingAppServicePrincipalId,",
    "detection": "authenticationmethodschangedforprivilegedaccount.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1]),",
    "detection": "authenticationmethodschangedforprivilegedaccount.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1]),",
    "detection": "authenticationmethodschangedforprivilegedaccount.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend FailureOrSuccess = iff(ResultType in (\"0\", \"50125\", \"50140\", \"70043\", \"70044\"), \"Success\", \"Failure\")",
    "detection": "bruteforcecloudpc.yaml",
    "field": "failureorsuccess",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailureCount = countif(FailureOrSuccess==\"Failure\"), SuccessCount = countif(FailureOrSuccess==\"Success\"), IPAddresses = make_set(IPAddress,1000)",
    "detection": "bruteforcecloudpc.yaml",
    "field": "failurecount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailureCount = countif(FailureOrSuccess==\"Failure\"), SuccessCount = countif(FailureOrSuccess==\"Success\"), IPAddresses = make_set(IPAddress,1000)",
    "detection": "bruteforcecloudpc.yaml",
    "field": "successcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailureCount = countif(FailureOrSuccess==\"Failure\"), SuccessCount = countif(FailureOrSuccess==\"Success\"), IPAddresses = make_set(IPAddress,1000)",
    "detection": "bruteforcecloudpc.yaml",
    "field": "ipaddresses",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend FailureSuccessDiff = FailureCount - SuccessCount",
    "detection": "bruteforcecloudpc.yaml",
    "field": "failuresuccessdiff",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Diff = make_list(FailureSuccessDiff, 10000), TimeStamp = make_list(TimeGenerated, 10000) by UserDisplayName, UserPrincipalName//, tostring(IPAddresses)",
    "detection": "bruteforcecloudpc.yaml",
    "field": "diff",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Diff = make_list(FailureSuccessDiff, 10000), TimeStamp = make_list(TimeGenerated, 10000) by UserDisplayName, UserPrincipalName//, tostring(IPAddresses)",
    "detection": "bruteforcecloudpc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Diff = make_list(FailureSuccessDiff, 10000), TimeStamp = make_list(TimeGenerated, 10000) by UserDisplayName, UserPrincipalName//, tostring(IPAddresses)",
    "detection": "bruteforcecloudpc.yaml",
    "field": "userdisplayname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by UserDisplayName, UserPrincipalName, Anomalies, Score, Baseline, FailureToSuccessDiff = Diff",
    "detection": "bruteforcecloudpc.yaml",
    "field": "failuretosuccessdiff",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend OS = DeviceDetail.operatingSystem, Browser = DeviceDetail.browser",
    "detection": "bruteforcecloudpc.yaml",
    "field": "os",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend OS = DeviceDetail.operatingSystem, Browser = DeviceDetail.browser",
    "detection": "bruteforcecloudpc.yaml",
    "field": "browser",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend StatusCode = tostring(Status.errorCode), StatusDetails = tostring(Status.additionalDetails)",
    "detection": "bruteforcecloudpc.yaml",
    "field": "statuscode",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend StatusCode = tostring(Status.errorCode), StatusDetails = tostring(Status.additionalDetails)",
    "detection": "bruteforcecloudpc.yaml",
    "field": "statusdetails",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend State = tostring(LocationDetails.state), City = tostring(LocationDetails.city)",
    "detection": "bruteforcecloudpc.yaml",
    "field": "state",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend State = tostring(LocationDetails.state), City = tostring(LocationDetails.city)",
    "detection": "bruteforcecloudpc.yaml",
    "field": "city",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "      | summarize StartTime = min(TimeGenerated),",
    "detection": "bruteforcecloudpc.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPAddressFirst = tostring(IPAddresses[0])",
    "detection": "bruteforcecloudpc.yaml",
    "field": "ipaddressfirst",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "bruteforcecloudpc.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "bruteforcecloudpc.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend type_ = tostring(TargetResources[0].type)",
    "detection": "serviceprincipalassignedprivilegedrole.yaml",
    "field": "type_",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "serviceprincipalassignedprivilegedrole.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "serviceprincipalassignedprivilegedrole.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "serviceprincipalassignedprivilegedrole.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "serviceprincipalassignedprivilegedrole.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingIPAddress = tostring(InitiatedBy.user.ipAddress)",
    "detection": "serviceprincipalassignedprivilegedrole.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatedBy = tostring(iff(isnotempty(InitiatingUserPrincipalName),InitiatingUserPrincipalName, InitiatingAppName))",
    "detection": "serviceprincipalassignedprivilegedrole.yaml",
    "field": "initiatedby",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend ServicePrincipalName = tostring(TargetResources[0].displayName)",
    "detection": "serviceprincipalassignedprivilegedrole.yaml",
    "field": "serviceprincipalname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend ServicePrincipalId = tostring(TargetResources[0].id)",
    "detection": "serviceprincipalassignedprivilegedrole.yaml",
    "field": "serviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetResources_0_modifiedProperties = columnifexists(\"TargetResources_0_modifiedProperties\", '')",
    "detection": "serviceprincipalassignedprivilegedrole.yaml",
    "field": "targetresources_0_modifiedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend displayName = tostring(TargetResources_0_modifiedProperties.displayName), newValue = tostring(parse_json(tostring(TargetResources_0_modifiedProperties.newValue)))",
    "detection": "serviceprincipalassignedprivilegedrole.yaml",
    "field": "displayname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend displayName = tostring(TargetResources_0_modifiedProperties.displayName), newValue = tostring(parse_json(tostring(TargetResources_0_modifiedProperties.newValue)))",
    "detection": "serviceprincipalassignedprivilegedrole.yaml",
    "field": "newvalue",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "serviceprincipalassignedprivilegedrole.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "serviceprincipalassignedprivilegedrole.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetRole = newValue",
    "detection": "serviceprincipalassignedprivilegedrole.yaml",
    "field": "targetrole",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AppID = tostring(AdditionalDetails[1].value)",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "appid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend creationTime = ActivityDateTime",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "creationtime",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend CreatorUserPrincipalName = tostring(parse_json(tostring(InitiatedBy.user)).userPrincipalName)",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "creatoruserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend CreatorIPAddress = tostring(parse_json(tostring(InitiatedBy.user)).ipAddress);",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "creatoripaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Activities = pack(\"ActivityTime\", TimeGenerated ,\"IpAddress\", IPAddress, \"ResourceDisplayName\", ResourceDisplayName)",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "activities",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AppID = AppId",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "appid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AppID = tostring(AdditionalDetails[1].value)",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "appid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend deletionTime = ActivityDateTime",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "deletiontime",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend DeleterUserPrincipalName = tostring(parse_json(tostring(InitiatedBy.user)).userPrincipalName)",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "deleteruserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend DeleterIPAddress = tostring(parse_json(tostring(InitiatedBy.user)).ipAddress);",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "deleteripaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AppID = tostring(AdditionalDetails[1].value)",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "appid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend credentialCreationTime = ActivityDateTime;",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "credentialcreationtime",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AppID = tostring(TargetResources[1].displayName)",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "appid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AssignedRole =  iff(tostring(parse_json(tostring(TargetResources[0].modifiedProperties))[1].displayName)==\"AppRole.Value\", tostring(parse_json(tostring(parse_json(tostring(TargetResources[0].modifiedProperties))[1].newValue))),\"\")",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "assignedrole",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AssignedRoles = pack(\"Role\", AssignedRole)",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "assignedroles",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AliveTime = deletionTime - creationTime",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "alivetime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AADTenantId, AppID, creationTime, deletionTime, CreatorUserPrincipalName, DeleterUserPrincipalName, CreatorIPAddress, DeleterIPAddress, list_Activities, list_AssignedRoles, AliveTime",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "aadtenantid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AADTenantId, AppID, creationTime, deletionTime, CreatorUserPrincipalName, DeleterUserPrincipalName, CreatorIPAddress, DeleterIPAddress, list_Activities, list_AssignedRoles, AliveTime",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "appid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AADTenantId, AppID, creationTime, deletionTime, CreatorUserPrincipalName, DeleterUserPrincipalName, CreatorIPAddress, DeleterIPAddress, list_Activities, list_AssignedRoles, AliveTime",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "creationtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AADTenantId, AppID, creationTime, deletionTime, CreatorUserPrincipalName, DeleterUserPrincipalName, CreatorIPAddress, DeleterIPAddress, list_Activities, list_AssignedRoles, AliveTime",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "deletiontime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AADTenantId, AppID, creationTime, deletionTime, CreatorUserPrincipalName, DeleterUserPrincipalName, CreatorIPAddress, DeleterIPAddress, list_Activities, list_AssignedRoles, AliveTime",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "creatoruserprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AADTenantId, AppID, creationTime, deletionTime, CreatorUserPrincipalName, DeleterUserPrincipalName, CreatorIPAddress, DeleterIPAddress, list_Activities, list_AssignedRoles, AliveTime",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "deleteruserprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AADTenantId, AppID, creationTime, deletionTime, CreatorUserPrincipalName, DeleterUserPrincipalName, CreatorIPAddress, DeleterIPAddress, list_Activities, list_AssignedRoles, AliveTime",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "creatoripaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project AADTenantId, AppID, creationTime, deletionTime, CreatorUserPrincipalName, DeleterUserPrincipalName, CreatorIPAddress, DeleterIPAddress, list_Activities, list_AssignedRoles, AliveTime",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "deleteripaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project AADTenantId, AppID, creationTime, deletionTime, CreatorUserPrincipalName, DeleterUserPrincipalName, CreatorIPAddress, DeleterIPAddress, list_Activities, list_AssignedRoles, AliveTime",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "list_activities",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AADTenantId, AppID, creationTime, deletionTime, CreatorUserPrincipalName, DeleterUserPrincipalName, CreatorIPAddress, DeleterIPAddress, list_Activities, list_AssignedRoles, AliveTime",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "list_assignedroles",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AADTenantId, AppID, creationTime, deletionTime, CreatorUserPrincipalName, DeleterUserPrincipalName, CreatorIPAddress, DeleterIPAddress, list_Activities, list_AssignedRoles, AliveTime",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "alivetime",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend CreatorName = tostring(split(CreatorUserPrincipalName, \"@\")[0]), CreatorUPNSuffix = tostring(split(CreatorUserPrincipalName, \"@\")[1])",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "creatorname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend CreatorName = tostring(split(CreatorUserPrincipalName, \"@\")[0]), CreatorUPNSuffix = tostring(split(CreatorUserPrincipalName, \"@\")[1])",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "creatorupnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeleterName = tostring(split(DeleterUserPrincipalName, \"@\")[0]), DeleterSuffix = tostring(split(DeleterUserPrincipalName, \"@\")[1])",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "deletername",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeleterName = tostring(split(DeleterUserPrincipalName, \"@\")[0]), DeleterSuffix = tostring(split(DeleterUserPrincipalName, \"@\")[1])",
    "detection": "suspiciousserviceprincipalcreationactivity.yaml",
    "field": "deletersuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend targetDisplayName = tostring(TargetResource.displayName),",
    "detection": "newapporserviceprincipalcredential.yaml",
    "field": "targetdisplayname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend new_value_set = parse_json(tostring(Property.newValue)),",
    "detection": "newapporserviceprincipalcredential.yaml",
    "field": "new_value_set",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend diff = set_difference(new_value_set, old_value_set)",
    "detection": "newapporserviceprincipalcredential.yaml",
    "field": "diff",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend UserAgent = tostring(AdditionalDetail.value)",
    "detection": "newapporserviceprincipalcredential.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "newapporserviceprincipalcredential.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "newapporserviceprincipalcredential.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "newapporserviceprincipalcredential.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "newapporserviceprincipalcredential.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingIpAddress = tostring(iff(isnotempty(InitiatedBy.user.ipAddress), InitiatedBy.user.ipAddress, InitiatedBy.app.ipAddress))",
    "detection": "newapporserviceprincipalcredential.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(InitiatingUserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(InitiatingUserPrincipalName,'@',1)[0])",
    "detection": "newapporserviceprincipalcredential.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(InitiatingUserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(InitiatingUserPrincipalName,'@',1)[0])",
    "detection": "newapporserviceprincipalcredential.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize FailedCountPerDay=count(),FailedUserAgents=make_set(UserAgent), FailedCountries=make_set(LocationDetails.countryOrRegion),FailedIps=make_set(IPAddress) by UserPrincipalName, Day=bin(TimeGenerated, 1d)",
    "detection": "expiredaccesscredentials.yaml",
    "field": "failedcountperday",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize FailedCountPerDay=count(),FailedUserAgents=make_set(UserAgent), FailedCountries=make_set(LocationDetails.countryOrRegion),FailedIps=make_set(IPAddress) by UserPrincipalName, Day=bin(TimeGenerated, 1d)",
    "detection": "expiredaccesscredentials.yaml",
    "field": "faileduseragents",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize FailedCountPerDay=count(),FailedUserAgents=make_set(UserAgent), FailedCountries=make_set(LocationDetails.countryOrRegion),FailedIps=make_set(IPAddress) by UserPrincipalName, Day=bin(TimeGenerated, 1d)",
    "detection": "expiredaccesscredentials.yaml",
    "field": "failedcountries",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize FailedCountPerDay=count(),FailedUserAgents=make_set(UserAgent), FailedCountries=make_set(LocationDetails.countryOrRegion),FailedIps=make_set(IPAddress) by UserPrincipalName, Day=bin(TimeGenerated, 1d)",
    "detection": "expiredaccesscredentials.yaml",
    "field": "failedips",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize FailedCountPerDay=count(),FailedUserAgents=make_set(UserAgent), FailedCountries=make_set(LocationDetails.countryOrRegion),FailedIps=make_set(IPAddress) by UserPrincipalName, Day=bin(TimeGenerated, 1d)",
    "detection": "expiredaccesscredentials.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize count() by UserPrincipalName, IPAddress",
    "detection": "expiredaccesscredentials.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize count() by UserPrincipalName, IPAddress",
    "detection": "expiredaccesscredentials.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend FailedIp=tostring(FailedIp)",
    "detection": "expiredaccesscredentials.yaml",
    "field": "failedip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Target = tostring(TargetResources[0].[\"userPrincipalName\"])",
    "detection": "newextusergrantedadmin.yaml",
    "field": "target",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InviteInitiator = tostring(InitiatedBy.[\"user\"].[\"userPrincipalName\"])",
    "detection": "newextusergrantedadmin.yaml",
    "field": "inviteinitiator",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Target = tostring(TargetResources[0].[\"displayName\"]) | extend Target = tostring(extract(@\"UPN\\:\\s(.+)\\,\\sEmail\",1,Target))",
    "detection": "newextusergrantedadmin.yaml",
    "field": "target",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Target, InviteInitiator, OperationName, TenantId",
    "detection": "newextusergrantedadmin.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Target, InviteInitiator, OperationName, TenantId",
    "detection": "newextusergrantedadmin.yaml",
    "field": "target",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Target, InviteInitiator, OperationName, TenantId",
    "detection": "newextusergrantedadmin.yaml",
    "field": "inviteinitiator",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Target, InviteInitiator, OperationName, TenantId",
    "detection": "newextusergrantedadmin.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Target, InviteInitiator, OperationName, TenantId",
    "detection": "newextusergrantedadmin.yaml",
    "field": "tenantid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend displayName_ = tostring(TargetResources_modifiedProperties.displayName)",
    "detection": "newextusergrantedadmin.yaml",
    "field": "displayname_",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend RoleName = tostring(parse_json(tostring(TargetResources_modifiedProperties.newValue)))",
    "detection": "newextusergrantedadmin.yaml",
    "field": "rolename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingApp = tostring(parse_json(tostring(InitiatedBy.app)).displayName)",
    "detection": "newextusergrantedadmin.yaml",
    "field": "initiatingapp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Initiator = iif(isnotempty(InitiatingApp), InitiatingApp, tostring(parse_json(tostring(InitiatedBy.user)).userPrincipalName))",
    "detection": "newextusergrantedadmin.yaml",
    "field": "initiator",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Target = tostring(TargetResources.userPrincipalName)",
    "detection": "newextusergrantedadmin.yaml",
    "field": "target",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend delta = datetime_diff(\"minute\", TimeGenerated, invite_TimeGenerated)",
    "detection": "newextusergrantedadmin.yaml",
    "field": "delta",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project InvitationTime=invite_TimeGenerated, RedeemTime=redeem_TimeGenerated, GrantTime=TimeGenerated, ExternalUser=Target, RoleGranted=RoleName, AdminInitiator=Initiator, MinsBetweenInviteAndEscalation=delta",
    "detection": "newextusergrantedadmin.yaml",
    "field": "invitationtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project InvitationTime=invite_TimeGenerated, RedeemTime=redeem_TimeGenerated, GrantTime=TimeGenerated, ExternalUser=Target, RoleGranted=RoleName, AdminInitiator=Initiator, MinsBetweenInviteAndEscalation=delta",
    "detection": "newextusergrantedadmin.yaml",
    "field": "redeemtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project InvitationTime=invite_TimeGenerated, RedeemTime=redeem_TimeGenerated, GrantTime=TimeGenerated, ExternalUser=Target, RoleGranted=RoleName, AdminInitiator=Initiator, MinsBetweenInviteAndEscalation=delta",
    "detection": "newextusergrantedadmin.yaml",
    "field": "granttime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project InvitationTime=invite_TimeGenerated, RedeemTime=redeem_TimeGenerated, GrantTime=TimeGenerated, ExternalUser=Target, RoleGranted=RoleName, AdminInitiator=Initiator, MinsBetweenInviteAndEscalation=delta",
    "detection": "newextusergrantedadmin.yaml",
    "field": "externaluser",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project InvitationTime=invite_TimeGenerated, RedeemTime=redeem_TimeGenerated, GrantTime=TimeGenerated, ExternalUser=Target, RoleGranted=RoleName, AdminInitiator=Initiator, MinsBetweenInviteAndEscalation=delta",
    "detection": "newextusergrantedadmin.yaml",
    "field": "rolegranted",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project InvitationTime=invite_TimeGenerated, RedeemTime=redeem_TimeGenerated, GrantTime=TimeGenerated, ExternalUser=Target, RoleGranted=RoleName, AdminInitiator=Initiator, MinsBetweenInviteAndEscalation=delta",
    "detection": "newextusergrantedadmin.yaml",
    "field": "admininitiator",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project InvitationTime=invite_TimeGenerated, RedeemTime=redeem_TimeGenerated, GrantTime=TimeGenerated, ExternalUser=Target, RoleGranted=RoleName, AdminInitiator=Initiator, MinsBetweenInviteAndEscalation=delta",
    "detection": "newextusergrantedadmin.yaml",
    "field": "minsbetweeninviteandescalation",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ExternalUserName = tostring(split(ExternalUser, '@', 0)[0]), ExternalUserUPNSuffix = tostring(split(ExternalUser, '@', 1)[0])",
    "detection": "newextusergrantedadmin.yaml",
    "field": "externalusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend ExternalUserName = tostring(split(ExternalUser, '@', 0)[0]), ExternalUserUPNSuffix = tostring(split(ExternalUser, '@', 1)[0])",
    "detection": "newextusergrantedadmin.yaml",
    "field": "externaluserupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AdminInitiatorName = tostring(split(AdminInitiator, '@', 0)[0]), AdminInitiatorUPNSuffix = tostring(split(AdminInitiator, '@', 1)[0])",
    "detection": "newextusergrantedadmin.yaml",
    "field": "admininitiatorname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AdminInitiatorName = tostring(split(AdminInitiator, '@', 0)[0]), AdminInitiatorUPNSuffix = tostring(split(AdminInitiator, '@', 1)[0])",
    "detection": "newextusergrantedadmin.yaml",
    "field": "admininitiatorupnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend LocationDetails = LocationDetails_dynamic",
    "detection": "anomaloususerappsigninlocationincrease-detection.yaml",
    "field": "locationdetails",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Location = strcat(LocationDetails.countryOrRegion, \"-\", LocationDetails.state,\"-\", LocationDetails.city)",
    "detection": "anomaloususerappsigninlocationincrease-detection.yaml",
    "field": "location",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize dcount(Location) by AppDisplayName, AppId, UserPrincipalName, UserId, bin(startofday(TimeGenerated), 1d)",
    "detection": "anomaloususerappsigninlocationincrease-detection.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize dcount(Location) by AppDisplayName, AppId, UserPrincipalName, UserId, bin(startofday(TimeGenerated), 1d)",
    "detection": "anomaloususerappsigninlocationincrease-detection.yaml",
    "field": "appid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize dcount(Location) by AppDisplayName, AppId, UserPrincipalName, UserId, bin(startofday(TimeGenerated), 1d)",
    "detection": "anomaloususerappsigninlocationincrease-detection.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize dcount(Location) by AppDisplayName, AppId, UserPrincipalName, UserId, bin(startofday(TimeGenerated), 1d)",
    "detection": "anomaloususerappsigninlocationincrease-detection.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend SignInDetails = bag_pack(\"TimeGenerated\", TimeGenerated1, \"Location\", Location, \"Source\", IPAddress, \"Device\", DeviceDetail_dynamic)",
    "detection": "anomaloususerappsigninlocationincrease-detection.yaml",
    "field": "signindetails",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SignInDetailsSet=make_set(SignInDetails, 1000) by UserId, UserPrincipalName, CountOfLocations, TimeGenerated, AppId, AppDisplayName",
    "detection": "anomaloususerappsigninlocationincrease-detection.yaml",
    "field": "signindetailsset",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SignInDetailsSet=make_set(SignInDetails, 1000) by UserId, UserPrincipalName, CountOfLocations, TimeGenerated, AppId, AppDisplayName",
    "detection": "anomaloususerappsigninlocationincrease-detection.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SignInDetailsSet=make_set(SignInDetails, 1000) by UserId, UserPrincipalName, CountOfLocations, TimeGenerated, AppId, AppDisplayName",
    "detection": "anomaloususerappsigninlocationincrease-detection.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SignInDetailsSet=make_set(SignInDetails, 1000) by UserId, UserPrincipalName, CountOfLocations, TimeGenerated, AppId, AppDisplayName",
    "detection": "anomaloususerappsigninlocationincrease-detection.yaml",
    "field": "countoflocations",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SignInDetailsSet=make_set(SignInDetails, 1000) by UserId, UserPrincipalName, CountOfLocations, TimeGenerated, AppId, AppDisplayName",
    "detection": "anomaloususerappsigninlocationincrease-detection.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SignInDetailsSet=make_set(SignInDetails, 1000) by UserId, UserPrincipalName, CountOfLocations, TimeGenerated, AppId, AppDisplayName",
    "detection": "anomaloususerappsigninlocationincrease-detection.yaml",
    "field": "appid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SignInDetailsSet=make_set(SignInDetails, 1000) by UserId, UserPrincipalName, CountOfLocations, TimeGenerated, AppId, AppDisplayName",
    "detection": "anomaloususerappsigninlocationincrease-detection.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = split(UserPrincipalName, \"@\")[0], UPNSuffix = split(UserPrincipalName, \"@\")[1]",
    "detection": "anomaloususerappsigninlocationincrease-detection.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = split(UserPrincipalName, \"@\")[0], UPNSuffix = split(UserPrincipalName, \"@\")[1]",
    "detection": "anomaloususerappsigninlocationincrease-detection.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatedBy = parse_json(InitiatedBy)",
    "detection": "newonmicrosoftdomainadded.yaml",
    "field": "initiatedby",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingUser = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "newonmicrosoftdomainadded.yaml",
    "field": "initiatinguser",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "newonmicrosoftdomainadded.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingIp = tostring(InitiatedBy.user.ipAddress)",
    "detection": "newonmicrosoftdomainadded.yaml",
    "field": "initiatingip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingApp = tostring(InitiatedBy.app.displayName)",
    "detection": "newonmicrosoftdomainadded.yaml",
    "field": "initiatingapp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingSPID = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "newonmicrosoftdomainadded.yaml",
    "field": "initiatingspid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DomainAdded = tostring(TargetResources[0].displayName)",
    "detection": "newonmicrosoftdomainadded.yaml",
    "field": "domainadded",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ActionInitiatedBy = case(isnotempty(InitiatingUser), InitiatingUser, strcat(InitiatingApp, \" - \", InitiatingSPID))",
    "detection": "newonmicrosoftdomainadded.yaml",
    "field": "actioninitiatedby",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = split(InitiatingUser, \"@\")[0]",
    "detection": "newonmicrosoftdomainadded.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UPNSuffix = split(InitiatingUser, \"@\")[1]",
    "detection": "newonmicrosoftdomainadded.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend UserPrincipalName = extract(@'([a-f0-9]{32})?(.*)', 2, tostring(TargetResource.userPrincipalName))",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeletedByUser = tostring(InitiatedBy.user.userPrincipalName), DeletedByIPAddress = tostring(InitiatedBy.user.ipAddress)",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "deletedbyuser",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeletedByUser = tostring(InitiatedBy.user.userPrincipalName), DeletedByIPAddress = tostring(InitiatedBy.user.ipAddress)",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "deletedbyipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeletedByApp = tostring(InitiatedBy.app.displayName)",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "deletedbyapp",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Deletion_TimeGenerated = TimeGenerated, UserPrincipalName, DeletedByUser, DeletedByIPAddress, DeletedByApp, Deletion_AdditionalDetails = AdditionalDetails, Deletion_InitiatedBy = InitiatedBy, Deletion_TargetResources = TargetResources",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "deletion_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Deletion_TimeGenerated = TimeGenerated, UserPrincipalName, DeletedByUser, DeletedByIPAddress, DeletedByApp, Deletion_AdditionalDetails = AdditionalDetails, Deletion_InitiatedBy = InitiatedBy, Deletion_TargetResources = TargetResources",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Deletion_TimeGenerated = TimeGenerated, UserPrincipalName, DeletedByUser, DeletedByIPAddress, DeletedByApp, Deletion_AdditionalDetails = AdditionalDetails, Deletion_InitiatedBy = InitiatedBy, Deletion_TargetResources = TargetResources",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "deletedbyuser",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Deletion_TimeGenerated = TimeGenerated, UserPrincipalName, DeletedByUser, DeletedByIPAddress, DeletedByApp, Deletion_AdditionalDetails = AdditionalDetails, Deletion_InitiatedBy = InitiatedBy, Deletion_TargetResources = TargetResources",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "deletedbyipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project Deletion_TimeGenerated = TimeGenerated, UserPrincipalName, DeletedByUser, DeletedByIPAddress, DeletedByApp, Deletion_AdditionalDetails = AdditionalDetails, Deletion_InitiatedBy = InitiatedBy, Deletion_TargetResources = TargetResources",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "deletedbyapp",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Deletion_TimeGenerated = TimeGenerated, UserPrincipalName, DeletedByUser, DeletedByIPAddress, DeletedByApp, Deletion_AdditionalDetails = AdditionalDetails, Deletion_InitiatedBy = InitiatedBy, Deletion_TargetResources = TargetResources",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "deletion_additionaldetails",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Deletion_TimeGenerated = TimeGenerated, UserPrincipalName, DeletedByUser, DeletedByIPAddress, DeletedByApp, Deletion_AdditionalDetails = AdditionalDetails, Deletion_InitiatedBy = InitiatedBy, Deletion_TargetResources = TargetResources",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "deletion_initiatedby",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Deletion_TimeGenerated = TimeGenerated, UserPrincipalName, DeletedByUser, DeletedByIPAddress, DeletedByApp, Deletion_AdditionalDetails = AdditionalDetails, Deletion_InitiatedBy = InitiatedBy, Deletion_TargetResources = TargetResources",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "deletion_targetresources",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "          | extend UserPrincipalName = trim(@'\"',tostring(TargetResource.userPrincipalName))",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend TimeDelta = Deletion_TimeGenerated - Creation_TimeGenerated",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "timedelta",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend CreatedByUser = tostring(InitiatedBy.user.userPrincipalName), CreatedByIPAddress = tostring(InitiatedBy.user.ipAddress)",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "createdbyuser",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend CreatedByUser = tostring(InitiatedBy.user.userPrincipalName), CreatedByIPAddress = tostring(InitiatedBy.user.ipAddress)",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "createdbyipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend CreatedByApp = tostring(InitiatedBy.app.displayName)",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "createdbyapp",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Creation_TimeGenerated, Deletion_TimeGenerated, TimeDelta, UserPrincipalName, DeletedByUser, DeletedByIPAddress, DeletedByApp, CreatedByUser, CreatedByIPAddress, CreatedByApp, Creation_AdditionalDetails = AdditionalDetails, Creation_InitiatedBy = InitiatedBy, Creation_TargetResources = TargetResources, Deletion_AdditionalDetails, Deletion_InitiatedBy, Deletion_TargetResources",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "creation_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Creation_TimeGenerated, Deletion_TimeGenerated, TimeDelta, UserPrincipalName, DeletedByUser, DeletedByIPAddress, DeletedByApp, CreatedByUser, CreatedByIPAddress, CreatedByApp, Creation_AdditionalDetails = AdditionalDetails, Creation_InitiatedBy = InitiatedBy, Creation_TargetResources = TargetResources, Deletion_AdditionalDetails, Deletion_InitiatedBy, Deletion_TargetResources",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "deletion_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Creation_TimeGenerated, Deletion_TimeGenerated, TimeDelta, UserPrincipalName, DeletedByUser, DeletedByIPAddress, DeletedByApp, CreatedByUser, CreatedByIPAddress, CreatedByApp, Creation_AdditionalDetails = AdditionalDetails, Creation_InitiatedBy = InitiatedBy, Creation_TargetResources = TargetResources, Deletion_AdditionalDetails, Deletion_InitiatedBy, Deletion_TargetResources",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "timedelta",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Creation_TimeGenerated, Deletion_TimeGenerated, TimeDelta, UserPrincipalName, DeletedByUser, DeletedByIPAddress, DeletedByApp, CreatedByUser, CreatedByIPAddress, CreatedByApp, Creation_AdditionalDetails = AdditionalDetails, Creation_InitiatedBy = InitiatedBy, Creation_TargetResources = TargetResources, Deletion_AdditionalDetails, Deletion_InitiatedBy, Deletion_TargetResources",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Creation_TimeGenerated, Deletion_TimeGenerated, TimeDelta, UserPrincipalName, DeletedByUser, DeletedByIPAddress, DeletedByApp, CreatedByUser, CreatedByIPAddress, CreatedByApp, Creation_AdditionalDetails = AdditionalDetails, Creation_InitiatedBy = InitiatedBy, Creation_TargetResources = TargetResources, Deletion_AdditionalDetails, Deletion_InitiatedBy, Deletion_TargetResources",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "deletedbyuser",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Creation_TimeGenerated, Deletion_TimeGenerated, TimeDelta, UserPrincipalName, DeletedByUser, DeletedByIPAddress, DeletedByApp, CreatedByUser, CreatedByIPAddress, CreatedByApp, Creation_AdditionalDetails = AdditionalDetails, Creation_InitiatedBy = InitiatedBy, Creation_TargetResources = TargetResources, Deletion_AdditionalDetails, Deletion_InitiatedBy, Deletion_TargetResources",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "deletedbyipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project Creation_TimeGenerated, Deletion_TimeGenerated, TimeDelta, UserPrincipalName, DeletedByUser, DeletedByIPAddress, DeletedByApp, CreatedByUser, CreatedByIPAddress, CreatedByApp, Creation_AdditionalDetails = AdditionalDetails, Creation_InitiatedBy = InitiatedBy, Creation_TargetResources = TargetResources, Deletion_AdditionalDetails, Deletion_InitiatedBy, Deletion_TargetResources",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "deletedbyapp",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Creation_TimeGenerated, Deletion_TimeGenerated, TimeDelta, UserPrincipalName, DeletedByUser, DeletedByIPAddress, DeletedByApp, CreatedByUser, CreatedByIPAddress, CreatedByApp, Creation_AdditionalDetails = AdditionalDetails, Creation_InitiatedBy = InitiatedBy, Creation_TargetResources = TargetResources, Deletion_AdditionalDetails, Deletion_InitiatedBy, Deletion_TargetResources",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "createdbyuser",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Creation_TimeGenerated, Deletion_TimeGenerated, TimeDelta, UserPrincipalName, DeletedByUser, DeletedByIPAddress, DeletedByApp, CreatedByUser, CreatedByIPAddress, CreatedByApp, Creation_AdditionalDetails = AdditionalDetails, Creation_InitiatedBy = InitiatedBy, Creation_TargetResources = TargetResources, Deletion_AdditionalDetails, Deletion_InitiatedBy, Deletion_TargetResources",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "createdbyipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project Creation_TimeGenerated, Deletion_TimeGenerated, TimeDelta, UserPrincipalName, DeletedByUser, DeletedByIPAddress, DeletedByApp, CreatedByUser, CreatedByIPAddress, CreatedByApp, Creation_AdditionalDetails = AdditionalDetails, Creation_InitiatedBy = InitiatedBy, Creation_TargetResources = TargetResources, Deletion_AdditionalDetails, Deletion_InitiatedBy, Deletion_TargetResources",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "createdbyapp",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Creation_TimeGenerated, Deletion_TimeGenerated, TimeDelta, UserPrincipalName, DeletedByUser, DeletedByIPAddress, DeletedByApp, CreatedByUser, CreatedByIPAddress, CreatedByApp, Creation_AdditionalDetails = AdditionalDetails, Creation_InitiatedBy = InitiatedBy, Creation_TargetResources = TargetResources, Deletion_AdditionalDetails, Deletion_InitiatedBy, Deletion_TargetResources",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "creation_additionaldetails",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Creation_TimeGenerated, Deletion_TimeGenerated, TimeDelta, UserPrincipalName, DeletedByUser, DeletedByIPAddress, DeletedByApp, CreatedByUser, CreatedByIPAddress, CreatedByApp, Creation_AdditionalDetails = AdditionalDetails, Creation_InitiatedBy = InitiatedBy, Creation_TargetResources = TargetResources, Deletion_AdditionalDetails, Deletion_InitiatedBy, Deletion_TargetResources",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "creation_initiatedby",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Creation_TimeGenerated, Deletion_TimeGenerated, TimeDelta, UserPrincipalName, DeletedByUser, DeletedByIPAddress, DeletedByApp, CreatedByUser, CreatedByIPAddress, CreatedByApp, Creation_AdditionalDetails = AdditionalDetails, Creation_InitiatedBy = InitiatedBy, Creation_TargetResources = TargetResources, Deletion_AdditionalDetails, Deletion_InitiatedBy, Deletion_TargetResources",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "creation_targetresources",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Creation_TimeGenerated, Deletion_TimeGenerated, TimeDelta, UserPrincipalName, DeletedByUser, DeletedByIPAddress, DeletedByApp, CreatedByUser, CreatedByIPAddress, CreatedByApp, Creation_AdditionalDetails = AdditionalDetails, Creation_InitiatedBy = InitiatedBy, Creation_TargetResources = TargetResources, Deletion_AdditionalDetails, Deletion_InitiatedBy, Deletion_TargetResources",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "deletion_additionaldetails",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Creation_TimeGenerated, Deletion_TimeGenerated, TimeDelta, UserPrincipalName, DeletedByUser, DeletedByIPAddress, DeletedByApp, CreatedByUser, CreatedByIPAddress, CreatedByApp, Creation_AdditionalDetails = AdditionalDetails, Creation_InitiatedBy = InitiatedBy, Creation_TargetResources = TargetResources, Deletion_AdditionalDetails, Deletion_InitiatedBy, Deletion_TargetResources",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "deletion_initiatedby",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Creation_TimeGenerated, Deletion_TimeGenerated, TimeDelta, UserPrincipalName, DeletedByUser, DeletedByIPAddress, DeletedByApp, CreatedByUser, CreatedByIPAddress, CreatedByApp, Creation_AdditionalDetails = AdditionalDetails, Creation_InitiatedBy = InitiatedBy, Creation_TargetResources = TargetResources, Deletion_AdditionalDetails, Deletion_InitiatedBy, Deletion_TargetResources",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "deletion_targetresources",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = Deletion_TimeGenerated, Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = Deletion_TimeGenerated, Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = Deletion_TimeGenerated, Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "accountcreatedanddeletedinshorttimeframe.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend ModifiedProperties = TargetResource.modifiedProperties",
    "detection": "suspiciousaadjoineddeviceupdate.yaml",
    "field": "modifiedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend DeviceId = TargetResource.id)",
    "detection": "suspiciousaadjoineddeviceupdate.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend OldName = Prop.oldValue",
    "detection": "suspiciousaadjoineddeviceupdate.yaml",
    "field": "oldname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend NewName = Prop.newValue)",
    "detection": "suspiciousaadjoineddeviceupdate.yaml",
    "field": "newname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend OldComplianceState = Prop.oldValue",
    "detection": "suspiciousaadjoineddeviceupdate.yaml",
    "field": "oldcompliancestate",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend NewComplianceState = Prop.newValue)",
    "detection": "suspiciousaadjoineddeviceupdate.yaml",
    "field": "newcompliancestate",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend OldTrustType = Prop.oldValue",
    "detection": "suspiciousaadjoineddeviceupdate.yaml",
    "field": "oldtrusttype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend NewTrustType = Prop.newValue)",
    "detection": "suspiciousaadjoineddeviceupdate.yaml",
    "field": "newtrusttype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend UpdatedProperties = Prop.newValue)",
    "detection": "suspiciousaadjoineddeviceupdate.yaml",
    "field": "updatedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend OldDeviceName = tostring(parse_json(tostring(OldName))[0])",
    "detection": "suspiciousaadjoineddeviceupdate.yaml",
    "field": "olddevicename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend NewDeviceName = tostring(parse_json(tostring(NewName))[0])",
    "detection": "suspiciousaadjoineddeviceupdate.yaml",
    "field": "newdevicename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend OldComplianceState = tostring(parse_json(tostring(OldComplianceState))[0])",
    "detection": "suspiciousaadjoineddeviceupdate.yaml",
    "field": "oldcompliancestate",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend NewComplianceState = tostring(parse_json(tostring(NewComplianceState))[0])",
    "detection": "suspiciousaadjoineddeviceupdate.yaml",
    "field": "newcompliancestate",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatedByUser = tostring(iff(isnotempty(InitiatedBy.user.userPrincipalName),InitiatedBy.user.userPrincipalName, InitiatedBy.app.displayName))",
    "detection": "suspiciousaadjoineddeviceupdate.yaml",
    "field": "initiatedbyuser",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UpdatedPropertiesCount = array_length(split(UpdatedProperties, ','))",
    "detection": "suspiciousaadjoineddeviceupdate.yaml",
    "field": "updatedpropertiescount",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "accountcreateddeletedbynonapproveduser.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "accountcreateddeletedbynonapproveduser.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "accountcreateddeletedbynonapproveduser.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "accountcreateddeletedbynonapproveduser.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingIpAddress = tostring(iff(isnotempty(InitiatedBy.user.ipAddress), InitiatedBy.user.ipAddress, InitiatedBy.app.ipAddress))",
    "detection": "accountcreateddeletedbynonapproveduser.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "accountcreateddeletedbynonapproveduser.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "accountcreateddeletedbynonapproveduser.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Key = tostring(TargetResources_modifiedProperties.displayName)",
    "detection": "applicationredirecturlupdate.yaml",
    "field": "key",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend NewValue = TargetResources_modifiedProperties.newValue",
    "detection": "applicationredirecturlupdate.yaml",
    "field": "newvalue",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend OldValue = TargetResources_modifiedProperties.oldValue",
    "detection": "applicationredirecturlupdate.yaml",
    "field": "oldvalue",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend NewUrls = extract_all('\"Address\":([^,]*)', tostring(NewValue))",
    "detection": "applicationredirecturlupdate.yaml",
    "field": "newurls",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend OldUrls = extract_all('\"Address\":([^,]*)', tostring(OldValue))",
    "detection": "applicationredirecturlupdate.yaml",
    "field": "oldurls",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AddedUrls = set_difference(NewUrls, OldUrls)",
    "detection": "applicationredirecturlupdate.yaml",
    "field": "addedurls",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UserAgent = iif(tostring(AdditionalDetails[0].key) == \"User-Agent\", tostring(AdditionalDetails[0].value), \"\")",
    "detection": "applicationredirecturlupdate.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "applicationredirecturlupdate.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "applicationredirecturlupdate.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "applicationredirecturlupdate.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "applicationredirecturlupdate.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingIPAddress = tostring(InitiatedBy.user.ipAddress)",
    "detection": "applicationredirecturlupdate.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AddedBy = iif(isnotempty(InitiatingUserPrincipalName), InitiatingUserPrincipalName, InitiatingAppName)",
    "detection": "applicationredirecturlupdate.yaml",
    "field": "addedby",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetAppName = tostring(TargetResources.displayName)",
    "detection": "applicationredirecturlupdate.yaml",
    "field": "targetappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "applicationredirecturlupdate.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "applicationredirecturlupdate.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend ParsedDeletedUserPrincipalName = extract(@\"^[0-9a-f]{32}([^\\#]+)\\#EXT\\#\", 1, tostring(TargetResource[\"userPrincipalName\"]))",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "parseddeleteduserprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Delete_TimeGenerated = TimeGenerated, Category, Identity, Initiator, Delete_IPAddress, OperationName, Result, ParsedDeletedUserPrincipalName, InitiatedBy, AdditionalDetails, TargetResources, InitiatorId, CorrelationId",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "delete_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Delete_TimeGenerated = TimeGenerated, Category, Identity, Initiator, Delete_IPAddress, OperationName, Result, ParsedDeletedUserPrincipalName, InitiatedBy, AdditionalDetails, TargetResources, InitiatorId, CorrelationId",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "category",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Delete_TimeGenerated = TimeGenerated, Category, Identity, Initiator, Delete_IPAddress, OperationName, Result, ParsedDeletedUserPrincipalName, InitiatedBy, AdditionalDetails, TargetResources, InitiatorId, CorrelationId",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "identity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Delete_TimeGenerated = TimeGenerated, Category, Identity, Initiator, Delete_IPAddress, OperationName, Result, ParsedDeletedUserPrincipalName, InitiatedBy, AdditionalDetails, TargetResources, InitiatorId, CorrelationId",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "initiator",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Delete_TimeGenerated = TimeGenerated, Category, Identity, Initiator, Delete_IPAddress, OperationName, Result, ParsedDeletedUserPrincipalName, InitiatedBy, AdditionalDetails, TargetResources, InitiatorId, CorrelationId",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "delete_ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project Delete_TimeGenerated = TimeGenerated, Category, Identity, Initiator, Delete_IPAddress, OperationName, Result, ParsedDeletedUserPrincipalName, InitiatedBy, AdditionalDetails, TargetResources, InitiatorId, CorrelationId",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Delete_TimeGenerated = TimeGenerated, Category, Identity, Initiator, Delete_IPAddress, OperationName, Result, ParsedDeletedUserPrincipalName, InitiatedBy, AdditionalDetails, TargetResources, InitiatorId, CorrelationId",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "result",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Delete_TimeGenerated = TimeGenerated, Category, Identity, Initiator, Delete_IPAddress, OperationName, Result, ParsedDeletedUserPrincipalName, InitiatedBy, AdditionalDetails, TargetResources, InitiatorId, CorrelationId",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "parseddeleteduserprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Delete_TimeGenerated = TimeGenerated, Category, Identity, Initiator, Delete_IPAddress, OperationName, Result, ParsedDeletedUserPrincipalName, InitiatedBy, AdditionalDetails, TargetResources, InitiatorId, CorrelationId",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "initiatedby",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Delete_TimeGenerated = TimeGenerated, Category, Identity, Initiator, Delete_IPAddress, OperationName, Result, ParsedDeletedUserPrincipalName, InitiatedBy, AdditionalDetails, TargetResources, InitiatorId, CorrelationId",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "additionaldetails",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Delete_TimeGenerated = TimeGenerated, Category, Identity, Initiator, Delete_IPAddress, OperationName, Result, ParsedDeletedUserPrincipalName, InitiatedBy, AdditionalDetails, TargetResources, InitiatorId, CorrelationId",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "targetresources",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Delete_TimeGenerated = TimeGenerated, Category, Identity, Initiator, Delete_IPAddress, OperationName, Result, ParsedDeletedUserPrincipalName, InitiatedBy, AdditionalDetails, TargetResources, InitiatorId, CorrelationId",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "initiatorid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Delete_TimeGenerated = TimeGenerated, Category, Identity, Initiator, Delete_IPAddress, OperationName, Result, ParsedDeletedUserPrincipalName, InitiatedBy, AdditionalDetails, TargetResources, InitiatorId, CorrelationId",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize take_any(*) by UserPrincipalName",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend ParsedUserPrincipalName = translate(\"@\", \"_\", UserPrincipalName)",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "parseduserprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project SigninLogs_TimeGenerated = TimeGenerated, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, IPAddress, LocationDetails, AppDisplayName, ResourceDisplayName, ClientAppUsed, UserAgent, DeviceDetail, UserId, UserType, OriginalRequestId, ParsedUserPrincipalName",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "signinlogs_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project SigninLogs_TimeGenerated = TimeGenerated, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, IPAddress, LocationDetails, AppDisplayName, ResourceDisplayName, ClientAppUsed, UserAgent, DeviceDetail, UserId, UserType, OriginalRequestId, ParsedUserPrincipalName",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project SigninLogs_TimeGenerated = TimeGenerated, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, IPAddress, LocationDetails, AppDisplayName, ResourceDisplayName, ClientAppUsed, UserAgent, DeviceDetail, UserId, UserType, OriginalRequestId, ParsedUserPrincipalName",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "userdisplayname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project SigninLogs_TimeGenerated = TimeGenerated, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, IPAddress, LocationDetails, AppDisplayName, ResourceDisplayName, ClientAppUsed, UserAgent, DeviceDetail, UserId, UserType, OriginalRequestId, ParsedUserPrincipalName",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "resulttype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project SigninLogs_TimeGenerated = TimeGenerated, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, IPAddress, LocationDetails, AppDisplayName, ResourceDisplayName, ClientAppUsed, UserAgent, DeviceDetail, UserId, UserType, OriginalRequestId, ParsedUserPrincipalName",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "resultdescription",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project SigninLogs_TimeGenerated = TimeGenerated, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, IPAddress, LocationDetails, AppDisplayName, ResourceDisplayName, ClientAppUsed, UserAgent, DeviceDetail, UserId, UserType, OriginalRequestId, ParsedUserPrincipalName",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "    | project SigninLogs_TimeGenerated = TimeGenerated, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, IPAddress, LocationDetails, AppDisplayName, ResourceDisplayName, ClientAppUsed, UserAgent, DeviceDetail, UserId, UserType, OriginalRequestId, ParsedUserPrincipalName",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "locationdetails",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project SigninLogs_TimeGenerated = TimeGenerated, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, IPAddress, LocationDetails, AppDisplayName, ResourceDisplayName, ClientAppUsed, UserAgent, DeviceDetail, UserId, UserType, OriginalRequestId, ParsedUserPrincipalName",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project SigninLogs_TimeGenerated = TimeGenerated, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, IPAddress, LocationDetails, AppDisplayName, ResourceDisplayName, ClientAppUsed, UserAgent, DeviceDetail, UserId, UserType, OriginalRequestId, ParsedUserPrincipalName",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "resourcedisplayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project SigninLogs_TimeGenerated = TimeGenerated, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, IPAddress, LocationDetails, AppDisplayName, ResourceDisplayName, ClientAppUsed, UserAgent, DeviceDetail, UserId, UserType, OriginalRequestId, ParsedUserPrincipalName",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "clientappused",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project SigninLogs_TimeGenerated = TimeGenerated, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, IPAddress, LocationDetails, AppDisplayName, ResourceDisplayName, ClientAppUsed, UserAgent, DeviceDetail, UserId, UserType, OriginalRequestId, ParsedUserPrincipalName",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project SigninLogs_TimeGenerated = TimeGenerated, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, IPAddress, LocationDetails, AppDisplayName, ResourceDisplayName, ClientAppUsed, UserAgent, DeviceDetail, UserId, UserType, OriginalRequestId, ParsedUserPrincipalName",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "devicedetail",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project SigninLogs_TimeGenerated = TimeGenerated, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, IPAddress, LocationDetails, AppDisplayName, ResourceDisplayName, ClientAppUsed, UserAgent, DeviceDetail, UserId, UserType, OriginalRequestId, ParsedUserPrincipalName",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project SigninLogs_TimeGenerated = TimeGenerated, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, IPAddress, LocationDetails, AppDisplayName, ResourceDisplayName, ClientAppUsed, UserAgent, DeviceDetail, UserId, UserType, OriginalRequestId, ParsedUserPrincipalName",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "usertype",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project SigninLogs_TimeGenerated = TimeGenerated, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, IPAddress, LocationDetails, AppDisplayName, ResourceDisplayName, ClientAppUsed, UserAgent, DeviceDetail, UserId, UserType, OriginalRequestId, ParsedUserPrincipalName",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "originalrequestid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project SigninLogs_TimeGenerated = TimeGenerated, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, IPAddress, LocationDetails, AppDisplayName, ResourceDisplayName, ClientAppUsed, UserAgent, DeviceDetail, UserId, UserType, OriginalRequestId, ParsedUserPrincipalName",
    "detection": "suspiciousloginfromdeletedexternalidentities.yaml",
    "field": "parseduserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend modifiedProperties = parse_json(TargetResources).modifiedProperties",
    "detection": "adfsdomaintrustmods.yaml",
    "field": "modifiedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend targetDisplayName = tostring(parse_json(modifiedProperties).displayName)",
    "detection": "adfsdomaintrustmods.yaml",
    "field": "targetdisplayname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend modifiedProperties = parse_json(TargetResources).modifiedProperties",
    "detection": "adfsdomaintrustmods.yaml",
    "field": "modifiedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend targetDisplayName = tostring(Property.displayName),",
    "detection": "adfsdomaintrustmods.yaml",
    "field": "targetdisplayname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend UserAgent = tostring(AdditionalDetail.value)",
    "detection": "adfsdomaintrustmods.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingUserOrApp = iff(isnotempty(InitiatedBy.user.userPrincipalName),tostring(InitiatedBy.user.userPrincipalName), tostring(InitiatedBy.app.displayName))",
    "detection": "adfsdomaintrustmods.yaml",
    "field": "initiatinguserorapp",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "adfsdomaintrustmods.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "adfsdomaintrustmods.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "adfsdomaintrustmods.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "adfsdomaintrustmods.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingIpAddress = tostring(iff(isnotempty(InitiatedBy.user.ipAddress), InitiatedBy.user.ipAddress, InitiatedBy.app.ipAddress))",
    "detection": "adfsdomaintrustmods.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "adfsdomaintrustmods.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "adfsdomaintrustmods.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend additionalDetails_ = tostring(Status.additionalDetails)",
    "detection": "mfarejectedbyuser.yaml",
    "field": "additionaldetails_",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserPrincipalName = tolower(UserPrincipalName)",
    "detection": "mfarejectedbyuser.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTIme = max(TimeGenerated) by UserPrincipalName, UserId, AADTenantId, IPAddress",
    "detection": "mfarejectedbyuser.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTIme = max(TimeGenerated) by UserPrincipalName, UserId, AADTenantId, IPAddress",
    "detection": "mfarejectedbyuser.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTIme = max(TimeGenerated) by UserPrincipalName, UserId, AADTenantId, IPAddress",
    "detection": "mfarejectedbyuser.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTIme = max(TimeGenerated) by UserPrincipalName, UserId, AADTenantId, IPAddress",
    "detection": "mfarejectedbyuser.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTIme = max(TimeGenerated) by UserPrincipalName, UserId, AADTenantId, IPAddress",
    "detection": "mfarejectedbyuser.yaml",
    "field": "aadtenantid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTIme = max(TimeGenerated) by UserPrincipalName, UserId, AADTenantId, IPAddress",
    "detection": "mfarejectedbyuser.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "mfarejectedbyuser.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "mfarejectedbyuser.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize LatestReportTime = arg_max(TimeGenerated, *) by AccountUPN",
    "detection": "mfarejectedbyuser.yaml",
    "field": "latestreporttime",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize LatestReportTime = arg_max(TimeGenerated, *) by AccountUPN",
    "detection": "mfarejectedbyuser.yaml",
    "field": "accountupn",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project AccountUPN, Tags, JobTitle, GroupMembership, AssignedRoles, UserType, IsAccountEnabled",
    "detection": "mfarejectedbyuser.yaml",
    "field": "accountupn",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project AccountUPN, Tags, JobTitle, GroupMembership, AssignedRoles, UserType, IsAccountEnabled",
    "detection": "mfarejectedbyuser.yaml",
    "field": "tags",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project AccountUPN, Tags, JobTitle, GroupMembership, AssignedRoles, UserType, IsAccountEnabled",
    "detection": "mfarejectedbyuser.yaml",
    "field": "jobtitle",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project AccountUPN, Tags, JobTitle, GroupMembership, AssignedRoles, UserType, IsAccountEnabled",
    "detection": "mfarejectedbyuser.yaml",
    "field": "groupmembership",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project AccountUPN, Tags, JobTitle, GroupMembership, AssignedRoles, UserType, IsAccountEnabled",
    "detection": "mfarejectedbyuser.yaml",
    "field": "assignedroles",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project AccountUPN, Tags, JobTitle, GroupMembership, AssignedRoles, UserType, IsAccountEnabled",
    "detection": "mfarejectedbyuser.yaml",
    "field": "usertype",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project AccountUPN, Tags, JobTitle, GroupMembership, AssignedRoles, UserType, IsAccountEnabled",
    "detection": "mfarejectedbyuser.yaml",
    "field": "isaccountenabled",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend UserPrincipalName=tolower(AccountUPN)",
    "detection": "mfarejectedbyuser.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project UsersInsights, DevicesInsights, ActivityInsights, InvestigationPriority, SourceIPAddress",
    "detection": "mfarejectedbyuser.yaml",
    "field": "usersinsights",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project UsersInsights, DevicesInsights, ActivityInsights, InvestigationPriority, SourceIPAddress",
    "detection": "mfarejectedbyuser.yaml",
    "field": "devicesinsights",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project UsersInsights, DevicesInsights, ActivityInsights, InvestigationPriority, SourceIPAddress",
    "detection": "mfarejectedbyuser.yaml",
    "field": "activityinsights",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project UsersInsights, DevicesInsights, ActivityInsights, InvestigationPriority, SourceIPAddress",
    "detection": "mfarejectedbyuser.yaml",
    "field": "investigationpriority",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project UsersInsights, DevicesInsights, ActivityInsights, InvestigationPriority, SourceIPAddress",
    "detection": "mfarejectedbyuser.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend UEBARiskScore = IPInvestigationPriority",
    "detection": "mfarejectedbyuser.yaml",
    "field": "uebariskscore",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend Properties = TargetResource.modifiedProperties",
    "detection": "cross-tenantaccesssettingsorganizationoutbounddirectsettingschanged.yaml",
    "field": "properties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend PremodifiedOutboundSettings = trim('\"',tostring(Property.oldValue)),",
    "detection": "cross-tenantaccesssettingsorganizationoutbounddirectsettingschanged.yaml",
    "field": "premodifiedoutboundsettings",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "cross-tenantaccesssettingsorganizationoutbounddirectsettingschanged.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "cross-tenantaccesssettingsorganizationoutbounddirectsettingschanged.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "cross-tenantaccesssettingsorganizationoutbounddirectsettingschanged.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "cross-tenantaccesssettingsorganizationoutbounddirectsettingschanged.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingIpAddress = tostring(iff(isnotempty(InitiatedBy.user.ipAddress), InitiatedBy.user.ipAddress, InitiatedBy.app.ipAddress))",
    "detection": "cross-tenantaccesssettingsorganizationoutbounddirectsettingschanged.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "cross-tenantaccesssettingsorganizationoutbounddirectsettingschanged.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "cross-tenantaccesssettingsorganizationoutbounddirectsettingschanged.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "changestopimsettings.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "changestopimsettings.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingIPAddress = tostring(InitiatedBy.user.ipAddress)",
    "detection": "changestopimsettings.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "changestopimsettings.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "changestopimsettings.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize arg_max(TimeGenerated, *) by AccountUPN",
    "detection": "authenticationsofprivilegedaccountsoutsideofexpectedcontrols.yaml",
    "field": "accountupn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend deviceId = tostring(DeviceDetail.deviceId)",
    "detection": "authenticationsofprivilegedaccountsoutsideofexpectedcontrols.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend deviceId = tostring(DeviceDetail.deviceId)",
    "detection": "authenticationsofprivilegedaccountsoutsideofexpectedcontrols.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AuthResult = tostring(parse_json(AuthenticationDetails)[1].authenticationStepResultDetail)",
    "detection": "multiple-mfa-failure-for-an-enduser-within-15min.yaml",
    "field": "authresult",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TimeDiff = iff(UserId == prev(UserId), TimeGenerated - prev(TimeGenerated), todynamic(\"\"))",
    "detection": "multiple-mfa-failure-for-an-enduser-within-15min.yaml",
    "field": "timediff",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend isRelated = iff((UserId == next(UserId) and (next(TimeDiff) < 15m)), True, todynamic(\"\"))",
    "detection": "multiple-mfa-failure-for-an-enduser-within-15min.yaml",
    "field": "isrelated",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountCustomEntity = UserId",
    "detection": "multiple-mfa-failure-for-an-enduser-within-15min.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingUserPrincipalName = tostring(parse_json(tostring(InitiatedBy.user)).userPrincipalName)",
    "detection": "guestusersinvitedtotenantbynewinviters.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingUserPrincipalName = tostring(parse_json(tostring(InitiatedBy.user)).userPrincipalName)",
    "detection": "guestusersinvitedtotenantbynewinviters.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "guestusersinvitedtotenantbynewinviters.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingIPAddress = tostring(InitiatedBy.user.ipAddress)",
    "detection": "guestusersinvitedtotenantbynewinviters.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetUserPrincipalName = tostring(TargetResources[0].userPrincipalName)",
    "detection": "guestusersinvitedtotenantbynewinviters.yaml",
    "field": "targetuserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetAadUserId = tostring(TargetResources[0].id)",
    "detection": "guestusersinvitedtotenantbynewinviters.yaml",
    "field": "targetaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend invitingUser = InitiatingUserPrincipalName, invitedUserPrincipalName = TargetUserPrincipalName",
    "detection": "guestusersinvitedtotenantbynewinviters.yaml",
    "field": "invitinguser",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend invitingUser = InitiatingUserPrincipalName, invitedUserPrincipalName = TargetUserPrincipalName",
    "detection": "guestusersinvitedtotenantbynewinviters.yaml",
    "field": "inviteduserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "guestusersinvitedtotenantbynewinviters.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "guestusersinvitedtotenantbynewinviters.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetAccountName = tostring(split(TargetUserPrincipalName, \"@\")[0]), TargetAccountUPNSuffix = tostring(split(TargetUserPrincipalName, \"@\")[1])",
    "detection": "guestusersinvitedtotenantbynewinviters.yaml",
    "field": "targetaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetAccountName = tostring(split(TargetUserPrincipalName, \"@\")[0]), TargetAccountUPNSuffix = tostring(split(TargetUserPrincipalName, \"@\")[1])",
    "detection": "guestusersinvitedtotenantbynewinviters.yaml",
    "field": "targetaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend displayName_ = tostring(TargetResources_modifiedProperties.displayName)",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "displayname_",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend RoleName = tostring(parse_json(tostring(TargetResources_modifiedProperties.oldValue)))",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "rolename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingApp = tostring(parse_json(tostring(InitiatedBy.app)).displayName)",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiatingapp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Initiator = iif(isnotempty(InitiatingApp), InitiatingApp, tostring(parse_json(tostring(InitiatedBy.user)).userPrincipalName))",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiator",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Target = tostring(TargetResources.userPrincipalName)",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "target",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize RemovedGlobalAdminTime = max(TimeGenerated), TargetAdmins = make_set(Target) by OperationName,  RoleName, Initiator, Result;",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "removedglobaladmintime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize RemovedGlobalAdminTime = max(TimeGenerated), TargetAdmins = make_set(Target) by OperationName,  RoleName, Initiator, Result;",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "targetadmins",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize RemovedGlobalAdminTime = max(TimeGenerated), TargetAdmins = make_set(Target) by OperationName,  RoleName, Initiator, Result;",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize RemovedGlobalAdminTime = max(TimeGenerated), TargetAdmins = make_set(Target) by OperationName,  RoleName, Initiator, Result;",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "rolename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize RemovedGlobalAdminTime = max(TimeGenerated), TargetAdmins = make_set(Target) by OperationName,  RoleName, Initiator, Result;",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiator",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend displayName_ = tostring(TargetResources_modifiedProperties.displayName)",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "displayname_",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend RoleName = tostring(parse_json(tostring(TargetResources_modifiedProperties.newValue)))",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "rolename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingApp = tostring(parse_json(tostring(InitiatedBy.app)).displayName)",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiatingapp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Initiator = iif(isnotempty(InitiatingApp), InitiatingApp, tostring(parse_json(tostring(InitiatedBy.user)).userPrincipalName))",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiator",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Target = tostring(TargetResources.userPrincipalName)",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "target",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AddedGlobalAdminTime = max(TimeGenerated) by OperationName,  RoleName, Target, Initiator, Result;",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "addedglobaladmintime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AddedGlobalAdminTime = max(TimeGenerated) by OperationName,  RoleName, Target, Initiator, Result;",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AddedGlobalAdminTime = max(TimeGenerated) by OperationName,  RoleName, Target, Initiator, Result;",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "rolename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AddedGlobalAdminTime = max(TimeGenerated) by OperationName,  RoleName, Target, Initiator, Result;",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "target",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AddedGlobalAdminTime = max(TimeGenerated) by OperationName,  RoleName, Target, Initiator, Result;",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiator",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend NoofAdminsRemoved = array_length(TargetAdmins)",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "noofadminsremoved",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AddedGlobalAdminTime, Initiator, Target, RemovedGlobalAdminTime, TargetAdmins, NoofAdminsRemoved",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "addedglobaladmintime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AddedGlobalAdminTime, Initiator, Target, RemovedGlobalAdminTime, TargetAdmins, NoofAdminsRemoved",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "initiator",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AddedGlobalAdminTime, Initiator, Target, RemovedGlobalAdminTime, TargetAdmins, NoofAdminsRemoved",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "target",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AddedGlobalAdminTime, Initiator, Target, RemovedGlobalAdminTime, TargetAdmins, NoofAdminsRemoved",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "removedglobaladmintime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AddedGlobalAdminTime, Initiator, Target, RemovedGlobalAdminTime, TargetAdmins, NoofAdminsRemoved",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "targetadmins",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AddedGlobalAdminTime, Initiator, Target, RemovedGlobalAdminTime, TargetAdmins, NoofAdminsRemoved",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "noofadminsremoved",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name=split(Target, \"@\")[0], UPNSuffix=split(Target, \"@\")[1]",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name=split(Target, \"@\")[0], UPNSuffix=split(Target, \"@\")[1]",
    "detection": "threat-essentials-multipleadmin-membership-removals-from-newadmin.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend AppDisplayName = tostring(TargetResource.displayName),",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend GrantScopeCount = countof(tolower(GrantScope1), o365_attack_regex, 'regex')",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantscopecount",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend GrantInitiatedByAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantinitiatedbyappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend GrantInitiatedByAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantinitiatedbyappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend GrantInitiatedByUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantinitiatedbyuserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend GrantInitiatedByAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantinitiatedbyaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend GrantIpAddress = iff(isnotempty(InitiatedBy.user.ipAddress), tostring(InitiatedBy.user.ipAddress), tostring(InitiatedBy.app.ipAddress))",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend GrantInitiatedBy = iff(isnotempty(GrantInitiatedByUserPrincipalName), GrantInitiatedByUserPrincipalName, GrantInitiatedByAppName)",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantinitiatedby",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend GrantUserAgent = AdditionalDetail.value",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantuseragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantconsenttype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantscope1",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantinitiatedby",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantinitiatedbyuserprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantinitiatedbyaaduserid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantinitiatedbyappname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantinitiatedbyappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantuseragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "appclientid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "consentfull",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "          | extend props = TargetResource.modifiedProperties,",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "props",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "          | extend AppReplyURLs = trim('\"',tostring(Property.newValue))",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "appreplyurls",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "              | extend GrantAuthentication = tostring(TargetResource.displayName)",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantauthentication",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend GrantOperation = OperationName",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantoperation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "      | project GrantAuthentication, GrantOperation, CorrelationId",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantauthentication",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "      | project GrantAuthentication, GrantOperation, CorrelationId",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantoperation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "      | project GrantAuthentication, GrantOperation, CorrelationId",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantconsenttype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantscope1",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantinitiatedby",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "appreplyurls",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantinitiatedbyuserprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantinitiatedbyaaduserid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantinitiatedbyappname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantinitiatedbyappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantuseragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "appclientid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantauthentication",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "grantoperation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "consentfull",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(GrantInitiatedByUserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(GrantInitiatedByUserPrincipalName,'@',1)[0])",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(GrantInitiatedByUserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(GrantInitiatedByUserPrincipalName,'@',1)[0])",
    "detection": "maliciousoauthapp-o365attacktoolkit.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend targetResourceName = tostring(TargetResource.displayName),",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "targetresourcename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend isAdminConsent = trim(@'\"',tostring(Property.newValue))",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "isadminconsent",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend Consent_Permissions = trim(@'\"',tostring(Property.newValue))",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "consent_permissions",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend Consent_ServicePrincipalNames = tostring(extract_all(@\"([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})\",trim(@'\"',tostring(Property.newValue)))[0])",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "consent_serviceprincipalnames",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Consent_InitiatingUserOrApp = iff(isnotempty(InitiatedBy.user.userPrincipalName),tostring(InitiatedBy.user.userPrincipalName), tostring(InitiatedBy.app.displayName))",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "consent_initiatinguserorapp",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Consent_InitiatingIpAddress = iff(isnotempty(InitiatedBy.user.ipAddress), tostring(InitiatedBy.user.ipAddress), tostring(InitiatedBy.app.ipAddress))",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "consent_initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "      | extend targetResourceName = tostring(TargetResource.displayName),",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "targetresourcename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend Credential_KeyDescription = trim(@'\"',tostring(Property.newValue))",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "credential_keydescription",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend UpdatedProperties = trim(@'\"',tostring(Property.newValue))",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "updatedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend Credential_ServicePrincipalNames = tostring(extract_all(@\"([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})\",trim(@'\"',tostring(Property.newValue)))[0])",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "credential_serviceprincipalnames",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Credential_InitiatingUserOrApp = iff(isnotempty(InitiatedBy.user.userPrincipalName),tostring(InitiatedBy.user.userPrincipalName), tostring(InitiatedBy.app.displayName))",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "credential_initiatinguserorapp",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Credential_InitiatingIpAddress = iff(isnotempty(InitiatedBy.user.ipAddress), tostring(InitiatedBy.user.ipAddress), tostring(InitiatedBy.app.ipAddress))",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "credential_initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend TimeConsent = TimeGenerated, TimeCred = TimeGenerated1",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "timeconsent",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TimeConsent = TimeGenerated, TimeCred = TimeGenerated1",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "timecred",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeConsent, TimeCred, Consent_InitiatingUserOrApp, Credential_InitiatingUserOrApp, targetResourceName, targetResourceType, isAdminConsent, Consent_ServicePrincipalNames, Credential_ServicePrincipalNames, Consent_Permissions, Credential_KeyDescription, Consent_InitiatingIpAddress, Credential_InitiatingIpAddress",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "timeconsent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeConsent, TimeCred, Consent_InitiatingUserOrApp, Credential_InitiatingUserOrApp, targetResourceName, targetResourceType, isAdminConsent, Consent_ServicePrincipalNames, Credential_ServicePrincipalNames, Consent_Permissions, Credential_KeyDescription, Consent_InitiatingIpAddress, Credential_InitiatingIpAddress",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "timecred",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeConsent, TimeCred, Consent_InitiatingUserOrApp, Credential_InitiatingUserOrApp, targetResourceName, targetResourceType, isAdminConsent, Consent_ServicePrincipalNames, Credential_ServicePrincipalNames, Consent_Permissions, Credential_KeyDescription, Consent_InitiatingIpAddress, Credential_InitiatingIpAddress",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "consent_initiatinguserorapp",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeConsent, TimeCred, Consent_InitiatingUserOrApp, Credential_InitiatingUserOrApp, targetResourceName, targetResourceType, isAdminConsent, Consent_ServicePrincipalNames, Credential_ServicePrincipalNames, Consent_Permissions, Credential_KeyDescription, Consent_InitiatingIpAddress, Credential_InitiatingIpAddress",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "credential_initiatinguserorapp",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeConsent, TimeCred, Consent_InitiatingUserOrApp, Credential_InitiatingUserOrApp, targetResourceName, targetResourceType, isAdminConsent, Consent_ServicePrincipalNames, Credential_ServicePrincipalNames, Consent_Permissions, Credential_KeyDescription, Consent_InitiatingIpAddress, Credential_InitiatingIpAddress",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "targetresourcename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeConsent, TimeCred, Consent_InitiatingUserOrApp, Credential_InitiatingUserOrApp, targetResourceName, targetResourceType, isAdminConsent, Consent_ServicePrincipalNames, Credential_ServicePrincipalNames, Consent_Permissions, Credential_KeyDescription, Consent_InitiatingIpAddress, Credential_InitiatingIpAddress",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "targetresourcetype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeConsent, TimeCred, Consent_InitiatingUserOrApp, Credential_InitiatingUserOrApp, targetResourceName, targetResourceType, isAdminConsent, Consent_ServicePrincipalNames, Credential_ServicePrincipalNames, Consent_Permissions, Credential_KeyDescription, Consent_InitiatingIpAddress, Credential_InitiatingIpAddress",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "isadminconsent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeConsent, TimeCred, Consent_InitiatingUserOrApp, Credential_InitiatingUserOrApp, targetResourceName, targetResourceType, isAdminConsent, Consent_ServicePrincipalNames, Credential_ServicePrincipalNames, Consent_Permissions, Credential_KeyDescription, Consent_InitiatingIpAddress, Credential_InitiatingIpAddress",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "consent_serviceprincipalnames",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeConsent, TimeCred, Consent_InitiatingUserOrApp, Credential_InitiatingUserOrApp, targetResourceName, targetResourceType, isAdminConsent, Consent_ServicePrincipalNames, Credential_ServicePrincipalNames, Consent_Permissions, Credential_KeyDescription, Consent_InitiatingIpAddress, Credential_InitiatingIpAddress",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "credential_serviceprincipalnames",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeConsent, TimeCred, Consent_InitiatingUserOrApp, Credential_InitiatingUserOrApp, targetResourceName, targetResourceType, isAdminConsent, Consent_ServicePrincipalNames, Credential_ServicePrincipalNames, Consent_Permissions, Credential_KeyDescription, Consent_InitiatingIpAddress, Credential_InitiatingIpAddress",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "consent_permissions",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeConsent, TimeCred, Consent_InitiatingUserOrApp, Credential_InitiatingUserOrApp, targetResourceName, targetResourceType, isAdminConsent, Consent_ServicePrincipalNames, Credential_ServicePrincipalNames, Consent_Permissions, Credential_KeyDescription, Consent_InitiatingIpAddress, Credential_InitiatingIpAddress",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "credential_keydescription",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeConsent, TimeCred, Consent_InitiatingUserOrApp, Credential_InitiatingUserOrApp, targetResourceName, targetResourceType, isAdminConsent, Consent_ServicePrincipalNames, Credential_ServicePrincipalNames, Consent_Permissions, Credential_KeyDescription, Consent_InitiatingIpAddress, Credential_InitiatingIpAddress",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "consent_initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeConsent, TimeCred, Consent_InitiatingUserOrApp, Credential_InitiatingUserOrApp, targetResourceName, targetResourceType, isAdminConsent, Consent_ServicePrincipalNames, Credential_ServicePrincipalNames, Consent_Permissions, Credential_KeyDescription, Consent_InitiatingIpAddress, Credential_InitiatingIpAddress",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "credential_initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeConsent, Name = tostring(split(Credential_InitiatingUserOrApp,'@',0)[0]), UPNSuffix = tostring(split(Credential_InitiatingUserOrApp,'@',1)[0])",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeConsent, Name = tostring(split(Credential_InitiatingUserOrApp,'@',0)[0]), UPNSuffix = tostring(split(Credential_InitiatingUserOrApp,'@',1)[0])",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeConsent, Name = tostring(split(Credential_InitiatingUserOrApp,'@',0)[0]), UPNSuffix = tostring(split(Credential_InitiatingUserOrApp,'@',1)[0])",
    "detection": "credentialaddedafteradminconsent.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UserPrincipalName = tolower(UserPrincipalName)",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AnomalyHour = TimeGenerated",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "anomalyhour",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project UserPrincipalName, AnomalyHour, TimeGenerated, DailyCount, baseline, anomalies, score;",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project UserPrincipalName, AnomalyHour, TimeGenerated, DailyCount, baseline, anomalies, score;",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "anomalyhour",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project UserPrincipalName, AnomalyHour, TimeGenerated, DailyCount, baseline, anomalies, score;",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project UserPrincipalName, AnomalyHour, TimeGenerated, DailyCount, baseline, anomalies, score;",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "dailycount",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project UserPrincipalName, AnomalyHour, TimeGenerated, DailyCount, baseline, anomalies, score;",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "baseline",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project UserPrincipalName, AnomalyHour, TimeGenerated, DailyCount, baseline, anomalies, score;",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "anomalies",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend DateHour = bin(TimeGenerated, 1h)",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "datehour",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize PartialFailedSignins = count(), LatestAnomalyTime = arg_max(TimeGenerated, *) by bin(TimeGenerated, 1h), OperationName, Category, ResultType, ResultDescription, UserPrincipalName, UserDisplayName, AppDisplayName, ClientAppUsed, IPAddress, ResourceDisplayName",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "partialfailedsignins",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize PartialFailedSignins = count(), LatestAnomalyTime = arg_max(TimeGenerated, *) by bin(TimeGenerated, 1h), OperationName, Category, ResultType, ResultDescription, UserPrincipalName, UserDisplayName, AppDisplayName, ClientAppUsed, IPAddress, ResourceDisplayName",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "latestanomalytime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize PartialFailedSignins = count(), LatestAnomalyTime = arg_max(TimeGenerated, *) by bin(TimeGenerated, 1h), OperationName, Category, ResultType, ResultDescription, UserPrincipalName, UserDisplayName, AppDisplayName, ClientAppUsed, IPAddress, ResourceDisplayName",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize PartialFailedSignins = count(), LatestAnomalyTime = arg_max(TimeGenerated, *) by bin(TimeGenerated, 1h), OperationName, Category, ResultType, ResultDescription, UserPrincipalName, UserDisplayName, AppDisplayName, ClientAppUsed, IPAddress, ResourceDisplayName",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "category",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize PartialFailedSignins = count(), LatestAnomalyTime = arg_max(TimeGenerated, *) by bin(TimeGenerated, 1h), OperationName, Category, ResultType, ResultDescription, UserPrincipalName, UserDisplayName, AppDisplayName, ClientAppUsed, IPAddress, ResourceDisplayName",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "resulttype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize PartialFailedSignins = count(), LatestAnomalyTime = arg_max(TimeGenerated, *) by bin(TimeGenerated, 1h), OperationName, Category, ResultType, ResultDescription, UserPrincipalName, UserDisplayName, AppDisplayName, ClientAppUsed, IPAddress, ResourceDisplayName",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "resultdescription",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize PartialFailedSignins = count(), LatestAnomalyTime = arg_max(TimeGenerated, *) by bin(TimeGenerated, 1h), OperationName, Category, ResultType, ResultDescription, UserPrincipalName, UserDisplayName, AppDisplayName, ClientAppUsed, IPAddress, ResourceDisplayName",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize PartialFailedSignins = count(), LatestAnomalyTime = arg_max(TimeGenerated, *) by bin(TimeGenerated, 1h), OperationName, Category, ResultType, ResultDescription, UserPrincipalName, UserDisplayName, AppDisplayName, ClientAppUsed, IPAddress, ResourceDisplayName",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "userdisplayname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize PartialFailedSignins = count(), LatestAnomalyTime = arg_max(TimeGenerated, *) by bin(TimeGenerated, 1h), OperationName, Category, ResultType, ResultDescription, UserPrincipalName, UserDisplayName, AppDisplayName, ClientAppUsed, IPAddress, ResourceDisplayName",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize PartialFailedSignins = count(), LatestAnomalyTime = arg_max(TimeGenerated, *) by bin(TimeGenerated, 1h), OperationName, Category, ResultType, ResultDescription, UserPrincipalName, UserDisplayName, AppDisplayName, ClientAppUsed, IPAddress, ResourceDisplayName",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "clientappused",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize PartialFailedSignins = count(), LatestAnomalyTime = arg_max(TimeGenerated, *) by bin(TimeGenerated, 1h), OperationName, Category, ResultType, ResultDescription, UserPrincipalName, UserDisplayName, AppDisplayName, ClientAppUsed, IPAddress, ResourceDisplayName",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize PartialFailedSignins = count(), LatestAnomalyTime = arg_max(TimeGenerated, *) by bin(TimeGenerated, 1h), OperationName, Category, ResultType, ResultDescription, UserPrincipalName, UserDisplayName, AppDisplayName, ClientAppUsed, IPAddress, ResourceDisplayName",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "resourcedisplayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = DailyCount, baseline, anomalies, score",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "latestanomalytime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = DailyCount, baseline, anomalies, score",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = DailyCount, baseline, anomalies, score",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "category",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = DailyCount, baseline, anomalies, score",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = DailyCount, baseline, anomalies, score",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "userdisplayname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = DailyCount, baseline, anomalies, score",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "resulttype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = DailyCount, baseline, anomalies, score",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "resultdescription",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = DailyCount, baseline, anomalies, score",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = DailyCount, baseline, anomalies, score",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "clientappused",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = DailyCount, baseline, anomalies, score",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = DailyCount, baseline, anomalies, score",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = DailyCount, baseline, anomalies, score",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "location",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = DailyCount, baseline, anomalies, score",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "authenticationrequirement",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = DailyCount, baseline, anomalies, score",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "conditionalaccessstatus",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = DailyCount, baseline, anomalies, score",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "resourcedisplayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = DailyCount, baseline, anomalies, score",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "partialfailedsignins",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = DailyCount, baseline, anomalies, score",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "totalfailedsignins",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = DailyCount, baseline, anomalies, score",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "baseline",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = DailyCount, baseline, anomalies, score",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "anomalies",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = DailyCount, baseline, anomalies, score",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "score",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = LatestAnomalyTime, Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = LatestAnomalyTime, Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = LatestAnomalyTime, Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserPrincipalName = tolower(UserPrincipalName)",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize LatestReportTime = arg_max(TimeGenerated, *) by AccountUPN",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "latestreporttime",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize LatestReportTime = arg_max(TimeGenerated, *) by AccountUPN",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "accountupn",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project AccountUPN, Tags, JobTitle, GroupMembership, AssignedRoles, UserType, IsAccountEnabled",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "accountupn",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project AccountUPN, Tags, JobTitle, GroupMembership, AssignedRoles, UserType, IsAccountEnabled",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "tags",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project AccountUPN, Tags, JobTitle, GroupMembership, AssignedRoles, UserType, IsAccountEnabled",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "jobtitle",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project AccountUPN, Tags, JobTitle, GroupMembership, AssignedRoles, UserType, IsAccountEnabled",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "groupmembership",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project AccountUPN, Tags, JobTitle, GroupMembership, AssignedRoles, UserType, IsAccountEnabled",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "assignedroles",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project AccountUPN, Tags, JobTitle, GroupMembership, AssignedRoles, UserType, IsAccountEnabled",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "usertype",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project AccountUPN, Tags, JobTitle, GroupMembership, AssignedRoles, UserType, IsAccountEnabled",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "isaccountenabled",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend UserPrincipalName=tolower(AccountUPN)",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project UsersInsights, DevicesInsights, ActivityInsights, InvestigationPriority, SourceIPAddress",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "usersinsights",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project UsersInsights, DevicesInsights, ActivityInsights, InvestigationPriority, SourceIPAddress",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "devicesinsights",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project UsersInsights, DevicesInsights, ActivityInsights, InvestigationPriority, SourceIPAddress",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "activityinsights",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project UsersInsights, DevicesInsights, ActivityInsights, InvestigationPriority, SourceIPAddress",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "investigationpriority",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project UsersInsights, DevicesInsights, ActivityInsights, InvestigationPriority, SourceIPAddress",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend UEBARiskScore = IPInvestigationPriority",
    "detection": "useraccounts-cablockedsigninspikes.yaml",
    "field": "uebariskscore",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend TargetUserPrincipalName = tostring(TargetResource.userPrincipalName),",
    "detection": "useraddedtoprivilgedgroups.yaml",
    "field": "targetuserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "      | extend DisplayName = trim('\"',tostring(Property.displayName)),",
    "detection": "useraddedtoprivilgedgroups.yaml",
    "field": "displayname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AppId = InitiatedBy.app.appId,",
    "detection": "useraddedtoprivilgedgroups.yaml",
    "field": "appid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, AADOperationType, Category, OperationName, AADTenantId, AppId, InitiatedByDisplayName, ServicePrincipalId, ServicePrincipalName, DisplayName, GroupName, UserId, UserIPAddress, UserRoles, UserPrincipalName, TargetUserPrincipalName",
    "detection": "useraddedtoprivilgedgroups.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, AADOperationType, Category, OperationName, AADTenantId, AppId, InitiatedByDisplayName, ServicePrincipalId, ServicePrincipalName, DisplayName, GroupName, UserId, UserIPAddress, UserRoles, UserPrincipalName, TargetUserPrincipalName",
    "detection": "useraddedtoprivilgedgroups.yaml",
    "field": "aadoperationtype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, AADOperationType, Category, OperationName, AADTenantId, AppId, InitiatedByDisplayName, ServicePrincipalId, ServicePrincipalName, DisplayName, GroupName, UserId, UserIPAddress, UserRoles, UserPrincipalName, TargetUserPrincipalName",
    "detection": "useraddedtoprivilgedgroups.yaml",
    "field": "category",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, AADOperationType, Category, OperationName, AADTenantId, AppId, InitiatedByDisplayName, ServicePrincipalId, ServicePrincipalName, DisplayName, GroupName, UserId, UserIPAddress, UserRoles, UserPrincipalName, TargetUserPrincipalName",
    "detection": "useraddedtoprivilgedgroups.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, AADOperationType, Category, OperationName, AADTenantId, AppId, InitiatedByDisplayName, ServicePrincipalId, ServicePrincipalName, DisplayName, GroupName, UserId, UserIPAddress, UserRoles, UserPrincipalName, TargetUserPrincipalName",
    "detection": "useraddedtoprivilgedgroups.yaml",
    "field": "aadtenantid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, AADOperationType, Category, OperationName, AADTenantId, AppId, InitiatedByDisplayName, ServicePrincipalId, ServicePrincipalName, DisplayName, GroupName, UserId, UserIPAddress, UserRoles, UserPrincipalName, TargetUserPrincipalName",
    "detection": "useraddedtoprivilgedgroups.yaml",
    "field": "appid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, AADOperationType, Category, OperationName, AADTenantId, AppId, InitiatedByDisplayName, ServicePrincipalId, ServicePrincipalName, DisplayName, GroupName, UserId, UserIPAddress, UserRoles, UserPrincipalName, TargetUserPrincipalName",
    "detection": "useraddedtoprivilgedgroups.yaml",
    "field": "initiatedbydisplayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, AADOperationType, Category, OperationName, AADTenantId, AppId, InitiatedByDisplayName, ServicePrincipalId, ServicePrincipalName, DisplayName, GroupName, UserId, UserIPAddress, UserRoles, UserPrincipalName, TargetUserPrincipalName",
    "detection": "useraddedtoprivilgedgroups.yaml",
    "field": "serviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, AADOperationType, Category, OperationName, AADTenantId, AppId, InitiatedByDisplayName, ServicePrincipalId, ServicePrincipalName, DisplayName, GroupName, UserId, UserIPAddress, UserRoles, UserPrincipalName, TargetUserPrincipalName",
    "detection": "useraddedtoprivilgedgroups.yaml",
    "field": "serviceprincipalname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, AADOperationType, Category, OperationName, AADTenantId, AppId, InitiatedByDisplayName, ServicePrincipalId, ServicePrincipalName, DisplayName, GroupName, UserId, UserIPAddress, UserRoles, UserPrincipalName, TargetUserPrincipalName",
    "detection": "useraddedtoprivilgedgroups.yaml",
    "field": "displayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, AADOperationType, Category, OperationName, AADTenantId, AppId, InitiatedByDisplayName, ServicePrincipalId, ServicePrincipalName, DisplayName, GroupName, UserId, UserIPAddress, UserRoles, UserPrincipalName, TargetUserPrincipalName",
    "detection": "useraddedtoprivilgedgroups.yaml",
    "field": "groupname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, AADOperationType, Category, OperationName, AADTenantId, AppId, InitiatedByDisplayName, ServicePrincipalId, ServicePrincipalName, DisplayName, GroupName, UserId, UserIPAddress, UserRoles, UserPrincipalName, TargetUserPrincipalName",
    "detection": "useraddedtoprivilgedgroups.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, AADOperationType, Category, OperationName, AADTenantId, AppId, InitiatedByDisplayName, ServicePrincipalId, ServicePrincipalName, DisplayName, GroupName, UserId, UserIPAddress, UserRoles, UserPrincipalName, TargetUserPrincipalName",
    "detection": "useraddedtoprivilgedgroups.yaml",
    "field": "useripaddress",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, AADOperationType, Category, OperationName, AADTenantId, AppId, InitiatedByDisplayName, ServicePrincipalId, ServicePrincipalName, DisplayName, GroupName, UserId, UserIPAddress, UserRoles, UserPrincipalName, TargetUserPrincipalName",
    "detection": "useraddedtoprivilgedgroups.yaml",
    "field": "userroles",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, AADOperationType, Category, OperationName, AADTenantId, AppId, InitiatedByDisplayName, ServicePrincipalId, ServicePrincipalName, DisplayName, GroupName, UserId, UserIPAddress, UserRoles, UserPrincipalName, TargetUserPrincipalName",
    "detection": "useraddedtoprivilgedgroups.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, AADOperationType, Category, OperationName, AADTenantId, AppId, InitiatedByDisplayName, ServicePrincipalId, ServicePrincipalName, DisplayName, GroupName, UserId, UserIPAddress, UserRoles, UserPrincipalName, TargetUserPrincipalName",
    "detection": "useraddedtoprivilgedgroups.yaml",
    "field": "targetuserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountCustomEntity = case(isnotempty(ServicePrincipalName), ServicePrincipalName,",
    "detection": "useraddedtoprivilgedgroups.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(AccountCustomEntity,'@',0)[0]), AccountUPNSuffix = tostring(split(AccountCustomEntity,'@',1)[0])",
    "detection": "useraddedtoprivilgedgroups.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(AccountCustomEntity,'@',0)[0]), AccountUPNSuffix = tostring(split(AccountCustomEntity,'@',1)[0])",
    "detection": "useraddedtoprivilgedgroups.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetName = tostring(split(TargetUserPrincipalName,'@',0)[0]), TargetUPNSuffix = tostring(split(TargetUserPrincipalName,'@',1)[0])",
    "detection": "useraddedtoprivilgedgroups.yaml",
    "field": "targetname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetName = tostring(split(TargetUserPrincipalName,'@',0)[0]), TargetUPNSuffix = tostring(split(TargetUserPrincipalName,'@',1)[0])",
    "detection": "useraddedtoprivilgedgroups.yaml",
    "field": "targetupnsuffix",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize arg_max(TimeGenerated, *) by AccountUPN",
    "detection": "privilegedaccountpermissionschanged.yaml",
    "field": "accountupn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetUserPrincipalName = tostring(TargetResources[0].userPrincipalName)",
    "detection": "privilegedaccountpermissionschanged.yaml",
    "field": "targetuserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetAadUserId = tostring(TargetResources[0].id)",
    "detection": "privilegedaccountpermissionschanged.yaml",
    "field": "targetaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Group = tostring(TargetResources[0].displayName)",
    "detection": "privilegedaccountpermissionschanged.yaml",
    "field": "group",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend RoleAddedTo = iif(isnotempty(TargetUserPrincipalName), TargetUserPrincipalName, Group)",
    "detection": "privilegedaccountpermissionschanged.yaml",
    "field": "roleaddedto",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend mod_props = TargetResources[0].modifiedProperties",
    "detection": "privilegedaccountpermissionschanged.yaml",
    "field": "mod_props",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "privilegedaccountpermissionschanged.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "privilegedaccountpermissionschanged.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "privilegedaccountpermissionschanged.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "privilegedaccountpermissionschanged.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingIPAddress = tostring(InitiatedBy.user.ipAddress)",
    "detection": "privilegedaccountpermissionschanged.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend RoleAddedBy = iif(isnotempty(InitiatingAppName), InitiatingAppName, InitiatingUserPrincipalName)",
    "detection": "privilegedaccountpermissionschanged.yaml",
    "field": "roleaddedby",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UserAgent = tostring(AdditionalDetails[0].value)",
    "detection": "privilegedaccountpermissionschanged.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend RoleAdded = tostring(parse_json(tostring(mod_props.newValue)))",
    "detection": "privilegedaccountpermissionschanged.yaml",
    "field": "roleadded",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetAccountName = tostring(split(TargetUserPrincipalName, \"@\")[0]), TargetAccountUPNSuffix = tostring(split(TargetUserPrincipalName, \"@\")[1])",
    "detection": "privilegedaccountpermissionschanged.yaml",
    "field": "targetaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetAccountName = tostring(split(TargetUserPrincipalName, \"@\")[0]), TargetAccountUPNSuffix = tostring(split(TargetUserPrincipalName, \"@\")[1])",
    "detection": "privilegedaccountpermissionschanged.yaml",
    "field": "targetaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "privilegedaccountpermissionschanged.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "privilegedaccountpermissionschanged.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "      | extend props = TargetResource.modifiedProperties",
    "detection": "azureadrolemanagementpermissiongrant.yaml",
    "field": "props",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend DisplayName = tostring(Property.displayName), PermissionGrant = trim('\"',tostring(Property.newValue))",
    "detection": "azureadrolemanagementpermissiongrant.yaml",
    "field": "displayname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend DisplayName = tostring(Property.displayName), PermissionGrant = trim('\"',tostring(Property.newValue))",
    "detection": "azureadrolemanagementpermissiongrant.yaml",
    "field": "permissiongrant",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend TargetAppDisplayName = trim('\"',tostring(Property.newValue))",
    "detection": "azureadrolemanagementpermissiongrant.yaml",
    "field": "targetappdisplayname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend TargetAppServicePrincipalId = trim('\"',tostring(Property.newValue))",
    "detection": "azureadrolemanagementpermissiongrant.yaml",
    "field": "targetappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "azureadrolemanagementpermissiongrant.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "azureadrolemanagementpermissiongrant.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "azureadrolemanagementpermissiongrant.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "azureadrolemanagementpermissiongrant.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingIpAddress = tostring(iff(isnotempty(InitiatedBy.user.ipAddress), InitiatedBy.user.ipAddress, InitiatedBy.app.ipAddress))",
    "detection": "azureadrolemanagementpermissiongrant.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationName, Result, PermissionGrant, TargetAppDisplayName, TargetAppServicePrincipalId, InitiatingAppName, InitiatingAppServicePrincipalId,",
    "detection": "azureadrolemanagementpermissiongrant.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationName, Result, PermissionGrant, TargetAppDisplayName, TargetAppServicePrincipalId, InitiatingAppName, InitiatingAppServicePrincipalId,",
    "detection": "azureadrolemanagementpermissiongrant.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationName, Result, PermissionGrant, TargetAppDisplayName, TargetAppServicePrincipalId, InitiatingAppName, InitiatingAppServicePrincipalId,",
    "detection": "azureadrolemanagementpermissiongrant.yaml",
    "field": "result",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationName, Result, PermissionGrant, TargetAppDisplayName, TargetAppServicePrincipalId, InitiatingAppName, InitiatingAppServicePrincipalId,",
    "detection": "azureadrolemanagementpermissiongrant.yaml",
    "field": "permissiongrant",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationName, Result, PermissionGrant, TargetAppDisplayName, TargetAppServicePrincipalId, InitiatingAppName, InitiatingAppServicePrincipalId,",
    "detection": "azureadrolemanagementpermissiongrant.yaml",
    "field": "targetappdisplayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationName, Result, PermissionGrant, TargetAppDisplayName, TargetAppServicePrincipalId, InitiatingAppName, InitiatingAppServicePrincipalId,",
    "detection": "azureadrolemanagementpermissiongrant.yaml",
    "field": "targetappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationName, Result, PermissionGrant, TargetAppDisplayName, TargetAppServicePrincipalId, InitiatingAppName, InitiatingAppServicePrincipalId,",
    "detection": "azureadrolemanagementpermissiongrant.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationName, Result, PermissionGrant, TargetAppDisplayName, TargetAppServicePrincipalId, InitiatingAppName, InitiatingAppServicePrincipalId,",
    "detection": "azureadrolemanagementpermissiongrant.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "azureadrolemanagementpermissiongrant.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "azureadrolemanagementpermissiongrant.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend IngestionTime = ingestion_time()",
    "detection": "adfssigninlogspasswordspray.yaml",
    "field": "ingestiontime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, OperationName, IPAddress, DistinctFailureCount, DistinctSuccessCount, SuccessAccounts, AuthenticationRequirement, ConditionalAccessStatus, IsInteractive, UserAgent, NetworkLocationDetails, DeviceDetail, TokenIssuerType, TokenIssuerName, ResourceIdentity",
    "detection": "adfssigninlogspasswordspray.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, OperationName, IPAddress, DistinctFailureCount, DistinctSuccessCount, SuccessAccounts, AuthenticationRequirement, ConditionalAccessStatus, IsInteractive, UserAgent, NetworkLocationDetails, DeviceDetail, TokenIssuerType, TokenIssuerName, ResourceIdentity",
    "detection": "adfssigninlogspasswordspray.yaml",
    "field": "category",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, OperationName, IPAddress, DistinctFailureCount, DistinctSuccessCount, SuccessAccounts, AuthenticationRequirement, ConditionalAccessStatus, IsInteractive, UserAgent, NetworkLocationDetails, DeviceDetail, TokenIssuerType, TokenIssuerName, ResourceIdentity",
    "detection": "adfssigninlogspasswordspray.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, OperationName, IPAddress, DistinctFailureCount, DistinctSuccessCount, SuccessAccounts, AuthenticationRequirement, ConditionalAccessStatus, IsInteractive, UserAgent, NetworkLocationDetails, DeviceDetail, TokenIssuerType, TokenIssuerName, ResourceIdentity",
    "detection": "adfssigninlogspasswordspray.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, OperationName, IPAddress, DistinctFailureCount, DistinctSuccessCount, SuccessAccounts, AuthenticationRequirement, ConditionalAccessStatus, IsInteractive, UserAgent, NetworkLocationDetails, DeviceDetail, TokenIssuerType, TokenIssuerName, ResourceIdentity",
    "detection": "adfssigninlogspasswordspray.yaml",
    "field": "distinctfailurecount",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, OperationName, IPAddress, DistinctFailureCount, DistinctSuccessCount, SuccessAccounts, AuthenticationRequirement, ConditionalAccessStatus, IsInteractive, UserAgent, NetworkLocationDetails, DeviceDetail, TokenIssuerType, TokenIssuerName, ResourceIdentity",
    "detection": "adfssigninlogspasswordspray.yaml",
    "field": "distinctsuccesscount",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, OperationName, IPAddress, DistinctFailureCount, DistinctSuccessCount, SuccessAccounts, AuthenticationRequirement, ConditionalAccessStatus, IsInteractive, UserAgent, NetworkLocationDetails, DeviceDetail, TokenIssuerType, TokenIssuerName, ResourceIdentity",
    "detection": "adfssigninlogspasswordspray.yaml",
    "field": "successaccounts",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, OperationName, IPAddress, DistinctFailureCount, DistinctSuccessCount, SuccessAccounts, AuthenticationRequirement, ConditionalAccessStatus, IsInteractive, UserAgent, NetworkLocationDetails, DeviceDetail, TokenIssuerType, TokenIssuerName, ResourceIdentity",
    "detection": "adfssigninlogspasswordspray.yaml",
    "field": "authenticationrequirement",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, OperationName, IPAddress, DistinctFailureCount, DistinctSuccessCount, SuccessAccounts, AuthenticationRequirement, ConditionalAccessStatus, IsInteractive, UserAgent, NetworkLocationDetails, DeviceDetail, TokenIssuerType, TokenIssuerName, ResourceIdentity",
    "detection": "adfssigninlogspasswordspray.yaml",
    "field": "conditionalaccessstatus",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, OperationName, IPAddress, DistinctFailureCount, DistinctSuccessCount, SuccessAccounts, AuthenticationRequirement, ConditionalAccessStatus, IsInteractive, UserAgent, NetworkLocationDetails, DeviceDetail, TokenIssuerType, TokenIssuerName, ResourceIdentity",
    "detection": "adfssigninlogspasswordspray.yaml",
    "field": "isinteractive",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, OperationName, IPAddress, DistinctFailureCount, DistinctSuccessCount, SuccessAccounts, AuthenticationRequirement, ConditionalAccessStatus, IsInteractive, UserAgent, NetworkLocationDetails, DeviceDetail, TokenIssuerType, TokenIssuerName, ResourceIdentity",
    "detection": "adfssigninlogspasswordspray.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, OperationName, IPAddress, DistinctFailureCount, DistinctSuccessCount, SuccessAccounts, AuthenticationRequirement, ConditionalAccessStatus, IsInteractive, UserAgent, NetworkLocationDetails, DeviceDetail, TokenIssuerType, TokenIssuerName, ResourceIdentity",
    "detection": "adfssigninlogspasswordspray.yaml",
    "field": "networklocationdetails",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, OperationName, IPAddress, DistinctFailureCount, DistinctSuccessCount, SuccessAccounts, AuthenticationRequirement, ConditionalAccessStatus, IsInteractive, UserAgent, NetworkLocationDetails, DeviceDetail, TokenIssuerType, TokenIssuerName, ResourceIdentity",
    "detection": "adfssigninlogspasswordspray.yaml",
    "field": "devicedetail",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, OperationName, IPAddress, DistinctFailureCount, DistinctSuccessCount, SuccessAccounts, AuthenticationRequirement, ConditionalAccessStatus, IsInteractive, UserAgent, NetworkLocationDetails, DeviceDetail, TokenIssuerType, TokenIssuerName, ResourceIdentity",
    "detection": "adfssigninlogspasswordspray.yaml",
    "field": "tokenissuertype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, OperationName, IPAddress, DistinctFailureCount, DistinctSuccessCount, SuccessAccounts, AuthenticationRequirement, ConditionalAccessStatus, IsInteractive, UserAgent, NetworkLocationDetails, DeviceDetail, TokenIssuerType, TokenIssuerName, ResourceIdentity",
    "detection": "adfssigninlogspasswordspray.yaml",
    "field": "tokenissuername",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, OperationName, IPAddress, DistinctFailureCount, DistinctSuccessCount, SuccessAccounts, AuthenticationRequirement, ConditionalAccessStatus, IsInteractive, UserAgent, NetworkLocationDetails, DeviceDetail, TokenIssuerType, TokenIssuerName, ResourceIdentity",
    "detection": "adfssigninlogspasswordspray.yaml",
    "field": "resourceidentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SuccessIPv6Block = strcat(split(IPAddress, \":\")[0], \":\", split(IPAddress, \":\")[1], \":\", split(IPAddress, \":\")[2], \":\", split(IPAddress, \":\")[3])",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "successipv6block",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend SuccessIPv4Block = strcat(split(IPAddress, \".\")[0], \".\", split(IPAddress, \".\")[1])",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "successipv4block",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project SuccessLogonTime = TimeGenerated, UserPrincipalName, SuccessIPAddress = IPAddress, SuccessLocation = Location, AppDisplayName, SuccessIPBlock = iff(IPAddress contains \":\", strcat(split(IPAddress, \":\")[0], \":\", split(IPAddress, \":\")[1]), strcat(split(IPAddress, \".\")[0], \".\", split(IPAddress, \".\")[1])), Type",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "successlogontime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SuccessLogonTime = TimeGenerated, UserPrincipalName, SuccessIPAddress = IPAddress, SuccessLocation = Location, AppDisplayName, SuccessIPBlock = iff(IPAddress contains \":\", strcat(split(IPAddress, \":\")[0], \":\", split(IPAddress, \":\")[1]), strcat(split(IPAddress, \".\")[0], \".\", split(IPAddress, \".\")[1])), Type",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project SuccessLogonTime = TimeGenerated, UserPrincipalName, SuccessIPAddress = IPAddress, SuccessLocation = Location, AppDisplayName, SuccessIPBlock = iff(IPAddress contains \":\", strcat(split(IPAddress, \":\")[0], \":\", split(IPAddress, \":\")[1]), strcat(split(IPAddress, \".\")[0], \".\", split(IPAddress, \".\")[1])), Type",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "successipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project SuccessLogonTime = TimeGenerated, UserPrincipalName, SuccessIPAddress = IPAddress, SuccessLocation = Location, AppDisplayName, SuccessIPBlock = iff(IPAddress contains \":\", strcat(split(IPAddress, \":\")[0], \":\", split(IPAddress, \":\")[1]), strcat(split(IPAddress, \".\")[0], \".\", split(IPAddress, \".\")[1])), Type",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "successlocation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SuccessLogonTime = TimeGenerated, UserPrincipalName, SuccessIPAddress = IPAddress, SuccessLocation = Location, AppDisplayName, SuccessIPBlock = iff(IPAddress contains \":\", strcat(split(IPAddress, \":\")[0], \":\", split(IPAddress, \":\")[1]), strcat(split(IPAddress, \".\")[0], \".\", split(IPAddress, \".\")[1])), Type",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SuccessLogonTime = TimeGenerated, UserPrincipalName, SuccessIPAddress = IPAddress, SuccessLocation = Location, AppDisplayName, SuccessIPBlock = iff(IPAddress contains \":\", strcat(split(IPAddress, \":\")[0], \":\", split(IPAddress, \":\")[1]), strcat(split(IPAddress, \".\")[0], \".\", split(IPAddress, \".\")[1])), Type",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "successipblock",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SuccessLogonTime = TimeGenerated, UserPrincipalName, SuccessIPAddress = IPAddress, SuccessLocation = Location, AppDisplayName, SuccessIPBlock = iff(IPAddress contains \":\", strcat(split(IPAddress, \":\")[0], \":\", split(IPAddress, \":\")[1]), strcat(split(IPAddress, \".\")[0], \".\", split(IPAddress, \".\")[1])), Type",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project FailedLogonTime = TimeGenerated, UserPrincipalName, FailedIPAddress = IPAddress, FailedLocation = Location, AppDisplayName, ResultType, ResultDescription, Type",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "failedlogontime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project FailedLogonTime = TimeGenerated, UserPrincipalName, FailedIPAddress = IPAddress, FailedLocation = Location, AppDisplayName, ResultType, ResultDescription, Type",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project FailedLogonTime = TimeGenerated, UserPrincipalName, FailedIPAddress = IPAddress, FailedLocation = Location, AppDisplayName, ResultType, ResultDescription, Type",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "failedipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "    | project FailedLogonTime = TimeGenerated, UserPrincipalName, FailedIPAddress = IPAddress, FailedLocation = Location, AppDisplayName, ResultType, ResultDescription, Type",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "failedlocation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project FailedLogonTime = TimeGenerated, UserPrincipalName, FailedIPAddress = IPAddress, FailedLocation = Location, AppDisplayName, ResultType, ResultDescription, Type",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project FailedLogonTime = TimeGenerated, UserPrincipalName, FailedIPAddress = IPAddress, FailedLocation = Location, AppDisplayName, ResultType, ResultDescription, Type",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "resulttype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project FailedLogonTime = TimeGenerated, UserPrincipalName, FailedIPAddress = IPAddress, FailedLocation = Location, AppDisplayName, ResultType, ResultDescription, Type",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "resultdescription",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project FailedLogonTime = TimeGenerated, UserPrincipalName, FailedIPAddress = IPAddress, FailedLocation = Location, AppDisplayName, ResultType, ResultDescription, Type",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailedLogonTime = max(FailedLogonTime), SuccessLogonTime = max(SuccessLogonTime) by UserPrincipalName, SuccessIPAddress, SuccessLocation, AppDisplayName, FailedIPAddress, FailedLocation, ResultType, ResultDescription, Type",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "failedlogontime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailedLogonTime = max(FailedLogonTime), SuccessLogonTime = max(SuccessLogonTime) by UserPrincipalName, SuccessIPAddress, SuccessLocation, AppDisplayName, FailedIPAddress, FailedLocation, ResultType, ResultDescription, Type",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "successlogontime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailedLogonTime = max(FailedLogonTime), SuccessLogonTime = max(SuccessLogonTime) by UserPrincipalName, SuccessIPAddress, SuccessLocation, AppDisplayName, FailedIPAddress, FailedLocation, ResultType, ResultDescription, Type",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailedLogonTime = max(FailedLogonTime), SuccessLogonTime = max(SuccessLogonTime) by UserPrincipalName, SuccessIPAddress, SuccessLocation, AppDisplayName, FailedIPAddress, FailedLocation, ResultType, ResultDescription, Type",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "successipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailedLogonTime = max(FailedLogonTime), SuccessLogonTime = max(SuccessLogonTime) by UserPrincipalName, SuccessIPAddress, SuccessLocation, AppDisplayName, FailedIPAddress, FailedLocation, ResultType, ResultDescription, Type",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "successlocation",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailedLogonTime = max(FailedLogonTime), SuccessLogonTime = max(SuccessLogonTime) by UserPrincipalName, SuccessIPAddress, SuccessLocation, AppDisplayName, FailedIPAddress, FailedLocation, ResultType, ResultDescription, Type",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailedLogonTime = max(FailedLogonTime), SuccessLogonTime = max(SuccessLogonTime) by UserPrincipalName, SuccessIPAddress, SuccessLocation, AppDisplayName, FailedIPAddress, FailedLocation, ResultType, ResultDescription, Type",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "failedipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailedLogonTime = max(FailedLogonTime), SuccessLogonTime = max(SuccessLogonTime) by UserPrincipalName, SuccessIPAddress, SuccessLocation, AppDisplayName, FailedIPAddress, FailedLocation, ResultType, ResultDescription, Type",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "failedlocation",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailedLogonTime = max(FailedLogonTime), SuccessLogonTime = max(SuccessLogonTime) by UserPrincipalName, SuccessIPAddress, SuccessLocation, AppDisplayName, FailedIPAddress, FailedLocation, ResultType, ResultDescription, Type",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "resulttype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailedLogonTime = max(FailedLogonTime), SuccessLogonTime = max(SuccessLogonTime) by UserPrincipalName, SuccessIPAddress, SuccessLocation, AppDisplayName, FailedIPAddress, FailedLocation, ResultType, ResultDescription, Type",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "resultdescription",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailedLogonTime = max(FailedLogonTime), SuccessLogonTime = max(SuccessLogonTime) by UserPrincipalName, SuccessIPAddress, SuccessLocation, AppDisplayName, FailedIPAddress, FailedLocation, ResultType, ResultDescription, Type",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = SuccessLogonTime",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserPrincipalName = tolower(UserPrincipalName)};",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize LatestReportTime = arg_max(TimeGenerated, *) by AccountUPN",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "latestreporttime",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize LatestReportTime = arg_max(TimeGenerated, *) by AccountUPN",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "accountupn",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project AccountUPN, Tags, JobTitle, GroupMembership, AssignedRoles, UserType, IsAccountEnabled",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "accountupn",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project AccountUPN, Tags, JobTitle, GroupMembership, AssignedRoles, UserType, IsAccountEnabled",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "tags",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project AccountUPN, Tags, JobTitle, GroupMembership, AssignedRoles, UserType, IsAccountEnabled",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "jobtitle",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project AccountUPN, Tags, JobTitle, GroupMembership, AssignedRoles, UserType, IsAccountEnabled",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "groupmembership",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project AccountUPN, Tags, JobTitle, GroupMembership, AssignedRoles, UserType, IsAccountEnabled",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "assignedroles",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project AccountUPN, Tags, JobTitle, GroupMembership, AssignedRoles, UserType, IsAccountEnabled",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "usertype",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project AccountUPN, Tags, JobTitle, GroupMembership, AssignedRoles, UserType, IsAccountEnabled",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "isaccountenabled",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend UserPrincipalName=tolower(AccountUPN)",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project UsersInsights, DevicesInsights, ActivityInsights, InvestigationPriority, SourceIPAddress, UserName",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "usersinsights",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project UsersInsights, DevicesInsights, ActivityInsights, InvestigationPriority, SourceIPAddress, UserName",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "devicesinsights",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project UsersInsights, DevicesInsights, ActivityInsights, InvestigationPriority, SourceIPAddress, UserName",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "activityinsights",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project UsersInsights, DevicesInsights, ActivityInsights, InvestigationPriority, SourceIPAddress, UserName",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "investigationpriority",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project UsersInsights, DevicesInsights, ActivityInsights, InvestigationPriority, SourceIPAddress, UserName",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "    | project UsersInsights, DevicesInsights, ActivityInsights, InvestigationPriority, SourceIPAddress, UserName",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UEBARiskScore = MaxInvestigationScore",
    "detection": "successthenfail-diffip-sameuserandapp.yaml",
    "field": "uebariskscore",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend LocationDetail = strcat(Location, \"-\", LocationDetails.state)",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "locationdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend LocationParsed = parse_json(LocationDetails), DeviceParsed = parse_json(DeviceDetail)",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "locationparsed",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend LocationParsed = parse_json(LocationDetails), DeviceParsed = parse_json(DeviceDetail)",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "deviceparsed",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend City = tostring(LocationParsed.city), State = tostring(LocationParsed.state)",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "city",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend City = tostring(LocationParsed.city), State = tostring(LocationParsed.state)",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "state",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend LocationDetail = strcat(Location, \"-\", State)",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "locationdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceId = tostring(DeviceParsed.deviceId), DeviceName=tostring(DeviceParsed.displayName), OS=tostring(DeviceParsed.operatingSystem), Browser=tostring(DeviceParsed.browser)",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceId = tostring(DeviceParsed.deviceId), DeviceName=tostring(DeviceParsed.displayName), OS=tostring(DeviceParsed.operatingSystem), Browser=tostring(DeviceParsed.browser)",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceId = tostring(DeviceParsed.deviceId), DeviceName=tostring(DeviceParsed.displayName), OS=tostring(DeviceParsed.operatingSystem), Browser=tostring(DeviceParsed.browser)",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "os",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceId = tostring(DeviceParsed.deviceId), DeviceName=tostring(DeviceParsed.displayName), OS=tostring(DeviceParsed.operatingSystem), Browser=tostring(DeviceParsed.browser)",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "browser",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "userdisplayname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "location",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "state",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "city",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "resulttype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "resultdescription",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "appid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "authenticationrequirement",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "conditionalaccessstatus",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "resourcedisplayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "clientappused",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "identity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "hometenantid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "resourcetenantid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "status",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "os",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "browser",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Type, UserId, UserDisplayName, UserPrincipalName, IPAddress, Location, State, City, ResultType, ResultDescription, AppId, AppDisplayName, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, ClientAppUsed, Identity, HomeTenantId, ResourceTenantId, Status, UserAgent, DeviceId, DeviceName, OS, Browser, MfaDetail",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "mfadetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "anomoloussinglefactorsignin.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UpdatingAppName = tostring(parse_json(tostring(InitiatedBy.app)).displayName)",
    "detection": "userstatechangedfromguesttomember.yaml",
    "field": "updatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UpdatingServicePrincipalId = tostring(parse_json(tostring(InitiatedBy.app)).servicePrincipalId)",
    "detection": "userstatechangedfromguesttomember.yaml",
    "field": "updatingserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UpdatingUserPrincipalName = tostring(parse_json(tostring(InitiatedBy.user)).userPrincipalName)",
    "detection": "userstatechangedfromguesttomember.yaml",
    "field": "updatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UpdatingUserAadUserId = tostring(parse_json(tostring(InitiatedBy.user)).id)",
    "detection": "userstatechangedfromguesttomember.yaml",
    "field": "updatinguseraaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UpdatingUserIPAddress = tostring(parse_json(tostring(InitiatedBy.user)).ipAddress)",
    "detection": "userstatechangedfromguesttomember.yaml",
    "field": "updatinguseripaddress",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UpdatingUser = iif(isnotempty(UpdatingServicePrincipalId), UpdatingServicePrincipalId, UpdatingUserPrincipalName)",
    "detection": "userstatechangedfromguesttomember.yaml",
    "field": "updatinguser",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UpdatedUserPrincipalName = tostring(TargetResources.userPrincipalName)",
    "detection": "userstatechangedfromguesttomember.yaml",
    "field": "updateduserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(UpdatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(UpdatingUserPrincipalName, \"@\")[1])",
    "detection": "userstatechangedfromguesttomember.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAccountName = tostring(split(UpdatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(UpdatingUserPrincipalName, \"@\")[1])",
    "detection": "userstatechangedfromguesttomember.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetAccountName = tostring(split(UpdatedUserPrincipalName, \"@\")[0]), TargetAccountUPNSuffix = tostring(split(UpdatedUserPrincipalName, \"@\")[1])",
    "detection": "userstatechangedfromguesttomember.yaml",
    "field": "targetaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetAccountName = tostring(split(UpdatedUserPrincipalName, \"@\")[0]), TargetAccountUPNSuffix = tostring(split(UpdatedUserPrincipalName, \"@\")[1])",
    "detection": "userstatechangedfromguesttomember.yaml",
    "field": "targetaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "      | extend AppDisplayName = tostring(TargetResource.displayName),",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend GrantInitiatedByAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantinitiatedbyappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend GrantInitiatedByAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantinitiatedbyappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend GrantInitiatedByUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantinitiatedbyuserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend GrantInitiatedByAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantinitiatedbyaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend GrantIpAddress = iff(isnotempty(InitiatedBy.user.ipAddress), tostring(InitiatedBy.user.ipAddress), tostring(InitiatedBy.app.ipAddress))",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend GrantInitiatedBy = iff(isnotempty(GrantInitiatedByUserPrincipalName), GrantInitiatedByUserPrincipalName, GrantInitiatedByAppName)",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantinitiatedby",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend GrantUserAgent = AdditionalDetail.value",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantuseragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantconsenttype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantscope1",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantinitiatedby",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantinitiatedbyuserprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantinitiatedbyaaduserid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantinitiatedbyappname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantinitiatedbyappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantuseragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "appclientid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "consentfull",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "          | extend props = TargetResource.modifiedProperties,",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "props",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "          | extend AppReplyURLs = trim('\"',tostring(Property.newValue))",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "appreplyurls",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "              | extend GrantAuthentication = tostring(TargetResource.displayName)",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantauthentication",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend GrantOperation = OperationName",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantoperation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project GrantAuthentication, GrantOperation, CorrelationId",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantauthentication",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project GrantAuthentication, GrantOperation, CorrelationId",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantoperation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project GrantAuthentication, GrantOperation, CorrelationId",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantconsenttype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantscope1",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantinitiatedby",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "appreplyurls",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantinitiatedbyuserprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantinitiatedbyaaduserid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantinitiatedbyappname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantinitiatedbyappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantuseragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "appclientid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantauthentication",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "grantoperation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "consentfull",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, Name = tostring(split(GrantInitiatedByUserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(GrantInitiatedByUserPrincipalName,'@',1)[0])",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, Name = tostring(split(GrantInitiatedByUserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(GrantInitiatedByUserPrincipalName,'@',1)[0])",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, Name = tostring(split(GrantInitiatedByUserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(GrantInitiatedByUserPrincipalName,'@',1)[0])",
    "detection": "maliciousoauthapp-pwnauth.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend Properties = TargetResource.modifiedProperties",
    "detection": "cross-tenantaccesssettingsorganizationoutboundcollaborationsettingschanged.yaml",
    "field": "properties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend PremodifiedOutboundSettings = trim('\"',tostring(Property.oldValue)),",
    "detection": "cross-tenantaccesssettingsorganizationoutboundcollaborationsettingschanged.yaml",
    "field": "premodifiedoutboundsettings",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "cross-tenantaccesssettingsorganizationoutboundcollaborationsettingschanged.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "cross-tenantaccesssettingsorganizationoutboundcollaborationsettingschanged.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "cross-tenantaccesssettingsorganizationoutboundcollaborationsettingschanged.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "cross-tenantaccesssettingsorganizationoutboundcollaborationsettingschanged.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingIpAddress = tostring(iff(isnotempty(InitiatedBy.user.ipAddress), InitiatedBy.user.ipAddress, InitiatedBy.app.ipAddress))",
    "detection": "cross-tenantaccesssettingsorganizationoutboundcollaborationsettingschanged.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "cross-tenantaccesssettingsorganizationoutboundcollaborationsettingschanged.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "cross-tenantaccesssettingsorganizationoutboundcollaborationsettingschanged.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatedByActionUserInformation = iff(isnotempty(InitiatedBy.user.userPrincipalName), InitiatedBy.user.userPrincipalName, InitiatedBy.app.displayName)",
    "detection": "guestaccountsaddedinaadgroupsotherthantheonesspecified.yaml",
    "field": "initiatedbyactionuserinformation",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatedByIPAdress = InitiatedBy.user.ipAddress",
    "detection": "guestaccountsaddedinaadgroupsotherthantheonesspecified.yaml",
    "field": "initiatedbyipadress",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend InvitedUser = trim(@'\"',tostring(TargetResource.userPrincipalName)),",
    "detection": "guestaccountsaddedinaadgroupsotherthantheonesspecified.yaml",
    "field": "inviteduser",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "      | extend AADGroup = trim('\"',tostring(Property.newValue))",
    "detection": "guestaccountsaddedinaadgroupsotherthantheonesspecified.yaml",
    "field": "aadgroup",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "     | extend AADGroupId = trim('\"',tostring(Property.newValue))",
    "detection": "guestaccountsaddedinaadgroupsotherthantheonesspecified.yaml",
    "field": "aadgroupid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(InitiatedByActionUserInformation,'@',0)[0]), UPNSuffix = tostring(split(InitiatedByActionUserInformation,'@',1)[0])",
    "detection": "guestaccountsaddedinaadgroupsotherthantheonesspecified.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(InitiatedByActionUserInformation,'@',0)[0]), UPNSuffix = tostring(split(InitiatedByActionUserInformation,'@',1)[0])",
    "detection": "guestaccountsaddedinaadgroupsotherthantheonesspecified.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend ModifiedProperties = TargetResource.modifiedProperties,",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "modifiedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend ConsentFull = tostring(Properties.newValue)",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "consentfull",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend ConsentFull = trim(@'\"',tostring(ConsentFull))",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "consentfull",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend GrantInitiatedByAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantinitiatedbyappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend GrantInitiatedByAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantinitiatedbyappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend GrantInitiatedByUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantinitiatedbyuserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend GrantInitiatedByAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantinitiatedbyaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend GrantIpAddress = iff(isnotempty(InitiatedBy.user.ipAddress), tostring(InitiatedBy.user.ipAddress), tostring(InitiatedBy.app.ipAddress))",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend GrantInitiatedBy = iff(isnotempty(GrantInitiatedByUserPrincipalName), GrantInitiatedByUserPrincipalName, GrantInitiatedByAppName)",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantinitiatedby",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend GrantUserAgent = tostring(iff(AdditionalDetails[0].key =~ \"User-Agent\", AdditionalDetails[0].value, \"\"))",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantuseragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantconsenttype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantscope1",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantinitiatedby",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantinitiatedbyuserprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantinitiatedbyaaduserid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantinitiatedbyappname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantinitiatedbyappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantuseragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "appclientid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "consentfull",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, OperationName, ConsentFull, CorrelationId",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend ModifiedProperties = TargetResource.modifiedProperties,",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "modifiedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend AppReplyURLs = ModifiedProperties.newValue",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "appreplyurls",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend GrantAuthentication = tostring(TargetResource.displayName)",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantauthentication",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend GrantOperation = OperationName",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantoperation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project GrantAuthentication, GrantOperation, CorrelationId",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantauthentication",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project GrantAuthentication, GrantOperation, CorrelationId",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantoperation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project GrantAuthentication, GrantOperation, CorrelationId",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantconsenttype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantscope1",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantinitiatedby",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "appreplyurls",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantinitiatedbyuserprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantinitiatedbyaaduserid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantinitiatedbyappname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantinitiatedbyappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantuseragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "appclientid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantauthentication",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "grantoperation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, GrantConsentType, GrantScope1, GrantInitiatedBy, AppDisplayName, AppReplyURLs, GrantInitiatedByUserPrincipalName, GrantInitiatedByAadUserId, GrantInitiatedByAppName, GrantInitiatedByAppServicePrincipalId, GrantIpAddress, GrantUserAgent, AppClientId, GrantAuthentication, OperationName, GrantOperation, CorrelationId, ConsentFull",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "consentfull",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(GrantInitiatedByUserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(GrantInitiatedByUserPrincipalName,'@',1)[0])",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(GrantInitiatedByUserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(GrantInitiatedByUserPrincipalName,'@',1)[0])",
    "detection": "suspiciousoauthapp-offlineaccess.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend props = TargetResource.modifiedProperties,",
    "detection": "mailpermissionsaddedtoapplication.yaml",
    "field": "props",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend DisplayName = tostring(Property.displayName), Permissions = trim('\"',tostring(Property.newValue))",
    "detection": "mailpermissionsaddedtoapplication.yaml",
    "field": "displayname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend DisplayName = tostring(Property.displayName), Permissions = trim('\"',tostring(Property.newValue))",
    "detection": "mailpermissionsaddedtoapplication.yaml",
    "field": "permissions",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend InitiatingUserAgent = tostring(AdditionalDetail.value)",
    "detection": "mailpermissionsaddedtoapplication.yaml",
    "field": "initiatinguseragent",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "mailpermissionsaddedtoapplication.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "mailpermissionsaddedtoapplication.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "mailpermissionsaddedtoapplication.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "mailpermissionsaddedtoapplication.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingIpAddress = tostring(iff(isnotempty(InitiatedBy.user.ipAddress), InitiatedBy.user.ipAddress, InitiatedBy.app.ipAddress))",
    "detection": "mailpermissionsaddedtoapplication.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "          | extend AppName = tostring(TargetResource.displayName),",
    "detection": "mailpermissionsaddedtoapplication.yaml",
    "field": "appname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(InitiatingUserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(InitiatingUserPrincipalName,'@',1)[0])",
    "detection": "mailpermissionsaddedtoapplication.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(InitiatingUserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(InitiatingUserPrincipalName,'@',1)[0])",
    "detection": "mailpermissionsaddedtoapplication.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize DistinctAccounts = dcount(UserPrincipalName), DistinctAddresses = make_set(IPAddress,100) by ResultType",
    "detection": "seamlessssopasswordspray.yaml",
    "field": "distinctaccounts",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize DistinctAccounts = dcount(UserPrincipalName), DistinctAddresses = make_set(IPAddress,100) by ResultType",
    "detection": "seamlessssopasswordspray.yaml",
    "field": "distinctaddresses",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize DistinctAccounts = dcount(UserPrincipalName), DistinctAddresses = make_set(IPAddress,100) by ResultType",
    "detection": "seamlessssopasswordspray.yaml",
    "field": "resulttype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPAddress = tostring(IPAddress)",
    "detection": "seamlessssopasswordspray.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, StartTime, EndTime, IPAddress, ResultType, ResultDescription, ResultSignature, UserPrincipalName, UserAgent = iff(array_length(UserAgent) == 1, UserAgent[0], UserAgent)",
    "detection": "seamlessssopasswordspray.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, StartTime, EndTime, IPAddress, ResultType, ResultDescription, ResultSignature, UserPrincipalName, UserAgent = iff(array_length(UserAgent) == 1, UserAgent[0], UserAgent)",
    "detection": "seamlessssopasswordspray.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, StartTime, EndTime, IPAddress, ResultType, ResultDescription, ResultSignature, UserPrincipalName, UserAgent = iff(array_length(UserAgent) == 1, UserAgent[0], UserAgent)",
    "detection": "seamlessssopasswordspray.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, StartTime, EndTime, IPAddress, ResultType, ResultDescription, ResultSignature, UserPrincipalName, UserAgent = iff(array_length(UserAgent) == 1, UserAgent[0], UserAgent)",
    "detection": "seamlessssopasswordspray.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, StartTime, EndTime, IPAddress, ResultType, ResultDescription, ResultSignature, UserPrincipalName, UserAgent = iff(array_length(UserAgent) == 1, UserAgent[0], UserAgent)",
    "detection": "seamlessssopasswordspray.yaml",
    "field": "resulttype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, StartTime, EndTime, IPAddress, ResultType, ResultDescription, ResultSignature, UserPrincipalName, UserAgent = iff(array_length(UserAgent) == 1, UserAgent[0], UserAgent)",
    "detection": "seamlessssopasswordspray.yaml",
    "field": "resultdescription",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, StartTime, EndTime, IPAddress, ResultType, ResultDescription, ResultSignature, UserPrincipalName, UserAgent = iff(array_length(UserAgent) == 1, UserAgent[0], UserAgent)",
    "detection": "seamlessssopasswordspray.yaml",
    "field": "resultsignature",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, StartTime, EndTime, IPAddress, ResultType, ResultDescription, ResultSignature, UserPrincipalName, UserAgent = iff(array_length(UserAgent) == 1, UserAgent[0], UserAgent)",
    "detection": "seamlessssopasswordspray.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, StartTime, EndTime, IPAddress, ResultType, ResultDescription, ResultSignature, UserPrincipalName, UserAgent = iff(array_length(UserAgent) == 1, UserAgent[0], UserAgent)",
    "detection": "seamlessssopasswordspray.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserPrincipalName[0],'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName[0],'@',1)[0])",
    "detection": "seamlessssopasswordspray.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserPrincipalName[0],'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName[0],'@',1)[0])",
    "detection": "seamlessssopasswordspray.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend Properties = TargetResource.modifiedProperties",
    "detection": "cross-tenantaccesssettingsorganizationadded.yaml",
    "field": "properties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend ExtTenantIDAdded = trim('\"',tostring(Property.newValue))",
    "detection": "cross-tenantaccesssettingsorganizationadded.yaml",
    "field": "exttenantidadded",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "cross-tenantaccesssettingsorganizationadded.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "cross-tenantaccesssettingsorganizationadded.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "cross-tenantaccesssettingsorganizationadded.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "cross-tenantaccesssettingsorganizationadded.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingIpAddress = tostring(iff(isnotempty(InitiatedBy.user.ipAddress), InitiatedBy.user.ipAddress, InitiatedBy.app.ipAddress))",
    "detection": "cross-tenantaccesssettingsorganizationadded.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "cross-tenantaccesssettingsorganizationadded.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "cross-tenantaccesssettingsorganizationadded.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "      | extend Role = trim(@'\"',tostring(ResourceItem.displayName))",
    "detection": "pimelevationrequestrejected.yaml",
    "field": "role",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend TargetUserPrincipalName = trim(@'\"',tostring(ResourceItem.userPrincipalName))",
    "detection": "pimelevationrequestrejected.yaml",
    "field": "targetuserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "pimelevationrequestrejected.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "pimelevationrequestrejected.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "pimelevationrequestrejected.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "pimelevationrequestrejected.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingIpAddress = tostring(iff(isnotempty(InitiatedBy.user.ipAddress), InitiatedBy.user.ipAddress, InitiatedBy.app.ipAddress))",
    "detection": "pimelevationrequestrejected.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetName = tostring(split(TargetUserPrincipalName,'@',0)[0]), TargetUPNSuffix = tostring(split(TargetUserPrincipalName,'@',1)[0])",
    "detection": "pimelevationrequestrejected.yaml",
    "field": "targetname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetName = tostring(split(TargetUserPrincipalName,'@',0)[0]), TargetUPNSuffix = tostring(split(TargetUserPrincipalName,'@',1)[0])",
    "detection": "pimelevationrequestrejected.yaml",
    "field": "targetupnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatedByName = tostring(split(InitiatingUserPrincipalName,'@',0)[0]), InitiatedByUPNSuffix = tostring(split(InitiatingUserPrincipalName,'@',1)[0])",
    "detection": "pimelevationrequestrejected.yaml",
    "field": "initiatedbyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatedByName = tostring(split(InitiatingUserPrincipalName,'@',0)[0]), InitiatedByUPNSuffix = tostring(split(InitiatingUserPrincipalName,'@',1)[0])",
    "detection": "pimelevationrequestrejected.yaml",
    "field": "initiatedbyupnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend TargetUserPrincipalName = tostring(TargetResource.userPrincipalName)",
    "detection": "privlegedroleassignedoutsidepim.yaml",
    "field": "targetuserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "privlegedroleassignedoutsidepim.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "privlegedroleassignedoutsidepim.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "privlegedroleassignedoutsidepim.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "privlegedroleassignedoutsidepim.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingIpAddress = tostring(iff(isnotempty(InitiatedBy.user.ipAddress), InitiatedBy.user.ipAddress, InitiatedBy.app.ipAddress))",
    "detection": "privlegedroleassignedoutsidepim.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetName = tostring(split(TargetUserPrincipalName,'@',0)[0]), TargetUPNSuffix = tostring(split(TargetUserPrincipalName,'@',1)[0])",
    "detection": "privlegedroleassignedoutsidepim.yaml",
    "field": "targetname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetName = tostring(split(TargetUserPrincipalName,'@',0)[0]), TargetUPNSuffix = tostring(split(TargetUserPrincipalName,'@',1)[0])",
    "detection": "privlegedroleassignedoutsidepim.yaml",
    "field": "targetupnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatedByName = tostring(split(InitiatingUserPrincipalName,'@',0)[0]), InitiatedByUPNSuffix = tostring(split(InitiatingUserPrincipalName,'@',1)[0])",
    "detection": "privlegedroleassignedoutsidepim.yaml",
    "field": "initiatedbyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatedByName = tostring(split(InitiatingUserPrincipalName,'@',0)[0]), InitiatedByUPNSuffix = tostring(split(InitiatingUserPrincipalName,'@',1)[0])",
    "detection": "privlegedroleassignedoutsidepim.yaml",
    "field": "initiatedbyupnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend isipv4 = parse_ipv4(values_properties_addressPrefixes)",
    "detection": "azureportalsigninfromanotherazuretenant.yaml",
    "field": "isipv4",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend isipv6 = parse_ipv6(values_properties_addressPrefixes)",
    "detection": "azureportalsigninfromanotherazuretenant.yaml",
    "field": "isipv6",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend ip_type = case(isnotnull(isipv4), \"v4\", \"v6\")",
    "detection": "azureportalsigninfromanotherazuretenant.yaml",
    "field": "ip_type",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize make_list(values_properties_addressPrefixes) by ip_type",
    "detection": "azureportalsigninfromanotherazuretenant.yaml",
    "field": "ip_type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend isipv4 = parse_ipv4(IPAddress)",
    "detection": "azureportalsigninfromanotherazuretenant.yaml",
    "field": "isipv4",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend ip_type = case(isnotnull(isipv4), \"v4\", \"v6\")",
    "detection": "azureportalsigninfromanotherazuretenant.yaml",
    "field": "ip_type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ipv6_match = ipv6_is_in_any_range(IPAddress,  list_values_properties_addressPrefixes)",
    "detection": "azureportalsigninfromanotherazuretenant.yaml",
    "field": "ipv6_match",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend ipv4_match = ipv4_is_in_any_range(IPAddress,  list_values_properties_addressPrefixes)",
    "detection": "azureportalsigninfromanotherazuretenant.yaml",
    "field": "ipv4_match",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstSeen = min(TimeGenerated), LastSeen = max(TimeGenerated), make_set(ResourceDisplayName) by UserPrincipalName, IPAddress, UserAgent, Location, HomeTenantId, ResourceTenantId, UserId",
    "detection": "azureportalsigninfromanotherazuretenant.yaml",
    "field": "firstseen",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstSeen = min(TimeGenerated), LastSeen = max(TimeGenerated), make_set(ResourceDisplayName) by UserPrincipalName, IPAddress, UserAgent, Location, HomeTenantId, ResourceTenantId, UserId",
    "detection": "azureportalsigninfromanotherazuretenant.yaml",
    "field": "lastseen",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstSeen = min(TimeGenerated), LastSeen = max(TimeGenerated), make_set(ResourceDisplayName) by UserPrincipalName, IPAddress, UserAgent, Location, HomeTenantId, ResourceTenantId, UserId",
    "detection": "azureportalsigninfromanotherazuretenant.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstSeen = min(TimeGenerated), LastSeen = max(TimeGenerated), make_set(ResourceDisplayName) by UserPrincipalName, IPAddress, UserAgent, Location, HomeTenantId, ResourceTenantId, UserId",
    "detection": "azureportalsigninfromanotherazuretenant.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstSeen = min(TimeGenerated), LastSeen = max(TimeGenerated), make_set(ResourceDisplayName) by UserPrincipalName, IPAddress, UserAgent, Location, HomeTenantId, ResourceTenantId, UserId",
    "detection": "azureportalsigninfromanotherazuretenant.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstSeen = min(TimeGenerated), LastSeen = max(TimeGenerated), make_set(ResourceDisplayName) by UserPrincipalName, IPAddress, UserAgent, Location, HomeTenantId, ResourceTenantId, UserId",
    "detection": "azureportalsigninfromanotherazuretenant.yaml",
    "field": "location",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstSeen = min(TimeGenerated), LastSeen = max(TimeGenerated), make_set(ResourceDisplayName) by UserPrincipalName, IPAddress, UserAgent, Location, HomeTenantId, ResourceTenantId, UserId",
    "detection": "azureportalsigninfromanotherazuretenant.yaml",
    "field": "hometenantid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstSeen = min(TimeGenerated), LastSeen = max(TimeGenerated), make_set(ResourceDisplayName) by UserPrincipalName, IPAddress, UserAgent, Location, HomeTenantId, ResourceTenantId, UserId",
    "detection": "azureportalsigninfromanotherazuretenant.yaml",
    "field": "resourcetenantid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstSeen = min(TimeGenerated), LastSeen = max(TimeGenerated), make_set(ResourceDisplayName) by UserPrincipalName, IPAddress, UserAgent, Location, HomeTenantId, ResourceTenantId, UserId",
    "detection": "azureportalsigninfromanotherazuretenant.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = split(UserPrincipalName, \"@\")[0]",
    "detection": "azureportalsigninfromanotherazuretenant.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UPNSuffix = split(UserPrincipalName, \"@\")[1]",
    "detection": "azureportalsigninfromanotherazuretenant.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend Properties = TargetResource.modifiedProperties",
    "detection": "cross-tenantaccesssettingsorganizationinboundcollaborationsettingschanged.yaml",
    "field": "properties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend PremodifiedInboundSettings = trim('\"',tostring(Property.oldValue)),",
    "detection": "cross-tenantaccesssettingsorganizationinboundcollaborationsettingschanged.yaml",
    "field": "premodifiedinboundsettings",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "cross-tenantaccesssettingsorganizationinboundcollaborationsettingschanged.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "cross-tenantaccesssettingsorganizationinboundcollaborationsettingschanged.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "cross-tenantaccesssettingsorganizationinboundcollaborationsettingschanged.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "cross-tenantaccesssettingsorganizationinboundcollaborationsettingschanged.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingIpAddress = tostring(iff(isnotempty(InitiatedBy.user.ipAddress), InitiatedBy.user.ipAddress, InitiatedBy.app.ipAddress))",
    "detection": "cross-tenantaccesssettingsorganizationinboundcollaborationsettingschanged.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "cross-tenantaccesssettingsorganizationinboundcollaborationsettingschanged.yaml",
    "field": "initiatingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAccountName = tostring(split(InitiatingUserPrincipalName, \"@\")[0]), InitiatingAccountUPNSuffix = tostring(split(InitiatingUserPrincipalName, \"@\")[1])",
    "detection": "cross-tenantaccesssettingsorganizationinboundcollaborationsettingschanged.yaml",
    "field": "initiatingaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend AccountObjectId = tostring(TargetResource[\"id\"])",
    "detection": "suspiciousmodificationofglobaladminproperties.yaml",
    "field": "accountobjectid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, Identity, Initiator, IPAddress, OperationName, Result, AccountUPN, InitiatedBy, AdditionalDetails, TargetResources, AccountObjectId, InitiatorId, CorrelationId",
    "detection": "suspiciousmodificationofglobaladminproperties.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, Identity, Initiator, IPAddress, OperationName, Result, AccountUPN, InitiatedBy, AdditionalDetails, TargetResources, AccountObjectId, InitiatorId, CorrelationId",
    "detection": "suspiciousmodificationofglobaladminproperties.yaml",
    "field": "category",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, Identity, Initiator, IPAddress, OperationName, Result, AccountUPN, InitiatedBy, AdditionalDetails, TargetResources, AccountObjectId, InitiatorId, CorrelationId",
    "detection": "suspiciousmodificationofglobaladminproperties.yaml",
    "field": "identity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, Identity, Initiator, IPAddress, OperationName, Result, AccountUPN, InitiatedBy, AdditionalDetails, TargetResources, AccountObjectId, InitiatorId, CorrelationId",
    "detection": "suspiciousmodificationofglobaladminproperties.yaml",
    "field": "initiator",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, Identity, Initiator, IPAddress, OperationName, Result, AccountUPN, InitiatedBy, AdditionalDetails, TargetResources, AccountObjectId, InitiatorId, CorrelationId",
    "detection": "suspiciousmodificationofglobaladminproperties.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, Identity, Initiator, IPAddress, OperationName, Result, AccountUPN, InitiatedBy, AdditionalDetails, TargetResources, AccountObjectId, InitiatorId, CorrelationId",
    "detection": "suspiciousmodificationofglobaladminproperties.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, Identity, Initiator, IPAddress, OperationName, Result, AccountUPN, InitiatedBy, AdditionalDetails, TargetResources, AccountObjectId, InitiatorId, CorrelationId",
    "detection": "suspiciousmodificationofglobaladminproperties.yaml",
    "field": "result",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, Identity, Initiator, IPAddress, OperationName, Result, AccountUPN, InitiatedBy, AdditionalDetails, TargetResources, AccountObjectId, InitiatorId, CorrelationId",
    "detection": "suspiciousmodificationofglobaladminproperties.yaml",
    "field": "accountupn",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, Identity, Initiator, IPAddress, OperationName, Result, AccountUPN, InitiatedBy, AdditionalDetails, TargetResources, AccountObjectId, InitiatorId, CorrelationId",
    "detection": "suspiciousmodificationofglobaladminproperties.yaml",
    "field": "initiatedby",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, Identity, Initiator, IPAddress, OperationName, Result, AccountUPN, InitiatedBy, AdditionalDetails, TargetResources, AccountObjectId, InitiatorId, CorrelationId",
    "detection": "suspiciousmodificationofglobaladminproperties.yaml",
    "field": "additionaldetails",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, Identity, Initiator, IPAddress, OperationName, Result, AccountUPN, InitiatedBy, AdditionalDetails, TargetResources, AccountObjectId, InitiatorId, CorrelationId",
    "detection": "suspiciousmodificationofglobaladminproperties.yaml",
    "field": "targetresources",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, Identity, Initiator, IPAddress, OperationName, Result, AccountUPN, InitiatedBy, AdditionalDetails, TargetResources, AccountObjectId, InitiatorId, CorrelationId",
    "detection": "suspiciousmodificationofglobaladminproperties.yaml",
    "field": "accountobjectid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, Identity, Initiator, IPAddress, OperationName, Result, AccountUPN, InitiatedBy, AdditionalDetails, TargetResources, AccountObjectId, InitiatorId, CorrelationId",
    "detection": "suspiciousmodificationofglobaladminproperties.yaml",
    "field": "initiatorid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Category, Identity, Initiator, IPAddress, OperationName, Result, AccountUPN, InitiatedBy, AdditionalDetails, TargetResources, AccountObjectId, InitiatorId, CorrelationId",
    "detection": "suspiciousmodificationofglobaladminproperties.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize CountOfLocations = dcount(Location), Locations = make_set(Location) by User = Identity",
    "detection": "gitlab-signinburst.yaml",
    "field": "countoflocations",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize CountOfLocations = dcount(Location), Locations = make_set(Location) by User = Identity",
    "detection": "gitlab-signinburst.yaml",
    "field": "locations",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend Target = iff(TargetResource.type =~ \"ServicePrincipal\", tostring(TargetResource.displayName), tostring(TargetResource.userPrincipalName)),",
    "detection": "userassignedprivilegedrole.yaml",
    "field": "target",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend RoleName = trim('\"', tostring(Property.newValue))",
    "detection": "userassignedprivilegedrole.yaml",
    "field": "rolename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "userassignedprivilegedrole.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "userassignedprivilegedrole.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "userassignedprivilegedrole.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "userassignedprivilegedrole.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingIpAddress = tostring(iff(isnotempty(InitiatedBy.user.ipAddress), InitiatedBy.user.ipAddress, InitiatedBy.app.ipAddress))",
    "detection": "userassignedprivilegedrole.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Initiator = iif(isnotempty(InitiatingAppName), InitiatingAppName, InitiatingUserPrincipalName)",
    "detection": "userassignedprivilegedrole.yaml",
    "field": "initiator",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationName, RoleName, Target, Initiator, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIpAddress, Result",
    "detection": "userassignedprivilegedrole.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationName, RoleName, Target, Initiator, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIpAddress, Result",
    "detection": "userassignedprivilegedrole.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationName, RoleName, Target, Initiator, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIpAddress, Result",
    "detection": "userassignedprivilegedrole.yaml",
    "field": "rolename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationName, RoleName, Target, Initiator, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIpAddress, Result",
    "detection": "userassignedprivilegedrole.yaml",
    "field": "target",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationName, RoleName, Target, Initiator, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIpAddress, Result",
    "detection": "userassignedprivilegedrole.yaml",
    "field": "initiator",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationName, RoleName, Target, Initiator, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIpAddress, Result",
    "detection": "userassignedprivilegedrole.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationName, RoleName, Target, Initiator, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIpAddress, Result",
    "detection": "userassignedprivilegedrole.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationName, RoleName, Target, Initiator, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIpAddress, Result",
    "detection": "userassignedprivilegedrole.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationName, RoleName, Target, Initiator, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIpAddress, Result",
    "detection": "userassignedprivilegedrole.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationName, RoleName, Target, Initiator, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIpAddress, Result",
    "detection": "userassignedprivilegedrole.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OperationName, RoleName, Target, Initiator, InitiatingUserPrincipalName, InitiatingAadUserId, InitiatingAppName, InitiatingAppServicePrincipalId, InitiatingIpAddress, Result",
    "detection": "userassignedprivilegedrole.yaml",
    "field": "result",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetName = tostring(split(Target,'@',0)[0]), TargetUPNSuffix = tostring(split(Target,'@',1)[0]), InitiatorName = tostring(split(InitiatingUserPrincipalName,'@',0)[0]), InitiatorUPNSuffix = tostring(split(InitiatingUserPrincipalName,'@',1)[0])",
    "detection": "userassignedprivilegedrole.yaml",
    "field": "targetname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetName = tostring(split(Target,'@',0)[0]), TargetUPNSuffix = tostring(split(Target,'@',1)[0]), InitiatorName = tostring(split(InitiatingUserPrincipalName,'@',0)[0]), InitiatorUPNSuffix = tostring(split(InitiatingUserPrincipalName,'@',1)[0])",
    "detection": "userassignedprivilegedrole.yaml",
    "field": "targetupnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetName = tostring(split(Target,'@',0)[0]), TargetUPNSuffix = tostring(split(Target,'@',1)[0]), InitiatorName = tostring(split(InitiatingUserPrincipalName,'@',0)[0]), InitiatorUPNSuffix = tostring(split(InitiatingUserPrincipalName,'@',1)[0])",
    "detection": "userassignedprivilegedrole.yaml",
    "field": "initiatorname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetName = tostring(split(Target,'@',0)[0]), TargetUPNSuffix = tostring(split(Target,'@',1)[0]), InitiatorName = tostring(split(InitiatingUserPrincipalName,'@',0)[0]), InitiatorUPNSuffix = tostring(split(InitiatingUserPrincipalName,'@',1)[0])",
    "detection": "userassignedprivilegedrole.yaml",
    "field": "initiatorupnsuffix",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "          | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), IPAddresses = make_set(IPAddress,100), Locations = make_set(LocationDetails,20), Devices = make_set(DeviceDetail,20) by UserPrincipalName, UserId, AppDisplayName",
    "detection": "brute-force-attack-against-github-account.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "          | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), IPAddresses = make_set(IPAddress,100), Locations = make_set(LocationDetails,20), Devices = make_set(DeviceDetail,20) by UserPrincipalName, UserId, AppDisplayName",
    "detection": "brute-force-attack-against-github-account.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "          | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), IPAddresses = make_set(IPAddress,100), Locations = make_set(LocationDetails,20), Devices = make_set(DeviceDetail,20) by UserPrincipalName, UserId, AppDisplayName",
    "detection": "brute-force-attack-against-github-account.yaml",
    "field": "ipaddresses",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "          | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), IPAddresses = make_set(IPAddress,100), Locations = make_set(LocationDetails,20), Devices = make_set(DeviceDetail,20) by UserPrincipalName, UserId, AppDisplayName",
    "detection": "brute-force-attack-against-github-account.yaml",
    "field": "locations",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "          | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), IPAddresses = make_set(IPAddress,100), Locations = make_set(LocationDetails,20), Devices = make_set(DeviceDetail,20) by UserPrincipalName, UserId, AppDisplayName",
    "detection": "brute-force-attack-against-github-account.yaml",
    "field": "devices",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "          | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), IPAddresses = make_set(IPAddress,100), Locations = make_set(LocationDetails,20), Devices = make_set(DeviceDetail,20) by UserPrincipalName, UserId, AppDisplayName",
    "detection": "brute-force-attack-against-github-account.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "          | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), IPAddresses = make_set(IPAddress,100), Locations = make_set(LocationDetails,20), Devices = make_set(DeviceDetail,20) by UserPrincipalName, UserId, AppDisplayName",
    "detection": "brute-force-attack-against-github-account.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "          | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), IPAddresses = make_set(IPAddress,100), Locations = make_set(LocationDetails,20), Devices = make_set(DeviceDetail,20) by UserPrincipalName, UserId, AppDisplayName",
    "detection": "brute-force-attack-against-github-account.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "brute-force-attack-against-github-account.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "brute-force-attack-against-github-account.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPAddressFirst = tostring(IPAddresses[0])",
    "detection": "brute-force-attack-against-github-account.yaml",
    "field": "ipaddressfirst",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend domain = tolower(split(UserPrincipalName, \"@\")[1])",
    "detection": "accountcreatedfromnon-approvedsources.yaml",
    "field": "domain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend domain = tolower(split(AlternateSignInName, \"@\")[1])",
    "detection": "accountcreatedfromnon-approvedsources.yaml",
    "field": "domain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAppName = tostring(InitiatedBy.app.displayName)",
    "detection": "accountcreatedfromnon-approvedsources.yaml",
    "field": "initiatingappname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)",
    "detection": "accountcreatedfromnon-approvedsources.yaml",
    "field": "initiatingappserviceprincipalid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)",
    "detection": "accountcreatedfromnon-approvedsources.yaml",
    "field": "initiatinguserprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingAadUserId = tostring(InitiatedBy.user.id)",
    "detection": "accountcreatedfromnon-approvedsources.yaml",
    "field": "initiatingaaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend InitiatingIpAddress = tostring(iff(isnotempty(InitiatedBy.user.ipAddress), InitiatedBy.user.ipAddress, InitiatedBy.app.ipAddress))",
    "detection": "accountcreatedfromnon-approvedsources.yaml",
    "field": "initiatingipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UserAdded = tostring(TargetResources[0].userPrincipalName)",
    "detection": "accountcreatedfromnon-approvedsources.yaml",
    "field": "useradded",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UserAddedDomain = case(",
    "detection": "accountcreatedfromnon-approvedsources.yaml",
    "field": "useraddeddomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AddedByName = case(",
    "detection": "accountcreatedfromnon-approvedsources.yaml",
    "field": "addedbyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AddedByUPNSuffix = case(",
    "detection": "accountcreatedfromnon-approvedsources.yaml",
    "field": "addedbyupnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UserAddedName = case(",
    "detection": "accountcreatedfromnon-approvedsources.yaml",
    "field": "useraddedname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project CorrelationId , UserName, ConnectionType , TimeGenerated",
    "detection": "unusual-high-avd-session-duration-detected.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project CorrelationId , UserName, ConnectionType , TimeGenerated",
    "detection": "unusual-high-avd-session-duration-detected.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project CorrelationId , UserName, ConnectionType , TimeGenerated",
    "detection": "unusual-high-avd-session-duration-detected.yaml",
    "field": "connectiontype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project CorrelationId , UserName, ConnectionType , TimeGenerated",
    "detection": "unusual-high-avd-session-duration-detected.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, CorrelationId",
    "detection": "unusual-high-avd-session-duration-detected.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, CorrelationId",
    "detection": "unusual-high-avd-session-duration-detected.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SessionDuration = (TimeGenerated1 - TimeGenerated)",
    "detection": "unusual-high-avd-session-duration-detected.yaml",
    "field": "sessionduration",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project UserName, TimeGenerated, HoursPerDay, baseline, anomalies, score;",
    "detection": "unusual-high-avd-session-duration-detected.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project UserName, TimeGenerated, HoursPerDay, baseline, anomalies, score;",
    "detection": "unusual-high-avd-session-duration-detected.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project UserName, TimeGenerated, HoursPerDay, baseline, anomalies, score;",
    "detection": "unusual-high-avd-session-duration-detected.yaml",
    "field": "hoursperday",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project UserName, TimeGenerated, HoursPerDay, baseline, anomalies, score;",
    "detection": "unusual-high-avd-session-duration-detected.yaml",
    "field": "baseline",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project UserName, TimeGenerated, HoursPerDay, baseline, anomalies, score;",
    "detection": "unusual-high-avd-session-duration-detected.yaml",
    "field": "anomalies",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Logons = count_);",
    "detection": "unusual-number-of-avd-connections-detected.yaml",
    "field": "logons",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project UserName, TimeGenerated, Logons, baseline, anomalies, score;",
    "detection": "unusual-number-of-avd-connections-detected.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "  | project UserName, TimeGenerated, Logons, baseline, anomalies, score;",
    "detection": "unusual-number-of-avd-connections-detected.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project UserName, TimeGenerated, Logons, baseline, anomalies, score;",
    "detection": "unusual-number-of-avd-connections-detected.yaml",
    "field": "logons",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project UserName, TimeGenerated, Logons, baseline, anomalies, score;",
    "detection": "unusual-number-of-avd-connections-detected.yaml",
    "field": "baseline",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project UserName, TimeGenerated, Logons, baseline, anomalies, score;",
    "detection": "unusual-number-of-avd-connections-detected.yaml",
    "field": "anomalies",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend key = 1",
    "detection": "possible-suspicious-resources-added-or-updated-to-adv.yaml",
    "field": "key",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostPoolName = extract(@\"microsoft.desktopvirtualization/hostpools/(.*)\", 1, _ResourceId)",
    "detection": "possible-suspicious-resources-added-or-updated-to-adv.yaml",
    "field": "hostpoolname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend key = 1",
    "detection": "possible-suspicious-resources-added-or-updated-to-adv.yaml",
    "field": "key",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize ConnectionCount = count() by UserName, ClientSideIPAddress, SessionHostName",
    "detection": "potential-avd-account-takeover-attempts-detected.yaml",
    "field": "connectioncount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize ConnectionCount = count() by UserName, ClientSideIPAddress, SessionHostName",
    "detection": "potential-avd-account-takeover-attempts-detected.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize ConnectionCount = count() by UserName, ClientSideIPAddress, SessionHostName",
    "detection": "potential-avd-account-takeover-attempts-detected.yaml",
    "field": "clientsideipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize ConnectionCount = count() by UserName, ClientSideIPAddress, SessionHostName",
    "detection": "potential-avd-account-takeover-attempts-detected.yaml",
    "field": "sessionhostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Region = geo_info_from_ip_address(ClientSideIPAddress)",
    "detection": "potential-avd-account-takeover-attempts-detected.yaml",
    "field": "region",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Region_Country = Region.country, Region_State = Region.state, Region_City = Region.city",
    "detection": "potential-avd-account-takeover-attempts-detected.yaml",
    "field": "region_country",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Region_Country = Region.country, Region_State = Region.state, Region_City = Region.city",
    "detection": "potential-avd-account-takeover-attempts-detected.yaml",
    "field": "region_state",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Region_Country = Region.country, Region_State = Region.state, Region_City = Region.city",
    "detection": "potential-avd-account-takeover-attempts-detected.yaml",
    "field": "region_city",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize count() by DvcHostname, SrcIpAddr, DstIpAddr, DstPortNumber, Url, DvcAction, Protocol",
    "detection": "severaldenyactionsregistered.yaml",
    "field": "dvchostname",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize count() by DvcHostname, SrcIpAddr, DstIpAddr, DstPortNumber, Url, DvcAction, Protocol",
    "detection": "severaldenyactionsregistered.yaml",
    "field": "srcipaddr",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize count() by DvcHostname, SrcIpAddr, DstIpAddr, DstPortNumber, Url, DvcAction, Protocol",
    "detection": "severaldenyactionsregistered.yaml",
    "field": "dstipaddr",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize count() by DvcHostname, SrcIpAddr, DstIpAddr, DstPortNumber, Url, DvcAction, Protocol",
    "detection": "severaldenyactionsregistered.yaml",
    "field": "dstportnumber",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize count() by DvcHostname, SrcIpAddr, DstIpAddr, DstPortNumber, Url, DvcAction, Protocol",
    "detection": "severaldenyactionsregistered.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize count() by DvcHostname, SrcIpAddr, DstIpAddr, DstPortNumber, Url, DvcAction, Protocol",
    "detection": "severaldenyactionsregistered.yaml",
    "field": "dvcaction",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize count() by DvcHostname, SrcIpAddr, DstIpAddr, DstPortNumber, Url, DvcAction, Protocol",
    "detection": "severaldenyactionsregistered.yaml",
    "field": "protocol",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend FirewallCustomEntity = DvcHostname, IPCustomEntity = SrcIpAddr, UrlCustomEntity = Url",
    "detection": "severaldenyactionsregistered.yaml",
    "field": "firewallcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend FirewallCustomEntity = DvcHostname, IPCustomEntity = SrcIpAddr, UrlCustomEntity = Url",
    "detection": "severaldenyactionsregistered.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend FirewallCustomEntity = DvcHostname, IPCustomEntity = SrcIpAddr, UrlCustomEntity = Url",
    "detection": "severaldenyactionsregistered.yaml",
    "field": "urlcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DstPortNumber = tostring(DstPortNumber)",
    "detection": "nonstandard-port-protocol-match.yaml",
    "field": "dstportnumber",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend ExpectedProtocol = case(",
    "detection": "nonstandard-port-protocol-match.yaml",
    "field": "expectedprotocol",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend MatchStatus = iff(ExpectedProtocol !has Protocol, \"Port to protocol mismatch\", \"Port to protocol match\")",
    "detection": "nonstandard-port-protocol-match.yaml",
    "field": "matchstatus",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AlertTimedCountPortsInBinTime = dcount(DestinationPort) by SourceIp, bin(TimeGenerated, BinTime), Fqdn",
    "detection": "azure-firewall-port-scan.yaml",
    "field": "alerttimedcountportsinbintime",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AlertTimedCountPortsInBinTime = dcount(DestinationPort) by SourceIp, bin(TimeGenerated, BinTime), Fqdn",
    "detection": "azure-firewall-port-scan.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AlertTimedCountPortsInBinTime = dcount(DestinationPort) by SourceIp, bin(TimeGenerated, BinTime), Fqdn",
    "detection": "azure-firewall-port-scan.yaml",
    "field": "fqdn",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Fqdn = DestinationIp",
    "detection": "azure-firewall-port-scan.yaml",
    "field": "fqdn",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AlertTimedCountPortsInBinTime = dcount(DestinationPort) by SourceIp, bin(TimeGenerated, BinTime), Fqdn",
    "detection": "azure-firewall-port-scan.yaml",
    "field": "alerttimedcountportsinbintime",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AlertTimedCountPortsInBinTime = dcount(DestinationPort) by SourceIp, bin(TimeGenerated, BinTime), Fqdn",
    "detection": "azure-firewall-port-scan.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AlertTimedCountPortsInBinTime = dcount(DestinationPort) by SourceIp, bin(TimeGenerated, BinTime), Fqdn",
    "detection": "azure-firewall-port-scan.yaml",
    "field": "fqdn",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AlertTimedCountPortsInBinTime = dcount(DestinationPort) by SourceIp, bin(TimeGenerated, BinTime), Fqdn",
    "detection": "azure-firewall-port-scan.yaml",
    "field": "alerttimedcountportsinbintime",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AlertTimedCountPortsInBinTime = dcount(DestinationPort) by SourceIp, bin(TimeGenerated, BinTime), Fqdn",
    "detection": "azure-firewall-port-scan.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AlertTimedCountPortsInBinTime = dcount(DestinationPort) by SourceIp, bin(TimeGenerated, BinTime), Fqdn",
    "detection": "azure-firewall-port-scan.yaml",
    "field": "fqdn",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AlertTimedCountHostsInBinTime = make_set(Fqdn) by SourceIp, bin(TimeGenerated, BinTime), DestinationPort",
    "detection": "azure-firewall-port-sweep.yaml",
    "field": "alerttimedcounthostsinbintime",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AlertTimedCountHostsInBinTime = make_set(Fqdn) by SourceIp, bin(TimeGenerated, BinTime), DestinationPort",
    "detection": "azure-firewall-port-sweep.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AlertTimedCountHostsInBinTime = make_set(Fqdn) by SourceIp, bin(TimeGenerated, BinTime), DestinationPort",
    "detection": "azure-firewall-port-sweep.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Fqdn = DestinationIp",
    "detection": "azure-firewall-port-sweep.yaml",
    "field": "fqdn",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AlertTimedCountHostsInBinTime = make_set(Fqdn) by SourceIp, bin(TimeGenerated, BinTime), DestinationPort",
    "detection": "azure-firewall-port-sweep.yaml",
    "field": "alerttimedcounthostsinbintime",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AlertTimedCountHostsInBinTime = make_set(Fqdn) by SourceIp, bin(TimeGenerated, BinTime), DestinationPort",
    "detection": "azure-firewall-port-sweep.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AlertTimedCountHostsInBinTime = make_set(Fqdn) by SourceIp, bin(TimeGenerated, BinTime), DestinationPort",
    "detection": "azure-firewall-port-sweep.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AlertTimedCountHostsInBinTime = make_set(Fqdn) by SourceIp, bin(TimeGenerated, BinTime), DestinationPort",
    "detection": "azure-firewall-port-sweep.yaml",
    "field": "alerttimedcounthostsinbintime",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AlertTimedCountHostsInBinTime = make_set(Fqdn) by SourceIp, bin(TimeGenerated, BinTime), DestinationPort",
    "detection": "azure-firewall-port-sweep.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AlertTimedCountHostsInBinTime = make_set(Fqdn) by SourceIp, bin(TimeGenerated, BinTime), DestinationPort",
    "detection": "azure-firewall-port-sweep.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project bin(TimeGenerated, BinTime), SourceIp, DestinationPort, AlertTimedCountHostsInBinTime, Fqdn",
    "detection": "azure-firewall-port-sweep.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project bin(TimeGenerated, BinTime), SourceIp, DestinationPort, AlertTimedCountHostsInBinTime, Fqdn",
    "detection": "azure-firewall-port-sweep.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project bin(TimeGenerated, BinTime), SourceIp, DestinationPort, AlertTimedCountHostsInBinTime, Fqdn",
    "detection": "azure-firewall-port-sweep.yaml",
    "field": "alerttimedcounthostsinbintime",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project bin(TimeGenerated, BinTime), SourceIp, DestinationPort, AlertTimedCountHostsInBinTime, Fqdn",
    "detection": "azure-firewall-port-sweep.yaml",
    "field": "fqdn",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize TiTrafficCount = count(), dCountSourceIps = dcount(SourceIp), AffectedIps = make_set(SourceIp, 10000) by Fqdn, ThreatDescription",
    "detection": "azure-firewall-multiple-sources-affected-by-the-same-ti-destination.yaml",
    "field": "titrafficcount",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize TiTrafficCount = count(), dCountSourceIps = dcount(SourceIp), AffectedIps = make_set(SourceIp, 10000) by Fqdn, ThreatDescription",
    "detection": "azure-firewall-multiple-sources-affected-by-the-same-ti-destination.yaml",
    "field": "dcountsourceips",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize TiTrafficCount = count(), dCountSourceIps = dcount(SourceIp), AffectedIps = make_set(SourceIp, 10000) by Fqdn, ThreatDescription",
    "detection": "azure-firewall-multiple-sources-affected-by-the-same-ti-destination.yaml",
    "field": "affectedips",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize TiTrafficCount = count(), dCountSourceIps = dcount(SourceIp), AffectedIps = make_set(SourceIp, 10000) by Fqdn, ThreatDescription",
    "detection": "azure-firewall-multiple-sources-affected-by-the-same-ti-destination.yaml",
    "field": "fqdn",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize TiTrafficCount = count(), dCountSourceIps = dcount(SourceIp), AffectedIps = make_set(SourceIp, 10000) by Fqdn, ThreatDescription",
    "detection": "azure-firewall-multiple-sources-affected-by-the-same-ti-destination.yaml",
    "field": "threatdescription",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ExtendedProperties = parse_json(ExtendedProperties)",
    "detection": "iotinternetaccess.yaml",
    "field": "extendedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceId = tostring(ExtendedProperties.DeviceId),",
    "detection": "iotinternetaccess.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ExtendedProperties = parse_json(ExtendedProperties)",
    "detection": "iotunauthorizeddevice.yaml",
    "field": "extendedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceId = tostring(ExtendedProperties.DeviceId),",
    "detection": "iotunauthorizeddevice.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ExtendedProperties = parse_json(ExtendedProperties)",
    "detection": "iotplcstopcommand.yaml",
    "field": "extendedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceId = tostring(ExtendedProperties.DeviceId),",
    "detection": "iotplcstopcommand.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ExtendedProperties = parse_json(ExtendedProperties)",
    "detection": "iotinsecureplc.yaml",
    "field": "extendedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceId = tostring(ExtendedProperties.DeviceId),",
    "detection": "iotinsecureplc.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ExtendedProperties = parse_json(ExtendedProperties)",
    "detection": "iothighbandwidth.yaml",
    "field": "extendedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceId = tostring(ExtendedProperties.DeviceId),",
    "detection": "iothighbandwidth.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ExtendedProperties = parse_json(ExtendedProperties)",
    "detection": "iotunauthorizedplcmodifications.yaml",
    "field": "extendedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceId = tostring(ExtendedProperties.DeviceId),",
    "detection": "iotunauthorizedplcmodifications.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ExtendedProperties = parse_json(ExtendedProperties)",
    "detection": "iotmalware.yaml",
    "field": "extendedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceId = tostring(ExtendedProperties.DeviceId),",
    "detection": "iotmalware.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ExtendedProperties = parse_json(ExtendedProperties)",
    "detection": "iotunauthorizednetworkconfiguration.yaml",
    "field": "extendedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceId = tostring(ExtendedProperties.DeviceId),",
    "detection": "iotunauthorizednetworkconfiguration.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ExtendedProperties = parse_json(ExtendedProperties)",
    "detection": "iotfirmwareupdates.yaml",
    "field": "extendedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceId = tostring(ExtendedProperties.DeviceId),",
    "detection": "iotfirmwareupdates.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ExtendedProperties = parse_json(ExtendedProperties)",
    "detection": "iotunauthorizedremoteaccess.yaml",
    "field": "extendedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceId = tostring(ExtendedProperties.DeviceId),",
    "detection": "iotunauthorizedremoteaccess.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ExtendedProperties = parse_json(ExtendedProperties)",
    "detection": "iotillegalfunctioncodes.yaml",
    "field": "extendedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceId = tostring(ExtendedProperties.DeviceId),",
    "detection": "iotillegalfunctioncodes.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ExtendedProperties = parse_json(ExtendedProperties)",
    "detection": "iotexcessiveloginattempts.yaml",
    "field": "extendedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceId = tostring(ExtendedProperties.DeviceId),",
    "detection": "iotexcessiveloginattempts.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ExtendedProperties = parse_json(ExtendedProperties)",
    "detection": "iotinosensortrafficdetected.yaml",
    "field": "extendedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceId = tostring(ExtendedProperties.DeviceId),",
    "detection": "iotinosensortrafficdetected.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ExtendedProperties = parse_json(ExtendedProperties)",
    "detection": "iotdenialofservice.yaml",
    "field": "extendedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceId = tostring(ExtendedProperties.DeviceId),",
    "detection": "iotdenialofservice.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ExtendedProperties = parse_json(ExtendedProperties)",
    "detection": "iotnetworkscanning.yaml",
    "field": "extendedproperties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceId = tostring(ExtendedProperties.DeviceId),",
    "detection": "iotnetworkscanning.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AadTenantId = tostring(Entity.AadTenantId)",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "aadtenantid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AadUserId = tostring(Entity.AadUserId)",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "aaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = AccountDisplayName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserAccount = AccountUPN",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "useraccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AccountTenantId, AccountObjectId, UserAccount, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "accounttenantid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AccountTenantId, AccountObjectId, UserAccount, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "accountobjectid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AccountTenantId, AccountObjectId, UserAccount, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "useraccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AccountTenantId, AccountObjectId, UserAccount, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend CompromisedEntity = iff(CompromisedEntity == \"N/A\" or isempty(CompromisedEntity), UserAccount, CompromisedEntity)",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "compromisedentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Alert_UnfamiliarSignInProps_Time = TimeGenerated",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "alert_unfamiliarsigninprops_time",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Alert_UnfamiliarSignInProps_Name = AlertName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "alert_unfamiliarsigninprops_name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Alert_UnfamiliarSignInProps_Severity = AlertSeverity",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "alert_unfamiliarsigninprops_severity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AadTenantId, AadUserId, AccountTenantId, AccountObjectId, Alert_UnfamiliarSignInProps_Name, Alert_UnfamiliarSignInProps_Severity, Alert_UnfamiliarSignInProps_Time, UserAccount, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "aadtenantid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AadTenantId, AadUserId, AccountTenantId, AccountObjectId, Alert_UnfamiliarSignInProps_Name, Alert_UnfamiliarSignInProps_Severity, Alert_UnfamiliarSignInProps_Time, UserAccount, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "aaduserid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AadTenantId, AadUserId, AccountTenantId, AccountObjectId, Alert_UnfamiliarSignInProps_Name, Alert_UnfamiliarSignInProps_Severity, Alert_UnfamiliarSignInProps_Time, UserAccount, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "accounttenantid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AadTenantId, AadUserId, AccountTenantId, AccountObjectId, Alert_UnfamiliarSignInProps_Name, Alert_UnfamiliarSignInProps_Severity, Alert_UnfamiliarSignInProps_Time, UserAccount, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "accountobjectid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AadTenantId, AadUserId, AccountTenantId, AccountObjectId, Alert_UnfamiliarSignInProps_Name, Alert_UnfamiliarSignInProps_Severity, Alert_UnfamiliarSignInProps_Time, UserAccount, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "alert_unfamiliarsigninprops_name",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AadTenantId, AadUserId, AccountTenantId, AccountObjectId, Alert_UnfamiliarSignInProps_Name, Alert_UnfamiliarSignInProps_Severity, Alert_UnfamiliarSignInProps_Time, UserAccount, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "alert_unfamiliarsigninprops_severity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AadTenantId, AadUserId, AccountTenantId, AccountObjectId, Alert_UnfamiliarSignInProps_Name, Alert_UnfamiliarSignInProps_Severity, Alert_UnfamiliarSignInProps_Time, UserAccount, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "alert_unfamiliarsigninprops_time",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AadTenantId, AadUserId, AccountTenantId, AccountObjectId, Alert_UnfamiliarSignInProps_Name, Alert_UnfamiliarSignInProps_Severity, Alert_UnfamiliarSignInProps_Time, UserAccount, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "useraccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AadTenantId, AadUserId, AccountTenantId, AccountObjectId, Alert_UnfamiliarSignInProps_Name, Alert_UnfamiliarSignInProps_Severity, Alert_UnfamiliarSignInProps_Time, UserAccount, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AadTenantId = tostring(Entity.AadTenantId)",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "aadtenantid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AadUserId = tostring(Entity.AadUserId)",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "aaduserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = AccountDisplayName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserAccount = AccountUPN",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "useraccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AccountTenantId, AccountObjectId, UserAccount, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "accounttenantid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AccountTenantId, AccountObjectId, UserAccount, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "accountobjectid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AccountTenantId, AccountObjectId, UserAccount, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "useraccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AccountTenantId, AccountObjectId, UserAccount, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend CompromisedEntity = iff(CompromisedEntity == \"N/A\" or isempty(CompromisedEntity), UserAccount, CompromisedEntity)",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "compromisedentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Alert_AtypicalTravels_Time = TimeGenerated",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "alert_atypicaltravels_time",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Alert_AtypicalTravels_Name = AlertName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "alert_atypicaltravels_name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Alert_AtypicalTravels_Severity = AlertSeverity",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "alert_atypicaltravels_severity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ExtendedProperties_json= parse_json(ExtendedProperties)",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "extendedproperties_json",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend CurrentLocation = tostring(ExtendedProperties_json.[\"Current Location\"])",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "currentlocation",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend PreviousLocation = tostring(ExtendedProperties_json.[\"Previous Location\"])",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "previouslocation",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend CurrentIPAddress = tostring(ExtendedProperties_json.[\"Current IP Address\"])",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "currentipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend PreviousIPAddress = tostring(ExtendedProperties_json.[\"Previous IP Address\"])",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "previousipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project AadTenantId, AadUserId, AccountTenantId, AccountObjectId, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, CurrentIPAddress, PreviousIPAddress, CurrentLocation, PreviousLocation, UserAccount, UserName, CompromisedEntity",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "aadtenantid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AadTenantId, AadUserId, AccountTenantId, AccountObjectId, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, CurrentIPAddress, PreviousIPAddress, CurrentLocation, PreviousLocation, UserAccount, UserName, CompromisedEntity",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "aaduserid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AadTenantId, AadUserId, AccountTenantId, AccountObjectId, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, CurrentIPAddress, PreviousIPAddress, CurrentLocation, PreviousLocation, UserAccount, UserName, CompromisedEntity",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "accounttenantid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AadTenantId, AadUserId, AccountTenantId, AccountObjectId, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, CurrentIPAddress, PreviousIPAddress, CurrentLocation, PreviousLocation, UserAccount, UserName, CompromisedEntity",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "accountobjectid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AadTenantId, AadUserId, AccountTenantId, AccountObjectId, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, CurrentIPAddress, PreviousIPAddress, CurrentLocation, PreviousLocation, UserAccount, UserName, CompromisedEntity",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "alert_atypicaltravels_name",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AadTenantId, AadUserId, AccountTenantId, AccountObjectId, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, CurrentIPAddress, PreviousIPAddress, CurrentLocation, PreviousLocation, UserAccount, UserName, CompromisedEntity",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "alert_atypicaltravels_severity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AadTenantId, AadUserId, AccountTenantId, AccountObjectId, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, CurrentIPAddress, PreviousIPAddress, CurrentLocation, PreviousLocation, UserAccount, UserName, CompromisedEntity",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "alert_atypicaltravels_time",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AadTenantId, AadUserId, AccountTenantId, AccountObjectId, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, CurrentIPAddress, PreviousIPAddress, CurrentLocation, PreviousLocation, UserAccount, UserName, CompromisedEntity",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "currentipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project AadTenantId, AadUserId, AccountTenantId, AccountObjectId, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, CurrentIPAddress, PreviousIPAddress, CurrentLocation, PreviousLocation, UserAccount, UserName, CompromisedEntity",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "previousipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project AadTenantId, AadUserId, AccountTenantId, AccountObjectId, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, CurrentIPAddress, PreviousIPAddress, CurrentLocation, PreviousLocation, UserAccount, UserName, CompromisedEntity",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "currentlocation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AadTenantId, AadUserId, AccountTenantId, AccountObjectId, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, CurrentIPAddress, PreviousIPAddress, CurrentLocation, PreviousLocation, UserAccount, UserName, CompromisedEntity",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "previouslocation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AadTenantId, AadUserId, AccountTenantId, AccountObjectId, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, CurrentIPAddress, PreviousIPAddress, CurrentLocation, PreviousLocation, UserAccount, UserName, CompromisedEntity",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "useraccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AadTenantId, AadUserId, AccountTenantId, AccountObjectId, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, CurrentIPAddress, PreviousIPAddress, CurrentLocation, PreviousLocation, UserAccount, UserName, CompromisedEntity",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AadTenantId, AadUserId, AccountTenantId, AccountObjectId, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, CurrentIPAddress, PreviousIPAddress, CurrentLocation, PreviousLocation, UserAccount, UserName, CompromisedEntity",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "compromisedentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TimeDelta = Alert_UnfamiliarSignInProps_Time - Alert_AtypicalTravels_Time",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "timedelta",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project UserAccount, AadUserId, Alert_UnfamiliarSignInProps_Name, Alert_UnfamiliarSignInProps_Severity, Alert_UnfamiliarSignInProps_Time, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, TimeDelta, CurrentLocation, PreviousLocation, CurrentIPAddress, PreviousIPAddress, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "useraccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project UserAccount, AadUserId, Alert_UnfamiliarSignInProps_Name, Alert_UnfamiliarSignInProps_Severity, Alert_UnfamiliarSignInProps_Time, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, TimeDelta, CurrentLocation, PreviousLocation, CurrentIPAddress, PreviousIPAddress, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "aaduserid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project UserAccount, AadUserId, Alert_UnfamiliarSignInProps_Name, Alert_UnfamiliarSignInProps_Severity, Alert_UnfamiliarSignInProps_Time, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, TimeDelta, CurrentLocation, PreviousLocation, CurrentIPAddress, PreviousIPAddress, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "alert_unfamiliarsigninprops_name",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project UserAccount, AadUserId, Alert_UnfamiliarSignInProps_Name, Alert_UnfamiliarSignInProps_Severity, Alert_UnfamiliarSignInProps_Time, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, TimeDelta, CurrentLocation, PreviousLocation, CurrentIPAddress, PreviousIPAddress, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "alert_unfamiliarsigninprops_severity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project UserAccount, AadUserId, Alert_UnfamiliarSignInProps_Name, Alert_UnfamiliarSignInProps_Severity, Alert_UnfamiliarSignInProps_Time, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, TimeDelta, CurrentLocation, PreviousLocation, CurrentIPAddress, PreviousIPAddress, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "alert_unfamiliarsigninprops_time",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project UserAccount, AadUserId, Alert_UnfamiliarSignInProps_Name, Alert_UnfamiliarSignInProps_Severity, Alert_UnfamiliarSignInProps_Time, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, TimeDelta, CurrentLocation, PreviousLocation, CurrentIPAddress, PreviousIPAddress, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "alert_atypicaltravels_name",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project UserAccount, AadUserId, Alert_UnfamiliarSignInProps_Name, Alert_UnfamiliarSignInProps_Severity, Alert_UnfamiliarSignInProps_Time, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, TimeDelta, CurrentLocation, PreviousLocation, CurrentIPAddress, PreviousIPAddress, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "alert_atypicaltravels_severity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project UserAccount, AadUserId, Alert_UnfamiliarSignInProps_Name, Alert_UnfamiliarSignInProps_Severity, Alert_UnfamiliarSignInProps_Time, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, TimeDelta, CurrentLocation, PreviousLocation, CurrentIPAddress, PreviousIPAddress, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "alert_atypicaltravels_time",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project UserAccount, AadUserId, Alert_UnfamiliarSignInProps_Name, Alert_UnfamiliarSignInProps_Severity, Alert_UnfamiliarSignInProps_Time, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, TimeDelta, CurrentLocation, PreviousLocation, CurrentIPAddress, PreviousIPAddress, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "timedelta",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project UserAccount, AadUserId, Alert_UnfamiliarSignInProps_Name, Alert_UnfamiliarSignInProps_Severity, Alert_UnfamiliarSignInProps_Time, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, TimeDelta, CurrentLocation, PreviousLocation, CurrentIPAddress, PreviousIPAddress, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "currentlocation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project UserAccount, AadUserId, Alert_UnfamiliarSignInProps_Name, Alert_UnfamiliarSignInProps_Severity, Alert_UnfamiliarSignInProps_Time, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, TimeDelta, CurrentLocation, PreviousLocation, CurrentIPAddress, PreviousIPAddress, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "previouslocation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project UserAccount, AadUserId, Alert_UnfamiliarSignInProps_Name, Alert_UnfamiliarSignInProps_Severity, Alert_UnfamiliarSignInProps_Time, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, TimeDelta, CurrentLocation, PreviousLocation, CurrentIPAddress, PreviousIPAddress, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "currentipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project UserAccount, AadUserId, Alert_UnfamiliarSignInProps_Name, Alert_UnfamiliarSignInProps_Severity, Alert_UnfamiliarSignInProps_Time, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, TimeDelta, CurrentLocation, PreviousLocation, CurrentIPAddress, PreviousIPAddress, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "previousipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project UserAccount, AadUserId, Alert_UnfamiliarSignInProps_Name, Alert_UnfamiliarSignInProps_Severity, Alert_UnfamiliarSignInProps_Time, Alert_AtypicalTravels_Name, Alert_AtypicalTravels_Severity, Alert_AtypicalTravels_Time, TimeDelta, CurrentLocation, PreviousLocation, CurrentIPAddress, PreviousIPAddress, UserName",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserEmailName = split(UserAccount,'@')[0], UPNSuffix = split(UserAccount,'@')[1]",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "useremailname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserEmailName = split(UserAccount,'@')[0], UPNSuffix = split(UserAccount,'@')[1]",
    "detection": "correlateipc-unfamiliar-atypical.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SessionBlockedStarted = row_window_session(TimeGenerated, queryperiod, 10m, ((clientIp_s != prev(clientIp_s)) or (hostname_s != prev(hostname_s))))",
    "detection": "maliciouswafsessions.yaml",
    "field": "sessionblockedstarted",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SessionBlockedEnded = max(TimeGenerated), SessionBlockedCount = count() by hostname_s, clientIp_s, SessionBlockedStarted",
    "detection": "maliciouswafsessions.yaml",
    "field": "sessionblockedended",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SessionBlockedEnded = max(TimeGenerated), SessionBlockedCount = count() by hostname_s, clientIp_s, SessionBlockedStarted",
    "detection": "maliciouswafsessions.yaml",
    "field": "sessionblockedcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SessionBlockedEnded = max(TimeGenerated), SessionBlockedCount = count() by hostname_s, clientIp_s, SessionBlockedStarted",
    "detection": "maliciouswafsessions.yaml",
    "field": "hostname_s",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SessionBlockedEnded = max(TimeGenerated), SessionBlockedCount = count() by hostname_s, clientIp_s, SessionBlockedStarted",
    "detection": "maliciouswafsessions.yaml",
    "field": "clientip_s",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SessionBlockedEnded = max(TimeGenerated), SessionBlockedCount = count() by hostname_s, clientIp_s, SessionBlockedStarted",
    "detection": "maliciouswafsessions.yaml",
    "field": "sessionblockedstarted",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TimeKey = range(bin(SessionBlockedStarted, sessionBin), bin(SessionBlockedEnded, sessionBin), sessionBin)",
    "detection": "maliciouswafsessions.yaml",
    "field": "timekey",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TimeKey = bin(TimeGenerated, sessionBin)",
    "detection": "maliciouswafsessions.yaml",
    "field": "timekey",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend hostname_s = coalesce(hostname_s,host_s), clientIp_s = coalesce(clientIp_s,clientIP_s)",
    "detection": "maliciouswafsessions.yaml",
    "field": "hostname_s",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "    | extend hostname_s = coalesce(hostname_s,host_s), clientIp_s = coalesce(clientIp_s,clientIP_s)",
    "detection": "maliciouswafsessions.yaml",
    "field": "clientip_s",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend BlockvsSuccessRatio = SessionBlockedCount/toreal(SuccessfulAccessCount)",
    "detection": "maliciouswafsessions.yaml",
    "field": "blockvssuccessratio",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "appgwwaf-sqlidetection.yaml",
    "field": "transactionid_g",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "appgwwaf-sqlidetection.yaml",
    "field": "hostname_s",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "appgwwaf-sqlidetection.yaml",
    "field": "requesturi_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "appgwwaf-sqlidetection.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "appgwwaf-sqlidetection.yaml",
    "field": "clientip_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "appgwwaf-sqlidetection.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "appgwwaf-sqlidetection.yaml",
    "field": "details_message_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "appgwwaf-sqlidetection.yaml",
    "field": "details_data_s",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Uri = strcat(hostname_s,requestUri_s)",
    "detection": "appgwwaf-sqlidetection.yaml",
    "field": "uri",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s, SQLI_Score, TotalInboundScore",
    "detection": "appgwwaf-sqlidetection.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s, SQLI_Score, TotalInboundScore",
    "detection": "appgwwaf-sqlidetection.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s, SQLI_Score, TotalInboundScore",
    "detection": "appgwwaf-sqlidetection.yaml",
    "field": "transactionid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s, SQLI_Score, TotalInboundScore",
    "detection": "appgwwaf-sqlidetection.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s, SQLI_Score, TotalInboundScore",
    "detection": "appgwwaf-sqlidetection.yaml",
    "field": "detail_message",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s, SQLI_Score, TotalInboundScore",
    "detection": "appgwwaf-sqlidetection.yaml",
    "field": "detail_data",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s, SQLI_Score, TotalInboundScore",
    "detection": "appgwwaf-sqlidetection.yaml",
    "field": "total_transactionid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s, SQLI_Score, TotalInboundScore",
    "detection": "appgwwaf-sqlidetection.yaml",
    "field": "clientip_s",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s, SQLI_Score, TotalInboundScore",
    "detection": "appgwwaf-sqlidetection.yaml",
    "field": "uri",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s, SQLI_Score, TotalInboundScore",
    "detection": "appgwwaf-sqlidetection.yaml",
    "field": "action_s",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s, SQLI_Score, TotalInboundScore",
    "detection": "appgwwaf-sqlidetection.yaml",
    "field": "sqli_score",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s, SQLI_Score, TotalInboundScore",
    "detection": "appgwwaf-sqlidetection.yaml",
    "field": "totalinboundscore",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-waf-path-traversal-attack.yaml",
    "field": "trackingreference_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-waf-path-traversal-attack.yaml",
    "field": "host_s",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-waf-path-traversal-attack.yaml",
    "field": "requesturi_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-waf-path-traversal-attack.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-waf-path-traversal-attack.yaml",
    "field": "clientip_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-waf-path-traversal-attack.yaml",
    "field": "details_matches_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-waf-path-traversal-attack.yaml",
    "field": "details_msg_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-waf-path-traversal-attack.yaml",
    "field": "details_data_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-waf-path-traversal-attack.yaml",
    "field": "tablename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-waf-path-traversal-attack.yaml",
    "field": "matcheddata",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-waf-path-traversal-attack.yaml",
    "field": "uri_s",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-waf-path-traversal-attack.yaml",
    "field": "table",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-waf-path-traversal-attack.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-waf-path-traversal-attack.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-waf-path-traversal-attack.yaml",
    "field": "trackingreference",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-waf-path-traversal-attack.yaml",
    "field": "matched_data",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-waf-path-traversal-attack.yaml",
    "field": "detail_data",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-waf-path-traversal-attack.yaml",
    "field": "detail_message",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-waf-path-traversal-attack.yaml",
    "field": "total_trackingreference",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-waf-path-traversal-attack.yaml",
    "field": "clientip_s",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-waf-path-traversal-attack.yaml",
    "field": "host_s",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-waf-path-traversal-attack.yaml",
    "field": "action_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "app-gw-waf-code-injection.yaml",
    "field": "transactionid_g",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "app-gw-waf-code-injection.yaml",
    "field": "hostname_s",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "app-gw-waf-code-injection.yaml",
    "field": "requesturi_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "app-gw-waf-code-injection.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "app-gw-waf-code-injection.yaml",
    "field": "clientip_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "app-gw-waf-code-injection.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "app-gw-waf-code-injection.yaml",
    "field": "details_message_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "app-gw-waf-code-injection.yaml",
    "field": "details_data_s",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Uri = strcat(hostname_s,requestUri_s)",
    "detection": "app-gw-waf-code-injection.yaml",
    "field": "uri",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g,100), Message = make_set(Message,100), Detail_Message = make_set(details_message_s,100), Detail_Data = make_set(details_data_s,100), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-code-injection.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g,100), Message = make_set(Message,100), Detail_Message = make_set(details_message_s,100), Detail_Data = make_set(details_data_s,100), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-code-injection.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g,100), Message = make_set(Message,100), Detail_Message = make_set(details_message_s,100), Detail_Data = make_set(details_data_s,100), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-code-injection.yaml",
    "field": "transactionid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g,100), Message = make_set(Message,100), Detail_Message = make_set(details_message_s,100), Detail_Data = make_set(details_data_s,100), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-code-injection.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g,100), Message = make_set(Message,100), Detail_Message = make_set(details_message_s,100), Detail_Data = make_set(details_data_s,100), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-code-injection.yaml",
    "field": "detail_message",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g,100), Message = make_set(Message,100), Detail_Message = make_set(details_message_s,100), Detail_Data = make_set(details_data_s,100), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-code-injection.yaml",
    "field": "detail_data",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g,100), Message = make_set(Message,100), Detail_Message = make_set(details_message_s,100), Detail_Data = make_set(details_data_s,100), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-code-injection.yaml",
    "field": "total_transactionid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g,100), Message = make_set(Message,100), Detail_Message = make_set(details_message_s,100), Detail_Data = make_set(details_data_s,100), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-code-injection.yaml",
    "field": "clientip_s",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g,100), Message = make_set(Message,100), Detail_Message = make_set(details_message_s,100), Detail_Data = make_set(details_data_s,100), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-code-injection.yaml",
    "field": "uri",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g,100), Message = make_set(Message,100), Detail_Message = make_set(details_message_s,100), Detail_Data = make_set(details_data_s,100), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-code-injection.yaml",
    "field": "action_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-premium-waf-xssdetection.yaml",
    "field": "trackingreference_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-premium-waf-xssdetection.yaml",
    "field": "host_s",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-premium-waf-xssdetection.yaml",
    "field": "requesturi_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-premium-waf-xssdetection.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-premium-waf-xssdetection.yaml",
    "field": "clientip_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-premium-waf-xssdetection.yaml",
    "field": "details_matches_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-premium-waf-xssdetection.yaml",
    "field": "details_msg_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-premium-waf-xssdetection.yaml",
    "field": "details_data_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-premium-waf-xssdetection.yaml",
    "field": "tablename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-premium-waf-xssdetection.yaml",
    "field": "matcheddata",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-premium-waf-xssdetection.yaml",
    "field": "uri_s",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-premium-waf-xssdetection.yaml",
    "field": "table",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-premium-waf-xssdetection.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-premium-waf-xssdetection.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-premium-waf-xssdetection.yaml",
    "field": "trackingreference",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-premium-waf-xssdetection.yaml",
    "field": "matched_data",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-premium-waf-xssdetection.yaml",
    "field": "detail_data",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-premium-waf-xssdetection.yaml",
    "field": "detail_message",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-premium-waf-xssdetection.yaml",
    "field": "total_trackingreference",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-premium-waf-xssdetection.yaml",
    "field": "clientip_s",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-premium-waf-xssdetection.yaml",
    "field": "host_s",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-premium-waf-xssdetection.yaml",
    "field": "action_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-premium-waf-sqlidetection.yaml",
    "field": "trackingreference_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-premium-waf-sqlidetection.yaml",
    "field": "host_s",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-premium-waf-sqlidetection.yaml",
    "field": "requesturi_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-premium-waf-sqlidetection.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-premium-waf-sqlidetection.yaml",
    "field": "clientip_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-premium-waf-sqlidetection.yaml",
    "field": "details_matches_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-premium-waf-sqlidetection.yaml",
    "field": "details_msg_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-premium-waf-sqlidetection.yaml",
    "field": "details_data_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-premium-waf-sqlidetection.yaml",
    "field": "tablename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-premium-waf-sqlidetection.yaml",
    "field": "matcheddata",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-premium-waf-sqlidetection.yaml",
    "field": "uri_s",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-premium-waf-sqlidetection.yaml",
    "field": "table",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-premium-waf-sqlidetection.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-premium-waf-sqlidetection.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-premium-waf-sqlidetection.yaml",
    "field": "trackingreference",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-premium-waf-sqlidetection.yaml",
    "field": "matched_data",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-premium-waf-sqlidetection.yaml",
    "field": "detail_data",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-premium-waf-sqlidetection.yaml",
    "field": "detail_message",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-premium-waf-sqlidetection.yaml",
    "field": "total_trackingreference",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-premium-waf-sqlidetection.yaml",
    "field": "clientip_s",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-premium-waf-sqlidetection.yaml",
    "field": "host_s",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-premium-waf-sqlidetection.yaml",
    "field": "action_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-waf-code-injection.yaml",
    "field": "trackingreference_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-waf-code-injection.yaml",
    "field": "host_s",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-waf-code-injection.yaml",
    "field": "requesturi_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-waf-code-injection.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-waf-code-injection.yaml",
    "field": "clientip_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-waf-code-injection.yaml",
    "field": "details_matches_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-waf-code-injection.yaml",
    "field": "details_msg_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-waf-code-injection.yaml",
    "field": "details_data_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-waf-code-injection.yaml",
    "field": "tablename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project trackingReference_s, host_s, requestUri_s, TimeGenerated, clientIP_s, details_matches_s, details_msg_s, details_data_s, TableName, MatchedData",
    "detection": "afd-waf-code-injection.yaml",
    "field": "matcheddata",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-waf-code-injection.yaml",
    "field": "uri_s",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-waf-code-injection.yaml",
    "field": "table",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-waf-code-injection.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-waf-code-injection.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-waf-code-injection.yaml",
    "field": "trackingreference",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-waf-code-injection.yaml",
    "field": "matched_data",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-waf-code-injection.yaml",
    "field": "detail_data",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-waf-code-injection.yaml",
    "field": "detail_message",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-waf-code-injection.yaml",
    "field": "total_trackingreference",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-waf-code-injection.yaml",
    "field": "clientip_s",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-waf-code-injection.yaml",
    "field": "host_s",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize URI_s = make_set(requestUri_s,100), Table = make_set(TableName,100), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TrackingReference = make_set(trackingReference_s,100), Matched_Data = make_set(MatchedData,100), Detail_Data = make_set(details_data_s,100), Detail_Message = make_set(details_msg_s,100), Total_TrackingReference = dcount(trackingReference_s) by clientIP_s, host_s, action_s",
    "detection": "afd-waf-code-injection.yaml",
    "field": "action_s",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend details_data_s = column_ifexists(\"details_data_s\", tostring(AdditionalFields.details_data))",
    "detection": "azurewafmatching-log4j-vuln.yaml",
    "field": "details_data_s",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Malicious = iff(isnotempty( details_data_s),details_data_s,iff(isnotempty( requestUri_s),requestUri_s,\"\"))",
    "detection": "azurewafmatching-log4j-vuln.yaml",
    "field": "malicious",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EncodeCmd = iff(MaliciousCommand has 'Base64/', split(split(MaliciousCommand, \"Base64/\",1)[0], \"}\", 0)[0], \"\")",
    "detection": "azurewafmatching-log4j-vuln.yaml",
    "field": "encodecmd",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EncodeCmd1 = iff(MaliciousCommand has 'base64/', split(split(MaliciousCommand, \"base64/\",1)[0], \"}\", 0)[0], \"\")",
    "detection": "azurewafmatching-log4j-vuln.yaml",
    "field": "encodecmd1",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend CmdLine = iff( isnotempty(EncodeCmd), EncodeCmd, EncodeCmd1)",
    "detection": "azurewafmatching-log4j-vuln.yaml",
    "field": "cmdline",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DecodedCmdLine = base64_decode_tostring(tostring(CmdLine))",
    "detection": "azurewafmatching-log4j-vuln.yaml",
    "field": "decodedcmdline",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DecodedCmdLine = iff( isnotempty(DecodedCmdLine), DecodedCmdLine, \"Unable to decode/Doesn't need decoding\")",
    "detection": "azurewafmatching-log4j-vuln.yaml",
    "field": "decodedcmdline",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Target=column_ifexists(\"hostname_s\", tostring(AdditionalFields.hostname)), MaliciousHost = column_ifexists(\"clientIp_s\", tostring(AdditionalFields.clientIp)) , MaliciousCommand, details_data_s = column_ifexists(\"details_data_s\", tostring(AdditionalFields.details_data)), DecodedCmdLine, Message,",
    "detection": "azurewafmatching-log4j-vuln.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Target=column_ifexists(\"hostname_s\", tostring(AdditionalFields.hostname)), MaliciousHost = column_ifexists(\"clientIp_s\", tostring(AdditionalFields.clientIp)) , MaliciousCommand, details_data_s = column_ifexists(\"details_data_s\", tostring(AdditionalFields.details_data)), DecodedCmdLine, Message,",
    "detection": "azurewafmatching-log4j-vuln.yaml",
    "field": "target",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Target=column_ifexists(\"hostname_s\", tostring(AdditionalFields.hostname)), MaliciousHost = column_ifexists(\"clientIp_s\", tostring(AdditionalFields.clientIp)) , MaliciousCommand, details_data_s = column_ifexists(\"details_data_s\", tostring(AdditionalFields.details_data)), DecodedCmdLine, Message,",
    "detection": "azurewafmatching-log4j-vuln.yaml",
    "field": "malicioushost",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Target=column_ifexists(\"hostname_s\", tostring(AdditionalFields.hostname)), MaliciousHost = column_ifexists(\"clientIp_s\", tostring(AdditionalFields.clientIp)) , MaliciousCommand, details_data_s = column_ifexists(\"details_data_s\", tostring(AdditionalFields.details_data)), DecodedCmdLine, Message,",
    "detection": "azurewafmatching-log4j-vuln.yaml",
    "field": "maliciouscommand",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Target=column_ifexists(\"hostname_s\", tostring(AdditionalFields.hostname)), MaliciousHost = column_ifexists(\"clientIp_s\", tostring(AdditionalFields.clientIp)) , MaliciousCommand, details_data_s = column_ifexists(\"details_data_s\", tostring(AdditionalFields.details_data)), DecodedCmdLine, Message,",
    "detection": "azurewafmatching-log4j-vuln.yaml",
    "field": "details_data_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Target=column_ifexists(\"hostname_s\", tostring(AdditionalFields.hostname)), MaliciousHost = column_ifexists(\"clientIp_s\", tostring(AdditionalFields.clientIp)) , MaliciousCommand, details_data_s = column_ifexists(\"details_data_s\", tostring(AdditionalFields.details_data)), DecodedCmdLine, Message,",
    "detection": "azurewafmatching-log4j-vuln.yaml",
    "field": "decodedcmdline",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Target=column_ifexists(\"hostname_s\", tostring(AdditionalFields.hostname)), MaliciousHost = column_ifexists(\"clientIp_s\", tostring(AdditionalFields.clientIp)) , MaliciousCommand, details_data_s = column_ifexists(\"details_data_s\", tostring(AdditionalFields.details_data)), DecodedCmdLine, Message,",
    "detection": "azurewafmatching-log4j-vuln.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "azurewafmatching-log4j-vuln.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": " | project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "appgwwaf-xssdetection.yaml",
    "field": "transactionid_g",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": " | project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "appgwwaf-xssdetection.yaml",
    "field": "hostname_s",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": " | project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "appgwwaf-xssdetection.yaml",
    "field": "requesturi_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": " | project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "appgwwaf-xssdetection.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": " | project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "appgwwaf-xssdetection.yaml",
    "field": "clientip_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": " | project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "appgwwaf-xssdetection.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": " | project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "appgwwaf-xssdetection.yaml",
    "field": "details_message_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": " | project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "appgwwaf-xssdetection.yaml",
    "field": "details_data_s",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": " | extend Uri = strcat(hostname_s,requestUri_s)",
    "detection": "appgwwaf-xssdetection.yaml",
    "field": "uri",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": " | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s, SQLI_Score, XSS_Score, TotalInboundScore",
    "detection": "appgwwaf-xssdetection.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": " | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s, SQLI_Score, XSS_Score, TotalInboundScore",
    "detection": "appgwwaf-xssdetection.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": " | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s, SQLI_Score, XSS_Score, TotalInboundScore",
    "detection": "appgwwaf-xssdetection.yaml",
    "field": "transactionid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": " | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s, SQLI_Score, XSS_Score, TotalInboundScore",
    "detection": "appgwwaf-xssdetection.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": " | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s, SQLI_Score, XSS_Score, TotalInboundScore",
    "detection": "appgwwaf-xssdetection.yaml",
    "field": "detail_message",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": " | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s, SQLI_Score, XSS_Score, TotalInboundScore",
    "detection": "appgwwaf-xssdetection.yaml",
    "field": "detail_data",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": " | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s, SQLI_Score, XSS_Score, TotalInboundScore",
    "detection": "appgwwaf-xssdetection.yaml",
    "field": "total_transactionid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": " | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s, SQLI_Score, XSS_Score, TotalInboundScore",
    "detection": "appgwwaf-xssdetection.yaml",
    "field": "clientip_s",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": " | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s, SQLI_Score, XSS_Score, TotalInboundScore",
    "detection": "appgwwaf-xssdetection.yaml",
    "field": "uri",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": " | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s, SQLI_Score, XSS_Score, TotalInboundScore",
    "detection": "appgwwaf-xssdetection.yaml",
    "field": "action_s",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": " | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s, SQLI_Score, XSS_Score, TotalInboundScore",
    "detection": "appgwwaf-xssdetection.yaml",
    "field": "sqli_score",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": " | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s, SQLI_Score, XSS_Score, TotalInboundScore",
    "detection": "appgwwaf-xssdetection.yaml",
    "field": "xss_score",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": " | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s, SQLI_Score, XSS_Score, TotalInboundScore",
    "detection": "appgwwaf-xssdetection.yaml",
    "field": "totalinboundscore",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "app-gw-waf-scanner-detection.yaml",
    "field": "transactionid_g",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "app-gw-waf-scanner-detection.yaml",
    "field": "hostname_s",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "app-gw-waf-scanner-detection.yaml",
    "field": "requesturi_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "app-gw-waf-scanner-detection.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "app-gw-waf-scanner-detection.yaml",
    "field": "clientip_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "app-gw-waf-scanner-detection.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "app-gw-waf-scanner-detection.yaml",
    "field": "details_message_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "app-gw-waf-scanner-detection.yaml",
    "field": "details_data_s",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Uri = strcat(hostname_s,requestUri_s)",
    "detection": "app-gw-waf-scanner-detection.yaml",
    "field": "uri",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-scanner-detection.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-scanner-detection.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-scanner-detection.yaml",
    "field": "transactionid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-scanner-detection.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-scanner-detection.yaml",
    "field": "detail_message",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-scanner-detection.yaml",
    "field": "detail_data",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-scanner-detection.yaml",
    "field": "total_transactionid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-scanner-detection.yaml",
    "field": "clientip_s",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-scanner-detection.yaml",
    "field": "uri",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g), Message = make_set(Message), Detail_Message = make_set(details_message_s), Detail_Data = make_set(details_data_s), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-scanner-detection.yaml",
    "field": "action_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "app-gw-waf-path-traversal-attack.yaml",
    "field": "transactionid_g",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "app-gw-waf-path-traversal-attack.yaml",
    "field": "hostname_s",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "app-gw-waf-path-traversal-attack.yaml",
    "field": "requesturi_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "app-gw-waf-path-traversal-attack.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "app-gw-waf-path-traversal-attack.yaml",
    "field": "clientip_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "app-gw-waf-path-traversal-attack.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "app-gw-waf-path-traversal-attack.yaml",
    "field": "details_message_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project transactionId_g, hostname_s, requestUri_s, TimeGenerated, clientIp_s, Message, details_message_s, details_data_s",
    "detection": "app-gw-waf-path-traversal-attack.yaml",
    "field": "details_data_s",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Uri = strcat(hostname_s,requestUri_s)",
    "detection": "app-gw-waf-path-traversal-attack.yaml",
    "field": "uri",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g,100), Message = make_set(Message,100), Detail_Message = make_set(details_message_s,100), Detail_Data = make_set(details_data_s,100), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-path-traversal-attack.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g,100), Message = make_set(Message,100), Detail_Message = make_set(details_message_s,100), Detail_Data = make_set(details_data_s,100), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-path-traversal-attack.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g,100), Message = make_set(Message,100), Detail_Message = make_set(details_message_s,100), Detail_Data = make_set(details_data_s,100), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-path-traversal-attack.yaml",
    "field": "transactionid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g,100), Message = make_set(Message,100), Detail_Message = make_set(details_message_s,100), Detail_Data = make_set(details_data_s,100), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-path-traversal-attack.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g,100), Message = make_set(Message,100), Detail_Message = make_set(details_message_s,100), Detail_Data = make_set(details_data_s,100), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-path-traversal-attack.yaml",
    "field": "detail_message",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g,100), Message = make_set(Message,100), Detail_Message = make_set(details_message_s,100), Detail_Data = make_set(details_data_s,100), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-path-traversal-attack.yaml",
    "field": "detail_data",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g,100), Message = make_set(Message,100), Detail_Message = make_set(details_message_s,100), Detail_Data = make_set(details_data_s,100), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-path-traversal-attack.yaml",
    "field": "total_transactionid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g,100), Message = make_set(Message,100), Detail_Message = make_set(details_message_s,100), Detail_Data = make_set(details_data_s,100), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-path-traversal-attack.yaml",
    "field": "clientip_s",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g,100), Message = make_set(Message,100), Detail_Message = make_set(details_message_s,100), Detail_Data = make_set(details_data_s,100), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-path-traversal-attack.yaml",
    "field": "uri",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TransactionID = make_set(transactionId_g,100), Message = make_set(Message,100), Detail_Message = make_set(details_message_s,100), Detail_Data = make_set(details_data_s,100), Total_TransactionId = dcount(transactionId_g) by clientIp_s, Uri, action_s",
    "detection": "app-gw-waf-path-traversal-attack.yaml",
    "field": "action_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-hotwordsoutgoingstatefulanomalyondatabase.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-hotwordsoutgoingstatefulanomalyondatabase.yaml",
    "field": "principalname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-hotwordsoutgoingstatefulanomalyondatabase.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-hotwordsoutgoingstatefulanomalyondatabase.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-hotwordsoutgoingstatefulanomalyondatabase.yaml",
    "field": "resourceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend hasHotword = iff(Statement has_any (hotwords), 1, 0)",
    "detection": "detection-hotwordsoutgoingstatefulanomalyondatabase.yaml",
    "field": "hashotword",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize countEvents = count(), countStatements = dcount(Statement)",
    "detection": "detection-hotwordsoutgoingstatefulanomalyondatabase.yaml",
    "field": "countevents",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize countEvents = count(), countStatements = dcount(Statement)",
    "detection": "detection-hotwordsoutgoingstatefulanomalyondatabase.yaml",
    "field": "countstatements",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend WindowType = case( timeSlice >= ago(detectionWindow), 'detection',",
    "detection": "detection-hotwordsoutgoingstatefulanomalyondatabase.yaml",
    "field": "windowtype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize countSlicesWithHotwords = dcountif(timeSlice, countStatementsWithHotwords >= monitoredStatementsThreshold)",
    "detection": "detection-hotwordsoutgoingstatefulanomalyondatabase.yaml",
    "field": "countsliceswithhotwords",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IsHotwordAnomalyOnStatement = iff(((countStatementsWithHotwords >= monitoredStatementsThreshold) and (countSlicesWithHotwords <= trainingSlicesThreshold)), true, false)",
    "detection": "detection-hotwordsoutgoingstatefulanomalyondatabase.yaml",
    "field": "ishotwordanomalyonstatement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(PrincipalName,'@',0)[0]), UPNSuffix = tostring(split(PrincipalName,'@',1)[0])",
    "detection": "detection-hotwordsoutgoingstatefulanomalyondatabase.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(PrincipalName,'@',0)[0]), UPNSuffix = tostring(split(PrincipalName,'@',1)[0])",
    "detection": "detection-hotwordsoutgoingstatefulanomalyondatabase.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-hotwordsfirewallrulestatefulanomalyondatabase.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-hotwordsfirewallrulestatefulanomalyondatabase.yaml",
    "field": "principalname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-hotwordsfirewallrulestatefulanomalyondatabase.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-hotwordsfirewallrulestatefulanomalyondatabase.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-hotwordsfirewallrulestatefulanomalyondatabase.yaml",
    "field": "resourceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend hasHotword = iff(Statement has_any (hotwords), 1, 0)",
    "detection": "detection-hotwordsfirewallrulestatefulanomalyondatabase.yaml",
    "field": "hashotword",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize countEvents = count(), countStatements = dcount(Statement)",
    "detection": "detection-hotwordsfirewallrulestatefulanomalyondatabase.yaml",
    "field": "countevents",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize countEvents = count(), countStatements = dcount(Statement)",
    "detection": "detection-hotwordsfirewallrulestatefulanomalyondatabase.yaml",
    "field": "countstatements",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend WindowType = case( timeSlice >= ago(detectionWindow), 'detection',",
    "detection": "detection-hotwordsfirewallrulestatefulanomalyondatabase.yaml",
    "field": "windowtype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize countSlicesWithHotwords = dcountif(timeSlice, countStatementsWithHotwords >= monitoredStatementsThreshold)",
    "detection": "detection-hotwordsfirewallrulestatefulanomalyondatabase.yaml",
    "field": "countsliceswithhotwords",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IsHotwordAnomalyOnStatement = iff(((countStatementsWithHotwords >= monitoredStatementsThreshold) and (countSlicesWithHotwords <= trainingSlicesThreshold)), true, false)",
    "detection": "detection-hotwordsfirewallrulestatefulanomalyondatabase.yaml",
    "field": "ishotwordanomalyonstatement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(PrincipalName,'@',0)[0]), UPNSuffix = tostring(split(PrincipalName,'@',1)[0])",
    "detection": "detection-hotwordsfirewallrulestatefulanomalyondatabase.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(PrincipalName,'@',0)[0]), UPNSuffix = tostring(split(PrincipalName,'@',1)[0])",
    "detection": "detection-hotwordsfirewallrulestatefulanomalyondatabase.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-errorscredentialstatefulanomalyondatabase.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-errorscredentialstatefulanomalyondatabase.yaml",
    "field": "principalname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-errorscredentialstatefulanomalyondatabase.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-errorscredentialstatefulanomalyondatabase.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-errorscredentialstatefulanomalyondatabase.yaml",
    "field": "resourceid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize countEvents = count(), countStatements = dcount(Statement), countStatementsWithError = dcountif(Statement, Error in (monitoredErrors))",
    "detection": "detection-errorscredentialstatefulanomalyondatabase.yaml",
    "field": "countevents",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize countEvents = count(), countStatements = dcount(Statement), countStatementsWithError = dcountif(Statement, Error in (monitoredErrors))",
    "detection": "detection-errorscredentialstatefulanomalyondatabase.yaml",
    "field": "countstatements",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize countEvents = count(), countStatements = dcount(Statement), countStatementsWithError = dcountif(Statement, Error in (monitoredErrors))",
    "detection": "detection-errorscredentialstatefulanomalyondatabase.yaml",
    "field": "countstatementswitherror",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend WindowType = case( timeSlice >= ago(detectionWindow), 'detection',",
    "detection": "detection-errorscredentialstatefulanomalyondatabase.yaml",
    "field": "windowtype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize countSlicesWithErrors = dcountif(timeSlice, countStatementsWithError >= monitoredStatementsThreshold)",
    "detection": "detection-errorscredentialstatefulanomalyondatabase.yaml",
    "field": "countsliceswitherrors",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IsErrorAnomalyOnStatement = iff(((countStatementsWithError >= monitoredStatementsThreshold) and (countSlicesWithErrors <= trainingSlicesThreshold)), true, false)",
    "detection": "detection-errorscredentialstatefulanomalyondatabase.yaml",
    "field": "iserroranomalyonstatement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(PrincipalName,'@',0)[0]), UPNSuffix = tostring(split(PrincipalName,'@',1)[0])",
    "detection": "detection-errorscredentialstatefulanomalyondatabase.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(PrincipalName,'@',0)[0]), UPNSuffix = tostring(split(PrincipalName,'@',1)[0])",
    "detection": "detection-errorscredentialstatefulanomalyondatabase.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-errorssyntaxstatefulanomalyondatabase.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-errorssyntaxstatefulanomalyondatabase.yaml",
    "field": "principalname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-errorssyntaxstatefulanomalyondatabase.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-errorssyntaxstatefulanomalyondatabase.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-errorssyntaxstatefulanomalyondatabase.yaml",
    "field": "resourceid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize countEvents = count(), countStatements = dcount(Statement), countStatementsWithError = dcountif(Statement, Error in (monitoredErrors))",
    "detection": "detection-errorssyntaxstatefulanomalyondatabase.yaml",
    "field": "countevents",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize countEvents = count(), countStatements = dcount(Statement), countStatementsWithError = dcountif(Statement, Error in (monitoredErrors))",
    "detection": "detection-errorssyntaxstatefulanomalyondatabase.yaml",
    "field": "countstatements",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize countEvents = count(), countStatements = dcount(Statement), countStatementsWithError = dcountif(Statement, Error in (monitoredErrors))",
    "detection": "detection-errorssyntaxstatefulanomalyondatabase.yaml",
    "field": "countstatementswitherror",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend WindowType = case( timeSlice >= ago(detectionWindow), 'detection',",
    "detection": "detection-errorssyntaxstatefulanomalyondatabase.yaml",
    "field": "windowtype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize countSlicesWithErrors = dcountif(timeSlice, countStatementsWithError >= monitoredStatementsThreshold)",
    "detection": "detection-errorssyntaxstatefulanomalyondatabase.yaml",
    "field": "countsliceswitherrors",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IsErrorAnomalyOnStatement = iff(((countStatementsWithError >= monitoredStatementsThreshold) and (countSlicesWithErrors <= trainingSlicesThreshold)), true, false)",
    "detection": "detection-errorssyntaxstatefulanomalyondatabase.yaml",
    "field": "iserroranomalyonstatement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(PrincipalName,'@',0)[0]), UPNSuffix = tostring(split(PrincipalName,'@',1)[0])",
    "detection": "detection-errorssyntaxstatefulanomalyondatabase.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(PrincipalName,'@',0)[0]), UPNSuffix = tostring(split(PrincipalName,'@',1)[0])",
    "detection": "detection-errorssyntaxstatefulanomalyondatabase.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TI_ipEntity = iff(isnotempty(NetworkIP), NetworkIP, NetworkDestinationIP)",
    "detection": "ipentity-azuresql.yaml",
    "field": "ti_ipentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TI_ipEntity = iff(isempty(TI_ipEntity) and isnotempty(NetworkSourceIP), NetworkSourceIP, TI_ipEntity)",
    "detection": "ipentity-azuresql.yaml",
    "field": "ti_ipentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TI_ipEntity = iff(isempty(TI_ipEntity) and isnotempty(EmailSourceIpAddress), EmailSourceIpAddress, TI_ipEntity)",
    "detection": "ipentity-azuresql.yaml",
    "field": "ti_ipentity",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "ipentity-azuresql.yaml",
    "field": "latestindicatortime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "ipentity-azuresql.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend SQLSecurityAuditEvents_TimeGenerated = TimeGenerated",
    "detection": "ipentity-azuresql.yaml",
    "field": "sqlsecurityauditevents_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend ClientIP = column_ifexists(\"client_ip_s\", \"Not Available\")",
    "detection": "ipentity-azuresql.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend Action = column_ifexists(\"action_name_s\", \"Not Available\")",
    "detection": "ipentity-azuresql.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend Application = column_ifexists(\"application_name_s\", \"Not Available\")",
    "detection": "ipentity-azuresql.yaml",
    "field": "application",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend HostName = column_ifexists(\"host_name_s\", \"Not Available\")",
    "detection": "ipentity-azuresql.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize SQLSecurityAuditEvents_TimeGenerated = arg_max(SQLSecurityAuditEvents_TimeGenerated, *) by IndicatorId, ClientIP",
    "detection": "ipentity-azuresql.yaml",
    "field": "sqlsecurityauditevents_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize SQLSecurityAuditEvents_TimeGenerated = arg_max(SQLSecurityAuditEvents_TimeGenerated, *) by IndicatorId, ClientIP",
    "detection": "ipentity-azuresql.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize SQLSecurityAuditEvents_TimeGenerated = arg_max(SQLSecurityAuditEvents_TimeGenerated, *) by IndicatorId, ClientIP",
    "detection": "ipentity-azuresql.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project SQLSecurityAuditEvents_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "ipentity-azuresql.yaml",
    "field": "sqlsecurityauditevents_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project SQLSecurityAuditEvents_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "ipentity-azuresql.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project SQLSecurityAuditEvents_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "ipentity-azuresql.yaml",
    "field": "activitygroupnames",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project SQLSecurityAuditEvents_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "ipentity-azuresql.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project SQLSecurityAuditEvents_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "ipentity-azuresql.yaml",
    "field": "threattype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project SQLSecurityAuditEvents_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "ipentity-azuresql.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project SQLSecurityAuditEvents_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "ipentity-azuresql.yaml",
    "field": "expirationdatetime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project SQLSecurityAuditEvents_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "ipentity-azuresql.yaml",
    "field": "confidencescore",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend timestamp = SQLSecurityAuditEvents_TimeGenerated",
    "detection": "ipentity-azuresql.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-hotwordsoleobjectstatefulanomalyondatabase.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-hotwordsoleobjectstatefulanomalyondatabase.yaml",
    "field": "principalname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-hotwordsoleobjectstatefulanomalyondatabase.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-hotwordsoleobjectstatefulanomalyondatabase.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-hotwordsoleobjectstatefulanomalyondatabase.yaml",
    "field": "resourceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend hasHotword = iff(Statement has_any (hotwords), 1, 0)",
    "detection": "detection-hotwordsoleobjectstatefulanomalyondatabase.yaml",
    "field": "hashotword",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize countEvents = count(), countStatements = dcount(Statement)",
    "detection": "detection-hotwordsoleobjectstatefulanomalyondatabase.yaml",
    "field": "countevents",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize countEvents = count(), countStatements = dcount(Statement)",
    "detection": "detection-hotwordsoleobjectstatefulanomalyondatabase.yaml",
    "field": "countstatements",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend WindowType = case( timeSlice >= ago(detectionWindow), 'detection',",
    "detection": "detection-hotwordsoleobjectstatefulanomalyondatabase.yaml",
    "field": "windowtype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize countSlicesWithHotwords = dcountif(timeSlice, countStatementsWithHotwords >= monitoredStatementsThreshold)",
    "detection": "detection-hotwordsoleobjectstatefulanomalyondatabase.yaml",
    "field": "countsliceswithhotwords",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IsHotwordAnomalyOnStatement = iff(((countStatementsWithHotwords >= monitoredStatementsThreshold) and (countSlicesWithHotwords <= trainingSlicesThreshold)), true, false)",
    "detection": "detection-hotwordsoleobjectstatefulanomalyondatabase.yaml",
    "field": "ishotwordanomalyonstatement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(PrincipalName,'@',0)[0]), UPNSuffix = tostring(split(PrincipalName,'@',1)[0])",
    "detection": "detection-hotwordsoleobjectstatefulanomalyondatabase.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(PrincipalName,'@',0)[0]), UPNSuffix = tostring(split(PrincipalName,'@',1)[0])",
    "detection": "detection-hotwordsoleobjectstatefulanomalyondatabase.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-volumeresponserowsstatefulanomalyondatabase.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-volumeresponserowsstatefulanomalyondatabase.yaml",
    "field": "principalname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-volumeresponserowsstatefulanomalyondatabase.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-volumeresponserowsstatefulanomalyondatabase.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-volumeresponserowsstatefulanomalyondatabase.yaml",
    "field": "resourceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend QuantityColumn = column_ifexists(monitoredColumn, 0)",
    "detection": "detection-volumeresponserowsstatefulanomalyondatabase.yaml",
    "field": "quantitycolumn",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend WindowType = case( TimeGenerated >= ago(detectionWindow), 'detection',",
    "detection": "detection-volumeresponserowsstatefulanomalyondatabase.yaml",
    "field": "windowtype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize AvgVal = round(avg(QuantityColumn), 2), StdVal = round(stdev(QuantityColumn), 2), N = count(),",
    "detection": "detection-volumeresponserowsstatefulanomalyondatabase.yaml",
    "field": "avgval",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize AvgVal = round(avg(QuantityColumn), 2), StdVal = round(stdev(QuantityColumn), 2), N = count(),",
    "detection": "detection-volumeresponserowsstatefulanomalyondatabase.yaml",
    "field": "stdval",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize AvgVal = round(avg(QuantityColumn), 2), StdVal = round(stdev(QuantityColumn), 2), N = count(),",
    "detection": "detection-volumeresponserowsstatefulanomalyondatabase.yaml",
    "field": "n",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ZScoreVal = iff(N >= 20, round(todouble(QuantityColumn - AvgVal) / todouble(StdVal + 1), 2), 0.00),",
    "detection": "detection-volumeresponserowsstatefulanomalyondatabase.yaml",
    "field": "zscoreval",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IsVolumeAnomalyOnVal = iff((ZScoreVal > volumeThresholdZ and QScoreVal > volumeThresholdQ and QuantityColumn > volumeThresholdHardcoded), true, false), AnomalyScore = round((ZScoreVal + QScoreVal)/2, 0)",
    "detection": "detection-volumeresponserowsstatefulanomalyondatabase.yaml",
    "field": "isvolumeanomalyonval",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IsVolumeAnomalyOnVal = iff((ZScoreVal > volumeThresholdZ and QScoreVal > volumeThresholdQ and QuantityColumn > volumeThresholdHardcoded), true, false), AnomalyScore = round((ZScoreVal + QScoreVal)/2, 0)",
    "detection": "detection-volumeresponserowsstatefulanomalyondatabase.yaml",
    "field": "anomalyscore",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Database, PrincipalName, ClientIp, HostName, ApplicationName, ActionName, Statement,",
    "detection": "detection-volumeresponserowsstatefulanomalyondatabase.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Database, PrincipalName, ClientIp, HostName, ApplicationName, ActionName, Statement,",
    "detection": "detection-volumeresponserowsstatefulanomalyondatabase.yaml",
    "field": "database",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Database, PrincipalName, ClientIp, HostName, ApplicationName, ActionName, Statement,",
    "detection": "detection-volumeresponserowsstatefulanomalyondatabase.yaml",
    "field": "principalname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Database, PrincipalName, ClientIp, HostName, ApplicationName, ActionName, Statement,",
    "detection": "detection-volumeresponserowsstatefulanomalyondatabase.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Database, PrincipalName, ClientIp, HostName, ApplicationName, ActionName, Statement,",
    "detection": "detection-volumeresponserowsstatefulanomalyondatabase.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Database, PrincipalName, ClientIp, HostName, ApplicationName, ActionName, Statement,",
    "detection": "detection-volumeresponserowsstatefulanomalyondatabase.yaml",
    "field": "applicationname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Database, PrincipalName, ClientIp, HostName, ApplicationName, ActionName, Statement,",
    "detection": "detection-volumeresponserowsstatefulanomalyondatabase.yaml",
    "field": "actionname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Database, PrincipalName, ClientIp, HostName, ApplicationName, ActionName, Statement,",
    "detection": "detection-volumeresponserowsstatefulanomalyondatabase.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(PrincipalName,'@',0)[0]), UPNSuffix = tostring(split(PrincipalName,'@',1)[0])",
    "detection": "detection-volumeresponserowsstatefulanomalyondatabase.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(PrincipalName,'@',0)[0]), UPNSuffix = tostring(split(PrincipalName,'@',1)[0])",
    "detection": "detection-volumeresponserowsstatefulanomalyondatabase.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Caller = column_ifexists(\"server_principal_name_s\", \"Not Available\"), ClientIP = column_ifexists(\"client_ip_s\", \"Not Available\"), Action = column_ifexists(\"action_name_s\", \"Not Available\"),",
    "detection": "suspicious-db-connection-to-azure-sql.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Caller = column_ifexists(\"server_principal_name_s\", \"Not Available\"), ClientIP = column_ifexists(\"client_ip_s\", \"Not Available\"), Action = column_ifexists(\"action_name_s\", \"Not Available\"),",
    "detection": "suspicious-db-connection-to-azure-sql.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Caller = column_ifexists(\"server_principal_name_s\", \"Not Available\"), ClientIP = column_ifexists(\"client_ip_s\", \"Not Available\"), Action = column_ifexists(\"action_name_s\", \"Not Available\"),",
    "detection": "suspicious-db-connection-to-azure-sql.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-errorsfirewallstatefulanomalyondatabase.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-errorsfirewallstatefulanomalyondatabase.yaml",
    "field": "principalname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-errorsfirewallstatefulanomalyondatabase.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-errorsfirewallstatefulanomalyondatabase.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, PrincipalName = server_principal_name_s, ClientIp = client_ip_s, HostName = host_name_s, ResourceId,",
    "detection": "detection-errorsfirewallstatefulanomalyondatabase.yaml",
    "field": "resourceid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize countEvents = count(), countStatements = dcount(Statement), countStatementsWithError = dcountif(Statement, Error in (monitoredErrors))",
    "detection": "detection-errorsfirewallstatefulanomalyondatabase.yaml",
    "field": "countevents",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize countEvents = count(), countStatements = dcount(Statement), countStatementsWithError = dcountif(Statement, Error in (monitoredErrors))",
    "detection": "detection-errorsfirewallstatefulanomalyondatabase.yaml",
    "field": "countstatements",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize countEvents = count(), countStatements = dcount(Statement), countStatementsWithError = dcountif(Statement, Error in (monitoredErrors))",
    "detection": "detection-errorsfirewallstatefulanomalyondatabase.yaml",
    "field": "countstatementswitherror",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend WindowType = case( timeSlice >= ago(detectionWindow), 'detection',",
    "detection": "detection-errorsfirewallstatefulanomalyondatabase.yaml",
    "field": "windowtype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize countSlicesWithErrors = dcountif(timeSlice, countStatementsWithError >= monitoredStatementsThreshold)",
    "detection": "detection-errorsfirewallstatefulanomalyondatabase.yaml",
    "field": "countsliceswitherrors",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IsErrorAnomalyOnStatement = iff(((countStatementsWithError >= monitoredStatementsThreshold) and (countSlicesWithErrors <= trainingSlicesThreshold)), true, false)",
    "detection": "detection-errorsfirewallstatefulanomalyondatabase.yaml",
    "field": "iserroranomalyonstatement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(PrincipalName,'@',0)[0]), UPNSuffix = tostring(split(PrincipalName,'@',1)[0])",
    "detection": "detection-errorsfirewallstatefulanomalyondatabase.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(PrincipalName,'@',0)[0]), UPNSuffix = tostring(split(PrincipalName,'@',1)[0])",
    "detection": "detection-errorsfirewallstatefulanomalyondatabase.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by data_definedTags_Oracle_Tags_CreatedBy_s, bin(TimeGenerated, 10m)",
    "detection": "ocidiscoveryactivity.yaml",
    "field": "data_definedtags_oracle_tags_createdby_s",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountCustomEntity = data_definedTags_Oracle_Tags_CreatedBy_s",
    "detection": "ocidiscoveryactivity.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by SrcIpAddr, bin(TimeGenerated, 10m)",
    "detection": "ocimultipleinstancesterminated.yaml",
    "field": "srcipaddr",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr",
    "detection": "ocimultipleinstancesterminated.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by DstPortNumber",
    "detection": "ocimultiplerejects.yaml",
    "field": "dstportnumber",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize dports = makeset(DstPortNumber)",
    "detection": "ocimultiplerejects.yaml",
    "field": "dports",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend k = 1;",
    "detection": "ocimultiplerejects.yaml",
    "field": "k",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend k = 1",
    "detection": "ocimultiplerejects.yaml",
    "field": "k",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by SrcIpAddr, bin(TimeGenerated, 5m)",
    "detection": "ocimultiplerejects.yaml",
    "field": "srcipaddr",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr",
    "detection": "ocimultiplerejects.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr",
    "detection": "ociunexpecteduseragent.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize p_count = dcount(DstIpAddr) by SrcIpAddr, bin(TimeGenerated, 5m)",
    "detection": "ocisshscan.yaml",
    "field": "p_count",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize p_count = dcount(DstIpAddr) by SrcIpAddr, bin(TimeGenerated, 5m)",
    "detection": "ocisshscan.yaml",
    "field": "srcipaddr",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr",
    "detection": "ocisshscan.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by SrcIpAddr, bin(TimeGenerated, 10m)",
    "detection": "ocimultipleinstanceslaunched.yaml",
    "field": "srcipaddr",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr",
    "detection": "ocimultipleinstanceslaunched.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr",
    "detection": "ocieventruledeleted.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = DstIpAddr",
    "detection": "ociinboundsshconnection.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = DstIpAddr",
    "detection": "ociinsecuremetadataendpoint.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr",
    "detection": "ocimetadataendpointipaccess.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend CallerIp = tostring(RequestMetadata.callerIp)",
    "detection": "gcp-iam-detects-accounts-manipulation-performed.yaml",
    "field": "callerip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-logtampering.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-logtampering.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-logtampering.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-logtampering.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-logtampering.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-logtampering.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-logtampering.yaml",
    "field": "eventname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-logtampering.yaml",
    "field": "eventtypename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-logtampering.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-logtampering.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-logtampering.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-logtampering.yaml",
    "field": "useridentityaccountid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-logtampering.yaml",
    "field": "useridentityprincipalid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-logtampering.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc",
    "detection": "aws-logtampering.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend MFAUsed = tostring(parse_json(AdditionalEventData).MFAUsed), LoginResult = tostring(parse_json(ResponseElements).ConsoleLogin), indexId = indexof(tostring(UserIdentityPrincipalid),\":\")",
    "detection": "aws-consolelogonwithoutmfa.yaml",
    "field": "mfaused",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend MFAUsed = tostring(parse_json(AdditionalEventData).MFAUsed), LoginResult = tostring(parse_json(ResponseElements).ConsoleLogin), indexId = indexof(tostring(UserIdentityPrincipalid),\":\")",
    "detection": "aws-consolelogonwithoutmfa.yaml",
    "field": "loginresult",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend MFAUsed = tostring(parse_json(AdditionalEventData).MFAUsed), LoginResult = tostring(parse_json(ResponseElements).ConsoleLogin), indexId = indexof(tostring(UserIdentityPrincipalid),\":\")",
    "detection": "aws-consolelogonwithoutmfa.yaml",
    "field": "indexid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-consolelogonwithoutmfa.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-consolelogonwithoutmfa.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-consolelogonwithoutmfa.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-consolelogonwithoutmfa.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, LoginResult, MFAUsed, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId,  UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-consolelogonwithoutmfa.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, LoginResult, MFAUsed, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId,  UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-consolelogonwithoutmfa.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, LoginResult, MFAUsed, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId,  UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-consolelogonwithoutmfa.yaml",
    "field": "eventname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, LoginResult, MFAUsed, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId,  UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-consolelogonwithoutmfa.yaml",
    "field": "eventtypename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, LoginResult, MFAUsed, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId,  UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-consolelogonwithoutmfa.yaml",
    "field": "loginresult",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, LoginResult, MFAUsed, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId,  UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-consolelogonwithoutmfa.yaml",
    "field": "mfaused",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, LoginResult, MFAUsed, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId,  UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-consolelogonwithoutmfa.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, LoginResult, MFAUsed, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId,  UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-consolelogonwithoutmfa.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, LoginResult, MFAUsed, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId,  UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-consolelogonwithoutmfa.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, LoginResult, MFAUsed, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId,  UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-consolelogonwithoutmfa.yaml",
    "field": "useridentityaccountid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, LoginResult, MFAUsed, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId,  UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-consolelogonwithoutmfa.yaml",
    "field": "useridentityprincipalid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, LoginResult, MFAUsed, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId,  UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-consolelogonwithoutmfa.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc",
    "detection": "aws-consolelogonwithoutmfa.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(parse_json(RequestParameters).policyName)",
    "detection": "aws-privilegeescalationviacrudkmspolicy.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Statement = parse_json(tostring((parse_json(RequestParameters).policyDocument))).Statement",
    "detection": "aws-privilegeescalationviacrudkmspolicy.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviacrudkmspolicy.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviacrudkmspolicy.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviacrudkmspolicy.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviacrudkmspolicy.yaml",
    "field": "condition",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = tostring(Action)",
    "detection": "aws-privilegeescalationviacrudkmspolicy.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-privilegeescalationviacrudkmspolicy.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-privilegeescalationviacrudkmspolicy.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-privilegeescalationviacrudkmspolicy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-privilegeescalationviacrudkmspolicy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "aws-privilegeescalationviacrudkmspolicy.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(parse_json(RequestParameters).policyName)",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Statement = parse_json(tostring((parse_json(RequestParameters).policyDocument))).Statement",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "condition",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = tostring(Action)",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(split(tostring(parse_json(RequestParameters).policyArn),\"/\")[1])",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "attacheventcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "eventname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "useridentitytype",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttachEvent = pack(\"StartTime\", StartTime, \"EndTime\", EndTime, \"EventName\", EventName, \"UserIdentityType\",   UserIdentityType,  \"AccountName\", AccountName, \"AccountUPNSuffix\", AccountUPNSuffix, \"RecipientAccountId\", RecipientAccountId, \"UserIdentityArn\", UserIdentityArn, \"SourceIpAddress\", SourceIpAddress)",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "attachevent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "attachevent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "attacheventcount",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTime",
    "detection": "aws-createdec2policytoprivilegeescalation.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-privilegeescalationadministratoraccessmanagedpolicy.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-privilegeescalationadministratoraccessmanagedpolicy.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-privilegeescalationadministratoraccessmanagedpolicy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-privilegeescalationadministratoraccessmanagedpolicy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-privilegeescalationadministratoraccessmanagedpolicy.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-privilegeescalationadministratoraccessmanagedpolicy.yaml",
    "field": "eventname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-privilegeescalationadministratoraccessmanagedpolicy.yaml",
    "field": "eventtypename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-privilegeescalationadministratoraccessmanagedpolicy.yaml",
    "field": "useridentityaccountid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-privilegeescalationadministratoraccessmanagedpolicy.yaml",
    "field": "useridentityprincipalid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-privilegeescalationadministratoraccessmanagedpolicy.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-privilegeescalationadministratoraccessmanagedpolicy.yaml",
    "field": "useridentityusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-privilegeescalationadministratoraccessmanagedpolicy.yaml",
    "field": "sessionmfaauthenticated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-privilegeescalationadministratoraccessmanagedpolicy.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-privilegeescalationadministratoraccessmanagedpolicy.yaml",
    "field": "awsregion",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-privilegeescalationadministratoraccessmanagedpolicy.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-privilegeescalationadministratoraccessmanagedpolicy.yaml",
    "field": "additionaleventdata",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-privilegeescalationadministratoraccessmanagedpolicy.yaml",
    "field": "requestparameters",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-privilegeescalationadministratoraccessmanagedpolicy.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-privilegeescalationadministratoraccessmanagedpolicy.yaml",
    "field": "responseelements",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-privilegeescalationadministratoraccessmanagedpolicy.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-privilegeescalationadministratoraccessmanagedpolicy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-privilegeescalationadministratoraccessmanagedpolicy.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "aws-privilegeescalationadministratoraccessmanagedpolicy.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by ClientIP",
    "detection": "suspicious-actor-detected-on-aws-elb.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Count=count() by ClientIP, bin(TimeGenerated, 1h)",
    "detection": "suspicious-actor-detected-on-aws-elb.yaml",
    "field": "count",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Count=count() by ClientIP, bin(TimeGenerated, 1h)",
    "detection": "suspicious-actor-detected-on-aws-elb.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend session_start_time = row_window_session(TimeGenerated, 1h, 1h, ClientIP != prev(ClientIP))",
    "detection": "suspicious-actor-detected-on-aws-elb.yaml",
    "field": "session_start_time",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize session_count = count(), failure_count = countif(elb_status_code!=200), failure_count_target = countif(target_status_code=='-'),session_end_time = max(TimeGenerated), make_list(elb_status_code), make_list(target_status_code), make_set(elb_status_code) by session_start_time , ClientIP",
    "detection": "suspicious-actor-detected-on-aws-elb.yaml",
    "field": "session_count",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize session_count = count(), failure_count = countif(elb_status_code!=200), failure_count_target = countif(target_status_code=='-'),session_end_time = max(TimeGenerated), make_list(elb_status_code), make_list(target_status_code), make_set(elb_status_code) by session_start_time , ClientIP",
    "detection": "suspicious-actor-detected-on-aws-elb.yaml",
    "field": "failure_count",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize session_count = count(), failure_count = countif(elb_status_code!=200), failure_count_target = countif(target_status_code=='-'),session_end_time = max(TimeGenerated), make_list(elb_status_code), make_list(target_status_code), make_set(elb_status_code) by session_start_time , ClientIP",
    "detection": "suspicious-actor-detected-on-aws-elb.yaml",
    "field": "failure_count_target",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize session_count = count(), failure_count = countif(elb_status_code!=200), failure_count_target = countif(target_status_code=='-'),session_end_time = max(TimeGenerated), make_list(elb_status_code), make_list(target_status_code), make_set(elb_status_code) by session_start_time , ClientIP",
    "detection": "suspicious-actor-detected-on-aws-elb.yaml",
    "field": "session_end_time",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize session_count = count(), failure_count = countif(elb_status_code!=200), failure_count_target = countif(target_status_code=='-'),session_end_time = max(TimeGenerated), make_list(elb_status_code), make_list(target_status_code), make_set(elb_status_code) by session_start_time , ClientIP",
    "detection": "suspicious-actor-detected-on-aws-elb.yaml",
    "field": "session_start_time",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize session_count = count(), failure_count = countif(elb_status_code!=200), failure_count_target = countif(target_status_code=='-'),session_end_time = max(TimeGenerated), make_list(elb_status_code), make_list(target_status_code), make_set(elb_status_code) by session_start_time , ClientIP",
    "detection": "suspicious-actor-detected-on-aws-elb.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend percentage_of_failure = todouble(failure_count)/session_count*100",
    "detection": "suspicious-actor-detected-on-aws-elb.yaml",
    "field": "percentage_of_failure",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-s3bruteforce.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-s3bruteforce.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-s3bruteforce.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-s3bruteforce.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend bucketName = tostring(parse_json(RequestParameters).bucketName), keyName = tostring(parse_json(RequestParameters).key)",
    "detection": "aws-s3bruteforce.yaml",
    "field": "bucketname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend bucketName = tostring(parse_json(RequestParameters).bucketName), keyName = tostring(parse_json(RequestParameters).key)",
    "detection": "aws-s3bruteforce.yaml",
    "field": "keyname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize time_min_failed=arg_min(TimeGenerated, *), failed_keys = dcount(keyName) by RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, SourceIpAddress, bucketName",
    "detection": "aws-s3bruteforce.yaml",
    "field": "time_min_failed",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize time_min_failed=arg_min(TimeGenerated, *), failed_keys = dcount(keyName) by RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, SourceIpAddress, bucketName",
    "detection": "aws-s3bruteforce.yaml",
    "field": "failed_keys",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize time_min_failed=arg_min(TimeGenerated, *), failed_keys = dcount(keyName) by RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, SourceIpAddress, bucketName",
    "detection": "aws-s3bruteforce.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize time_min_failed=arg_min(TimeGenerated, *), failed_keys = dcount(keyName) by RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, SourceIpAddress, bucketName",
    "detection": "aws-s3bruteforce.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize time_min_failed=arg_min(TimeGenerated, *), failed_keys = dcount(keyName) by RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, SourceIpAddress, bucketName",
    "detection": "aws-s3bruteforce.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize time_min_failed=arg_min(TimeGenerated, *), failed_keys = dcount(keyName) by RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, SourceIpAddress, bucketName",
    "detection": "aws-s3bruteforce.yaml",
    "field": "useridentityaccountid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize time_min_failed=arg_min(TimeGenerated, *), failed_keys = dcount(keyName) by RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, SourceIpAddress, bucketName",
    "detection": "aws-s3bruteforce.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize time_min_failed=arg_min(TimeGenerated, *), failed_keys = dcount(keyName) by RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, SourceIpAddress, bucketName",
    "detection": "aws-s3bruteforce.yaml",
    "field": "bucketname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-s3bruteforce.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-s3bruteforce.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-s3bruteforce.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-s3bruteforce.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend bucketName = tostring(parse_json(RequestParameters).bucketName), keyName = tostring(parse_json(RequestParameters).key)",
    "detection": "aws-s3bruteforce.yaml",
    "field": "bucketname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend bucketName = tostring(parse_json(RequestParameters).bucketName), keyName = tostring(parse_json(RequestParameters).key)",
    "detection": "aws-s3bruteforce.yaml",
    "field": "keyname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize time_min_success=arg_min(TimeGenerated, *), success_keys = dcount(keyName) by RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, SourceIpAddress, bucketName",
    "detection": "aws-s3bruteforce.yaml",
    "field": "time_min_success",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize time_min_success=arg_min(TimeGenerated, *), success_keys = dcount(keyName) by RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, SourceIpAddress, bucketName",
    "detection": "aws-s3bruteforce.yaml",
    "field": "success_keys",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize time_min_success=arg_min(TimeGenerated, *), success_keys = dcount(keyName) by RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, SourceIpAddress, bucketName",
    "detection": "aws-s3bruteforce.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize time_min_success=arg_min(TimeGenerated, *), success_keys = dcount(keyName) by RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, SourceIpAddress, bucketName",
    "detection": "aws-s3bruteforce.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize time_min_success=arg_min(TimeGenerated, *), success_keys = dcount(keyName) by RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, SourceIpAddress, bucketName",
    "detection": "aws-s3bruteforce.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize time_min_success=arg_min(TimeGenerated, *), success_keys = dcount(keyName) by RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, SourceIpAddress, bucketName",
    "detection": "aws-s3bruteforce.yaml",
    "field": "useridentityaccountid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize time_min_success=arg_min(TimeGenerated, *), success_keys = dcount(keyName) by RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, SourceIpAddress, bucketName",
    "detection": "aws-s3bruteforce.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize time_min_success=arg_min(TimeGenerated, *), success_keys = dcount(keyName) by RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, SourceIpAddress, bucketName",
    "detection": "aws-s3bruteforce.yaml",
    "field": "bucketname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = time_min_success",
    "detection": "aws-s3bruteforce.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(parse_json(RequestParameters).policyName)",
    "detection": "aws-privilegeescalationviacruddynamodb.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Statement = parse_json(tostring((parse_json(RequestParameters).policyDocument))).Statement",
    "detection": "aws-privilegeescalationviacruddynamodb.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviacruddynamodb.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviacruddynamodb.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviacruddynamodb.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviacruddynamodb.yaml",
    "field": "condition",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = tostring(Action)",
    "detection": "aws-privilegeescalationviacruddynamodb.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-privilegeescalationviacruddynamodb.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-privilegeescalationviacruddynamodb.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-privilegeescalationviacruddynamodb.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-privilegeescalationviacruddynamodb.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "aws-privilegeescalationviacruddynamodb.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-privilegeescalationadminmanagedpolicy.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-privilegeescalationadminmanagedpolicy.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-privilegeescalationadminmanagedpolicy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-privilegeescalationadminmanagedpolicy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-privilegeescalationadminmanagedpolicy.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-privilegeescalationadminmanagedpolicy.yaml",
    "field": "eventname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-privilegeescalationadminmanagedpolicy.yaml",
    "field": "eventtypename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-privilegeescalationadminmanagedpolicy.yaml",
    "field": "useridentityaccountid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-privilegeescalationadminmanagedpolicy.yaml",
    "field": "useridentityprincipalid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-privilegeescalationadminmanagedpolicy.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-privilegeescalationadminmanagedpolicy.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-privilegeescalationadminmanagedpolicy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-privilegeescalationadminmanagedpolicy.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-privilegeescalationadminmanagedpolicy.yaml",
    "field": "useridentityusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-privilegeescalationadminmanagedpolicy.yaml",
    "field": "sessionmfaauthenticated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-privilegeescalationadminmanagedpolicy.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-privilegeescalationadminmanagedpolicy.yaml",
    "field": "awsregion",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-privilegeescalationadminmanagedpolicy.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-privilegeescalationadminmanagedpolicy.yaml",
    "field": "additionaleventdata",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-privilegeescalationadminmanagedpolicy.yaml",
    "field": "requestparameters",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-privilegeescalationadminmanagedpolicy.yaml",
    "field": "responseelements",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-privilegeescalationadminmanagedpolicy.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "aws-privilegeescalationadminmanagedpolicy.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend scanOnPush = parse_json(tostring((parse_json(RequestParameters).imageScanningConfiguration))).scanOnPush",
    "detection": "aws-ecrimagescanningdisabled.yaml",
    "field": "scanonpush",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-ecrimagescanningdisabled.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-ecrimagescanningdisabled.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-ecrimagescanningdisabled.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-ecrimagescanningdisabled.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "aws-ecrimagescanningdisabled.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(parse_json(RequestParameters).policyName)",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Statement = parse_json(tostring((parse_json(RequestParameters).policyDocument))).Statement",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "condition",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = tostring(Action)",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(split(tostring(parse_json(RequestParameters).policyArn),\"/\")[1])",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityType , UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "attacheventcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityType , UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityType , UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityType , UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityType , UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "eventname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityType , UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityType , UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityType , UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityType , UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "useridentitytype",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityType , UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityType , UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityType , UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttachEvent = pack(\"StartTime\", StartTime, \"EndTime\", EndTime, \"EventName\", EventName, \"UserIdentityType\",   UserIdentityType, \"SourceIpAddress\", SourceIpAddress,\"AccountName\", AccountName, \"AccountUPNSuffix\", AccountUPNSuffix, \"RecipientAccountId\", RecipientAccountId, \"UserIdentityArn\", UserIdentityArn)",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "attachevent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "attachevent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "attacheventcount",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTime",
    "detection": "aws-createdcrudiamtoprivilegeescalation.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize BlockedCount = countif(DvcAction == \"BLOCK\"), AllowedCount = toreal(countif(DvcAction == \"ALLOW\")), TotalCount = toreal(count()) by SrcIpAddr",
    "detection": "suspicious-ip-with-allowed-requests-in-aws-waf.yaml",
    "field": "blockedcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize BlockedCount = countif(DvcAction == \"BLOCK\"), AllowedCount = toreal(countif(DvcAction == \"ALLOW\")), TotalCount = toreal(count()) by SrcIpAddr",
    "detection": "suspicious-ip-with-allowed-requests-in-aws-waf.yaml",
    "field": "allowedcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize BlockedCount = countif(DvcAction == \"BLOCK\"), AllowedCount = toreal(countif(DvcAction == \"ALLOW\")), TotalCount = toreal(count()) by SrcIpAddr",
    "detection": "suspicious-ip-with-allowed-requests-in-aws-waf.yaml",
    "field": "totalcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize BlockedCount = countif(DvcAction == \"BLOCK\"), AllowedCount = toreal(countif(DvcAction == \"ALLOW\")), TotalCount = toreal(count()) by SrcIpAddr",
    "detection": "suspicious-ip-with-allowed-requests-in-aws-waf.yaml",
    "field": "srcipaddr",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend BlockedPercent = (BlockedCount / TotalCount)*100",
    "detection": "suspicious-ip-with-allowed-requests-in-aws-waf.yaml",
    "field": "blockedpercent",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend isPrivate = ipv4_is_private(SrcIpAddr)",
    "detection": "suspicious-ip-with-allowed-requests-in-aws-waf.yaml",
    "field": "isprivate",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project BlockedPercent, SrcIpAddr, isPrivate",
    "detection": "suspicious-ip-with-allowed-requests-in-aws-waf.yaml",
    "field": "blockedpercent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project BlockedPercent, SrcIpAddr, isPrivate",
    "detection": "suspicious-ip-with-allowed-requests-in-aws-waf.yaml",
    "field": "srcipaddr",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project BlockedPercent, SrcIpAddr, isPrivate",
    "detection": "suspicious-ip-with-allowed-requests-in-aws-waf.yaml",
    "field": "isprivate",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend params = tostring(parse_json(RequestParameters).parameters)",
    "detection": "aws-suspiciouscommandec2.yaml",
    "field": "params",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend s3bucketCommand = tostring(parse_json(RequestParameters).outputS3BucketName)",
    "detection": "aws-suspiciouscommandec2.yaml",
    "field": "s3bucketcommand",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend s3bucketAssociation = tostring(parse_json(RequestParameters).outputLocation.s3Location.outputS3BucketName)",
    "detection": "aws-suspiciouscommandec2.yaml",
    "field": "s3bucketassociation",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend commandId = tostring(parse_json(ResponseElements).command.commandId)",
    "detection": "aws-suspiciouscommandec2.yaml",
    "field": "commandid",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend associationId = tostring(parse_json(ResponseElements).associationDescription.associationId)",
    "detection": "aws-suspiciouscommandec2.yaml",
    "field": "associationid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend executionId = iff(isnotempty(commandId), commandId, associationId)",
    "detection": "aws-suspiciouscommandec2.yaml",
    "field": "executionid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend s3bucket = iff(isnotempty(s3bucketCommand), s3bucketCommand, s3bucketAssociation)",
    "detection": "aws-suspiciouscommandec2.yaml",
    "field": "s3bucket",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityUserName = iff(isnotempty(UserIdentityUserName), UserIdentityUserName, tostring(split(UserIdentityArn,'/')[-1]))",
    "detection": "aws-suspiciouscommandec2.yaml",
    "field": "useridentityusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated;",
    "detection": "aws-suspiciouscommandec2.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend s3bucket = tostring(parse_json(RequestParameters).bucketName)",
    "detection": "aws-suspiciouscommandec2.yaml",
    "field": "s3bucket",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend accountId=tostring(todynamic(Resources.['accountId']))",
    "detection": "aws-suspiciouscommandec2.yaml",
    "field": "accountid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-suspiciouscommandec2.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-suspiciouscommandec2.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-suspiciouscommandec2.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-suspiciouscommandec2.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend PolicyName = tostring(parse_json(RequestParameters).policyName)",
    "detection": "aws-privilegeescalationviagluepolicy.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Statement = parse_json(tostring((parse_json(RequestParameters).policyDocument))).Statement",
    "detection": "aws-privilegeescalationviagluepolicy.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviagluepolicy.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviagluepolicy.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviagluepolicy.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviagluepolicy.yaml",
    "field": "condition",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = tostring(Action)",
    "detection": "aws-privilegeescalationviagluepolicy.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-privilegeescalationviagluepolicy.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-privilegeescalationviagluepolicy.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-privilegeescalationviagluepolicy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-privilegeescalationviagluepolicy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend timestamp = TimeGenerated",
    "detection": "aws-privilegeescalationviagluepolicy.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(parse_json(RequestParameters).policyName)",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Statement = parse_json(tostring((parse_json(RequestParameters).policyDocument))).Statement",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "condition",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = tostring(Action)",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(split(tostring(parse_json(RequestParameters).policyArn),\"/\")[1])",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName, UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "attacheventcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName, UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName, UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName, UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName, UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "eventname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName, UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "useridentitytype",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName, UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName, UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName, UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName, UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName, UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName, UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttachEvent = pack(\"StartTime\", StartTime, \"EndTime\", EndTime, \"EventName\", EventName, \"UserIdentityType\",   UserIdentityType, \"SourceIpAddress\", SourceIpAddress, \"AccountName\", AccountName, \"AccountUPNSuffix\", AccountUPNSuffix, \"RecipientAccountId\", RecipientAccountId, \"UserIdentityArn\", UserIdentityArn)",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "attachevent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "attachevent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "attacheventcount",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTime",
    "detection": "aws-createdcruds3policytoprivilegeescalation.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-setdefaulypolicyversion.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-setdefaulypolicyversion.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-setdefaulypolicyversion.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-setdefaulypolicyversion.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "aws-setdefaulypolicyversion.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(parse_json(RequestParameters).policyName)",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Statement = parse_json(tostring((parse_json(RequestParameters).policyDocument))).Statement",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "condition",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = tostring(Action)",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(split(tostring(parse_json(RequestParameters).policyArn),\"/\")[1])",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix,  PolicyName",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "attacheventcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix,  PolicyName",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix,  PolicyName",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix,  PolicyName",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix,  PolicyName",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "eventname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix,  PolicyName",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "useridentitytype",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix,  PolicyName",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix,  PolicyName",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix,  PolicyName",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix,  PolicyName",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix,  PolicyName",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix,  PolicyName",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttachEvent = pack(\"StartTime\", StartTime, \"EndTime\", EndTime, \"EventName\", EventName, \"UserIdentityType\",   UserIdentityType, \"SourceIpAddress\", SourceIpAddress, \"AccountName\", AccountName, \"AccountUPNSuffix\", AccountUPNSuffix, \"RecipientAccountId\", RecipientAccountId, \"UserIdentityArn\", UserIdentityArn)",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "attachevent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "attachevent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "attacheventcount",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTime",
    "detection": "aws-createdlambdapolicytoprivilegeescalation.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Statement = parse_json(tostring((parse_json(RequestParameters).bucketPolicy))).Statement",
    "detection": "aws-s3bucketexposedviapolicy.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition), Principal_aws = tostring(parse_json(Statement).Principal.AWS), Principal = tostring(parse_json(Statement).Principal)",
    "detection": "aws-s3bucketexposedviapolicy.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition), Principal_aws = tostring(parse_json(Statement).Principal.AWS), Principal = tostring(parse_json(Statement).Principal)",
    "detection": "aws-s3bucketexposedviapolicy.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition), Principal_aws = tostring(parse_json(Statement).Principal.AWS), Principal = tostring(parse_json(Statement).Principal)",
    "detection": "aws-s3bucketexposedviapolicy.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition), Principal_aws = tostring(parse_json(Statement).Principal.AWS), Principal = tostring(parse_json(Statement).Principal)",
    "detection": "aws-s3bucketexposedviapolicy.yaml",
    "field": "condition",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition), Principal_aws = tostring(parse_json(Statement).Principal.AWS), Principal = tostring(parse_json(Statement).Principal)",
    "detection": "aws-s3bucketexposedviapolicy.yaml",
    "field": "principal_aws",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition), Principal_aws = tostring(parse_json(Statement).Principal.AWS), Principal = tostring(parse_json(Statement).Principal)",
    "detection": "aws-s3bucketexposedviapolicy.yaml",
    "field": "principal",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = tostring(Action)",
    "detection": "aws-s3bucketexposedviapolicy.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-s3bucketexposedviapolicy.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-s3bucketexposedviapolicy.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-s3bucketexposedviapolicy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-s3bucketexposedviapolicy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "aws-s3bucketexposedviapolicy.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend PolicyName = tostring(parse_json(RequestParameters).policyName)",
    "detection": "aws-privilegeescalationvialambdapolicy.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Statement = parse_json(tostring((parse_json(RequestParameters).policyDocument))).Statement",
    "detection": "aws-privilegeescalationvialambdapolicy.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationvialambdapolicy.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationvialambdapolicy.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationvialambdapolicy.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationvialambdapolicy.yaml",
    "field": "condition",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = tostring(Action)",
    "detection": "aws-privilegeescalationvialambdapolicy.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-privilegeescalationvialambdapolicy.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-privilegeescalationvialambdapolicy.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-privilegeescalationvialambdapolicy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-privilegeescalationvialambdapolicy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend timestamp = TimeGenerated",
    "detection": "aws-privilegeescalationvialambdapolicy.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend repoName = tostring(parse_json(ResponseElements).repositoryName)",
    "detection": "aws-ecrcontainerhigh.yaml",
    "field": "reponame",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend imageId = tostring(parse_json(ResponseElements).imageId.imageDigest)",
    "detection": "aws-ecrcontainerhigh.yaml",
    "field": "imageid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Critical = toint(parse_json(ResponseElements).imageScanFindings.findingSeverityCounts.CRITICAL)",
    "detection": "aws-ecrcontainerhigh.yaml",
    "field": "critical",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend High = toint(parse_json(ResponseElements).imageScanFindings.findingSeverityCounts.HIGH)",
    "detection": "aws-ecrcontainerhigh.yaml",
    "field": "high",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-ecrcontainerhigh.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-ecrcontainerhigh.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-ecrcontainerhigh.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-ecrcontainerhigh.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "aws-ecrcontainerhigh.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend FilePath = tostring(parse_json(RequestParameters).key)",
    "detection": "suspiciousaccessofbecrelateddocumentsinawss3buckets.yaml",
    "field": "filepath",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize dcount(FilePath) by UserIdentityPrincipalid, bin(startofday(TimeGenerated), 1d)",
    "detection": "suspiciousaccessofbecrelateddocumentsinawss3buckets.yaml",
    "field": "useridentityprincipalid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize CountOfDocs = make_list(dcount_FilePath, 10000), TimeStamp = make_list(TimeGenerated, 10000) by UserIdentityPrincipalid",
    "detection": "suspiciousaccessofbecrelateddocumentsinawss3buckets.yaml",
    "field": "countofdocs",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize CountOfDocs = make_list(dcount_FilePath, 10000), TimeStamp = make_list(TimeGenerated, 10000) by UserIdentityPrincipalid",
    "detection": "suspiciousaccessofbecrelateddocumentsinawss3buckets.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize CountOfDocs = make_list(dcount_FilePath, 10000), TimeStamp = make_list(TimeGenerated, 10000) by UserIdentityPrincipalid",
    "detection": "suspiciousaccessofbecrelateddocumentsinawss3buckets.yaml",
    "field": "useridentityprincipalid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeStamp, CountOfDocs, Baseline, Score, Anomalies, UserIdentityPrincipalid",
    "detection": "suspiciousaccessofbecrelateddocumentsinawss3buckets.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeStamp, CountOfDocs, Baseline, Score, Anomalies, UserIdentityPrincipalid",
    "detection": "suspiciousaccessofbecrelateddocumentsinawss3buckets.yaml",
    "field": "countofdocs",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeStamp, CountOfDocs, Baseline, Score, Anomalies, UserIdentityPrincipalid",
    "detection": "suspiciousaccessofbecrelateddocumentsinawss3buckets.yaml",
    "field": "baseline",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeStamp, CountOfDocs, Baseline, Score, Anomalies, UserIdentityPrincipalid",
    "detection": "suspiciousaccessofbecrelateddocumentsinawss3buckets.yaml",
    "field": "score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeStamp, CountOfDocs, Baseline, Score, Anomalies, UserIdentityPrincipalid",
    "detection": "suspiciousaccessofbecrelateddocumentsinawss3buckets.yaml",
    "field": "anomalies",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeStamp, CountOfDocs, Baseline, Score, Anomalies, UserIdentityPrincipalid",
    "detection": "suspiciousaccessofbecrelateddocumentsinawss3buckets.yaml",
    "field": "useridentityprincipalid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = iif(UserIdentityUserName contains \"@\", split(UserIdentityUserName, \"@\")[0], UserIdentityUserName)",
    "detection": "suspiciousaccessofbecrelateddocumentsinawss3buckets.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UPNSuffix = iif(UserIdentityUserName contains \"@\", split(UserIdentityUserName, \"@\")[1], \"\")",
    "detection": "suspiciousaccessofbecrelateddocumentsinawss3buckets.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend toPort = parse_json(tostring(parse_json(tostring(parse_json(RequestParameters).ipPermissions)).items))[0].toPort",
    "detection": "aws-ingressegresssecuritygroupchange.yaml",
    "field": "toport",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "    | extend cidrIp = parse_json(tostring(parse_json(tostring(parse_json(tostring(parse_json(tostring(parse_json(RequestParameters).ipPermissions)).items))[0].ipRanges)).items))[0].cidrIp",
    "detection": "aws-ingressegresssecuritygroupchange.yaml",
    "field": "cidrip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-ingressegresssecuritygroupchange.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-ingressegresssecuritygroupchange.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-ingressegresssecuritygroupchange.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-changetordsdatabase.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-changetordsdatabase.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-changetordsdatabase.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-changetordsdatabase.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, ResponseElements",
    "detection": "aws-changetordsdatabase.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, ResponseElements",
    "detection": "aws-changetordsdatabase.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, ResponseElements",
    "detection": "aws-changetordsdatabase.yaml",
    "field": "eventname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, ResponseElements",
    "detection": "aws-changetordsdatabase.yaml",
    "field": "eventtypename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, ResponseElements",
    "detection": "aws-changetordsdatabase.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, ResponseElements",
    "detection": "aws-changetordsdatabase.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, ResponseElements",
    "detection": "aws-changetordsdatabase.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, ResponseElements",
    "detection": "aws-changetordsdatabase.yaml",
    "field": "useridentityaccountid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, ResponseElements",
    "detection": "aws-changetordsdatabase.yaml",
    "field": "useridentityprincipalid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, ResponseElements",
    "detection": "aws-changetordsdatabase.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, ResponseElements",
    "detection": "aws-changetordsdatabase.yaml",
    "field": "useridentityusername",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, ResponseElements",
    "detection": "aws-changetordsdatabase.yaml",
    "field": "sessionmfaauthenticated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, ResponseElements",
    "detection": "aws-changetordsdatabase.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, ResponseElements",
    "detection": "aws-changetordsdatabase.yaml",
    "field": "awsregion",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, ResponseElements",
    "detection": "aws-changetordsdatabase.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, ResponseElements",
    "detection": "aws-changetordsdatabase.yaml",
    "field": "additionaleventdata",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, ResponseElements",
    "detection": "aws-changetordsdatabase.yaml",
    "field": "responseelements",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc",
    "detection": "aws-changetordsdatabase.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(parse_json(RequestParameters).policyName)",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Statement = parse_json(tostring((parse_json(RequestParameters).policyDocument))).Statement",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "condition",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = tostring(Action)",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(split(tostring(parse_json(RequestParameters).policyArn),\"/\")[1])",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "attacheventcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "eventname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "useridentitytype",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttachEvent = pack(\"StartTime\", StartTime, \"EndTime\", EndTime, \"EventName\", EventName, \"UserIdentityType\",   UserIdentityType, \"SourceIpAddress\", SourceIpAddress, \"AccountName\", AccountName, \"AccountUPNSuffix\", AccountUPNSuffix, \"RecipientAccountId\", RecipientAccountId, \"UserIdentityArn\", UserIdentityArn)",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "attachevent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "attachevent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "attacheventcount",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTime",
    "detection": "aws-createddatapipelinepolicytoprivilegeescalation.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-samlupdateidentity.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-samlupdateidentity.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-samlupdateidentity.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-samlupdateidentity.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "aws-samlupdateidentity.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(parse_json(RequestParameters).policyName)",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Statement = parse_json(tostring((parse_json(RequestParameters).policyDocument))).Statement",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "condition",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = tostring(Action)",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(split(tostring(parse_json(RequestParameters).policyArn),\"/\")[1])",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "attacheventcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "eventname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "useridentitytype",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttachEvent = pack(\"StartTime\", StartTime, \"EndTime\", EndTime, \"EventName\", EventName, \"UserIdentityType\",   UserIdentityType, \"SourceIpAddress\", SourceIpAddress, \"AccountName\", AccountName, \"AccountUPNSuffix\", AccountUPNSuffix, \"RecipientAccountId\", RecipientAccountId, \"UserIdentityArn\", UserIdentityArn)",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "attachevent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "attachevent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "attacheventcount",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTime",
    "detection": "aws-createdcrudkmspolicytoprivilegeescalation.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-rdsinstancepubliclyexposed.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-rdsinstancepubliclyexposed.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-rdsinstancepubliclyexposed.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-rdsinstancepubliclyexposed.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "aws-rdsinstancepubliclyexposed.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(parse_json(RequestParameters).policyName)",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Statement = parse_json(tostring((parse_json(RequestParameters).policyDocument))).Statement",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "condition",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = tostring(Action)",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(split(tostring(parse_json(RequestParameters).policyArn),\"/\")[1])",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "attacheventcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "eventname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "useridentitytype",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttachEvent = pack(\"StartTime\", StartTime, \"EndTime\", EndTime, \"EventName\", EventName, \"UserIdentityType\",   UserIdentityType,\"SourceIpAddress\", SourceIpAddress, \"AccountName\", AccountName, \"AccountUPNSuffix\", AccountUPNSuffix, \"RecipientAccountId\", RecipientAccountId, \"UserIdentityArn\", UserIdentityArn)",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "attachevent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "attachevent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "attacheventcount",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTime",
    "detection": "aws-createdgluepolicytoprivilegeescalation.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(parse_json(RequestParameters).policyName)",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Statement = parse_json(tostring((parse_json(RequestParameters).policyDocument))).Statement",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "condition",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = tostring(Action)",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(split(tostring(parse_json(RequestParameters).policyArn),\"/\")[1])",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName, UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "attacheventcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName, UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName, UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName, UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName, UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "eventname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName, UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "useridentitytype",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName, UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName, UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName, UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName, UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName, UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName, UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttachEvent = pack(\"StartTime\", StartTime, \"EndTime\", EndTime, \"EventName\", EventName, \"UserIdentityType\",   UserIdentityType, \"SourceIpAddress\", SourceIpAddress, \"AccountName\", AccountName, \"AccountUPNSuffix\", AccountUPNSuffix, \"RecipientAccountId\", RecipientAccountId, \"UserIdentityArn\", UserIdentityArn)",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "attachevent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "attachevent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "attacheventcount",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTime",
    "detection": "aws-createdcurdlambdapolicytoprivilegescalation.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Severity = tostring(parse_json(tostring(parse_json(tostring(parse_json(Message).findings))[0].Severity)).Label)",
    "detection": "aws-securityhub.yaml",
    "field": "severity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AccountId = tostring(parse_json(tostring(parse_json(tostring(parse_json(Message).findings))[0].AwsAccountId)))",
    "detection": "aws-securityhub.yaml",
    "field": "accountid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend EventType = tostring(parse_json(tostring(parse_json(tostring(parse_json(Message).findings))[0].Types))[0])",
    "detection": "aws-securityhub.yaml",
    "field": "eventtype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(parse_json(RequestParameters).policyName)",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Statement = parse_json(tostring((parse_json(RequestParameters).policyDocument))).Statement",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource)",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource)",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource)",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = tostring(Action)",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityUserName = iff(isnotempty(UserIdentityUserName), UserIdentityUserName, tostring(split(UserIdentityArn,'/')[-1]))",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "useridentityusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(split(tostring(parse_json(RequestParameters).policyArn),\"/\")[1])",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "attacheventcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "eventname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "useridentitytype",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttachEvent = pack(\"StartTime\", StartTime, \"EndTime\", EndTime, \"EventName\", EventName, \"UserIdentityType\",   UserIdentityType, \"AccountName\", AccountName, \"AccountUPNSuffix\", AccountUPNSuffix, \"RecipientAccountId\", RecipientAccountId, \"UserIdentityArn\", UserIdentityArn, \"SourceIpAddress\", SourceIpAddress)",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "attachevent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "attachevent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "attacheventcount",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTime",
    "detection": "aws-fulladminpolicyattachedtorolesusersgroups.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend PolicyName = tostring(parse_json(RequestParameters).policyName)",
    "detection": "aws-privilegeescalationviacloudformationpolicy.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Statement = parse_json(tostring((parse_json(RequestParameters).policyDocument))).Statement",
    "detection": "aws-privilegeescalationviacloudformationpolicy.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviacloudformationpolicy.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviacloudformationpolicy.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviacloudformationpolicy.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviacloudformationpolicy.yaml",
    "field": "condition",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = tostring(Action)",
    "detection": "aws-privilegeescalationviacloudformationpolicy.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-privilegeescalationviacloudformationpolicy.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-privilegeescalationviacloudformationpolicy.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-privilegeescalationviacloudformationpolicy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-privilegeescalationviacloudformationpolicy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend timestamp = TimeGenerated",
    "detection": "aws-privilegeescalationviacloudformationpolicy.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(parse_json(RequestParameters).policyName)",
    "detection": "aws-privilegeescalationviacrudlambdapolicy.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Statement = parse_json(tostring((parse_json(RequestParameters).policyDocument))).Statement",
    "detection": "aws-privilegeescalationviacrudlambdapolicy.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviacrudlambdapolicy.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviacrudlambdapolicy.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviacrudlambdapolicy.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviacrudlambdapolicy.yaml",
    "field": "condition",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = tostring(Action)",
    "detection": "aws-privilegeescalationviacrudlambdapolicy.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-privilegeescalationviacrudlambdapolicy.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-privilegeescalationviacrudlambdapolicy.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-privilegeescalationviacrudlambdapolicy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-privilegeescalationviacrudlambdapolicy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "aws-privilegeescalationviacrudlambdapolicy.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-privilegeescalationfullaccessmanagedpolicy.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-privilegeescalationfullaccessmanagedpolicy.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-privilegeescalationfullaccessmanagedpolicy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-privilegeescalationfullaccessmanagedpolicy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements",
    "detection": "aws-privilegeescalationfullaccessmanagedpolicy.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements",
    "detection": "aws-privilegeescalationfullaccessmanagedpolicy.yaml",
    "field": "eventname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements",
    "detection": "aws-privilegeescalationfullaccessmanagedpolicy.yaml",
    "field": "eventtypename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements",
    "detection": "aws-privilegeescalationfullaccessmanagedpolicy.yaml",
    "field": "useridentityaccountid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements",
    "detection": "aws-privilegeescalationfullaccessmanagedpolicy.yaml",
    "field": "useridentityprincipalid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements",
    "detection": "aws-privilegeescalationfullaccessmanagedpolicy.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements",
    "detection": "aws-privilegeescalationfullaccessmanagedpolicy.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements",
    "detection": "aws-privilegeescalationfullaccessmanagedpolicy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements",
    "detection": "aws-privilegeescalationfullaccessmanagedpolicy.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements",
    "detection": "aws-privilegeescalationfullaccessmanagedpolicy.yaml",
    "field": "useridentityusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements",
    "detection": "aws-privilegeescalationfullaccessmanagedpolicy.yaml",
    "field": "sessionmfaauthenticated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements",
    "detection": "aws-privilegeescalationfullaccessmanagedpolicy.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements",
    "detection": "aws-privilegeescalationfullaccessmanagedpolicy.yaml",
    "field": "awsregion",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements",
    "detection": "aws-privilegeescalationfullaccessmanagedpolicy.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements",
    "detection": "aws-privilegeescalationfullaccessmanagedpolicy.yaml",
    "field": "additionaleventdata",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements",
    "detection": "aws-privilegeescalationfullaccessmanagedpolicy.yaml",
    "field": "requestparameters",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements",
    "detection": "aws-privilegeescalationfullaccessmanagedpolicy.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, UserIdentityArn, ResponseElements",
    "detection": "aws-privilegeescalationfullaccessmanagedpolicy.yaml",
    "field": "responseelements",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "aws-privilegeescalationfullaccessmanagedpolicy.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend state=parse_json(parse_json(replace_string(tostring(parse_json(RequestParameters)['policy']),'\\\\\"','\"')).['Statement'])",
    "detection": "aws-creationofencryptkeyswithoutmfa.yaml",
    "field": "state",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action= tostring(parse_json(state.['Action'][0])), Effect=tostring(parse_json(state.['Effect'])),",
    "detection": "aws-creationofencryptkeyswithoutmfa.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action= tostring(parse_json(state.['Action'][0])), Effect=tostring(parse_json(state.['Effect'])),",
    "detection": "aws-creationofencryptkeyswithoutmfa.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-creationofencryptkeyswithoutmfa.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-creationofencryptkeyswithoutmfa.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-creationofencryptkeyswithoutmfa.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-creationofencryptkeyswithoutmfa.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "aws-creationofencryptkeyswithoutmfa.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend PolicyName = tostring(parse_json(RequestParameters).policyName)",
    "detection": "aws-privilegeescalationviassm.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Statement = parse_json(tostring((parse_json(RequestParameters).policyDocument))).Statement",
    "detection": "aws-privilegeescalationviassm.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviassm.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviassm.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviassm.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviassm.yaml",
    "field": "condition",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = tostring(Action)",
    "detection": "aws-privilegeescalationviassm.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-privilegeescalationviassm.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-privilegeescalationviassm.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-privilegeescalationviassm.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-privilegeescalationviassm.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend timestamp = TimeGenerated",
    "detection": "aws-privilegeescalationviassm.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-s3bucketexposedviaacl.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-s3bucketexposedviaacl.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-s3bucketexposedviaacl.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-s3bucketexposedviaacl.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Grant = parse_json(tostring((parse_json(RequestParameters).AccessControlPolicy))).AccessControlList.Grant",
    "detection": "aws-s3bucketexposedviaacl.yaml",
    "field": "grant",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend cannedacl = parse_json(tostring((parse_json(RequestParameters))))",
    "detection": "aws-s3bucketexposedviaacl.yaml",
    "field": "cannedacl",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend URI = parse_json(Grant).Grantee.URI, type = parse_json(Grant).Grantee.[\"xsi:type\"], xamzacl = parse_json(cannedacl).[\"x-amz-acl\"]",
    "detection": "aws-s3bucketexposedviaacl.yaml",
    "field": "uri",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend URI = parse_json(Grant).Grantee.URI, type = parse_json(Grant).Grantee.[\"xsi:type\"], xamzacl = parse_json(cannedacl).[\"x-amz-acl\"]",
    "detection": "aws-s3bucketexposedviaacl.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend URI = parse_json(Grant).Grantee.URI, type = parse_json(Grant).Grantee.[\"xsi:type\"], xamzacl = parse_json(cannedacl).[\"x-amz-acl\"]",
    "detection": "aws-s3bucketexposedviaacl.yaml",
    "field": "xamzacl",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "aws-s3bucketexposedviaacl.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-clearstopchangetraillogs.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-clearstopchangetraillogs.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-clearstopchangetraillogs.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-clearstopchangetraillogs.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-clearstopchangetraillogs.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-clearstopchangetraillogs.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-clearstopchangetraillogs.yaml",
    "field": "eventname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-clearstopchangetraillogs.yaml",
    "field": "eventtypename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-clearstopchangetraillogs.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-clearstopchangetraillogs.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-clearstopchangetraillogs.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-clearstopchangetraillogs.yaml",
    "field": "useridentityaccountid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-clearstopchangetraillogs.yaml",
    "field": "useridentityprincipalid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-clearstopchangetraillogs.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc",
    "detection": "aws-clearstopchangetraillogs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend PolicyName = tostring(parse_json(RequestParameters).policyName)",
    "detection": "aws-privilegeescalationviacrudiampolicy.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Statement = parse_json(tostring((parse_json(RequestParameters).policyDocument))).Statement",
    "detection": "aws-privilegeescalationviacrudiampolicy.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviacrudiampolicy.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviacrudiampolicy.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviacrudiampolicy.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviacrudiampolicy.yaml",
    "field": "condition",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = tostring(Action)",
    "detection": "aws-privilegeescalationviacrudiampolicy.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-privilegeescalationviacrudiampolicy.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-privilegeescalationviacrudiampolicy.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-privilegeescalationviacrudiampolicy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-privilegeescalationviacrudiampolicy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend timestamp = TimeGenerated",
    "detection": "aws-privilegeescalationviacrudiampolicy.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-changetovpc.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-changetovpc.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-changetovpc.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-changetovpc.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-changetovpc.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-changetovpc.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-changetovpc.yaml",
    "field": "eventname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-changetovpc.yaml",
    "field": "eventtypename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-changetovpc.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-changetovpc.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-changetovpc.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-changetovpc.yaml",
    "field": "useridentityaccountid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-changetovpc.yaml",
    "field": "useridentityprincipalid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventName, EventTypeName, RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,",
    "detection": "aws-changetovpc.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc",
    "detection": "aws-changetovpc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend bucketName = tostring(parse_json(RequestParameters).bucketName), keyName = tostring(parse_json(RequestParameters).key)",
    "detection": "aws-s3ransomware.yaml",
    "field": "bucketname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend bucketName = tostring(parse_json(RequestParameters).bucketName), keyName = tostring(parse_json(RequestParameters).key)",
    "detection": "aws-s3ransomware.yaml",
    "field": "keyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend bucketName = tostring(parse_json(RequestParameters).bucketName), keyName = tostring(parse_json(RequestParameters).key)",
    "detection": "aws-s3ransomware.yaml",
    "field": "bucketname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend bucketName = tostring(parse_json(RequestParameters).bucketName), keyName = tostring(parse_json(RequestParameters).key)",
    "detection": "aws-s3ransomware.yaml",
    "field": "keyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend kmsId = tostring(parse_json(RequestParameters).[\"x-amz-server-side-encryption-aws-kms-key-id\"])",
    "detection": "aws-s3ransomware.yaml",
    "field": "kmsid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-s3ransomware.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-s3ransomware.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-s3ransomware.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-s3ransomware.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTime",
    "detection": "aws-s3ransomware.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-guarddutydisabled.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-guarddutydisabled.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-guarddutydisabled.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-guarddutydisabled.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "aws-guarddutydisabled.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-loadbalancersecgroupchange.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-loadbalancersecgroupchange.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-loadbalancersecgroupchange.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-loadbalancersecgroupchange.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount=count(), StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated)",
    "detection": "aws-loadbalancersecgroupchange.yaml",
    "field": "eventcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount=count(), StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated)",
    "detection": "aws-loadbalancersecgroupchange.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount=count(), StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated)",
    "detection": "aws-loadbalancersecgroupchange.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc",
    "detection": "aws-loadbalancersecgroupchange.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(parse_json(RequestParameters).policyName)",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Statement = parse_json(tostring((parse_json(RequestParameters).policyDocument))).Statement",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "condition",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = tostring(Action)",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(split(tostring(parse_json(RequestParameters).policyArn),\"/\")[1])",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "attacheventcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "eventname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "useridentitytype",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttachEvent = pack(\"StartTime\", StartTime, \"EndTime\", EndTime, \"EventName\", EventName, \"UserIdentityType\",   UserIdentityType, \"SourceIpAddress\", SourceIpAddress, \"AccountName\", AccountName, \"AccountUPNSuffix\", AccountUPNSuffix, \"RecipientAccountId\", RecipientAccountId, \"UserIdentityArn\", UserIdentityArn)",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "attachevent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "attachevent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "attacheventcount",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTime",
    "detection": "aws-createdcruddyanmodbpolicytoprivilegeescalation.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Grant = parse_json(tostring((parse_json(RequestParameters).AccessControlPolicy))).AccessControlList.Grant",
    "detection": "aws-s3objectpubliclyexposed.yaml",
    "field": "grant",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend cannedacl = parse_json(tostring((parse_json(RequestParameters))))",
    "detection": "aws-s3objectpubliclyexposed.yaml",
    "field": "cannedacl",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend URI = parse_json(Grant).Grantee.URI, type = parse_json(Grant).Grantee.[\"xsi:type\"], xamzacl = parse_json(cannedacl).[\"x-amz-acl\"]",
    "detection": "aws-s3objectpubliclyexposed.yaml",
    "field": "uri",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend URI = parse_json(Grant).Grantee.URI, type = parse_json(Grant).Grantee.[\"xsi:type\"], xamzacl = parse_json(cannedacl).[\"x-amz-acl\"]",
    "detection": "aws-s3objectpubliclyexposed.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend URI = parse_json(Grant).Grantee.URI, type = parse_json(Grant).Grantee.[\"xsi:type\"], xamzacl = parse_json(cannedacl).[\"x-amz-acl\"]",
    "detection": "aws-s3objectpubliclyexposed.yaml",
    "field": "xamzacl",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-s3objectpubliclyexposed.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-s3objectpubliclyexposed.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-s3objectpubliclyexposed.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-s3objectpubliclyexposed.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend timestamp = TimeGenerated",
    "detection": "aws-s3objectpubliclyexposed.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SrcAddr, SrcPort, DstAddr, DstPort, AccountId",
    "detection": "awsvpc-external-ip-to-suspicious-port-activity.yaml",
    "field": "srcaddr",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SrcAddr, SrcPort, DstAddr, DstPort, AccountId",
    "detection": "awsvpc-external-ip-to-suspicious-port-activity.yaml",
    "field": "srcport",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project SrcAddr, SrcPort, DstAddr, DstPort, AccountId",
    "detection": "awsvpc-external-ip-to-suspicious-port-activity.yaml",
    "field": "dstaddr",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SrcAddr, SrcPort, DstAddr, DstPort, AccountId",
    "detection": "awsvpc-external-ip-to-suspicious-port-activity.yaml",
    "field": "dstport",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project SrcAddr, SrcPort, DstAddr, DstPort, AccountId",
    "detection": "awsvpc-external-ip-to-suspicious-port-activity.yaml",
    "field": "accountid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(parse_json(RequestParameters).policyName)",
    "detection": "aws-privilegeescalationviacruds3policy.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Statement = parse_json(tostring((parse_json(RequestParameters).policyDocument))).Statement",
    "detection": "aws-privilegeescalationviacruds3policy.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviacruds3policy.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviacruds3policy.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviacruds3policy.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviacruds3policy.yaml",
    "field": "condition",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = tostring(Action)",
    "detection": "aws-privilegeescalationviacruds3policy.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-privilegeescalationviacruds3policy.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-privilegeescalationviacruds3policy.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-privilegeescalationviacruds3policy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-privilegeescalationviacruds3policy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "aws-privilegeescalationviacruds3policy.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ruleAction = tostring(parse_json(RequestParameters)['ruleAction']),",
    "detection": "aws-networkaclopentoallports.yaml",
    "field": "ruleaction",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-networkaclopentoallports.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-networkaclopentoallports.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-networkaclopentoallports.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-networkaclopentoallports.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "aws-networkaclopentoallports.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttackType = \"SQL Injection\";",
    "detection": "malicious-requests-detected-on-aws-elb.yaml",
    "field": "attacktype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttackType = \"Carriage Return Line Feed Injection\";",
    "detection": "malicious-requests-detected-on-aws-elb.yaml",
    "field": "attacktype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttackType = \"Path traversal Attack\";",
    "detection": "malicious-requests-detected-on-aws-elb.yaml",
    "field": "attacktype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttackType = \"File Inclusion attack\";",
    "detection": "malicious-requests-detected-on-aws-elb.yaml",
    "field": "attacktype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttackType = \"Insecure Management interface attack\";",
    "detection": "malicious-requests-detected-on-aws-elb.yaml",
    "field": "attacktype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttackType = \"NoSQL injection\";",
    "detection": "malicious-requests-detected-on-aws-elb.yaml",
    "field": "attacktype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttackType = \"Open URL Redirection attack\";",
    "detection": "malicious-requests-detected-on-aws-elb.yaml",
    "field": "attacktype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttackType = \"Server-Side Request Forgery attack\";",
    "detection": "malicious-requests-detected-on-aws-elb.yaml",
    "field": "attacktype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttackType = \"Server Side Template Injection\";",
    "detection": "malicious-requests-detected-on-aws-elb.yaml",
    "field": "attacktype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttackType = \"Malicious User Agent Detected\";",
    "detection": "malicious-requests-detected-on-aws-elb.yaml",
    "field": "attacktype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-ssmpubliclyexposed.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-ssmpubliclyexposed.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-ssmpubliclyexposed.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-ssmpubliclyexposed.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, RecipientAccountId, AccountName, AccountUPNSuffix, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-ssmpubliclyexposed.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, RecipientAccountId, AccountName, AccountUPNSuffix, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-ssmpubliclyexposed.yaml",
    "field": "eventname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, RecipientAccountId, AccountName, AccountUPNSuffix, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-ssmpubliclyexposed.yaml",
    "field": "eventtypename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, RecipientAccountId, AccountName, AccountUPNSuffix, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-ssmpubliclyexposed.yaml",
    "field": "useridentityaccountid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, RecipientAccountId, AccountName, AccountUPNSuffix, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-ssmpubliclyexposed.yaml",
    "field": "useridentityprincipalid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, RecipientAccountId, AccountName, AccountUPNSuffix, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-ssmpubliclyexposed.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, RecipientAccountId, AccountName, AccountUPNSuffix, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-ssmpubliclyexposed.yaml",
    "field": "useridentityusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, RecipientAccountId, AccountName, AccountUPNSuffix, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-ssmpubliclyexposed.yaml",
    "field": "sessionmfaauthenticated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, RecipientAccountId, AccountName, AccountUPNSuffix, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-ssmpubliclyexposed.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, RecipientAccountId, AccountName, AccountUPNSuffix, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-ssmpubliclyexposed.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, RecipientAccountId, AccountName, AccountUPNSuffix, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-ssmpubliclyexposed.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, RecipientAccountId, AccountName, AccountUPNSuffix, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-ssmpubliclyexposed.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, RecipientAccountId, AccountName, AccountUPNSuffix, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-ssmpubliclyexposed.yaml",
    "field": "awsregion",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, RecipientAccountId, AccountName, AccountUPNSuffix, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-ssmpubliclyexposed.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, RecipientAccountId, AccountName, AccountUPNSuffix, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-ssmpubliclyexposed.yaml",
    "field": "additionaleventdata",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, RecipientAccountId, AccountName, AccountUPNSuffix, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-ssmpubliclyexposed.yaml",
    "field": "requestparameters",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, RecipientAccountId, AccountName, AccountUPNSuffix, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-ssmpubliclyexposed.yaml",
    "field": "responseelements",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent,UserIdentityUserName, SessionMfaAuthenticated, RecipientAccountId, AccountName, AccountUPNSuffix, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, RequestParameters, ResponseElements, UserIdentityArn",
    "detection": "aws-ssmpubliclyexposed.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "aws-ssmpubliclyexposed.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend PolicyName = tostring(parse_json(RequestParameters).policyName)",
    "detection": "aws-privilegeescalationviadatapipeline.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Statement = parse_json(tostring((parse_json(RequestParameters).policyDocument))).Statement",
    "detection": "aws-privilegeescalationviadatapipeline.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviadatapipeline.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviadatapipeline.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviadatapipeline.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviadatapipeline.yaml",
    "field": "condition",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = tostring(Action)",
    "detection": "aws-privilegeescalationviadatapipeline.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-privilegeescalationviadatapipeline.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-privilegeescalationviadatapipeline.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-privilegeescalationviadatapipeline.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-privilegeescalationviadatapipeline.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend timestamp = TimeGenerated",
    "detection": "aws-privilegeescalationviadatapipeline.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend PolicyName = tostring(parse_json(RequestParameters).policyName)",
    "detection": "aws-privilegeescalationviaec2policy.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Statement = parse_json(tostring((parse_json(RequestParameters).policyDocument))).Statement",
    "detection": "aws-privilegeescalationviaec2policy.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviaec2policy.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviaec2policy.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviaec2policy.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-privilegeescalationviaec2policy.yaml",
    "field": "condition",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Action = tostring(Action)",
    "detection": "aws-privilegeescalationviaec2policy.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-privilegeescalationviaec2policy.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-privilegeescalationviaec2policy.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-privilegeescalationviaec2policy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-privilegeescalationviaec2policy.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend timestamp = TimeGenerated",
    "detection": "aws-privilegeescalationviaec2policy.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(parse_json(RequestParameters).policyName)",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Statement = parse_json(tostring((parse_json(RequestParameters).policyDocument))).Statement",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "condition",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = tostring(Action)",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(split(tostring(parse_json(RequestParameters).policyArn),\"/\")[1])",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityType , UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "attacheventcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityType , UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityType , UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityType , UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityType , UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "eventname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityType , UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityType , UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityType , UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityType , UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "useridentitytype",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityType , UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityType , UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   RecipientAccountId, AccountName, AccountUPNSuffix, UserIdentityType , UserIdentityArn, SourceIpAddress, PolicyName",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttachEvent = pack(\"StartTime\", StartTime, \"EndTime\", EndTime, \"EventName\", EventName, \"UserIdentityType\",   UserIdentityType, \"SourceIpAddress\", SourceIpAddress, \"AccountName\", AccountName, \"AccountUPNSuffix\", AccountUPNSuffix, \"RecipientAccountId\", RecipientAccountId, \"UserIdentityArn\", UserIdentityArn)",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "attachevent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "attachevent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "attacheventcount",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, AttachEventCount, RecipientAccountId, AccountName, AccountUPNSuffix",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTime",
    "detection": "aws-createdcloudformationpolicytoprivilegeescalation.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(parse_json(RequestParameters).policyName)",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Statement = parse_json(tostring((parse_json(RequestParameters).policyDocument))).Statement",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition)",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "condition",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = tostring(Action)",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend PolicyName = tostring(split(tostring(parse_json(RequestParameters).policyArn),\"/\")[1])",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "attacheventcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "eventname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "useridentitytype",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AttachEventCount=count(), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventSource, EventName,   UserIdentityType , UserIdentityArn, SourceIpAddress, RecipientAccountId, AccountName, AccountUPNSuffix, PolicyName",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttachEvent = pack(\"StartTime\", StartTime, \"EndTime\", EndTime, \"EventName\", EventName, \"UserIdentityType\",   UserIdentityType, \"AccountName\", AccountName, \"AccountUPNSuffix\", AccountUPNSuffix, \"RecipientAccountId\", RecipientAccountId, \"UserIdentityArn\", UserIdentityArn, \"SourceIpAddress\", SourceIpAddress)",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "attachevent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "eventsource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "policyname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "attachevent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "recipientaccountid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project EventSource, PolicyName, AttachEvent, RecipientAccountId, AccountName, AccountUPNSuffix, AttachEventCount",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "attacheventcount",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTime",
    "detection": "aws-createdssmpolicytoprivilegeescalation.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize count() by SrcAddr, DstAddr, AccountId",
    "detection": "awsvpc-network-traffic-flow.yaml",
    "field": "srcaddr",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize count() by SrcAddr, DstAddr, AccountId",
    "detection": "awsvpc-network-traffic-flow.yaml",
    "field": "dstaddr",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize count() by SrcAddr, DstAddr, AccountId",
    "detection": "awsvpc-network-traffic-flow.yaml",
    "field": "accountid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "  | project SrcAddr, DstAddr, AccountId, count_",
    "detection": "awsvpc-network-traffic-flow.yaml",
    "field": "srcaddr",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project SrcAddr, DstAddr, AccountId, count_",
    "detection": "awsvpc-network-traffic-flow.yaml",
    "field": "dstaddr",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project SrcAddr, DstAddr, AccountId, count_",
    "detection": "awsvpc-network-traffic-flow.yaml",
    "field": "accountid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "  | project SrcAddr, DstAddr, AccountId, count_",
    "detection": "awsvpc-network-traffic-flow.yaml",
    "field": "count_",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Statement = parse_json(tostring((parse_json(RequestParameters).PutAccessPointPolicyRequest.Policy))).Statement",
    "detection": "aws-s3bucketaccesspointexposed.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition), Principal_aws = tostring(parse_json(Statement).Principal.AWS), Principal = tostring(parse_json(Statement).Principal)",
    "detection": "aws-s3bucketaccesspointexposed.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition), Principal_aws = tostring(parse_json(Statement).Principal.AWS), Principal = tostring(parse_json(Statement).Principal)",
    "detection": "aws-s3bucketaccesspointexposed.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition), Principal_aws = tostring(parse_json(Statement).Principal.AWS), Principal = tostring(parse_json(Statement).Principal)",
    "detection": "aws-s3bucketaccesspointexposed.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition), Principal_aws = tostring(parse_json(Statement).Principal.AWS), Principal = tostring(parse_json(Statement).Principal)",
    "detection": "aws-s3bucketaccesspointexposed.yaml",
    "field": "condition",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition), Principal_aws = tostring(parse_json(Statement).Principal.AWS), Principal = tostring(parse_json(Statement).Principal)",
    "detection": "aws-s3bucketaccesspointexposed.yaml",
    "field": "principal_aws",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = parse_json(Statement).Action , Effect = tostring(parse_json(Statement).Effect), Resource = tostring(parse_json(Statement).Resource), Condition = tostring(parse_json(Statement).Condition), Principal_aws = tostring(parse_json(Statement).Principal.AWS), Principal = tostring(parse_json(Statement).Principal)",
    "detection": "aws-s3bucketaccesspointexposed.yaml",
    "field": "principal",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = tostring(Action)",
    "detection": "aws-s3bucketaccesspointexposed.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-s3bucketaccesspointexposed.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-s3bucketaccesspointexposed.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-s3bucketaccesspointexposed.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-s3bucketaccesspointexposed.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "aws-s3bucketaccesspointexposed.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Statement = parse_json(tostring((parse_json(RequestParameters).policy))).Statement",
    "detection": "aws-overlypermessivekms.yaml",
    "field": "statement",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = tostring(parse_json(Statement).Action), Effect = tostring(parse_json(Statement).Effect), Principal = iff(isnotempty(tostring(parse_json(Statement).Principal.AWS)),tostring(parse_json(Statement).Principal.AWS), tostring(parse_json(Statement).Principal))",
    "detection": "aws-overlypermessivekms.yaml",
    "field": "action",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = tostring(parse_json(Statement).Action), Effect = tostring(parse_json(Statement).Effect), Principal = iff(isnotempty(tostring(parse_json(Statement).Principal.AWS)),tostring(parse_json(Statement).Principal.AWS), tostring(parse_json(Statement).Principal))",
    "detection": "aws-overlypermessivekms.yaml",
    "field": "effect",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Action = tostring(parse_json(Statement).Action), Effect = tostring(parse_json(Statement).Effect), Principal = iff(isnotempty(tostring(parse_json(Statement).Principal.AWS)),tostring(parse_json(Statement).Principal.AWS), tostring(parse_json(Statement).Principal))",
    "detection": "aws-overlypermessivekms.yaml",
    "field": "principal",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-overlypermessivekms.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-overlypermessivekms.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-overlypermessivekms.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-overlypermessivekms.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "aws-overlypermessivekms.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdentityArn = iif(isempty(UserIdentityArn), tostring(parse_json(Resources)[0].ARN), UserIdentityArn)",
    "detection": "aws-apifromtor.yaml",
    "field": "useridentityarn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = tostring(split(UserIdentityArn, '/')[-1])",
    "detection": "aws-apifromtor.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = case( UserIdentityPrincipalid == \"Anonymous\", \"Anonymous\", isempty(UserIdentityUserName), UserName, UserIdentityUserName)",
    "detection": "aws-apifromtor.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iif(AccountName contains \"@\", tostring(split(AccountName, '@', 0)[0]), AccountName),",
    "detection": "aws-apifromtor.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "aws-apifromtor.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend message = parse_json(Message)",
    "detection": "aws-config-notification-delivery-failed.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend message = parse_json(Message)",
    "detection": "change-is-non-compliant-with-aws-config-rule.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Message = todynamic(Message)",
    "detection": "dynamodb-deletetable.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(parse_json(tostring(parse_json(tostring(userIdentity.sessionContext)).sessionIssuer)).userName)",
    "detection": "dynamodb-deletetable.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend findingTokens = split(ActivityType, \":\")",
    "detection": "aws-guardduty-template.yaml",
    "field": "findingtokens",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ThreatPurpose=findingTokens[0], findingTokens=split(findingTokens[1], \"/\")",
    "detection": "aws-guardduty-template.yaml",
    "field": "threatpurpose",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ThreatPurpose=findingTokens[0], findingTokens=split(findingTokens[1], \"/\")",
    "detection": "aws-guardduty-template.yaml",
    "field": "findingtokens",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ResourceTypeAffected=findingTokens[0], findingTokens= split(findingTokens[1], \".\")",
    "detection": "aws-guardduty-template.yaml",
    "field": "resourcetypeaffected",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ResourceTypeAffected=findingTokens[0], findingTokens= split(findingTokens[1], \".\")",
    "detection": "aws-guardduty-template.yaml",
    "field": "findingtokens",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ThreatFamilyName=findingTokens[0], findingTokens=split(findingTokens[1], \"!\")",
    "detection": "aws-guardduty-template.yaml",
    "field": "threatfamilyname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ThreatFamilyName=findingTokens[0], findingTokens=split(findingTokens[1], \"!\")",
    "detection": "aws-guardduty-template.yaml",
    "field": "findingtokens",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DetectionMechanism=findingTokens[0], Artifact=findingTokens[1]",
    "detection": "aws-guardduty-template.yaml",
    "field": "detectionmechanism",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DetectionMechanism=findingTokens[0], Artifact=findingTokens[1]",
    "detection": "aws-guardduty-template.yaml",
    "field": "artifact",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Severity =",
    "detection": "aws-guardduty-template.yaml",
    "field": "severity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccessKeyDetails=ResourceDetails.accessKeyDetails",
    "detection": "aws-guardduty-template.yaml",
    "field": "accesskeydetails",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend RdsDbUserDetails=ResourceDetails.rdsDbUserDetails",
    "detection": "aws-guardduty-template.yaml",
    "field": "rdsdbuserdetails",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend KubernetesDetails=ResourceDetails.kubernetesDetails",
    "detection": "aws-guardduty-template.yaml",
    "field": "kubernetesdetails",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ServiceAction =",
    "detection": "aws-guardduty-template.yaml",
    "field": "serviceaction",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend RemoteIpAddress =",
    "detection": "aws-guardduty-template.yaml",
    "field": "remoteipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend LocalIpAddress = ServiceAction.localIpDetails.ipAddressV4",
    "detection": "aws-guardduty-template.yaml",
    "field": "localipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend RemoteAWSAccountId = ServiceAction.remoteAccountDetails.accountId",
    "detection": "aws-guardduty-template.yaml",
    "field": "remoteawsaccountid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountUpn =",
    "detection": "aws-guardduty-template.yaml",
    "field": "accountupn",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = split(AccountUpn, \"@\", 0)[0]",
    "detection": "aws-guardduty-template.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UPNSuffix = split(AccountUpn, \"@\", 1)[0]",
    "detection": "aws-guardduty-template.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend GuardDutyDetails =",
    "detection": "aws-guardduty-template.yaml",
    "field": "guarddutydetails",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend FindingLink =",
    "detection": "aws-guardduty-template.yaml",
    "field": "findinglink",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend FindingLinkDescription =",
    "detection": "aws-guardduty-template.yaml",
    "field": "findinglinkdescription",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "successful-action-detected-on-eks-from-a-potentially-malicious-ip-caller.yaml",
    "field": "latestindicatortime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "successful-action-detected-on-eks-from-a-potentially-malicious-ip-caller.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TI_ipEntity = coalesce(NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress)",
    "detection": "successful-action-detected-on-eks-from-a-potentially-malicious-ip-caller.yaml",
    "field": "ti_ipentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Domain = iff(countof(DestinationHostName,'.') >= 2, strcat(split(DestinationHostName,'.')[-2], '.',split(DestinationHostName,'.')[-1]), DestinationHostName)",
    "detection": "zscaler-lowvolumedomainrequests.yaml",
    "field": "domain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend GetData=iff(RequestURL == \"?\", 1, 0)",
    "detection": "zscaler-lowvolumedomainrequests.yaml",
    "field": "getdata",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), makelist(RequestURL), makelist(DestinationIP), makelist(SourceIP), numOfConnections = count(), make_set(RequestMethod), max(GetData), max(RequestContext) by Domain",
    "detection": "zscaler-lowvolumedomainrequests.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), makelist(RequestURL), makelist(DestinationIP), makelist(SourceIP), numOfConnections = count(), make_set(RequestMethod), max(GetData), max(RequestContext) by Domain",
    "detection": "zscaler-lowvolumedomainrequests.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), makelist(RequestURL), makelist(DestinationIP), makelist(SourceIP), numOfConnections = count(), make_set(RequestMethod), max(GetData), max(RequestContext) by Domain",
    "detection": "zscaler-lowvolumedomainrequests.yaml",
    "field": "numofconnections",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), makelist(RequestURL), makelist(DestinationIP), makelist(SourceIP), numOfConnections = count(), make_set(RequestMethod), max(GetData), max(RequestContext) by Domain",
    "detection": "zscaler-lowvolumedomainrequests.yaml",
    "field": "domain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend destinationURI = arraylength(list_RequestURL)",
    "detection": "zscaler-lowvolumedomainrequests.yaml",
    "field": "destinationuri",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend RequestURL = tostring(list_RequestURL), DestinationIP = tostring(list_DestinationIP), ClientIP = tostring(list_SourceIP)",
    "detection": "zscaler-lowvolumedomainrequests.yaml",
    "field": "requesturl",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend RequestURL = tostring(list_RequestURL), DestinationIP = tostring(list_DestinationIP), ClientIP = tostring(list_SourceIP)",
    "detection": "zscaler-lowvolumedomainrequests.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend RequestURL = tostring(list_RequestURL), DestinationIP = tostring(list_DestinationIP), ClientIP = tostring(list_SourceIP)",
    "detection": "zscaler-lowvolumedomainrequests.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(DeviceName, \".\")[0]), DomainIndex = toint(indexof(DeviceName, '.'))",
    "detection": "ciscoasa-threatdetectionmessage.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(DeviceName, \".\")[0]), DomainIndex = toint(indexof(DeviceName, '.'))",
    "detection": "ciscoasa-threatdetectionmessage.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(DeviceName, DomainIndex + 1), DeviceName)",
    "detection": "ciscoasa-threatdetectionmessage.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceOfDropRateCount = tostring(split(tostring(split(Message, \"]\")[0]),\"[ \")[1])",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "sourceofdropratecount",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend splitMessage = split(Message, \".\")",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "splitmessage",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DropRate = tostring(split(tostring(splitMessage[0]),\"] \")[1])",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "droprate",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend CurrentBurstRate = split(tostring(split(tostring(splitMessage[1]),\"  \")[0]),\"is \")",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "currentburstrate",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend CurrentBurstRatePerSec = toint(split(tostring(CurrentBurstRate[1]),\" \")[0])",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "currentburstratepersec",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend MaxConfiguredBurstRate = toint(CurrentBurstRate[2])",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "maxconfiguredburstrate",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend CurrentAvgRate = split(tostring(split(tostring(splitMessage[1]),\"  \")[1]),\"is \")",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "currentavgrate",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend CurrentAvgRatePerSec = toint(split(tostring(CurrentAvgRate[1]),\" \")[0])",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "currentavgratepersec",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend MaxConfiguredAvgRate = toint(CurrentAvgRate[2])",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "maxconfiguredavgrate",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend CumulativeTotal = toint(split(tostring(split(tostring(splitMessage[1]),\"  \")[2]),\"is \")[1])",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "cumulativetotal",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize last1hCumTotal = sum(CumulativeTotal), last1hAvgRatePerSec = avg(CurrentAvgRatePerSec), last1hAvgBurstRatePerSec = avg(CurrentBurstRatePerSec) by DeviceName, DeviceEventClassID, SourceIP, SourceOfDropRateCount, DropRate;",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "last1hcumtotal",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize last1hCumTotal = sum(CumulativeTotal), last1hAvgRatePerSec = avg(CurrentAvgRatePerSec), last1hAvgBurstRatePerSec = avg(CurrentBurstRatePerSec) by DeviceName, DeviceEventClassID, SourceIP, SourceOfDropRateCount, DropRate;",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "last1havgratepersec",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize last1hCumTotal = sum(CumulativeTotal), last1hAvgRatePerSec = avg(CurrentAvgRatePerSec), last1hAvgBurstRatePerSec = avg(CurrentBurstRatePerSec) by DeviceName, DeviceEventClassID, SourceIP, SourceOfDropRateCount, DropRate;",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "last1havgburstratepersec",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize last1hCumTotal = sum(CumulativeTotal), last1hAvgRatePerSec = avg(CurrentAvgRatePerSec), last1hAvgBurstRatePerSec = avg(CurrentBurstRatePerSec) by DeviceName, DeviceEventClassID, SourceIP, SourceOfDropRateCount, DropRate;",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize last1hCumTotal = sum(CumulativeTotal), last1hAvgRatePerSec = avg(CurrentAvgRatePerSec), last1hAvgBurstRatePerSec = avg(CurrentBurstRatePerSec) by DeviceName, DeviceEventClassID, SourceIP, SourceOfDropRateCount, DropRate;",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "deviceeventclassid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize last1hCumTotal = sum(CumulativeTotal), last1hAvgRatePerSec = avg(CurrentAvgRatePerSec), last1hAvgBurstRatePerSec = avg(CurrentBurstRatePerSec) by DeviceName, DeviceEventClassID, SourceIP, SourceOfDropRateCount, DropRate;",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize last1hCumTotal = sum(CumulativeTotal), last1hAvgRatePerSec = avg(CurrentAvgRatePerSec), last1hAvgBurstRatePerSec = avg(CurrentBurstRatePerSec) by DeviceName, DeviceEventClassID, SourceIP, SourceOfDropRateCount, DropRate;",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "sourceofdropratecount",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceOfDropRateCount = tostring(split(tostring(split(Message, \"]\")[0]),\"[ \")[1])",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "sourceofdropratecount",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend splitMessage = split(Message, \".\")",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "splitmessage",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DropRate = tostring(split(tostring(splitMessage[0]),\"] \")[1])",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "droprate",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend CurrentBurstRate = split(tostring(split(tostring(splitMessage[1]),\"  \")[0]),\"is \")",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "currentburstrate",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend prevCurrentBurstRatePerSec = toint(split(tostring(CurrentBurstRate[1]),\" \")[0])",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "prevcurrentburstratepersec",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend prevMaxConfiguredBurstRate = toint(CurrentBurstRate[2])",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "prevmaxconfiguredburstrate",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend CurrentAvgRate = split(tostring(split(tostring(splitMessage[1]),\"  \")[1]),\"is \")",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "currentavgrate",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend prevCurrentAvgRatePerSec = toint(split(tostring(CurrentAvgRate[1]),\" \")[0])",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "prevcurrentavgratepersec",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend prevMaxConfiguredAvgRate = toint(CurrentAvgRate[2])",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "prevmaxconfiguredavgrate",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend prevCumulativeTotal = toint(split(tostring(split(tostring(splitMessage[1]),\"  \")[2]),\"is \")[1])",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "prevcumulativetotal",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), prev6hCumTotal = sum(prevCumulativeTotal), prev6hAvgRatePerSec = avg(prevCurrentAvgRatePerSec), prev6hAvgBurstRatePerSec = avg(prevCurrentBurstRatePerSec)",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), prev6hCumTotal = sum(prevCumulativeTotal), prev6hAvgRatePerSec = avg(prevCurrentAvgRatePerSec), prev6hAvgBurstRatePerSec = avg(prevCurrentBurstRatePerSec)",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), prev6hCumTotal = sum(prevCumulativeTotal), prev6hAvgRatePerSec = avg(prevCurrentAvgRatePerSec), prev6hAvgBurstRatePerSec = avg(prevCurrentBurstRatePerSec)",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "prev6hcumtotal",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), prev6hCumTotal = sum(prevCumulativeTotal), prev6hAvgRatePerSec = avg(prevCurrentAvgRatePerSec), prev6hAvgBurstRatePerSec = avg(prevCurrentBurstRatePerSec)",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "prev6havgratepersec",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), prev6hCumTotal = sum(prevCumulativeTotal), prev6hAvgRatePerSec = avg(prevCurrentAvgRatePerSec), prev6hAvgBurstRatePerSec = avg(prevCurrentBurstRatePerSec)",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "prev6havgburstratepersec",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTimeUtc, EndTimeUtc, DeviceName, DeviceEventClassID, SourceIP, SourceOfDropRateCount, DropRate, last1hCumTotal, prev6hCumTotal, prev6hAvgCumTotal = prev6hCumTotal/6, last1hAvgRatePerSec, prev6hAvgRatePerSec, last1hAvgBurstRatePerSec, prev6hAvgBurstRatePerSec",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTimeUtc, EndTimeUtc, DeviceName, DeviceEventClassID, SourceIP, SourceOfDropRateCount, DropRate, last1hCumTotal, prev6hCumTotal, prev6hAvgCumTotal = prev6hCumTotal/6, last1hAvgRatePerSec, prev6hAvgRatePerSec, last1hAvgBurstRatePerSec, prev6hAvgBurstRatePerSec",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTimeUtc, EndTimeUtc, DeviceName, DeviceEventClassID, SourceIP, SourceOfDropRateCount, DropRate, last1hCumTotal, prev6hCumTotal, prev6hAvgCumTotal = prev6hCumTotal/6, last1hAvgRatePerSec, prev6hAvgRatePerSec, last1hAvgBurstRatePerSec, prev6hAvgBurstRatePerSec",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTimeUtc, EndTimeUtc, DeviceName, DeviceEventClassID, SourceIP, SourceOfDropRateCount, DropRate, last1hCumTotal, prev6hCumTotal, prev6hAvgCumTotal = prev6hCumTotal/6, last1hAvgRatePerSec, prev6hAvgRatePerSec, last1hAvgBurstRatePerSec, prev6hAvgBurstRatePerSec",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "deviceeventclassid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTimeUtc, EndTimeUtc, DeviceName, DeviceEventClassID, SourceIP, SourceOfDropRateCount, DropRate, last1hCumTotal, prev6hCumTotal, prev6hAvgCumTotal = prev6hCumTotal/6, last1hAvgRatePerSec, prev6hAvgRatePerSec, last1hAvgBurstRatePerSec, prev6hAvgBurstRatePerSec",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTimeUtc, EndTimeUtc, DeviceName, DeviceEventClassID, SourceIP, SourceOfDropRateCount, DropRate, last1hCumTotal, prev6hCumTotal, prev6hAvgCumTotal = prev6hCumTotal/6, last1hAvgRatePerSec, prev6hAvgRatePerSec, last1hAvgBurstRatePerSec, prev6hAvgBurstRatePerSec",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "sourceofdropratecount",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTimeUtc, EndTimeUtc, DeviceName, DeviceEventClassID, SourceIP, SourceOfDropRateCount, DropRate, last1hCumTotal, prev6hCumTotal, prev6hAvgCumTotal = prev6hCumTotal/6, last1hAvgRatePerSec, prev6hAvgRatePerSec, last1hAvgBurstRatePerSec, prev6hAvgBurstRatePerSec",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "droprate",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTimeUtc, EndTimeUtc, DeviceName, DeviceEventClassID, SourceIP, SourceOfDropRateCount, DropRate, last1hCumTotal, prev6hCumTotal, prev6hAvgCumTotal = prev6hCumTotal/6, last1hAvgRatePerSec, prev6hAvgRatePerSec, last1hAvgBurstRatePerSec, prev6hAvgBurstRatePerSec",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "last1hcumtotal",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTimeUtc, EndTimeUtc, DeviceName, DeviceEventClassID, SourceIP, SourceOfDropRateCount, DropRate, last1hCumTotal, prev6hCumTotal, prev6hAvgCumTotal = prev6hCumTotal/6, last1hAvgRatePerSec, prev6hAvgRatePerSec, last1hAvgBurstRatePerSec, prev6hAvgBurstRatePerSec",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "prev6hcumtotal",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTimeUtc, EndTimeUtc, DeviceName, DeviceEventClassID, SourceIP, SourceOfDropRateCount, DropRate, last1hCumTotal, prev6hCumTotal, prev6hAvgCumTotal = prev6hCumTotal/6, last1hAvgRatePerSec, prev6hAvgRatePerSec, last1hAvgBurstRatePerSec, prev6hAvgBurstRatePerSec",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "prev6havgcumtotal",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTimeUtc, EndTimeUtc, DeviceName, DeviceEventClassID, SourceIP, SourceOfDropRateCount, DropRate, last1hCumTotal, prev6hCumTotal, prev6hAvgCumTotal = prev6hCumTotal/6, last1hAvgRatePerSec, prev6hAvgRatePerSec, last1hAvgBurstRatePerSec, prev6hAvgBurstRatePerSec",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "last1havgratepersec",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTimeUtc, EndTimeUtc, DeviceName, DeviceEventClassID, SourceIP, SourceOfDropRateCount, DropRate, last1hCumTotal, prev6hCumTotal, prev6hAvgCumTotal = prev6hCumTotal/6, last1hAvgRatePerSec, prev6hAvgRatePerSec, last1hAvgBurstRatePerSec, prev6hAvgBurstRatePerSec",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "prev6havgratepersec",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTimeUtc, EndTimeUtc, DeviceName, DeviceEventClassID, SourceIP, SourceOfDropRateCount, DropRate, last1hCumTotal, prev6hCumTotal, prev6hAvgCumTotal = prev6hCumTotal/6, last1hAvgRatePerSec, prev6hAvgRatePerSec, last1hAvgBurstRatePerSec, prev6hAvgBurstRatePerSec",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "last1havgburstratepersec",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTimeUtc, EndTimeUtc, DeviceName, DeviceEventClassID, SourceIP, SourceOfDropRateCount, DropRate, last1hCumTotal, prev6hCumTotal, prev6hAvgCumTotal = prev6hCumTotal/6, last1hAvgRatePerSec, prev6hAvgRatePerSec, last1hAvgBurstRatePerSec, prev6hAvgBurstRatePerSec",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "prev6havgburstratepersec",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(DeviceName, \".\")[0]), DomainIndex = toint(indexof(DeviceName, '.'))",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(DeviceName, \".\")[0]), DomainIndex = toint(indexof(DeviceName, '.'))",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(DeviceName, DomainIndex + 1), DeviceName)",
    "detection": "ciscoasa-avgattackdetectrateincrease.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Reason = coalesce(",
    "detection": "paloalto-portscanning.yaml",
    "field": "reason",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), count() by DeviceName, SourceUserID, SourceIP, ApplicationProtocol, Reason, DestinationPort, Protocol, DeviceVendor, DeviceProduct, DeviceAction, DestinationIP",
    "detection": "paloalto-portscanning.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), count() by DeviceName, SourceUserID, SourceIP, ApplicationProtocol, Reason, DestinationPort, Protocol, DeviceVendor, DeviceProduct, DeviceAction, DestinationIP",
    "detection": "paloalto-portscanning.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), count() by DeviceName, SourceUserID, SourceIP, ApplicationProtocol, Reason, DestinationPort, Protocol, DeviceVendor, DeviceProduct, DeviceAction, DestinationIP",
    "detection": "paloalto-portscanning.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), count() by DeviceName, SourceUserID, SourceIP, ApplicationProtocol, Reason, DestinationPort, Protocol, DeviceVendor, DeviceProduct, DeviceAction, DestinationIP",
    "detection": "paloalto-portscanning.yaml",
    "field": "sourceuserid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), count() by DeviceName, SourceUserID, SourceIP, ApplicationProtocol, Reason, DestinationPort, Protocol, DeviceVendor, DeviceProduct, DeviceAction, DestinationIP",
    "detection": "paloalto-portscanning.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), count() by DeviceName, SourceUserID, SourceIP, ApplicationProtocol, Reason, DestinationPort, Protocol, DeviceVendor, DeviceProduct, DeviceAction, DestinationIP",
    "detection": "paloalto-portscanning.yaml",
    "field": "applicationprotocol",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), count() by DeviceName, SourceUserID, SourceIP, ApplicationProtocol, Reason, DestinationPort, Protocol, DeviceVendor, DeviceProduct, DeviceAction, DestinationIP",
    "detection": "paloalto-portscanning.yaml",
    "field": "reason",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), count() by DeviceName, SourceUserID, SourceIP, ApplicationProtocol, Reason, DestinationPort, Protocol, DeviceVendor, DeviceProduct, DeviceAction, DestinationIP",
    "detection": "paloalto-portscanning.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), count() by DeviceName, SourceUserID, SourceIP, ApplicationProtocol, Reason, DestinationPort, Protocol, DeviceVendor, DeviceProduct, DeviceAction, DestinationIP",
    "detection": "paloalto-portscanning.yaml",
    "field": "protocol",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), count() by DeviceName, SourceUserID, SourceIP, ApplicationProtocol, Reason, DestinationPort, Protocol, DeviceVendor, DeviceProduct, DeviceAction, DestinationIP",
    "detection": "paloalto-portscanning.yaml",
    "field": "devicevendor",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), count() by DeviceName, SourceUserID, SourceIP, ApplicationProtocol, Reason, DestinationPort, Protocol, DeviceVendor, DeviceProduct, DeviceAction, DestinationIP",
    "detection": "paloalto-portscanning.yaml",
    "field": "deviceproduct",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), count() by DeviceName, SourceUserID, SourceIP, ApplicationProtocol, Reason, DestinationPort, Protocol, DeviceVendor, DeviceProduct, DeviceAction, DestinationIP",
    "detection": "paloalto-portscanning.yaml",
    "field": "deviceaction",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), count() by DeviceName, SourceUserID, SourceIP, ApplicationProtocol, Reason, DestinationPort, Protocol, DeviceVendor, DeviceProduct, DeviceAction, DestinationIP",
    "detection": "paloalto-portscanning.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(StartTimeUtc), EndTimeUtc = max(EndTimeUtc), makeset(DestinationIP), totalcount = sum(count_) by DeviceName, SourceUserID, SourceIP, ApplicationProtocol, Reason, DestinationPort, Protocol, DeviceVendor, DeviceProduct, DeviceAction",
    "detection": "paloalto-portscanning.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(StartTimeUtc), EndTimeUtc = max(EndTimeUtc), makeset(DestinationIP), totalcount = sum(count_) by DeviceName, SourceUserID, SourceIP, ApplicationProtocol, Reason, DestinationPort, Protocol, DeviceVendor, DeviceProduct, DeviceAction",
    "detection": "paloalto-portscanning.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(StartTimeUtc), EndTimeUtc = max(EndTimeUtc), makeset(DestinationIP), totalcount = sum(count_) by DeviceName, SourceUserID, SourceIP, ApplicationProtocol, Reason, DestinationPort, Protocol, DeviceVendor, DeviceProduct, DeviceAction",
    "detection": "paloalto-portscanning.yaml",
    "field": "totalcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(StartTimeUtc), EndTimeUtc = max(EndTimeUtc), makeset(DestinationIP), totalcount = sum(count_) by DeviceName, SourceUserID, SourceIP, ApplicationProtocol, Reason, DestinationPort, Protocol, DeviceVendor, DeviceProduct, DeviceAction",
    "detection": "paloalto-portscanning.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(StartTimeUtc), EndTimeUtc = max(EndTimeUtc), makeset(DestinationIP), totalcount = sum(count_) by DeviceName, SourceUserID, SourceIP, ApplicationProtocol, Reason, DestinationPort, Protocol, DeviceVendor, DeviceProduct, DeviceAction",
    "detection": "paloalto-portscanning.yaml",
    "field": "sourceuserid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(StartTimeUtc), EndTimeUtc = max(EndTimeUtc), makeset(DestinationIP), totalcount = sum(count_) by DeviceName, SourceUserID, SourceIP, ApplicationProtocol, Reason, DestinationPort, Protocol, DeviceVendor, DeviceProduct, DeviceAction",
    "detection": "paloalto-portscanning.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(StartTimeUtc), EndTimeUtc = max(EndTimeUtc), makeset(DestinationIP), totalcount = sum(count_) by DeviceName, SourceUserID, SourceIP, ApplicationProtocol, Reason, DestinationPort, Protocol, DeviceVendor, DeviceProduct, DeviceAction",
    "detection": "paloalto-portscanning.yaml",
    "field": "applicationprotocol",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(StartTimeUtc), EndTimeUtc = max(EndTimeUtc), makeset(DestinationIP), totalcount = sum(count_) by DeviceName, SourceUserID, SourceIP, ApplicationProtocol, Reason, DestinationPort, Protocol, DeviceVendor, DeviceProduct, DeviceAction",
    "detection": "paloalto-portscanning.yaml",
    "field": "reason",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(StartTimeUtc), EndTimeUtc = max(EndTimeUtc), makeset(DestinationIP), totalcount = sum(count_) by DeviceName, SourceUserID, SourceIP, ApplicationProtocol, Reason, DestinationPort, Protocol, DeviceVendor, DeviceProduct, DeviceAction",
    "detection": "paloalto-portscanning.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(StartTimeUtc), EndTimeUtc = max(EndTimeUtc), makeset(DestinationIP), totalcount = sum(count_) by DeviceName, SourceUserID, SourceIP, ApplicationProtocol, Reason, DestinationPort, Protocol, DeviceVendor, DeviceProduct, DeviceAction",
    "detection": "paloalto-portscanning.yaml",
    "field": "protocol",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(StartTimeUtc), EndTimeUtc = max(EndTimeUtc), makeset(DestinationIP), totalcount = sum(count_) by DeviceName, SourceUserID, SourceIP, ApplicationProtocol, Reason, DestinationPort, Protocol, DeviceVendor, DeviceProduct, DeviceAction",
    "detection": "paloalto-portscanning.yaml",
    "field": "devicevendor",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(StartTimeUtc), EndTimeUtc = max(EndTimeUtc), makeset(DestinationIP), totalcount = sum(count_) by DeviceName, SourceUserID, SourceIP, ApplicationProtocol, Reason, DestinationPort, Protocol, DeviceVendor, DeviceProduct, DeviceAction",
    "detection": "paloalto-portscanning.yaml",
    "field": "deviceproduct",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(StartTimeUtc), EndTimeUtc = max(EndTimeUtc), makeset(DestinationIP), totalcount = sum(count_) by DeviceName, SourceUserID, SourceIP, ApplicationProtocol, Reason, DestinationPort, Protocol, DeviceVendor, DeviceProduct, DeviceAction",
    "detection": "paloalto-portscanning.yaml",
    "field": "deviceaction",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, IPCustomEntity = SourceIP, AccountCustomEntity = SourceUserID, HostCustomEntity = DeviceName",
    "detection": "paloalto-portscanning.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, IPCustomEntity = SourceIP, AccountCustomEntity = SourceUserID, HostCustomEntity = DeviceName",
    "detection": "paloalto-portscanning.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, IPCustomEntity = SourceIP, AccountCustomEntity = SourceUserID, HostCustomEntity = DeviceName",
    "detection": "paloalto-portscanning.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, IPCustomEntity = SourceIP, AccountCustomEntity = SourceUserID, HostCustomEntity = DeviceName",
    "detection": "paloalto-portscanning.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "   | extend CommonSecurityLog_TimeGenerated = TimeGenerated",
    "detection": "filehashentity-covid19-commonsecuritylog.yaml",
    "field": "commonsecuritylog_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize CommonSecurityLog_TimeGenerated = arg_max(CommonSecurityLog_TimeGenerated, *) by FileHashValue",
    "detection": "filehashentity-covid19-commonsecuritylog.yaml",
    "field": "commonsecuritylog_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize CommonSecurityLog_TimeGenerated = arg_max(CommonSecurityLog_TimeGenerated, *) by FileHashValue",
    "detection": "filehashentity-covid19-commonsecuritylog.yaml",
    "field": "filehashvalue",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project CommonSecurityLog_TimeGenerated, FileHashValue, FileHashType, Description, ThreatType,",
    "detection": "filehashentity-covid19-commonsecuritylog.yaml",
    "field": "commonsecuritylog_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project CommonSecurityLog_TimeGenerated, FileHashValue, FileHashType, Description, ThreatType,",
    "detection": "filehashentity-covid19-commonsecuritylog.yaml",
    "field": "filehashvalue",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project CommonSecurityLog_TimeGenerated, FileHashValue, FileHashType, Description, ThreatType,",
    "detection": "filehashentity-covid19-commonsecuritylog.yaml",
    "field": "filehashtype",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project CommonSecurityLog_TimeGenerated, FileHashValue, FileHashType, Description, ThreatType,",
    "detection": "filehashentity-covid19-commonsecuritylog.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project CommonSecurityLog_TimeGenerated, FileHashValue, FileHashType, Description, ThreatType,",
    "detection": "filehashentity-covid19-commonsecuritylog.yaml",
    "field": "threattype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(SourceUserName, \"@\")[0]), AccountUPNSuffix = tostring(split(SourceUserName, \"@\")[1])",
    "detection": "filehashentity-covid19-commonsecuritylog.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(SourceUserName, \"@\")[0]), AccountUPNSuffix = tostring(split(SourceUserName, \"@\")[1])",
    "detection": "filehashentity-covid19-commonsecuritylog.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(DeviceName, \".\")[0]), DomainIndex = toint(indexof(DeviceName, '.'))",
    "detection": "filehashentity-covid19-commonsecuritylog.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(DeviceName, \".\")[0]), DomainIndex = toint(indexof(DeviceName, '.'))",
    "detection": "filehashentity-covid19-commonsecuritylog.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(DeviceName, DomainIndex + 1), DeviceName)",
    "detection": "filehashentity-covid19-commonsecuritylog.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, SourceUserName, DestinationIP, DestinationPort, DeviceAction, ReceivedBytes, Protocol, SentBytes, DeviceName",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, SourceUserName, DestinationIP, DestinationPort, DeviceAction, ReceivedBytes, Protocol, SentBytes, DeviceName",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "sourceusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, SourceUserName, DestinationIP, DestinationPort, DeviceAction, ReceivedBytes, Protocol, SentBytes, DeviceName",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, SourceUserName, DestinationIP, DestinationPort, DeviceAction, ReceivedBytes, Protocol, SentBytes, DeviceName",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, SourceUserName, DestinationIP, DestinationPort, DeviceAction, ReceivedBytes, Protocol, SentBytes, DeviceName",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "deviceaction",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, SourceUserName, DestinationIP, DestinationPort, DeviceAction, ReceivedBytes, Protocol, SentBytes, DeviceName",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "receivedbytes",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, SourceUserName, DestinationIP, DestinationPort, DeviceAction, ReceivedBytes, Protocol, SentBytes, DeviceName",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "protocol",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, SourceUserName, DestinationIP, DestinationPort, DeviceAction, ReceivedBytes, Protocol, SentBytes, DeviceName",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "sentbytes",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, SourceUserName, DestinationIP, DestinationPort, DeviceAction, ReceivedBytes, Protocol, SentBytes, DeviceName",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend tuple = strcat(SourceUserName, '->', Protocol, ' ', DestinationIP, ':', DestinationPort, ' (', DeviceAction, ')')",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "tuple",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TimeGenerated=bin(TimeGenerated, 1s) // this and next keep only one event per tuple - in case the request is made in the same second",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TimeGenerated_prev=prev(TimeGenerated)",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "timegenerated_prev",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend diff=iff(tuple == prev(tuple), datetime_diff('second', TimeGenerated, TimeGenerated_prev), 9999)",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "diff",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize EventCount=count(), stdevif(diff, diff != 9999), stdev(ReceivedBytes), StartTime=min(TimeGenerated), EndTime=arg_max(TimeGenerated, *) by tuple, Bin=bin(TimeGenerated, bin_size), DeviceName",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "eventcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize EventCount=count(), stdevif(diff, diff != 9999), stdev(ReceivedBytes), StartTime=min(TimeGenerated), EndTime=arg_max(TimeGenerated, *) by tuple, Bin=bin(TimeGenerated, bin_size), DeviceName",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize EventCount=count(), stdevif(diff, diff != 9999), stdev(ReceivedBytes), StartTime=min(TimeGenerated), EndTime=arg_max(TimeGenerated, *) by tuple, Bin=bin(TimeGenerated, bin_size), DeviceName",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize EventCount=count(), stdevif(diff, diff != 9999), stdev(ReceivedBytes), StartTime=min(TimeGenerated), EndTime=arg_max(TimeGenerated, *) by tuple, Bin=bin(TimeGenerated, bin_size), DeviceName",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "tuple",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize EventCount=count(), stdevif(diff, diff != 9999), stdev(ReceivedBytes), StartTime=min(TimeGenerated), EndTime=arg_max(TimeGenerated, *) by tuple, Bin=bin(TimeGenerated, bin_size), DeviceName",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize VictimCount=dcount(SourceUserName) by DestinationIP",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "victimcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize VictimCount=dcount(SourceUserName) by DestinationIP",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize BinCount=dcount(Bin) by tuple",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "bincount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize BinCount=dcount(Bin) by tuple",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "tuple",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend DestinationIP = coalesce(NetworkDestinationIP, NetworkIP, NetworkSourceIP)",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize ConfidenceScore=max(ConfidenceScore), LastSeen=max(TimeGenerated) by DestinationIP, ThreatDescription=Description, ThreatType",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "confidencescore",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize ConfidenceScore=max(ConfidenceScore), LastSeen=max(TimeGenerated) by DestinationIP, ThreatDescription=Description, ThreatType",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "lastseen",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize ConfidenceScore=max(ConfidenceScore), LastSeen=max(TimeGenerated) by DestinationIP, ThreatDescription=Description, ThreatType",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize ConfidenceScore=max(ConfidenceScore), LastSeen=max(TimeGenerated) by DestinationIP, ThreatDescription=Description, ThreatType",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "threattype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_min(StartTime, EndTime, stdevif_diff, VictimCount, EventCount, stdev_ReceivedBytes, BinCount, Protocol, DestinationIP, DestinationPort, DeviceAction, ThreatType, ConfidenceScore, ThreatDescription), TotalEventCount=sum(EventCount), TotalBytesSent=sum(SentBytes), TotalBytesReceived=sum(ReceivedBytes) by tuple, SourceUserName, DestinationIP, DeviceName",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "totaleventcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_min(StartTime, EndTime, stdevif_diff, VictimCount, EventCount, stdev_ReceivedBytes, BinCount, Protocol, DestinationIP, DestinationPort, DeviceAction, ThreatType, ConfidenceScore, ThreatDescription), TotalEventCount=sum(EventCount), TotalBytesSent=sum(SentBytes), TotalBytesReceived=sum(ReceivedBytes) by tuple, SourceUserName, DestinationIP, DeviceName",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "totalbytessent",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_min(StartTime, EndTime, stdevif_diff, VictimCount, EventCount, stdev_ReceivedBytes, BinCount, Protocol, DestinationIP, DestinationPort, DeviceAction, ThreatType, ConfidenceScore, ThreatDescription), TotalEventCount=sum(EventCount), TotalBytesSent=sum(SentBytes), TotalBytesReceived=sum(ReceivedBytes) by tuple, SourceUserName, DestinationIP, DeviceName",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "totalbytesreceived",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_min(StartTime, EndTime, stdevif_diff, VictimCount, EventCount, stdev_ReceivedBytes, BinCount, Protocol, DestinationIP, DestinationPort, DeviceAction, ThreatType, ConfidenceScore, ThreatDescription), TotalEventCount=sum(EventCount), TotalBytesSent=sum(SentBytes), TotalBytesReceived=sum(ReceivedBytes) by tuple, SourceUserName, DestinationIP, DeviceName",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "tuple",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_min(StartTime, EndTime, stdevif_diff, VictimCount, EventCount, stdev_ReceivedBytes, BinCount, Protocol, DestinationIP, DestinationPort, DeviceAction, ThreatType, ConfidenceScore, ThreatDescription), TotalEventCount=sum(EventCount), TotalBytesSent=sum(SentBytes), TotalBytesReceived=sum(ReceivedBytes) by tuple, SourceUserName, DestinationIP, DeviceName",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "sourceusername",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_min(StartTime, EndTime, stdevif_diff, VictimCount, EventCount, stdev_ReceivedBytes, BinCount, Protocol, DestinationIP, DestinationPort, DeviceAction, ThreatType, ConfidenceScore, ThreatDescription), TotalEventCount=sum(EventCount), TotalBytesSent=sum(SentBytes), TotalBytesReceived=sum(ReceivedBytes) by tuple, SourceUserName, DestinationIP, DeviceName",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_min(StartTime, EndTime, stdevif_diff, VictimCount, EventCount, stdev_ReceivedBytes, BinCount, Protocol, DestinationIP, DestinationPort, DeviceAction, ThreatType, ConfidenceScore, ThreatDescription), TotalEventCount=sum(EventCount), TotalBytesSent=sum(SentBytes), TotalBytesReceived=sum(ReceivedBytes) by tuple, SourceUserName, DestinationIP, DeviceName",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Description=strcat('Between ', StartTime, ' and ', EndTime, ', potential beaconing traffic matching [', tuple, '] has generated ', EventCount, ' events in ', bin_size, ' with ~', round(stdevif_diff,1), 's deviation among beacons and ', TotalEventCount, ' total events observed in the entire window checked.')",
    "detection": "paloalto-potential-beaconing.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = iff(DvcHostname has '.', substring(DvcHostname,0,indexof(DvcHostname,'.')),DvcHostname)",
    "detection": "dns-miners.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend DnsDomain = iff(DvcHostname has '.', substring(DvcHostname,indexof(DvcHostname,'.')+1),\"\")",
    "detection": "dns-miners.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend mytld = tostring(split(Query, '.')[-1])",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "mytld",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend truncatedDomain = iff((strlen(Query) - indexof(Query, tostring(split(Query, \".\")[-2])) ) >= 7,",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "truncateddomain",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize domainCount = dcount(truncatedDomain) by DvcIpAddr, bin(TimeGenerated, 1d)",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "domaincount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize domainCount = dcount(truncatedDomain) by DvcIpAddr, bin(TimeGenerated, 1d)",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "dvcipaddr",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SearchList = (domainCount), DvcIpAddr",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "searchlist",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SearchList = (domainCount), DvcIpAddr",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "dvcipaddr",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize qPercentiles = percentiles(SearchList, mypercentile) by DvcIpAddr);",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "qpercentiles",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPthreshold = percentile_SearchList_75 + (1.5*exp(3)*(percentile_SearchList_75 - percentile_SearchList_25))",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "ipthreshold",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize TotalNXLookups=dcount(truncatedDomain) by DvcIpAddr",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "totalnxlookups",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize TotalNXLookups=dcount(truncatedDomain) by DvcIpAddr",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "dvcipaddr",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize domainCount = dcount(Query) by truncatedDomain, DvcIpAddr",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "domaincount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize domainCount = dcount(Query) by truncatedDomain, DvcIpAddr",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "truncateddomain",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize domainCount = dcount(Query) by truncatedDomain, DvcIpAddr",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "dvcipaddr",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project SearchList = strcat(truncatedDomain,\" (\",tostring(domainCount),\")\"), DvcIpAddr",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "searchlist",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project SearchList = strcat(truncatedDomain,\" (\",tostring(domainCount),\")\"), DvcIpAddr",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "dvcipaddr",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SLDs_DistinctLookups = make_list(SearchList) by DvcIpAddr, TotalNXLookups, IPthreshold",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "slds_distinctlookups",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SLDs_DistinctLookups = make_list(SearchList) by DvcIpAddr, TotalNXLookups, IPthreshold",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "dvcipaddr",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SLDs_DistinctLookups = make_list(SearchList) by DvcIpAddr, TotalNXLookups, IPthreshold",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "totalnxlookups",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SLDs_DistinctLookups = make_list(SearchList) by DvcIpAddr, TotalNXLookups, IPthreshold",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "ipthreshold",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize domainCount = dcount(truncatedDomain) by DvcIpAddr",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "domaincount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize domainCount = dcount(truncatedDomain) by DvcIpAddr",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "dvcipaddr",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize event_count = count() by domainCount",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "event_count",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize event_count = count() by domainCount",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "domaincount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize perc2 = percentilesw(domainCount, event_count, mypercentile));",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "perc2",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TotalNXLookups = dcount(truncatedDomain) by DvcIpAddr",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TotalNXLookups = dcount(truncatedDomain) by DvcIpAddr",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TotalNXLookups = dcount(truncatedDomain) by DvcIpAddr",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "totalnxlookups",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), TotalNXLookups = dcount(truncatedDomain) by DvcIpAddr",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "dvcipaddr",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize domainCount = dcount(Query) by truncatedDomain, DvcIpAddr",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "domaincount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize domainCount = dcount(Query) by truncatedDomain, DvcIpAddr",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "truncateddomain",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize domainCount = dcount(Query) by truncatedDomain, DvcIpAddr",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "dvcipaddr",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project truncatedDomain = strcat(truncatedDomain,\" (\",tostring(domainCount),\")\"), DvcIpAddr",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "truncateddomain",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project truncatedDomain = strcat(truncatedDomain,\" (\",tostring(domainCount),\")\"), DvcIpAddr",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "dvcipaddr",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(StartTime), EndTime = max(EndTime), SLDs_DistinctLookups = make_list(truncatedDomain), UniqueSLDsCount=dcount(truncatedDomain) by DvcIpAddr, TotalNXLookups, GlobalThreshold",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(StartTime), EndTime = max(EndTime), SLDs_DistinctLookups = make_list(truncatedDomain), UniqueSLDsCount=dcount(truncatedDomain) by DvcIpAddr, TotalNXLookups, GlobalThreshold",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(StartTime), EndTime = max(EndTime), SLDs_DistinctLookups = make_list(truncatedDomain), UniqueSLDsCount=dcount(truncatedDomain) by DvcIpAddr, TotalNXLookups, GlobalThreshold",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "slds_distinctlookups",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(StartTime), EndTime = max(EndTime), SLDs_DistinctLookups = make_list(truncatedDomain), UniqueSLDsCount=dcount(truncatedDomain) by DvcIpAddr, TotalNXLookups, GlobalThreshold",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "uniquesldscount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(StartTime), EndTime = max(EndTime), SLDs_DistinctLookups = make_list(truncatedDomain), UniqueSLDsCount=dcount(truncatedDomain) by DvcIpAddr, TotalNXLookups, GlobalThreshold",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "dvcipaddr",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(StartTime), EndTime = max(EndTime), SLDs_DistinctLookups = make_list(truncatedDomain), UniqueSLDsCount=dcount(truncatedDomain) by DvcIpAddr, TotalNXLookups, GlobalThreshold",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "totalnxlookups",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(StartTime), EndTime = max(EndTime), SLDs_DistinctLookups = make_list(truncatedDomain), UniqueSLDsCount=dcount(truncatedDomain) by DvcIpAddr, TotalNXLookups, GlobalThreshold",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "globalthreshold",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, DvcIpAddr, TotalNXLookups, IPthreshold, GlobalThreshold, SLDs_DistinctLookups, UniqueSLDsCount",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, DvcIpAddr, TotalNXLookups, IPthreshold, GlobalThreshold, SLDs_DistinctLookups, UniqueSLDsCount",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, DvcIpAddr, TotalNXLookups, IPthreshold, GlobalThreshold, SLDs_DistinctLookups, UniqueSLDsCount",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "dvcipaddr",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, DvcIpAddr, TotalNXLookups, IPthreshold, GlobalThreshold, SLDs_DistinctLookups, UniqueSLDsCount",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "totalnxlookups",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, DvcIpAddr, TotalNXLookups, IPthreshold, GlobalThreshold, SLDs_DistinctLookups, UniqueSLDsCount",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "ipthreshold",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, DvcIpAddr, TotalNXLookups, IPthreshold, GlobalThreshold, SLDs_DistinctLookups, UniqueSLDsCount",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "globalthreshold",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, DvcIpAddr, TotalNXLookups, IPthreshold, GlobalThreshold, SLDs_DistinctLookups, UniqueSLDsCount",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "slds_distinctlookups",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, DvcIpAddr, TotalNXLookups, IPthreshold, GlobalThreshold, SLDs_DistinctLookups, UniqueSLDsCount",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "uniquesldscount",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IP_0_Address = DvcIpAddr",
    "detection": "dns-highpercentnxdomaincount.yaml",
    "field": "ip_0_address",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), dcount(Query), ReverseDNSLookup_List = make_set(Query,100) by DvcIpAddr",
    "detection": "dns-highreversednscount-detection.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), dcount(Query), ReverseDNSLookup_List = make_set(Query,100) by DvcIpAddr",
    "detection": "dns-highreversednscount-detection.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), dcount(Query), ReverseDNSLookup_List = make_set(Query,100) by DvcIpAddr",
    "detection": "dns-highreversednscount-detection.yaml",
    "field": "reversednslookup_list",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), dcount(Query), ReverseDNSLookup_List = make_set(Query,100) by DvcIpAddr",
    "detection": "dns-highreversednscount-detection.yaml",
    "field": "dvcipaddr",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTimeUtc, EndTimeUtc, DvcIpAddr , dcount_Query, ReverseDNSLookup_List",
    "detection": "dns-highreversednscount-detection.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTimeUtc, EndTimeUtc, DvcIpAddr , dcount_Query, ReverseDNSLookup_List",
    "detection": "dns-highreversednscount-detection.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTimeUtc, EndTimeUtc, DvcIpAddr , dcount_Query, ReverseDNSLookup_List",
    "detection": "dns-highreversednscount-detection.yaml",
    "field": "dvcipaddr",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTimeUtc, EndTimeUtc, DvcIpAddr , dcount_Query, ReverseDNSLookup_List",
    "detection": "dns-highreversednscount-detection.yaml",
    "field": "dcount_query",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTimeUtc, EndTimeUtc, DvcIpAddr , dcount_Query, ReverseDNSLookup_List",
    "detection": "dns-highreversednscount-detection.yaml",
    "field": "reversednslookup_list",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize dcount(Query) by DvcIpAddr, bin(TimeGenerated, 1d)",
    "detection": "dns-highreversednscount-detection.yaml",
    "field": "dvcipaddr",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project DvcIpAddr , dcount_Query",
    "detection": "dns-highreversednscount-detection.yaml",
    "field": "dvcipaddr",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project DvcIpAddr , dcount_Query",
    "detection": "dns-highreversednscount-detection.yaml",
    "field": "dcount_query",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = iff(DvcHostname has '.', substring(DvcHostname,0,indexof(DvcHostname,'.')),DvcHostname)",
    "detection": "dns-torproxies.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend DnsDomain = iff(DvcHostname has '.', substring(DvcHostname,indexof(DvcHostname,'.')+1),\"\")",
    "detection": "dns-torproxies.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated , SourceIP, DestinationIP, DestinationPort, ReceivedBytes, SentBytes, DeviceAction",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated , SourceIP, DestinationIP, DestinationPort, ReceivedBytes, SentBytes, DeviceAction",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated , SourceIP, DestinationIP, DestinationPort, ReceivedBytes, SentBytes, DeviceAction",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated , SourceIP, DestinationIP, DestinationPort, ReceivedBytes, SentBytes, DeviceAction",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated , SourceIP, DestinationIP, DestinationPort, ReceivedBytes, SentBytes, DeviceAction",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "receivedbytes",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated , SourceIP, DestinationIP, DestinationPort, ReceivedBytes, SentBytes, DeviceAction",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "sentbytes",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated , SourceIP, DestinationIP, DestinationPort, ReceivedBytes, SentBytes, DeviceAction",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "deviceaction",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend nextTimeGenerated = next(TimeGenerated, 1), nextSourceIP = next(SourceIP, 1), nextDestIP = next(DestinationIP, 1), nextDestPort = next(DestinationPort, 1)",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "nexttimegenerated",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend nextTimeGenerated = next(TimeGenerated, 1), nextSourceIP = next(SourceIP, 1), nextDestIP = next(DestinationIP, 1), nextDestPort = next(DestinationPort, 1)",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "nextsourceip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend nextTimeGenerated = next(TimeGenerated, 1), nextSourceIP = next(SourceIP, 1), nextDestIP = next(DestinationIP, 1), nextDestPort = next(DestinationPort, 1)",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "nextdestip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend nextTimeGenerated = next(TimeGenerated, 1), nextSourceIP = next(SourceIP, 1), nextDestIP = next(DestinationIP, 1), nextDestPort = next(DestinationPort, 1)",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "nextdestport",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend TimeDeltainSeconds = datetime_diff(\"second\",nextTimeGenerated,TimeGenerated)",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "timedeltainseconds",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), sum(ReceivedBytes), sum(SentBytes), makelist(TimeDeltainSeconds), makeset(DeviceAction) by SourceIP, DestinationIP, DestinationPort",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), sum(ReceivedBytes), sum(SentBytes), makelist(TimeDeltainSeconds), makeset(DeviceAction) by SourceIP, DestinationIP, DestinationPort",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), sum(ReceivedBytes), sum(SentBytes), makelist(TimeDeltainSeconds), makeset(DeviceAction) by SourceIP, DestinationIP, DestinationPort",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), sum(ReceivedBytes), sum(SentBytes), makelist(TimeDeltainSeconds), makeset(DeviceAction) by SourceIP, DestinationIP, DestinationPort",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), sum(ReceivedBytes), sum(SentBytes), makelist(TimeDeltainSeconds), makeset(DeviceAction) by SourceIP, DestinationIP, DestinationPort",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend series_stats(list_TimeDeltainSeconds), outliers=series_outliers(list_TimeDeltainSeconds)",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "outliers",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend list_TimeDeltainSeconds_normalized=iff(outliers > 1.5 or outliers < -1.5, series_stats_list_TimeDeltainSeconds_avg , list_TimeDeltainSeconds)",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "list_timedeltainseconds_normalized",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize BeaconCount=count(), makelist(list_TimeDeltainSeconds), list_TimeDeltainSeconds_normalized=makelist(list_TimeDeltainSeconds_normalized), makeset(set_DeviceAction) by StartTime, EndTime, SourceIP, DestinationIP, DestinationPort, sum_ReceivedBytes, sum_SentBytes",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "beaconcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize BeaconCount=count(), makelist(list_TimeDeltainSeconds), list_TimeDeltainSeconds_normalized=makelist(list_TimeDeltainSeconds_normalized), makeset(set_DeviceAction) by StartTime, EndTime, SourceIP, DestinationIP, DestinationPort, sum_ReceivedBytes, sum_SentBytes",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "list_timedeltainseconds_normalized",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize BeaconCount=count(), makelist(list_TimeDeltainSeconds), list_TimeDeltainSeconds_normalized=makelist(list_TimeDeltainSeconds_normalized), makeset(set_DeviceAction) by StartTime, EndTime, SourceIP, DestinationIP, DestinationPort, sum_ReceivedBytes, sum_SentBytes",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize BeaconCount=count(), makelist(list_TimeDeltainSeconds), list_TimeDeltainSeconds_normalized=makelist(list_TimeDeltainSeconds_normalized), makeset(set_DeviceAction) by StartTime, EndTime, SourceIP, DestinationIP, DestinationPort, sum_ReceivedBytes, sum_SentBytes",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize BeaconCount=count(), makelist(list_TimeDeltainSeconds), list_TimeDeltainSeconds_normalized=makelist(list_TimeDeltainSeconds_normalized), makeset(set_DeviceAction) by StartTime, EndTime, SourceIP, DestinationIP, DestinationPort, sum_ReceivedBytes, sum_SentBytes",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize BeaconCount=count(), makelist(list_TimeDeltainSeconds), list_TimeDeltainSeconds_normalized=makelist(list_TimeDeltainSeconds_normalized), makeset(set_DeviceAction) by StartTime, EndTime, SourceIP, DestinationIP, DestinationPort, sum_ReceivedBytes, sum_SentBytes",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize BeaconCount=count(), makelist(list_TimeDeltainSeconds), list_TimeDeltainSeconds_normalized=makelist(list_TimeDeltainSeconds_normalized), makeset(set_DeviceAction) by StartTime, EndTime, SourceIP, DestinationIP, DestinationPort, sum_ReceivedBytes, sum_SentBytes",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize BeaconCount=count(), makelist(list_TimeDeltainSeconds), list_TimeDeltainSeconds_normalized=makelist(list_TimeDeltainSeconds_normalized), makeset(set_DeviceAction) by StartTime, EndTime, SourceIP, DestinationIP, DestinationPort, sum_ReceivedBytes, sum_SentBytes",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "sum_receivedbytes",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize BeaconCount=count(), makelist(list_TimeDeltainSeconds), list_TimeDeltainSeconds_normalized=makelist(list_TimeDeltainSeconds_normalized), makeset(set_DeviceAction) by StartTime, EndTime, SourceIP, DestinationIP, DestinationPort, sum_ReceivedBytes, sum_SentBytes",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "sum_sentbytes",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend MaxJitter = (series_stats_list_TimeDeltainSeconds_normalized_avg*JitterTolerance)",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "maxjitter",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, SourceIP, DestinationIP, DestinationPort, BeaconCount, TimeDeltasInSeconds=list_list_TimeDeltainSeconds, Periodicity=series_stats_list_TimeDeltainSeconds_normalized_avg, ReceivedBytes=sum_ReceivedBytes, SentBytes=sum_SentBytes, Actions=set_set_DeviceAction",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, SourceIP, DestinationIP, DestinationPort, BeaconCount, TimeDeltasInSeconds=list_list_TimeDeltainSeconds, Periodicity=series_stats_list_TimeDeltainSeconds_normalized_avg, ReceivedBytes=sum_ReceivedBytes, SentBytes=sum_SentBytes, Actions=set_set_DeviceAction",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, SourceIP, DestinationIP, DestinationPort, BeaconCount, TimeDeltasInSeconds=list_list_TimeDeltainSeconds, Periodicity=series_stats_list_TimeDeltainSeconds_normalized_avg, ReceivedBytes=sum_ReceivedBytes, SentBytes=sum_SentBytes, Actions=set_set_DeviceAction",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, SourceIP, DestinationIP, DestinationPort, BeaconCount, TimeDeltasInSeconds=list_list_TimeDeltainSeconds, Periodicity=series_stats_list_TimeDeltainSeconds_normalized_avg, ReceivedBytes=sum_ReceivedBytes, SentBytes=sum_SentBytes, Actions=set_set_DeviceAction",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, SourceIP, DestinationIP, DestinationPort, BeaconCount, TimeDeltasInSeconds=list_list_TimeDeltainSeconds, Periodicity=series_stats_list_TimeDeltainSeconds_normalized_avg, ReceivedBytes=sum_ReceivedBytes, SentBytes=sum_SentBytes, Actions=set_set_DeviceAction",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, SourceIP, DestinationIP, DestinationPort, BeaconCount, TimeDeltasInSeconds=list_list_TimeDeltainSeconds, Periodicity=series_stats_list_TimeDeltainSeconds_normalized_avg, ReceivedBytes=sum_ReceivedBytes, SentBytes=sum_SentBytes, Actions=set_set_DeviceAction",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "beaconcount",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, SourceIP, DestinationIP, DestinationPort, BeaconCount, TimeDeltasInSeconds=list_list_TimeDeltainSeconds, Periodicity=series_stats_list_TimeDeltainSeconds_normalized_avg, ReceivedBytes=sum_ReceivedBytes, SentBytes=sum_SentBytes, Actions=set_set_DeviceAction",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "timedeltasinseconds",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, SourceIP, DestinationIP, DestinationPort, BeaconCount, TimeDeltasInSeconds=list_list_TimeDeltainSeconds, Periodicity=series_stats_list_TimeDeltainSeconds_normalized_avg, ReceivedBytes=sum_ReceivedBytes, SentBytes=sum_SentBytes, Actions=set_set_DeviceAction",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "periodicity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, SourceIP, DestinationIP, DestinationPort, BeaconCount, TimeDeltasInSeconds=list_list_TimeDeltainSeconds, Periodicity=series_stats_list_TimeDeltainSeconds_normalized_avg, ReceivedBytes=sum_ReceivedBytes, SentBytes=sum_SentBytes, Actions=set_set_DeviceAction",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "receivedbytes",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, SourceIP, DestinationIP, DestinationPort, BeaconCount, TimeDeltasInSeconds=list_list_TimeDeltainSeconds, Periodicity=series_stats_list_TimeDeltainSeconds_normalized_avg, ReceivedBytes=sum_ReceivedBytes, SentBytes=sum_SentBytes, Actions=set_set_DeviceAction",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "sentbytes",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, SourceIP, DestinationIP, DestinationPort, BeaconCount, TimeDeltasInSeconds=list_list_TimeDeltainSeconds, Periodicity=series_stats_list_TimeDeltainSeconds_normalized_avg, ReceivedBytes=sum_ReceivedBytes, SentBytes=sum_SentBytes, Actions=set_set_DeviceAction",
    "detection": "fortinet-networkbeaconpattern.yaml",
    "field": "actions",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(TimeGenerated,*) by Computer",
    "detection": "omi-vulnerability-detection.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project Version, Major,Minor,Patch,",
    "detection": "omi-vulnerability-detection.yaml",
    "field": "version",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Version, Major,Minor,Patch,",
    "detection": "omi-vulnerability-detection.yaml",
    "field": "major",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Version, Major,Minor,Patch,",
    "detection": "omi-vulnerability-detection.yaml",
    "field": "minor",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Version, Major,Minor,Patch,",
    "detection": "omi-vulnerability-detection.yaml",
    "field": "patch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TotalBytesIngested = array_sum(sum_Quantity)",
    "detection": "detected-significant-ingestion-decrease.yaml",
    "field": "totalbytesingested",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend PercentageDifference = ((prevCount - actualCount) / prevCount) * 100",
    "detection": "detected-significant-ingestion-decrease.yaml",
    "field": "percentagedifference",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize max(TimeGenerated) by SentinelResourceName, Status, prev_status, SentinelResourceId // Get latest event",
    "detection": "detect-latest-failure-events-per-connector.yaml",
    "field": "sentinelresourcename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize max(TimeGenerated) by SentinelResourceName, Status, prev_status, SentinelResourceId // Get latest event",
    "detection": "detect-latest-failure-events-per-connector.yaml",
    "field": "status",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize max(TimeGenerated) by SentinelResourceName, Status, prev_status, SentinelResourceId // Get latest event",
    "detection": "detect-latest-failure-events-per-connector.yaml",
    "field": "prev_status",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Remarks = \"Failed recently\";",
    "detection": "detect-latest-failure-events-per-connector.yaml",
    "field": "remarks",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by bin(TimeGenerated, 1d), SentinelResourceName, Status, SentinelResourceId // Normalise events to per day",
    "detection": "detect-latest-failure-events-per-connector.yaml",
    "field": "sentinelresourcename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by bin(TimeGenerated, 1d), SentinelResourceName, Status, SentinelResourceId // Normalise events to per day",
    "detection": "detect-latest-failure-events-per-connector.yaml",
    "field": "status",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Count=count(), max(TimeGenerated) by SentinelResourceName, Status, SentinelResourceId // Count the number of updates by resource name and status",
    "detection": "detect-latest-failure-events-per-connector.yaml",
    "field": "count",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Count=count(), max(TimeGenerated) by SentinelResourceName, Status, SentinelResourceId // Count the number of updates by resource name and status",
    "detection": "detect-latest-failure-events-per-connector.yaml",
    "field": "sentinelresourcename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Count=count(), max(TimeGenerated) by SentinelResourceName, Status, SentinelResourceId // Count the number of updates by resource name and status",
    "detection": "detect-latest-failure-events-per-connector.yaml",
    "field": "status",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend NumOfDays = datetime_diff('day', max_TimeGenerated, startofweek(now())) // Get the difference in number of days between latest event and start date of the week",
    "detection": "detect-latest-failure-events-per-connector.yaml",
    "field": "numofdays",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Remarks = strcat(\"Failed for \", Count/7, \" week\");",
    "detection": "detect-latest-failure-events-per-connector.yaml",
    "field": "remarks",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Count=count() by DataType, bin(TimeGenerated, 1h)",
    "detection": "potential-data-source-stopped-sending-logs.yaml",
    "field": "count",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Count=count() by DataType, bin(TimeGenerated, 1h)",
    "detection": "potential-data-source-stopped-sending-logs.yaml",
    "field": "datatype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Ingestion, ExpectedIngestion, AnomalyScore, Anomalies, DataType // Defines which columns to return",
    "detection": "potential-data-source-stopped-sending-logs.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Ingestion, ExpectedIngestion, AnomalyScore, Anomalies, DataType // Defines which columns to return",
    "detection": "potential-data-source-stopped-sending-logs.yaml",
    "field": "ingestion",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Ingestion, ExpectedIngestion, AnomalyScore, Anomalies, DataType // Defines which columns to return",
    "detection": "potential-data-source-stopped-sending-logs.yaml",
    "field": "expectedingestion",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Ingestion, ExpectedIngestion, AnomalyScore, Anomalies, DataType // Defines which columns to return",
    "detection": "potential-data-source-stopped-sending-logs.yaml",
    "field": "anomalyscore",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Ingestion, ExpectedIngestion, AnomalyScore, Anomalies, DataType // Defines which columns to return",
    "detection": "potential-data-source-stopped-sending-logs.yaml",
    "field": "anomalies",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Hash = hash(dynamic_to_json(pack_all()))",
    "detection": "detected-duplication-of-logs-in-aadnoninteractiveusersigninlogs.yaml",
    "field": "hash",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize recordsCount=count() by Hash",
    "detection": "detected-duplication-of-logs-in-aadnoninteractiveusersigninlogs.yaml",
    "field": "recordscount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize recordsCount=count() by Hash",
    "detection": "detected-duplication-of-logs-in-aadnoninteractiveusersigninlogs.yaml",
    "field": "hash",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project recordsCount = recordsCount - 1",
    "detection": "detected-duplication-of-logs-in-aadnoninteractiveusersigninlogs.yaml",
    "field": "recordscount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize duplicateRecords = sum(recordsCount)",
    "detection": "detected-duplication-of-logs-in-aadnoninteractiveusersigninlogs.yaml",
    "field": "duplicaterecords",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend duplicate_percentage = (duplicateRecords * 100.0) / _totalRecords",
    "detection": "detected-duplication-of-logs-in-aadnoninteractiveusersigninlogs.yaml",
    "field": "duplicate_percentage",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Score = score[-1]",
    "detection": "detected-potential-anomaly-in-volume-of-logs-ingested.yaml",
    "field": "score",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend diff= ((actualCount - expectedCounts) / expectedCounts) * 100",
    "detection": "detected-potential-anomaly-in-volume-of-logs-ingested.yaml",
    "field": "diff",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend abs_diff = abs(diff)",
    "detection": "detected-potential-anomaly-in-volume-of-logs-ingested.yaml",
    "field": "abs_diff",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Outcome = EventResult",
    "detection": "linux-ssh-failed-login-attempts-followed-by-successful-login.yaml",
    "field": "outcome",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize OutcomeCount=count(), make_set(TargetUsername,128), make_set(DvcHostname,128) by bin(TimeGenerated, 1m), SrcIpAddr, Outcome",
    "detection": "linux-ssh-failed-login-attempts-followed-by-successful-login.yaml",
    "field": "outcomecount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize OutcomeCount=count(), make_set(TargetUsername,128), make_set(DvcHostname,128) by bin(TimeGenerated, 1m), SrcIpAddr, Outcome",
    "detection": "linux-ssh-failed-login-attempts-followed-by-successful-login.yaml",
    "field": "srcipaddr",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize OutcomeCount=count(), make_set(TargetUsername,128), make_set(DvcHostname,128) by bin(TimeGenerated, 1m), SrcIpAddr, Outcome",
    "detection": "linux-ssh-failed-login-attempts-followed-by-successful-login.yaml",
    "field": "outcome",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, set_TargetUsername, SrcIpAddr, set_DvcHostname, Outcome, OutcomeCount",
    "detection": "linux-ssh-failed-login-attempts-followed-by-successful-login.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, set_TargetUsername, SrcIpAddr, set_DvcHostname, Outcome, OutcomeCount",
    "detection": "linux-ssh-failed-login-attempts-followed-by-successful-login.yaml",
    "field": "set_targetusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, set_TargetUsername, SrcIpAddr, set_DvcHostname, Outcome, OutcomeCount",
    "detection": "linux-ssh-failed-login-attempts-followed-by-successful-login.yaml",
    "field": "srcipaddr",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, set_TargetUsername, SrcIpAddr, set_DvcHostname, Outcome, OutcomeCount",
    "detection": "linux-ssh-failed-login-attempts-followed-by-successful-login.yaml",
    "field": "set_dvchostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, set_TargetUsername, SrcIpAddr, set_DvcHostname, Outcome, OutcomeCount",
    "detection": "linux-ssh-failed-login-attempts-followed-by-successful-login.yaml",
    "field": "outcome",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, set_TargetUsername, SrcIpAddr, set_DvcHostname, Outcome, OutcomeCount",
    "detection": "linux-ssh-failed-login-attempts-followed-by-successful-login.yaml",
    "field": "outcomecount",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SessionStartedUtc = row_window_session(TimeGenerated, timeRange, authenticationWindow, SrcIpAddr != prev(SrcIpAddr) or prev(Outcome) == \"Accepted\")",
    "detection": "linux-ssh-failed-login-attempts-followed-by-successful-login.yaml",
    "field": "sessionstartedutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailureCountBeforeSuccess=sumif(OutcomeCount, Outcome == \"Failed\"), StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), make_list(Outcome, 128), DvcHostnames = make_set(set_DvcHostname, 128), TargetUsernames = make_set(set_TargetUsername, 128) by SrcIpAddr, SessionStartedUtc",
    "detection": "linux-ssh-failed-login-attempts-followed-by-successful-login.yaml",
    "field": "failurecountbeforesuccess",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailureCountBeforeSuccess=sumif(OutcomeCount, Outcome == \"Failed\"), StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), make_list(Outcome, 128), DvcHostnames = make_set(set_DvcHostname, 128), TargetUsernames = make_set(set_TargetUsername, 128) by SrcIpAddr, SessionStartedUtc",
    "detection": "linux-ssh-failed-login-attempts-followed-by-successful-login.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailureCountBeforeSuccess=sumif(OutcomeCount, Outcome == \"Failed\"), StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), make_list(Outcome, 128), DvcHostnames = make_set(set_DvcHostname, 128), TargetUsernames = make_set(set_TargetUsername, 128) by SrcIpAddr, SessionStartedUtc",
    "detection": "linux-ssh-failed-login-attempts-followed-by-successful-login.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailureCountBeforeSuccess=sumif(OutcomeCount, Outcome == \"Failed\"), StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), make_list(Outcome, 128), DvcHostnames = make_set(set_DvcHostname, 128), TargetUsernames = make_set(set_TargetUsername, 128) by SrcIpAddr, SessionStartedUtc",
    "detection": "linux-ssh-failed-login-attempts-followed-by-successful-login.yaml",
    "field": "dvchostnames",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailureCountBeforeSuccess=sumif(OutcomeCount, Outcome == \"Failed\"), StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), make_list(Outcome, 128), DvcHostnames = make_set(set_DvcHostname, 128), TargetUsernames = make_set(set_TargetUsername, 128) by SrcIpAddr, SessionStartedUtc",
    "detection": "linux-ssh-failed-login-attempts-followed-by-successful-login.yaml",
    "field": "targetusernames",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailureCountBeforeSuccess=sumif(OutcomeCount, Outcome == \"Failed\"), StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), make_list(Outcome, 128), DvcHostnames = make_set(set_DvcHostname, 128), TargetUsernames = make_set(set_TargetUsername, 128) by SrcIpAddr, SessionStartedUtc",
    "detection": "linux-ssh-failed-login-attempts-followed-by-successful-login.yaml",
    "field": "srcipaddr",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailureCountBeforeSuccess=sumif(OutcomeCount, Outcome == \"Failed\"), StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), make_list(Outcome, 128), DvcHostnames = make_set(set_DvcHostname, 128), TargetUsernames = make_set(set_TargetUsername, 128) by SrcIpAddr, SessionStartedUtc",
    "detection": "linux-ssh-failed-login-attempts-followed-by-successful-login.yaml",
    "field": "sessionstartedutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventTimes = make_list(TimeGenerated), PerHourCount = count() by bin(TimeGenerated,4h), ip, Computer, user, _ResourceId",
    "detection": "ssh-potentialbruteforce.yaml",
    "field": "eventtimes",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventTimes = make_list(TimeGenerated), PerHourCount = count() by bin(TimeGenerated,4h), ip, Computer, user, _ResourceId",
    "detection": "ssh-potentialbruteforce.yaml",
    "field": "perhourcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventTimes = make_list(TimeGenerated), PerHourCount = count() by bin(TimeGenerated,4h), ip, Computer, user, _ResourceId",
    "detection": "ssh-potentialbruteforce.yaml",
    "field": "ip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventTimes = make_list(TimeGenerated), PerHourCount = count() by bin(TimeGenerated,4h), ip, Computer, user, _ResourceId",
    "detection": "ssh-potentialbruteforce.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventTimes = make_list(TimeGenerated), PerHourCount = count() by bin(TimeGenerated,4h), ip, Computer, user, _ResourceId",
    "detection": "ssh-potentialbruteforce.yaml",
    "field": "user",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventTimes = make_list(TimeGenerated), PerHourCount = count() by bin(TimeGenerated,4h), ip, Computer, user, _ResourceId",
    "detection": "ssh-potentialbruteforce.yaml",
    "field": "_resourceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventTimes = tostring(EventTimes)",
    "detection": "ssh-potentialbruteforce.yaml",
    "field": "eventtimes",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(EventTimes), EndTime = max(EventTimes), UserList = make_set(user), ComputerList = make_set(Computer), ResourceIdList = make_set(_ResourceId), sum(PerHourCount) by IPAddress = ip",
    "detection": "ssh-potentialbruteforce.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(EventTimes), EndTime = max(EventTimes), UserList = make_set(user), ComputerList = make_set(Computer), ResourceIdList = make_set(_ResourceId), sum(PerHourCount) by IPAddress = ip",
    "detection": "ssh-potentialbruteforce.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(EventTimes), EndTime = max(EventTimes), UserList = make_set(user), ComputerList = make_set(Computer), ResourceIdList = make_set(_ResourceId), sum(PerHourCount) by IPAddress = ip",
    "detection": "ssh-potentialbruteforce.yaml",
    "field": "userlist",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(EventTimes), EndTime = max(EventTimes), UserList = make_set(user), ComputerList = make_set(Computer), ResourceIdList = make_set(_ResourceId), sum(PerHourCount) by IPAddress = ip",
    "detection": "ssh-potentialbruteforce.yaml",
    "field": "computerlist",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(EventTimes), EndTime = max(EventTimes), UserList = make_set(user), ComputerList = make_set(Computer), ResourceIdList = make_set(_ResourceId), sum(PerHourCount) by IPAddress = ip",
    "detection": "ssh-potentialbruteforce.yaml",
    "field": "resourceidlist",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = iff(array_length(ComputerList) == 1, tostring(ComputerList[0]), strcat(\"SeeComputerListField\",\"_\", tostring(hash(tostring(ComputerList)))))",
    "detection": "ssh-potentialbruteforce.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = iff(array_length(ComputerList) == 1, tostring(UserList[0]), strcat(\"SeeUserListField\",\"_\", tostring(hash(tostring(UserList)))))",
    "detection": "ssh-potentialbruteforce.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend ResourceId = iff(array_length(ResourceIdList) == 1, tostring(ResourceIdList[0]), strcat(\"SeeResourceIdListField\",\"_\", tostring(hash(tostring(ResourceIdList)))))",
    "detection": "ssh-potentialbruteforce.yaml",
    "field": "resourceid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize ListOfActions = makeset(OperationName) by EventTime10MinInterval = bin(TimeGenerated, 10m), DvcHostname, ActorUsername",
    "detection": "abnormalcrontabaction.yaml",
    "field": "listofactions",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize ListOfActions = makeset(OperationName) by EventTime10MinInterval = bin(TimeGenerated, 10m), DvcHostname, ActorUsername",
    "detection": "abnormalcrontabaction.yaml",
    "field": "dvchostname",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize ListOfActions = makeset(OperationName) by EventTime10MinInterval = bin(TimeGenerated, 10m), DvcHostname, ActorUsername",
    "detection": "abnormalcrontabaction.yaml",
    "field": "actorusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = EventTime10MinInterval, AccountCustomEntity = ActorUsername, HostCustomEntity = DvcHostname",
    "detection": "abnormalcrontabaction.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = EventTime10MinInterval, AccountCustomEntity = ActorUsername, HostCustomEntity = DvcHostname",
    "detection": "abnormalcrontabaction.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = EventTime10MinInterval, AccountCustomEntity = ActorUsername, HostCustomEntity = DvcHostname",
    "detection": "abnormalcrontabaction.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend RemoteIP = extract(@\".*?rhost=([\\d.]+).*?\", 1,SyslogMessage)",
    "detection": "failedlogonattempts-unknownuser.yaml",
    "field": "remoteip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, ProcessName, HostIP, RemoteIP, ProcessID",
    "detection": "failedlogonattempts-unknownuser.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, ProcessName, HostIP, RemoteIP, ProcessID",
    "detection": "failedlogonattempts-unknownuser.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, ProcessName, HostIP, RemoteIP, ProcessID",
    "detection": "failedlogonattempts-unknownuser.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, ProcessName, HostIP, RemoteIP, ProcessID",
    "detection": "failedlogonattempts-unknownuser.yaml",
    "field": "hostip",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, ProcessName, HostIP, RemoteIP, ProcessID",
    "detection": "failedlogonattempts-unknownuser.yaml",
    "field": "remoteip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, ProcessName, HostIP, RemoteIP, ProcessID",
    "detection": "failedlogonattempts-unknownuser.yaml",
    "field": "processid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "    | project Computer, HostIP, ProcessID",
    "detection": "failedlogonattempts-unknownuser.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "    | project Computer, HostIP, ProcessID",
    "detection": "failedlogonattempts-unknownuser.yaml",
    "field": "hostip",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "    | project Computer, HostIP, ProcessID",
    "detection": "failedlogonattempts-unknownuser.yaml",
    "field": "processid",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstLogonAttempt = min(TimeGenerated), LatestLogonAttempt = max(TimeGenerated), TotalLogonAttempts = count() by Computer, HostIP, RemoteIP",
    "detection": "failedlogonattempts-unknownuser.yaml",
    "field": "firstlogonattempt",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstLogonAttempt = min(TimeGenerated), LatestLogonAttempt = max(TimeGenerated), TotalLogonAttempts = count() by Computer, HostIP, RemoteIP",
    "detection": "failedlogonattempts-unknownuser.yaml",
    "field": "latestlogonattempt",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstLogonAttempt = min(TimeGenerated), LatestLogonAttempt = max(TimeGenerated), TotalLogonAttempts = count() by Computer, HostIP, RemoteIP",
    "detection": "failedlogonattempts-unknownuser.yaml",
    "field": "totallogonattempts",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstLogonAttempt = min(TimeGenerated), LatestLogonAttempt = max(TimeGenerated), TotalLogonAttempts = count() by Computer, HostIP, RemoteIP",
    "detection": "failedlogonattempts-unknownuser.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstLogonAttempt = min(TimeGenerated), LatestLogonAttempt = max(TimeGenerated), TotalLogonAttempts = count() by Computer, HostIP, RemoteIP",
    "detection": "failedlogonattempts-unknownuser.yaml",
    "field": "hostip",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstLogonAttempt = min(TimeGenerated), LatestLogonAttempt = max(TimeGenerated), TotalLogonAttempts = count() by Computer, HostIP, RemoteIP",
    "detection": "failedlogonattempts-unknownuser.yaml",
    "field": "remoteip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TimeBetweenLogonAttempts = LatestLogonAttempt - FirstLogonAttempt",
    "detection": "failedlogonattempts-unknownuser.yaml",
    "field": "timebetweenlogonattempts",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project FirstLogonAttempt, LatestLogonAttempt, TimeBetweenLogonAttempts, TotalLogonAttempts, SourceAddress = RemoteIP, Computer,  HostIP",
    "detection": "failedlogonattempts-unknownuser.yaml",
    "field": "firstlogonattempt",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project FirstLogonAttempt, LatestLogonAttempt, TimeBetweenLogonAttempts, TotalLogonAttempts, SourceAddress = RemoteIP, Computer,  HostIP",
    "detection": "failedlogonattempts-unknownuser.yaml",
    "field": "latestlogonattempt",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project FirstLogonAttempt, LatestLogonAttempt, TimeBetweenLogonAttempts, TotalLogonAttempts, SourceAddress = RemoteIP, Computer,  HostIP",
    "detection": "failedlogonattempts-unknownuser.yaml",
    "field": "timebetweenlogonattempts",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project FirstLogonAttempt, LatestLogonAttempt, TimeBetweenLogonAttempts, TotalLogonAttempts, SourceAddress = RemoteIP, Computer,  HostIP",
    "detection": "failedlogonattempts-unknownuser.yaml",
    "field": "totallogonattempts",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project FirstLogonAttempt, LatestLogonAttempt, TimeBetweenLogonAttempts, TotalLogonAttempts, SourceAddress = RemoteIP, Computer,  HostIP",
    "detection": "failedlogonattempts-unknownuser.yaml",
    "field": "sourceaddress",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project FirstLogonAttempt, LatestLogonAttempt, TimeBetweenLogonAttempts, TotalLogonAttempts, SourceAddress = RemoteIP, Computer,  HostIP",
    "detection": "failedlogonattempts-unknownuser.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project FirstLogonAttempt, LatestLogonAttempt, TimeBetweenLogonAttempts, TotalLogonAttempts, SourceAddress = RemoteIP, Computer,  HostIP",
    "detection": "failedlogonattempts-unknownuser.yaml",
    "field": "hostip",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = extract(\"(([0-9]{1,3})\\\\.([0-9]{1,3})\\\\.([0-9]{1,3})\\\\.(([0-9]{1,3})))\",1,SyslogMessage)",
    "detection": "ssh-newlyinternetexposed.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ipType = iff(SourceIP matches regex PrivateIPregex,\"private\" ,\"public\");",
    "detection": "ssh-newlyinternetexposed.yaml",
    "field": "iptype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize privatecount=countif(ipType==\"private\"), publiccount=countif(ipType==\"public\") by HostName, HostIP, bin(EventTime, 1d)",
    "detection": "ssh-newlyinternetexposed.yaml",
    "field": "privatecount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize privatecount=countif(ipType==\"private\"), publiccount=countif(ipType==\"public\") by HostName, HostIP, bin(EventTime, 1d)",
    "detection": "ssh-newlyinternetexposed.yaml",
    "field": "publiccount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize privatecount=countif(ipType==\"private\"), publiccount=countif(ipType==\"public\") by HostName, HostIP, bin(EventTime, 1d)",
    "detection": "ssh-newlyinternetexposed.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize privatecount=countif(ipType==\"private\"), publiccount=countif(ipType==\"public\") by HostName, HostIP, bin(EventTime, 1d)",
    "detection": "ssh-newlyinternetexposed.yaml",
    "field": "hostip",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize publicIPLoginCountList=make_list(toint(publicIPLoginHistory['IPCount'])), publicAverage=avg(toint(publicIPLoginHistory['IPCount'])), publicStd=stdev(toint(publicIPLoginHistory['IPCount'])), maxPublicLoginCount=max(toint(publicIPLoginHistory['IPCount']))",
    "detection": "ssh-newlyinternetexposed.yaml",
    "field": "publiciplogincountlist",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize publicIPLoginCountList=make_list(toint(publicIPLoginHistory['IPCount'])), publicAverage=avg(toint(publicIPLoginHistory['IPCount'])), publicStd=stdev(toint(publicIPLoginHistory['IPCount'])), maxPublicLoginCount=max(toint(publicIPLoginHistory['IPCount']))",
    "detection": "ssh-newlyinternetexposed.yaml",
    "field": "publicaverage",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize publicIPLoginCountList=make_list(toint(publicIPLoginHistory['IPCount'])), publicAverage=avg(toint(publicIPLoginHistory['IPCount'])), publicStd=stdev(toint(publicIPLoginHistory['IPCount'])), maxPublicLoginCount=max(toint(publicIPLoginHistory['IPCount']))",
    "detection": "ssh-newlyinternetexposed.yaml",
    "field": "publicstd",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize publicIPLoginCountList=make_list(toint(publicIPLoginHistory['IPCount'])), publicAverage=avg(toint(publicIPLoginHistory['IPCount'])), publicStd=stdev(toint(publicIPLoginHistory['IPCount'])), maxPublicLoginCount=max(toint(publicIPLoginHistory['IPCount']))",
    "detection": "ssh-newlyinternetexposed.yaml",
    "field": "maxpubliclogincount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize privateIPLoginCountList=make_list(toint(privateIPLoginHistory['IPCount'])), privateAverage=avg(toint(privateIPLoginHistory['IPCount'])), privateStd=stdev(toint(privateIPLoginHistory['IPCount']))",
    "detection": "ssh-newlyinternetexposed.yaml",
    "field": "privateiplogincountlist",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize privateIPLoginCountList=make_list(toint(privateIPLoginHistory['IPCount'])), privateAverage=avg(toint(privateIPLoginHistory['IPCount'])), privateStd=stdev(toint(privateIPLoginHistory['IPCount']))",
    "detection": "ssh-newlyinternetexposed.yaml",
    "field": "privateaverage",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize privateIPLoginCountList=make_list(toint(privateIPLoginHistory['IPCount'])), privateAverage=avg(toint(privateIPLoginHistory['IPCount'])), privateStd=stdev(toint(privateIPLoginHistory['IPCount']))",
    "detection": "ssh-newlyinternetexposed.yaml",
    "field": "privatestd",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend probabilityPublic = publicAverage / (privateAverage + publicAverage)",
    "detection": "ssh-newlyinternetexposed.yaml",
    "field": "probabilitypublic",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend publicLoginCountToday = publicIPLoginCountList[-1]",
    "detection": "ssh-newlyinternetexposed.yaml",
    "field": "publiclogincounttoday",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostCustomEntity = HostName",
    "detection": "ssh-newlyinternetexposed.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr, MalwareCustomEntity = HttpReferrerOriginal",
    "detection": "nginxknownmaliciousreferrer.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr, MalwareCustomEntity = HttpReferrerOriginal",
    "detection": "nginxknownmaliciousreferrer.yaml",
    "field": "malwarecustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend File = extract(@\"(.*\\/)?(.*)\", 2, tostring(UrlOriginal))",
    "detection": "nginxrequesttosensitivefiles.yaml",
    "field": "file",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend FileCustomEntity = File, UrlCustomEntity = UrlOriginal",
    "detection": "nginxrequesttosensitivefiles.yaml",
    "field": "filecustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend FileCustomEntity = File, UrlCustomEntity = UrlOriginal",
    "detection": "nginxrequesttosensitivefiles.yaml",
    "field": "urlcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ProcessIdCustomEntity = ProcessId",
    "detection": "nginxcoredump.yaml",
    "field": "processidcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend UrlCustomEntity = UrlOriginal",
    "detection": "nginxcommandsinrequest.yaml",
    "field": "urlcustomentity",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize MultipleServerErrors = count() by SrcIpAddr, bin(TimeGenerated, 5m)",
    "detection": "nginxmultipleservererrorsfromsingleip.yaml",
    "field": "multipleservererrors",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize MultipleServerErrors = count() by SrcIpAddr, bin(TimeGenerated, 5m)",
    "detection": "nginxmultipleservererrorsfromsingleip.yaml",
    "field": "srcipaddr",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr",
    "detection": "nginxmultipleservererrorsfromsingleip.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr, MalwareCustomEntity = HttpUserAgentOriginal",
    "detection": "nginxknownmalicioususeragent.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr, MalwareCustomEntity = HttpUserAgentOriginal",
    "detection": "nginxknownmalicioususeragent.yaml",
    "field": "malwarecustomentity",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize makeset(HttpUserAgentOriginal) by SrcIpAddr, bin(TimeGenerated, 5m)",
    "detection": "nginxdifferentuasfromsingleip.yaml",
    "field": "srcipaddr",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ua_count = array_length(set_HttpUserAgentOriginal)",
    "detection": "nginxdifferentuasfromsingleip.yaml",
    "field": "ua_count",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr",
    "detection": "nginxdifferentuasfromsingleip.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr",
    "detection": "nginxknownmaliciousips.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend UrlCustomEntity = UrlOriginal",
    "detection": "nginxprivateipinurl.yaml",
    "field": "urlcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr, UrlCustomEntity = UrlOriginal",
    "detection": "nginxsstipattern.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr, UrlCustomEntity = UrlOriginal",
    "detection": "nginxsstipattern.yaml",
    "field": "urlcustomentity",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize post_time=min(EventStartTime) by SrcIpAddr, tostring(UrlOriginal);",
    "detection": "nginxputandgetfilefromsameip.yaml",
    "field": "post_time",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize post_time=min(EventStartTime) by SrcIpAddr, tostring(UrlOriginal);",
    "detection": "nginxputandgetfilefromsameip.yaml",
    "field": "srcipaddr",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize get_time=min(EventStartTime) by SrcIpAddr, tostring(UrlOriginal)",
    "detection": "nginxputandgetfilefromsameip.yaml",
    "field": "get_time",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize get_time=min(EventStartTime) by SrcIpAddr, tostring(UrlOriginal)",
    "detection": "nginxputandgetfilefromsameip.yaml",
    "field": "srcipaddr",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend second = datetime_diff('second',get_time,post_time)",
    "detection": "nginxputandgetfilefromsameip.yaml",
    "field": "second",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project second, post_time, get_time, SrcIpAddr, UrlOriginal",
    "detection": "nginxputandgetfilefromsameip.yaml",
    "field": "second",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project second, post_time, get_time, SrcIpAddr, UrlOriginal",
    "detection": "nginxputandgetfilefromsameip.yaml",
    "field": "post_time",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project second, post_time, get_time, SrcIpAddr, UrlOriginal",
    "detection": "nginxputandgetfilefromsameip.yaml",
    "field": "get_time",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project second, post_time, get_time, SrcIpAddr, UrlOriginal",
    "detection": "nginxputandgetfilefromsameip.yaml",
    "field": "srcipaddr",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project second, post_time, get_time, SrcIpAddr, UrlOriginal",
    "detection": "nginxputandgetfilefromsameip.yaml",
    "field": "urloriginal",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr, UrlCustomEntity = tostring(UrlOriginal)",
    "detection": "nginxputandgetfilefromsameip.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr, UrlCustomEntity = tostring(UrlOriginal)",
    "detection": "nginxputandgetfilefromsameip.yaml",
    "field": "urlcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr, UrlCustomEntity = UrlOriginal",
    "detection": "nginxcrlfpattern.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr, UrlCustomEntity = UrlOriginal",
    "detection": "nginxcrlfpattern.yaml",
    "field": "urlcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr, UrlCustomEntity = UrlOriginal",
    "detection": "nginxsqlpattern.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr, UrlCustomEntity = UrlOriginal",
    "detection": "nginxsqlpattern.yaml",
    "field": "urlcustomentity",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize MultipleClientErrors = count() by SrcIpAddr, bin(TimeGenerated, 5m)",
    "detection": "nginxmultipleclienterrorsfromsingleip.yaml",
    "field": "multipleclienterrors",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize MultipleClientErrors = count() by SrcIpAddr, bin(TimeGenerated, 5m)",
    "detection": "nginxmultipleclienterrorsfromsingleip.yaml",
    "field": "srcipaddr",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr",
    "detection": "nginxmultipleclienterrorsfromsingleip.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr, UrlCustomEntity = UrlOriginal",
    "detection": "nginxssrfpattern.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SrcIpAddr, UrlCustomEntity = UrlOriginal",
    "detection": "nginxssrfpattern.yaml",
    "field": "urlcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend RuleName = case(",
    "detection": "mail-redirect-via-exo-transport-rule.yaml",
    "field": "rulename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend RedirectTo = ExpandedParameters.Value",
    "detection": "mail-redirect-via-exo-transport-rule.yaml",
    "field": "redirectto",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ClientIPValues = extract_all(@'\\[?(::ffff:)?(?P<IPAddress>(\\d+\\.\\d+\\.\\d+\\.\\d+)|[^\\]]+)\\]?([-:](?P<Port>\\d+))?', dynamic([\"IPAddress\", \"Port\"]), ClientIP)[0]",
    "detection": "mail-redirect-via-exo-transport-rule.yaml",
    "field": "clientipvalues",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend From = ParsedParameters.From",
    "detection": "mail-redirect-via-exo-transport-rule.yaml",
    "field": "from",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, RedirectTo, IPAddress = tostring(ClientIPValues[0]), Port = tostring(ClientIPValues[1]), UserId, From, Operation, RuleName, Parameters",
    "detection": "mail-redirect-via-exo-transport-rule.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, RedirectTo, IPAddress = tostring(ClientIPValues[0]), Port = tostring(ClientIPValues[1]), UserId, From, Operation, RuleName, Parameters",
    "detection": "mail-redirect-via-exo-transport-rule.yaml",
    "field": "redirectto",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, RedirectTo, IPAddress = tostring(ClientIPValues[0]), Port = tostring(ClientIPValues[1]), UserId, From, Operation, RuleName, Parameters",
    "detection": "mail-redirect-via-exo-transport-rule.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, RedirectTo, IPAddress = tostring(ClientIPValues[0]), Port = tostring(ClientIPValues[1]), UserId, From, Operation, RuleName, Parameters",
    "detection": "mail-redirect-via-exo-transport-rule.yaml",
    "field": "port",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, RedirectTo, IPAddress = tostring(ClientIPValues[0]), Port = tostring(ClientIPValues[1]), UserId, From, Operation, RuleName, Parameters",
    "detection": "mail-redirect-via-exo-transport-rule.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, RedirectTo, IPAddress = tostring(ClientIPValues[0]), Port = tostring(ClientIPValues[1]), UserId, From, Operation, RuleName, Parameters",
    "detection": "mail-redirect-via-exo-transport-rule.yaml",
    "field": "from",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, RedirectTo, IPAddress = tostring(ClientIPValues[0]), Port = tostring(ClientIPValues[1]), UserId, From, Operation, RuleName, Parameters",
    "detection": "mail-redirect-via-exo-transport-rule.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, RedirectTo, IPAddress = tostring(ClientIPValues[0]), Port = tostring(ClientIPValues[1]), UserId, From, Operation, RuleName, Parameters",
    "detection": "mail-redirect-via-exo-transport-rule.yaml",
    "field": "rulename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, RedirectTo, IPAddress = tostring(ClientIPValues[0]), Port = tostring(ClientIPValues[1]), UserId, From, Operation, RuleName, Parameters",
    "detection": "mail-redirect-via-exo-transport-rule.yaml",
    "field": "parameters",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(UserId, \"@\")[0]), AccountUPNSuffix = tostring(split(UserId, \"@\")[1])",
    "detection": "mail-redirect-via-exo-transport-rule.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(UserId, \"@\")[0]), AccountUPNSuffix = tostring(split(UserId, \"@\")[1])",
    "detection": "mail-redirect-via-exo-transport-rule.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend p = parse_json(Parameters)",
    "detection": "threat-essentials-mail-redirect-via-exo-transport-rule.yaml",
    "field": "p",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend RuleName = case(",
    "detection": "threat-essentials-mail-redirect-via-exo-transport-rule.yaml",
    "field": "rulename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend RedirectTo = p.Value",
    "detection": "threat-essentials-mail-redirect-via-exo-transport-rule.yaml",
    "field": "redirectto",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ClientIPOnly = case(",
    "detection": "threat-essentials-mail-redirect-via-exo-transport-rule.yaml",
    "field": "clientiponly",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Port = case(",
    "detection": "threat-essentials-mail-redirect-via-exo-transport-rule.yaml",
    "field": "port",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend ClientIP = ClientIPOnly",
    "detection": "threat-essentials-mail-redirect-via-exo-transport-rule.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, RedirectTo, ClientIP, Port, UserId, Operation, RuleName",
    "detection": "threat-essentials-mail-redirect-via-exo-transport-rule.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, RedirectTo, ClientIP, Port, UserId, Operation, RuleName",
    "detection": "threat-essentials-mail-redirect-via-exo-transport-rule.yaml",
    "field": "redirectto",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, RedirectTo, ClientIP, Port, UserId, Operation, RuleName",
    "detection": "threat-essentials-mail-redirect-via-exo-transport-rule.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, RedirectTo, ClientIP, Port, UserId, Operation, RuleName",
    "detection": "threat-essentials-mail-redirect-via-exo-transport-rule.yaml",
    "field": "port",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, RedirectTo, ClientIP, Port, UserId, Operation, RuleName",
    "detection": "threat-essentials-mail-redirect-via-exo-transport-rule.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, RedirectTo, ClientIP, Port, UserId, Operation, RuleName",
    "detection": "threat-essentials-mail-redirect-via-exo-transport-rule.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, RedirectTo, ClientIP, Port, UserId, Operation, RuleName",
    "detection": "threat-essentials-mail-redirect-via-exo-transport-rule.yaml",
    "field": "rulename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name=split(UserId, \"@\")[0], UPNSuffix=split(UserId, \"@\")[1]",
    "detection": "threat-essentials-mail-redirect-via-exo-transport-rule.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name=split(UserId, \"@\")[0], UPNSuffix=split(UserId, \"@\")[1]",
    "detection": "threat-essentials-mail-redirect-via-exo-transport-rule.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Events=todynamic(Parameters)",
    "detection": "malicious-inbox-rule.yaml",
    "field": "events",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ClientIPAddress = case( ClientIP has \".\", tostring(split(ClientIP,\":\")[0]), ClientIP has \"[\", tostring(trim_start(@'[[]',tostring(split(ClientIP,\"]\")[0]))), ClientIP )",
    "detection": "malicious-inbox-rule.yaml",
    "field": "clientipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Keyword = iff(isnotempty(SubjectContainsWords), SubjectContainsWords, (iff(isnotempty(BodyContainsWords),BodyContainsWords,SubjectOrBodyContainsWords )))",
    "detection": "malicious-inbox-rule.yaml",
    "field": "keyword",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend RuleDetail = case(OfficeObjectId contains '/' , tostring(split(OfficeObjectId, '/')[-1]) , tostring(split(OfficeObjectId, '\\\\')[-1]))",
    "detection": "malicious-inbox-rule.yaml",
    "field": "ruledetail",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by  Operation, UserId, ClientIPAddress, ResultStatus, Keyword, OriginatingServer, OfficeObjectId, RuleDetail",
    "detection": "malicious-inbox-rule.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by  Operation, UserId, ClientIPAddress, ResultStatus, Keyword, OriginatingServer, OfficeObjectId, RuleDetail",
    "detection": "malicious-inbox-rule.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by  Operation, UserId, ClientIPAddress, ResultStatus, Keyword, OriginatingServer, OfficeObjectId, RuleDetail",
    "detection": "malicious-inbox-rule.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by  Operation, UserId, ClientIPAddress, ResultStatus, Keyword, OriginatingServer, OfficeObjectId, RuleDetail",
    "detection": "malicious-inbox-rule.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by  Operation, UserId, ClientIPAddress, ResultStatus, Keyword, OriginatingServer, OfficeObjectId, RuleDetail",
    "detection": "malicious-inbox-rule.yaml",
    "field": "clientipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by  Operation, UserId, ClientIPAddress, ResultStatus, Keyword, OriginatingServer, OfficeObjectId, RuleDetail",
    "detection": "malicious-inbox-rule.yaml",
    "field": "resultstatus",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by  Operation, UserId, ClientIPAddress, ResultStatus, Keyword, OriginatingServer, OfficeObjectId, RuleDetail",
    "detection": "malicious-inbox-rule.yaml",
    "field": "keyword",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by  Operation, UserId, ClientIPAddress, ResultStatus, Keyword, OriginatingServer, OfficeObjectId, RuleDetail",
    "detection": "malicious-inbox-rule.yaml",
    "field": "originatingserver",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by  Operation, UserId, ClientIPAddress, ResultStatus, Keyword, OriginatingServer, OfficeObjectId, RuleDetail",
    "detection": "malicious-inbox-rule.yaml",
    "field": "officeobjectid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by  Operation, UserId, ClientIPAddress, ResultStatus, Keyword, OriginatingServer, OfficeObjectId, RuleDetail",
    "detection": "malicious-inbox-rule.yaml",
    "field": "ruledetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(UserId, \"@\")[0]), AccountUPNSuffix = tostring(split(UserId, \"@\")[1])",
    "detection": "malicious-inbox-rule.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(UserId, \"@\")[0]), AccountUPNSuffix = tostring(split(UserId, \"@\")[1])",
    "detection": "malicious-inbox-rule.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend OriginatingServerName = tostring(split(OriginatingServer, \" \")[0])",
    "detection": "malicious-inbox-rule.yaml",
    "field": "originatingservername",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserAgent = iff(parse_json(ExtendedProperties)[0].Name =~ \"UserAgent\", extractjson(\"$[0].Value\", ExtendedProperties, typeof(string)),\"\")",
    "detection": "strontiumcredharvesting.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend RequestType = ExtendedProperties.Value",
    "detection": "strontiumcredharvesting.yaml",
    "field": "requesttype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize authAttempts=dcount(TimeGenerated), firstAttempt=min(TimeGenerated), lastAttempt=max(TimeGenerated), uniqueIPs=dcount(ClientIP), uniqueAccounts=dcount(UserId), attemptedAccounts=make_set(UserId) by UserAgent",
    "detection": "strontiumcredharvesting.yaml",
    "field": "authattempts",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize authAttempts=dcount(TimeGenerated), firstAttempt=min(TimeGenerated), lastAttempt=max(TimeGenerated), uniqueIPs=dcount(ClientIP), uniqueAccounts=dcount(UserId), attemptedAccounts=make_set(UserId) by UserAgent",
    "detection": "strontiumcredharvesting.yaml",
    "field": "firstattempt",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize authAttempts=dcount(TimeGenerated), firstAttempt=min(TimeGenerated), lastAttempt=max(TimeGenerated), uniqueIPs=dcount(ClientIP), uniqueAccounts=dcount(UserId), attemptedAccounts=make_set(UserId) by UserAgent",
    "detection": "strontiumcredharvesting.yaml",
    "field": "lastattempt",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize authAttempts=dcount(TimeGenerated), firstAttempt=min(TimeGenerated), lastAttempt=max(TimeGenerated), uniqueIPs=dcount(ClientIP), uniqueAccounts=dcount(UserId), attemptedAccounts=make_set(UserId) by UserAgent",
    "detection": "strontiumcredharvesting.yaml",
    "field": "uniqueips",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize authAttempts=dcount(TimeGenerated), firstAttempt=min(TimeGenerated), lastAttempt=max(TimeGenerated), uniqueIPs=dcount(ClientIP), uniqueAccounts=dcount(UserId), attemptedAccounts=make_set(UserId) by UserAgent",
    "detection": "strontiumcredharvesting.yaml",
    "field": "uniqueaccounts",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize authAttempts=dcount(TimeGenerated), firstAttempt=min(TimeGenerated), lastAttempt=max(TimeGenerated), uniqueIPs=dcount(ClientIP), uniqueAccounts=dcount(UserId), attemptedAccounts=make_set(UserId) by UserAgent",
    "detection": "strontiumcredharvesting.yaml",
    "field": "attemptedaccounts",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize authAttempts=dcount(TimeGenerated), firstAttempt=min(TimeGenerated), lastAttempt=max(TimeGenerated), uniqueIPs=dcount(ClientIP), uniqueAccounts=dcount(UserId), attemptedAccounts=make_set(UserId) by UserAgent",
    "detection": "strontiumcredharvesting.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = firstAttempt",
    "detection": "strontiumcredharvesting.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ClientIPOnly = tostring(extract_all(@'\\[?(::ffff:)?(?P<IPAddress>(\\d+\\.\\d+\\.\\d+\\.\\d+)|[^\\]]+)\\]?', dynamic([\"IPAddress\"]), ClientIP)[0])",
    "detection": "rareofficeoperations.yaml",
    "field": "clientiponly",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(UserId, \"@\")[0]), AccountUPNSuffix = tostring(split(UserId, \"@\")[1])",
    "detection": "rareofficeoperations.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(UserId, \"@\")[0]), AccountUPNSuffix = tostring(split(UserId, \"@\")[1])",
    "detection": "rareofficeoperations.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend ClientIPOnly = case(",
    "detection": "office-policytampering.yaml",
    "field": "clientiponly",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Port = case(",
    "detection": "office-policytampering.yaml",
    "field": "port",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), OperationCount = count() by Operation, UserType, UserId, ClientIP = ClientIPOnly, Port, ResultStatus, Parameters",
    "detection": "office-policytampering.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), OperationCount = count() by Operation, UserType, UserId, ClientIP = ClientIPOnly, Port, ResultStatus, Parameters",
    "detection": "office-policytampering.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), OperationCount = count() by Operation, UserType, UserId, ClientIP = ClientIPOnly, Port, ResultStatus, Parameters",
    "detection": "office-policytampering.yaml",
    "field": "operationcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), OperationCount = count() by Operation, UserType, UserId, ClientIP = ClientIPOnly, Port, ResultStatus, Parameters",
    "detection": "office-policytampering.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), OperationCount = count() by Operation, UserType, UserId, ClientIP = ClientIPOnly, Port, ResultStatus, Parameters",
    "detection": "office-policytampering.yaml",
    "field": "usertype",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), OperationCount = count() by Operation, UserType, UserId, ClientIP = ClientIPOnly, Port, ResultStatus, Parameters",
    "detection": "office-policytampering.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), OperationCount = count() by Operation, UserType, UserId, ClientIP = ClientIPOnly, Port, ResultStatus, Parameters",
    "detection": "office-policytampering.yaml",
    "field": "port",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), OperationCount = count() by Operation, UserType, UserId, ClientIP = ClientIPOnly, Port, ResultStatus, Parameters",
    "detection": "office-policytampering.yaml",
    "field": "resultstatus",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), OperationCount = count() by Operation, UserType, UserId, ClientIP = ClientIPOnly, Port, ResultStatus, Parameters",
    "detection": "office-policytampering.yaml",
    "field": "parameters",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(UserId, \"@\")[0]), AccountUPNSuffix = tostring(split(UserId, \"@\")[1])",
    "detection": "office-policytampering.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(UserId, \"@\")[0]), AccountUPNSuffix = tostring(split(UserId, \"@\")[1])",
    "detection": "office-policytampering.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), DeletedTeams = make_set(TeamName, 1000) by UserId",
    "detection": "multipleteamsdeletes.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), DeletedTeams = make_set(TeamName, 1000) by UserId",
    "detection": "multipleteamsdeletes.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), DeletedTeams = make_set(TeamName, 1000) by UserId",
    "detection": "multipleteamsdeletes.yaml",
    "field": "deletedteams",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), DeletedTeams = make_set(TeamName, 1000) by UserId",
    "detection": "multipleteamsdeletes.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(UserId, \"@\")[0]), AccountUPNSuffix = tostring(split(UserId, \"@\")[1])",
    "detection": "multipleteamsdeletes.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(UserId, \"@\")[0]), AccountUPNSuffix = tostring(split(UserId, \"@\")[1])",
    "detection": "multipleteamsdeletes.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Events=todynamic(Parameters)",
    "detection": "bec-mailboxrule.yaml",
    "field": "events",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ClientIPAddress = case( ClientIP has \".\", tostring(split(ClientIP,\":\")[0]), ClientIP has \"[\", tostring(trim_start(@'[[]',tostring(split(ClientIP,\"]\")[0]))), ClientIP )",
    "detection": "bec-mailboxrule.yaml",
    "field": "clientipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Keyword = iff(isnotempty(SubjectContainsWords), SubjectContainsWords, (iff(isnotempty(BodyContainsWords),BodyContainsWords,SubjectOrBodyContainsWords )))",
    "detection": "bec-mailboxrule.yaml",
    "field": "keyword",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend RuleDetail = case(OfficeObjectId contains '/' , tostring(split(OfficeObjectId, '/')[-1]) , tostring(split(OfficeObjectId, '\\\\')[-1]))",
    "detection": "bec-mailboxrule.yaml",
    "field": "ruledetail",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by  Operation, UserId, ClientIPAddress, ResultStatus, Keyword, OriginatingServer, OfficeObjectId, RuleDetail",
    "detection": "bec-mailboxrule.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by  Operation, UserId, ClientIPAddress, ResultStatus, Keyword, OriginatingServer, OfficeObjectId, RuleDetail",
    "detection": "bec-mailboxrule.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by  Operation, UserId, ClientIPAddress, ResultStatus, Keyword, OriginatingServer, OfficeObjectId, RuleDetail",
    "detection": "bec-mailboxrule.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by  Operation, UserId, ClientIPAddress, ResultStatus, Keyword, OriginatingServer, OfficeObjectId, RuleDetail",
    "detection": "bec-mailboxrule.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by  Operation, UserId, ClientIPAddress, ResultStatus, Keyword, OriginatingServer, OfficeObjectId, RuleDetail",
    "detection": "bec-mailboxrule.yaml",
    "field": "clientipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by  Operation, UserId, ClientIPAddress, ResultStatus, Keyword, OriginatingServer, OfficeObjectId, RuleDetail",
    "detection": "bec-mailboxrule.yaml",
    "field": "resultstatus",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by  Operation, UserId, ClientIPAddress, ResultStatus, Keyword, OriginatingServer, OfficeObjectId, RuleDetail",
    "detection": "bec-mailboxrule.yaml",
    "field": "keyword",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by  Operation, UserId, ClientIPAddress, ResultStatus, Keyword, OriginatingServer, OfficeObjectId, RuleDetail",
    "detection": "bec-mailboxrule.yaml",
    "field": "originatingserver",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by  Operation, UserId, ClientIPAddress, ResultStatus, Keyword, OriginatingServer, OfficeObjectId, RuleDetail",
    "detection": "bec-mailboxrule.yaml",
    "field": "officeobjectid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by  Operation, UserId, ClientIPAddress, ResultStatus, Keyword, OriginatingServer, OfficeObjectId, RuleDetail",
    "detection": "bec-mailboxrule.yaml",
    "field": "ruledetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = split(UserId, '@')[0], DomainName = split(UserId, '@')[1]",
    "detection": "bec-mailboxrule.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserName = split(UserId, '@')[0], DomainName = split(UserId, '@')[1]",
    "detection": "bec-mailboxrule.yaml",
    "field": "domainname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationMailAddress = tolower(case(",
    "detection": "multipleusersemailforwardedtosamedestination.yaml",
    "field": "destinationmailaddress",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ClientIPValues = extract_all(@'\\[?(::ffff:)?(?P<IPAddress>(\\d+\\.\\d+\\.\\d+\\.\\d+)|[^\\]]+)\\]?([-:](?P<Port>\\d+))?', dynamic([\"IPAddress\", \"Port\"]), ClientIP)[0]",
    "detection": "multipleusersemailforwardedtosamedestination.yaml",
    "field": "clientipvalues",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ClientIP = tostring(ClientIPValues[0]), Port = tostring(ClientIPValues[1])",
    "detection": "multipleusersemailforwardedtosamedestination.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ClientIP = tostring(ClientIPValues[0]), Port = tostring(ClientIPValues[1])",
    "detection": "multipleusersemailforwardedtosamedestination.yaml",
    "field": "port",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), DistinctUserCount = dcount(UserId), UserId = make_set(UserId, 250), Ports = make_set(Port, 250), EventCount = count() by tostring(DestinationMailAddress), ClientIP",
    "detection": "multipleusersemailforwardedtosamedestination.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), DistinctUserCount = dcount(UserId), UserId = make_set(UserId, 250), Ports = make_set(Port, 250), EventCount = count() by tostring(DestinationMailAddress), ClientIP",
    "detection": "multipleusersemailforwardedtosamedestination.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), DistinctUserCount = dcount(UserId), UserId = make_set(UserId, 250), Ports = make_set(Port, 250), EventCount = count() by tostring(DestinationMailAddress), ClientIP",
    "detection": "multipleusersemailforwardedtosamedestination.yaml",
    "field": "distinctusercount",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), DistinctUserCount = dcount(UserId), UserId = make_set(UserId, 250), Ports = make_set(Port, 250), EventCount = count() by tostring(DestinationMailAddress), ClientIP",
    "detection": "multipleusersemailforwardedtosamedestination.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), DistinctUserCount = dcount(UserId), UserId = make_set(UserId, 250), Ports = make_set(Port, 250), EventCount = count() by tostring(DestinationMailAddress), ClientIP",
    "detection": "multipleusersemailforwardedtosamedestination.yaml",
    "field": "ports",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), DistinctUserCount = dcount(UserId), UserId = make_set(UserId, 250), Ports = make_set(Port, 250), EventCount = count() by tostring(DestinationMailAddress), ClientIP",
    "detection": "multipleusersemailforwardedtosamedestination.yaml",
    "field": "eventcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), DistinctUserCount = dcount(UserId), UserId = make_set(UserId, 250), Ports = make_set(Port, 250), EventCount = count() by tostring(DestinationMailAddress), ClientIP",
    "detection": "multipleusersemailforwardedtosamedestination.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTime, AccountCustomEntity = UserId, IPCustomEntity = ClientIP",
    "detection": "multipleusersemailforwardedtosamedestination.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTime, AccountCustomEntity = UserId, IPCustomEntity = ClientIP",
    "detection": "multipleusersemailforwardedtosamedestination.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTime, AccountCustomEntity = UserId, IPCustomEntity = ClientIP",
    "detection": "multipleusersemailforwardedtosamedestination.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Minutes=make_list(range(StartTime,EndTime, 1m)) by AlertName, SystemAlertId",
    "detection": "unusual-volume-of-file-deletion-custom-correlation.yaml",
    "field": "minutes",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Minutes=make_list(range(StartTime,EndTime, 1m)) by AlertName, SystemAlertId",
    "detection": "unusual-volume-of-file-deletion-custom-correlation.yaml",
    "field": "alertname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Minutes=make_list(range(StartTime,EndTime, 1m)) by AlertName, SystemAlertId",
    "detection": "unusual-volume-of-file-deletion-custom-correlation.yaml",
    "field": "systemalertid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Minutes=tostring(Minutes)",
    "detection": "unusual-volume-of-file-deletion-custom-correlation.yaml",
    "field": "minutes",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Minutes=tostring(bin(TimeGenerated, 1m))) on Minutes",
    "detection": "unusual-volume-of-file-deletion-custom-correlation.yaml",
    "field": "minutes",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserId, RecordType, ItemType, UserAgent, Operation, AlertName, SystemAlertId, OrganizationId, UserType, UserKey, OfficeWorkload, OfficeObjectId,  ClientIP",
    "detection": "unusual-volume-of-file-deletion-custom-correlation.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserId, RecordType, ItemType, UserAgent, Operation, AlertName, SystemAlertId, OrganizationId, UserType, UserKey, OfficeWorkload, OfficeObjectId,  ClientIP",
    "detection": "unusual-volume-of-file-deletion-custom-correlation.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserId, RecordType, ItemType, UserAgent, Operation, AlertName, SystemAlertId, OrganizationId, UserType, UserKey, OfficeWorkload, OfficeObjectId,  ClientIP",
    "detection": "unusual-volume-of-file-deletion-custom-correlation.yaml",
    "field": "recordtype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserId, RecordType, ItemType, UserAgent, Operation, AlertName, SystemAlertId, OrganizationId, UserType, UserKey, OfficeWorkload, OfficeObjectId,  ClientIP",
    "detection": "unusual-volume-of-file-deletion-custom-correlation.yaml",
    "field": "itemtype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserId, RecordType, ItemType, UserAgent, Operation, AlertName, SystemAlertId, OrganizationId, UserType, UserKey, OfficeWorkload, OfficeObjectId,  ClientIP",
    "detection": "unusual-volume-of-file-deletion-custom-correlation.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserId, RecordType, ItemType, UserAgent, Operation, AlertName, SystemAlertId, OrganizationId, UserType, UserKey, OfficeWorkload, OfficeObjectId,  ClientIP",
    "detection": "unusual-volume-of-file-deletion-custom-correlation.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserId, RecordType, ItemType, UserAgent, Operation, AlertName, SystemAlertId, OrganizationId, UserType, UserKey, OfficeWorkload, OfficeObjectId,  ClientIP",
    "detection": "unusual-volume-of-file-deletion-custom-correlation.yaml",
    "field": "alertname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserId, RecordType, ItemType, UserAgent, Operation, AlertName, SystemAlertId, OrganizationId, UserType, UserKey, OfficeWorkload, OfficeObjectId,  ClientIP",
    "detection": "unusual-volume-of-file-deletion-custom-correlation.yaml",
    "field": "systemalertid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserId, RecordType, ItemType, UserAgent, Operation, AlertName, SystemAlertId, OrganizationId, UserType, UserKey, OfficeWorkload, OfficeObjectId,  ClientIP",
    "detection": "unusual-volume-of-file-deletion-custom-correlation.yaml",
    "field": "organizationid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserId, RecordType, ItemType, UserAgent, Operation, AlertName, SystemAlertId, OrganizationId, UserType, UserKey, OfficeWorkload, OfficeObjectId,  ClientIP",
    "detection": "unusual-volume-of-file-deletion-custom-correlation.yaml",
    "field": "usertype",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserId, RecordType, ItemType, UserAgent, Operation, AlertName, SystemAlertId, OrganizationId, UserType, UserKey, OfficeWorkload, OfficeObjectId,  ClientIP",
    "detection": "unusual-volume-of-file-deletion-custom-correlation.yaml",
    "field": "userkey",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserId, RecordType, ItemType, UserAgent, Operation, AlertName, SystemAlertId, OrganizationId, UserType, UserKey, OfficeWorkload, OfficeObjectId,  ClientIP",
    "detection": "unusual-volume-of-file-deletion-custom-correlation.yaml",
    "field": "officeworkload",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserId, RecordType, ItemType, UserAgent, Operation, AlertName, SystemAlertId, OrganizationId, UserType, UserKey, OfficeWorkload, OfficeObjectId,  ClientIP",
    "detection": "unusual-volume-of-file-deletion-custom-correlation.yaml",
    "field": "officeobjectid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserId, RecordType, ItemType, UserAgent, Operation, AlertName, SystemAlertId, OrganizationId, UserType, UserKey, OfficeWorkload, OfficeObjectId,  ClientIP",
    "detection": "unusual-volume-of-file-deletion-custom-correlation.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize [\"app@sharepoint\"]=countif(UserId == \"app@sharepoint\"), Others=countif(UserId != \"app@sharepoint\") by SystemAlertId",
    "detection": "unusual-volume-of-file-deletion-custom-correlation.yaml",
    "field": "others",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize [\"app@sharepoint\"]=countif(UserId == \"app@sharepoint\"), Others=countif(UserId != \"app@sharepoint\") by SystemAlertId",
    "detection": "unusual-volume-of-file-deletion-custom-correlation.yaml",
    "field": "systemalertid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UPN = tostring(Members.UPN)",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "upn",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Operation, UPN, UserId, TeamName, ClientIP",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Operation, UPN, UserId, TeamName, ClientIP",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Operation, UPN, UserId, TeamName, ClientIP",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "upn",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Operation, UPN, UserId, TeamName, ClientIP",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Operation, UPN, UserId, TeamName, ClientIP",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "teamname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Operation, UPN, UserId, TeamName, ClientIP",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeAdded=TimeGenerated, Operation, MemberAdded = UPN, UserWhoAdded = UserId, TeamName, ClientIP;",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "timeadded",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeAdded=TimeGenerated, Operation, MemberAdded = UPN, UserWhoAdded = UserId, TeamName, ClientIP;",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeAdded=TimeGenerated, Operation, MemberAdded = UPN, UserWhoAdded = UserId, TeamName, ClientIP;",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "memberadded",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeAdded=TimeGenerated, Operation, MemberAdded = UPN, UserWhoAdded = UserId, TeamName, ClientIP;",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "userwhoadded",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeAdded=TimeGenerated, Operation, MemberAdded = UPN, UserWhoAdded = UserId, TeamName, ClientIP;",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "teamname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeDeleted=TimeGenerated, Operation, MemberRemoved = UPN, UserWhoDeleted = UserId, TeamName, ClientIP;",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "timedeleted",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeDeleted=TimeGenerated, Operation, MemberRemoved = UPN, UserWhoDeleted = UserId, TeamName, ClientIP;",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeDeleted=TimeGenerated, Operation, MemberRemoved = UPN, UserWhoDeleted = UserId, TeamName, ClientIP;",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "memberremoved",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeDeleted=TimeGenerated, Operation, MemberRemoved = UPN, UserWhoDeleted = UserId, TeamName, ClientIP;",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "userwhodeleted",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeDeleted=TimeGenerated, Operation, MemberRemoved = UPN, UserWhoDeleted = UserId, TeamName, ClientIP;",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "teamname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeAdded, TimeDeleted, MemberAdded_Removed = MemberAdded, UserWhoAdded, UserWhoDeleted, TeamName, ClientIP",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "timeadded",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeAdded, TimeDeleted, MemberAdded_Removed = MemberAdded, UserWhoAdded, UserWhoDeleted, TeamName, ClientIP",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "timedeleted",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeAdded, TimeDeleted, MemberAdded_Removed = MemberAdded, UserWhoAdded, UserWhoDeleted, TeamName, ClientIP",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "memberadded_removed",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeAdded, TimeDeleted, MemberAdded_Removed = MemberAdded, UserWhoAdded, UserWhoDeleted, TeamName, ClientIP",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "userwhoadded",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeAdded, TimeDeleted, MemberAdded_Removed = MemberAdded, UserWhoAdded, UserWhoDeleted, TeamName, ClientIP",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "userwhodeleted",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeAdded, TimeDeleted, MemberAdded_Removed = MemberAdded, UserWhoAdded, UserWhoDeleted, TeamName, ClientIP",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "teamname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeAdded, TimeDeleted, MemberAdded_Removed = MemberAdded, UserWhoAdded, UserWhoDeleted, TeamName, ClientIP",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend MemberAdded_RemovedAccountName = tostring(split(MemberAdded_Removed, \"@\")[0]), MemberAdded_RemovedAccountUPNSuffix = tostring(split(MemberAdded_Removed, \"@\")[1])",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "memberadded_removedaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend MemberAdded_RemovedAccountName = tostring(split(MemberAdded_Removed, \"@\")[0]), MemberAdded_RemovedAccountUPNSuffix = tostring(split(MemberAdded_Removed, \"@\")[1])",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "memberadded_removedaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserWhoAddedAccountName = tostring(split(UserWhoAdded, \"@\")[0]), UserWhoAddedAccountUPNSuffix = tostring(split(UserWhoAdded, \"@\")[1])",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "userwhoaddedaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserWhoAddedAccountName = tostring(split(UserWhoAdded, \"@\")[0]), UserWhoAddedAccountUPNSuffix = tostring(split(UserWhoAdded, \"@\")[1])",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "userwhoaddedaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserWhoDeletedAccountName = tostring(split(UserWhoDeleted, \"@\")[0]), UserWhoDeletedAccountUPNSuffix = tostring(split(UserWhoDeleted, \"@\")[1])",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "userwhodeletedaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserWhoDeletedAccountName = tostring(split(UserWhoDeleted, \"@\")[0]), UserWhoDeletedAccountUPNSuffix = tostring(split(UserWhoDeleted, \"@\")[1])",
    "detection": "externaluseraddedremovedinteams.yaml",
    "field": "userwhodeletedaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationMailAddress = tolower(case(",
    "detection": "office-mailforwarding.yaml",
    "field": "destinationmailaddress",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ClientIPValues = extract_all(@'\\[?(::ffff:)?(?P<IPAddress>(\\d+\\.\\d+\\.\\d+\\.\\d+)|[^\\]]+)\\]?([-:](?P<Port>\\d+))?', dynamic([\"IPAddress\", \"Port\"]), ClientIP)[0]",
    "detection": "office-mailforwarding.yaml",
    "field": "clientipvalues",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ClientIP = tostring(ClientIPValues[0]), Port = tostring(ClientIPValues[1])",
    "detection": "office-mailforwarding.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ClientIP = tostring(ClientIPValues[0]), Port = tostring(ClientIPValues[1])",
    "detection": "office-mailforwarding.yaml",
    "field": "port",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), DistinctUserCount = dcount(UserId), UserId = make_set(UserId, 250), Ports = make_set(Port, 250), EventCount = count() by tostring(DestinationMailAddress), ClientIP",
    "detection": "office-mailforwarding.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), DistinctUserCount = dcount(UserId), UserId = make_set(UserId, 250), Ports = make_set(Port, 250), EventCount = count() by tostring(DestinationMailAddress), ClientIP",
    "detection": "office-mailforwarding.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), DistinctUserCount = dcount(UserId), UserId = make_set(UserId, 250), Ports = make_set(Port, 250), EventCount = count() by tostring(DestinationMailAddress), ClientIP",
    "detection": "office-mailforwarding.yaml",
    "field": "distinctusercount",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), DistinctUserCount = dcount(UserId), UserId = make_set(UserId, 250), Ports = make_set(Port, 250), EventCount = count() by tostring(DestinationMailAddress), ClientIP",
    "detection": "office-mailforwarding.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), DistinctUserCount = dcount(UserId), UserId = make_set(UserId, 250), Ports = make_set(Port, 250), EventCount = count() by tostring(DestinationMailAddress), ClientIP",
    "detection": "office-mailforwarding.yaml",
    "field": "ports",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), DistinctUserCount = dcount(UserId), UserId = make_set(UserId, 250), Ports = make_set(Port, 250), EventCount = count() by tostring(DestinationMailAddress), ClientIP",
    "detection": "office-mailforwarding.yaml",
    "field": "eventcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), DistinctUserCount = dcount(UserId), UserId = make_set(UserId, 250), Ports = make_set(Port, 250), EventCount = count() by tostring(DestinationMailAddress), ClientIP",
    "detection": "office-mailforwarding.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(UserId, \"@\")[0]), AccountUPNSuffix = tostring(split(UserId, \"@\")[1])",
    "detection": "office-mailforwarding.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(UserId, \"@\")[0]), AccountUPNSuffix = tostring(split(UserId, \"@\")[1])",
    "detection": "office-mailforwarding.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend MemberAdded = tostring(parse_json(Members)[0].UPN)",
    "detection": "external-user-added-to-team-and-immediately-uploads-file.yaml",
    "field": "memberadded",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeAdded=TimeGenerated, Operation, MemberAdded, UserWhoAdded = UserId, TeamName",
    "detection": "external-user-added-to-team-and-immediately-uploads-file.yaml",
    "field": "timeadded",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeAdded=TimeGenerated, Operation, MemberAdded, UserWhoAdded = UserId, TeamName",
    "detection": "external-user-added-to-team-and-immediately-uploads-file.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeAdded=TimeGenerated, Operation, MemberAdded, UserWhoAdded = UserId, TeamName",
    "detection": "external-user-added-to-team-and-immediately-uploads-file.yaml",
    "field": "memberadded",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeAdded=TimeGenerated, Operation, MemberAdded, UserWhoAdded = UserId, TeamName",
    "detection": "external-user-added-to-team-and-immediately-uploads-file.yaml",
    "field": "userwhoadded",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeAdded=TimeGenerated, Operation, MemberAdded, UserWhoAdded = UserId, TeamName",
    "detection": "external-user-added-to-team-and-immediately-uploads-file.yaml",
    "field": "teamname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend MemberAdded = tostring(parse_json(Members)[0].UPN)",
    "detection": "external-user-added-to-team-and-immediately-uploads-file.yaml",
    "field": "memberadded",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project TimeDeleted=TimeGenerated, Operation, MemberAdded, UserWhoDeleted = UserId, TeamName",
    "detection": "external-user-added-to-team-and-immediately-uploads-file.yaml",
    "field": "timedeleted",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project TimeDeleted=TimeGenerated, Operation, MemberAdded, UserWhoDeleted = UserId, TeamName",
    "detection": "external-user-added-to-team-and-immediately-uploads-file.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project TimeDeleted=TimeGenerated, Operation, MemberAdded, UserWhoDeleted = UserId, TeamName",
    "detection": "external-user-added-to-team-and-immediately-uploads-file.yaml",
    "field": "memberadded",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project TimeDeleted=TimeGenerated, Operation, MemberAdded, UserWhoDeleted = UserId, TeamName",
    "detection": "external-user-added-to-team-and-immediately-uploads-file.yaml",
    "field": "userwhodeleted",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "  | project TimeDeleted=TimeGenerated, Operation, MemberAdded, UserWhoDeleted = UserId, TeamName",
    "detection": "external-user-added-to-team-and-immediately-uploads-file.yaml",
    "field": "teamname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend MemberAdded = UserId",
    "detection": "external-user-added-to-team-and-immediately-uploads-file.yaml",
    "field": "memberadded",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "      | summarize FileAccessCount = count() by OfficeObjectId",
    "detection": "external-user-added-to-team-and-immediately-uploads-file.yaml",
    "field": "fileaccesscount",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "      | summarize FileAccessCount = count() by OfficeObjectId",
    "detection": "external-user-added-to-team-and-immediately-uploads-file.yaml",
    "field": "officeobjectid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend MemberAddedAccountName = tostring(split(MemberAdded, \"@\")[0]), MemberAddedAccountUPNSuffix = tostring(split(MemberAdded, \"@\")[1])",
    "detection": "external-user-added-to-team-and-immediately-uploads-file.yaml",
    "field": "memberaddedaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend MemberAddedAccountName = tostring(split(MemberAdded, \"@\")[0]), MemberAddedAccountUPNSuffix = tostring(split(MemberAdded, \"@\")[1])",
    "detection": "external-user-added-to-team-and-immediately-uploads-file.yaml",
    "field": "memberaddedaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserWhoAddedAccountName = tostring(split(UserWhoAdded, \"@\")[0]), UserWhoAddedAccountUPNSuffix = tostring(split(UserWhoAdded, \"@\")[1])",
    "detection": "external-user-added-to-team-and-immediately-uploads-file.yaml",
    "field": "userwhoaddedaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserWhoAddedAccountName = tostring(split(UserWhoAdded, \"@\")[0]), UserWhoAddedAccountUPNSuffix = tostring(split(UserWhoAdded, \"@\")[1])",
    "detection": "external-user-added-to-team-and-immediately-uploads-file.yaml",
    "field": "userwhoaddedaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserWhoDeletedAccountName = tostring(split(UserWhoDeleted, \"@\")[0]), UserWhoDeletedAccountUPNSuffix = tostring(split(UserWhoDeleted, \"@\")[1])",
    "detection": "external-user-added-to-team-and-immediately-uploads-file.yaml",
    "field": "userwhodeletedaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserWhoDeletedAccountName = tostring(split(UserWhoDeleted, \"@\")[0]), UserWhoDeletedAccountUPNSuffix = tostring(split(UserWhoDeleted, \"@\")[1])",
    "detection": "external-user-added-to-team-and-immediately-uploads-file.yaml",
    "field": "userwhodeletedaccountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserAgent = iff(parse_json(ExtendedProperties)[0].Name =~ \"UserAgent\", extractjson(\"$[0].Value\", ExtendedProperties, typeof(string)),\"\")",
    "detection": "strontiumoct292020iocs.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend RequestType = todynamic(ExtendedProperties).Value",
    "detection": "strontiumoct292020iocs.yaml",
    "field": "requesttype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize authAttempts=dcount(TimeGenerated), firstAttempt=min(TimeGenerated), lastAttempt=max(TimeGenerated), uniqueIPs=dcount(ClientIP), uniqueAccounts=dcount(UserId), attemptedAccounts=make_set(UserId) by UserAgent",
    "detection": "strontiumoct292020iocs.yaml",
    "field": "authattempts",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize authAttempts=dcount(TimeGenerated), firstAttempt=min(TimeGenerated), lastAttempt=max(TimeGenerated), uniqueIPs=dcount(ClientIP), uniqueAccounts=dcount(UserId), attemptedAccounts=make_set(UserId) by UserAgent",
    "detection": "strontiumoct292020iocs.yaml",
    "field": "firstattempt",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize authAttempts=dcount(TimeGenerated), firstAttempt=min(TimeGenerated), lastAttempt=max(TimeGenerated), uniqueIPs=dcount(ClientIP), uniqueAccounts=dcount(UserId), attemptedAccounts=make_set(UserId) by UserAgent",
    "detection": "strontiumoct292020iocs.yaml",
    "field": "lastattempt",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize authAttempts=dcount(TimeGenerated), firstAttempt=min(TimeGenerated), lastAttempt=max(TimeGenerated), uniqueIPs=dcount(ClientIP), uniqueAccounts=dcount(UserId), attemptedAccounts=make_set(UserId) by UserAgent",
    "detection": "strontiumoct292020iocs.yaml",
    "field": "uniqueips",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize authAttempts=dcount(TimeGenerated), firstAttempt=min(TimeGenerated), lastAttempt=max(TimeGenerated), uniqueIPs=dcount(ClientIP), uniqueAccounts=dcount(UserId), attemptedAccounts=make_set(UserId) by UserAgent",
    "detection": "strontiumoct292020iocs.yaml",
    "field": "uniqueaccounts",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize authAttempts=dcount(TimeGenerated), firstAttempt=min(TimeGenerated), lastAttempt=max(TimeGenerated), uniqueIPs=dcount(ClientIP), uniqueAccounts=dcount(UserId), attemptedAccounts=make_set(UserId) by UserAgent",
    "detection": "strontiumoct292020iocs.yaml",
    "field": "attemptedaccounts",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize authAttempts=dcount(TimeGenerated), firstAttempt=min(TimeGenerated), lastAttempt=max(TimeGenerated), uniqueIPs=dcount(ClientIP), uniqueAccounts=dcount(UserId), attemptedAccounts=make_set(UserId) by UserAgent",
    "detection": "strontiumoct292020iocs.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = firstAttempt",
    "detection": "strontiumoct292020iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OfficeId, OfficeWorkload, RecordType, Operation, UserType, UserKey, UserId, ClientIP, UserAgent, Site_Url, SourceRelativeUrl, SourceFileName",
    "detection": "office-uploaded-executables.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OfficeId, OfficeWorkload, RecordType, Operation, UserType, UserKey, UserId, ClientIP, UserAgent, Site_Url, SourceRelativeUrl, SourceFileName",
    "detection": "office-uploaded-executables.yaml",
    "field": "officeid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OfficeId, OfficeWorkload, RecordType, Operation, UserType, UserKey, UserId, ClientIP, UserAgent, Site_Url, SourceRelativeUrl, SourceFileName",
    "detection": "office-uploaded-executables.yaml",
    "field": "officeworkload",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OfficeId, OfficeWorkload, RecordType, Operation, UserType, UserKey, UserId, ClientIP, UserAgent, Site_Url, SourceRelativeUrl, SourceFileName",
    "detection": "office-uploaded-executables.yaml",
    "field": "recordtype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OfficeId, OfficeWorkload, RecordType, Operation, UserType, UserKey, UserId, ClientIP, UserAgent, Site_Url, SourceRelativeUrl, SourceFileName",
    "detection": "office-uploaded-executables.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OfficeId, OfficeWorkload, RecordType, Operation, UserType, UserKey, UserId, ClientIP, UserAgent, Site_Url, SourceRelativeUrl, SourceFileName",
    "detection": "office-uploaded-executables.yaml",
    "field": "usertype",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OfficeId, OfficeWorkload, RecordType, Operation, UserType, UserKey, UserId, ClientIP, UserAgent, Site_Url, SourceRelativeUrl, SourceFileName",
    "detection": "office-uploaded-executables.yaml",
    "field": "userkey",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OfficeId, OfficeWorkload, RecordType, Operation, UserType, UserKey, UserId, ClientIP, UserAgent, Site_Url, SourceRelativeUrl, SourceFileName",
    "detection": "office-uploaded-executables.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OfficeId, OfficeWorkload, RecordType, Operation, UserType, UserKey, UserId, ClientIP, UserAgent, Site_Url, SourceRelativeUrl, SourceFileName",
    "detection": "office-uploaded-executables.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OfficeId, OfficeWorkload, RecordType, Operation, UserType, UserKey, UserId, ClientIP, UserAgent, Site_Url, SourceRelativeUrl, SourceFileName",
    "detection": "office-uploaded-executables.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OfficeId, OfficeWorkload, RecordType, Operation, UserType, UserKey, UserId, ClientIP, UserAgent, Site_Url, SourceRelativeUrl, SourceFileName",
    "detection": "office-uploaded-executables.yaml",
    "field": "site_url",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OfficeId, OfficeWorkload, RecordType, Operation, UserType, UserKey, UserId, ClientIP, UserAgent, Site_Url, SourceRelativeUrl, SourceFileName",
    "detection": "office-uploaded-executables.yaml",
    "field": "sourcerelativeurl",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, OfficeId, OfficeWorkload, RecordType, Operation, UserType, UserKey, UserId, ClientIP, UserAgent, Site_Url, SourceRelativeUrl, SourceFileName",
    "detection": "office-uploaded-executables.yaml",
    "field": "sourcefilename",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SourceRelativeUrl = make_set(SourceRelativeUrl, 100000), UserId = make_set(UserId, 100000) , PrevSeenCount = count() by SourceFileName",
    "detection": "office-uploaded-executables.yaml",
    "field": "sourcerelativeurl",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SourceRelativeUrl = make_set(SourceRelativeUrl, 100000), UserId = make_set(UserId, 100000) , PrevSeenCount = count() by SourceFileName",
    "detection": "office-uploaded-executables.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SourceRelativeUrl = make_set(SourceRelativeUrl, 100000), UserId = make_set(UserId, 100000) , PrevSeenCount = count() by SourceFileName",
    "detection": "office-uploaded-executables.yaml",
    "field": "prevseencount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SourceRelativeUrl = make_set(SourceRelativeUrl, 100000), UserId = make_set(UserId, 100000) , PrevSeenCount = count() by SourceFileName",
    "detection": "office-uploaded-executables.yaml",
    "field": "sourcefilename",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceRelativeUrl = tostring(SourceRelativeUrl), UserId = tostring(UserId)",
    "detection": "office-uploaded-executables.yaml",
    "field": "sourcerelativeurl",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceRelativeUrl = tostring(SourceRelativeUrl), UserId = tostring(UserId)",
    "detection": "office-uploaded-executables.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend SiteUrlUserFolder = tolower(split(Site_Url, '/')[-2])",
    "detection": "office-uploaded-executables.yaml",
    "field": "siteurluserfolder",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdUserFolderFormat = tolower(replace_regex(UserId, '@|\\\\.', '_'))",
    "detection": "office-uploaded-executables.yaml",
    "field": "useriduserfolderformat",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserIdDiffThanUserFolder = iff(Site_Url has '/personal/' and SiteUrlUserFolder != UserIdUserFolderFormat, true , false )",
    "detection": "office-uploaded-executables.yaml",
    "field": "useriddiffthanuserfolder",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize TimeGenerated = make_list(TimeGenerated, 100000), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated),",
    "detection": "office-uploaded-executables.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize TimeGenerated = make_list(TimeGenerated, 100000), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated),",
    "detection": "office-uploaded-executables.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize TimeGenerated = make_list(TimeGenerated, 100000), StartTime = min(TimeGenerated), EndTime = max(TimeGenerated),",
    "detection": "office-uploaded-executables.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(UserId, \"@\")[0]), AccountUPNSuffix = tostring(split(UserId, \"@\")[1])",
    "detection": "office-uploaded-executables.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(UserId, \"@\")[0]), AccountUPNSuffix = tostring(split(UserId, \"@\")[1])",
    "detection": "office-uploaded-executables.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AdminAuditLogEnabledValue = tostring(parse_json(tostring(parse_json(tostring(array_slice(parse_json(Parameters),3,3)))[0])).Value)",
    "detection": "exchange-auditlogdisabled.yaml",
    "field": "adminauditlogenabledvalue",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), OperationCount = count() by Operation, UserType, UserId, ClientIP, ResultStatus, Parameters, AdminAuditLogEnabledValue",
    "detection": "exchange-auditlogdisabled.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), OperationCount = count() by Operation, UserType, UserId, ClientIP, ResultStatus, Parameters, AdminAuditLogEnabledValue",
    "detection": "exchange-auditlogdisabled.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), OperationCount = count() by Operation, UserType, UserId, ClientIP, ResultStatus, Parameters, AdminAuditLogEnabledValue",
    "detection": "exchange-auditlogdisabled.yaml",
    "field": "operationcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), OperationCount = count() by Operation, UserType, UserId, ClientIP, ResultStatus, Parameters, AdminAuditLogEnabledValue",
    "detection": "exchange-auditlogdisabled.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), OperationCount = count() by Operation, UserType, UserId, ClientIP, ResultStatus, Parameters, AdminAuditLogEnabledValue",
    "detection": "exchange-auditlogdisabled.yaml",
    "field": "usertype",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), OperationCount = count() by Operation, UserType, UserId, ClientIP, ResultStatus, Parameters, AdminAuditLogEnabledValue",
    "detection": "exchange-auditlogdisabled.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), OperationCount = count() by Operation, UserType, UserId, ClientIP, ResultStatus, Parameters, AdminAuditLogEnabledValue",
    "detection": "exchange-auditlogdisabled.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), OperationCount = count() by Operation, UserType, UserId, ClientIP, ResultStatus, Parameters, AdminAuditLogEnabledValue",
    "detection": "exchange-auditlogdisabled.yaml",
    "field": "resultstatus",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), OperationCount = count() by Operation, UserType, UserId, ClientIP, ResultStatus, Parameters, AdminAuditLogEnabledValue",
    "detection": "exchange-auditlogdisabled.yaml",
    "field": "parameters",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), OperationCount = count() by Operation, UserType, UserId, ClientIP, ResultStatus, Parameters, AdminAuditLogEnabledValue",
    "detection": "exchange-auditlogdisabled.yaml",
    "field": "adminauditlogenabledvalue",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iff(UserId contains '@', tostring(split(UserId, '@')[0]), UserId)",
    "detection": "exchange-auditlogdisabled.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountUPNSuffix = iff(UserId contains '@', tostring(split(UserId, '@')[1]), '')",
    "detection": "exchange-auditlogdisabled.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = iff(UserId contains '\\\\', tostring(split(UserId, '\\\\')[1]), AccountName)",
    "detection": "exchange-auditlogdisabled.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountNTDomain = iff(UserId contains '\\\\', tostring(split(UserId, '\\\\')[0]), '')",
    "detection": "exchange-auditlogdisabled.yaml",
    "field": "accountntdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Operation, MailboxOwnerUPN",
    "detection": "mailitemsaccessedtimeseries.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Operation, MailboxOwnerUPN",
    "detection": "mailitemsaccessedtimeseries.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Operation, MailboxOwnerUPN",
    "detection": "mailitemsaccessedtimeseries.yaml",
    "field": "mailboxownerupn",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Total, baseline, anomalies, score;",
    "detection": "mailitemsaccessedtimeseries.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Total, baseline, anomalies, score;",
    "detection": "mailitemsaccessedtimeseries.yaml",
    "field": "total",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Total, baseline, anomalies, score;",
    "detection": "mailitemsaccessedtimeseries.yaml",
    "field": "baseline",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Total, baseline, anomalies, score;",
    "detection": "mailitemsaccessedtimeseries.yaml",
    "field": "anomalies",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend DateHour = bin(TimeGenerated, 1h)",
    "detection": "mailitemsaccessedtimeseries.yaml",
    "field": "datehour",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize HourlyCount=count(), TimeGeneratedMax = arg_max(TimeGenerated, *), IPAdressList = make_set(Client_IPAddress, 1000), SourceIPMax= arg_max(Client_IPAddress, *), ClientInfoStringList= make_set(ClientInfoString, 1000) by MailboxOwnerUPN, Logon_Type, TenantId, UserType, TimeGenerated = bin(TimeGenerated, 1h)",
    "detection": "mailitemsaccessedtimeseries.yaml",
    "field": "hourlycount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize HourlyCount=count(), TimeGeneratedMax = arg_max(TimeGenerated, *), IPAdressList = make_set(Client_IPAddress, 1000), SourceIPMax= arg_max(Client_IPAddress, *), ClientInfoStringList= make_set(ClientInfoString, 1000) by MailboxOwnerUPN, Logon_Type, TenantId, UserType, TimeGenerated = bin(TimeGenerated, 1h)",
    "detection": "mailitemsaccessedtimeseries.yaml",
    "field": "timegeneratedmax",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize HourlyCount=count(), TimeGeneratedMax = arg_max(TimeGenerated, *), IPAdressList = make_set(Client_IPAddress, 1000), SourceIPMax= arg_max(Client_IPAddress, *), ClientInfoStringList= make_set(ClientInfoString, 1000) by MailboxOwnerUPN, Logon_Type, TenantId, UserType, TimeGenerated = bin(TimeGenerated, 1h)",
    "detection": "mailitemsaccessedtimeseries.yaml",
    "field": "ipadresslist",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize HourlyCount=count(), TimeGeneratedMax = arg_max(TimeGenerated, *), IPAdressList = make_set(Client_IPAddress, 1000), SourceIPMax= arg_max(Client_IPAddress, *), ClientInfoStringList= make_set(ClientInfoString, 1000) by MailboxOwnerUPN, Logon_Type, TenantId, UserType, TimeGenerated = bin(TimeGenerated, 1h)",
    "detection": "mailitemsaccessedtimeseries.yaml",
    "field": "sourceipmax",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize HourlyCount=count(), TimeGeneratedMax = arg_max(TimeGenerated, *), IPAdressList = make_set(Client_IPAddress, 1000), SourceIPMax= arg_max(Client_IPAddress, *), ClientInfoStringList= make_set(ClientInfoString, 1000) by MailboxOwnerUPN, Logon_Type, TenantId, UserType, TimeGenerated = bin(TimeGenerated, 1h)",
    "detection": "mailitemsaccessedtimeseries.yaml",
    "field": "clientinfostringlist",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize HourlyCount=count(), TimeGeneratedMax = arg_max(TimeGenerated, *), IPAdressList = make_set(Client_IPAddress, 1000), SourceIPMax= arg_max(Client_IPAddress, *), ClientInfoStringList= make_set(ClientInfoString, 1000) by MailboxOwnerUPN, Logon_Type, TenantId, UserType, TimeGenerated = bin(TimeGenerated, 1h)",
    "detection": "mailitemsaccessedtimeseries.yaml",
    "field": "mailboxownerupn",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize HourlyCount=count(), TimeGeneratedMax = arg_max(TimeGenerated, *), IPAdressList = make_set(Client_IPAddress, 1000), SourceIPMax= arg_max(Client_IPAddress, *), ClientInfoStringList= make_set(ClientInfoString, 1000) by MailboxOwnerUPN, Logon_Type, TenantId, UserType, TimeGenerated = bin(TimeGenerated, 1h)",
    "detection": "mailitemsaccessedtimeseries.yaml",
    "field": "logon_type",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize HourlyCount=count(), TimeGeneratedMax = arg_max(TimeGenerated, *), IPAdressList = make_set(Client_IPAddress, 1000), SourceIPMax= arg_max(Client_IPAddress, *), ClientInfoStringList= make_set(ClientInfoString, 1000) by MailboxOwnerUPN, Logon_Type, TenantId, UserType, TimeGenerated = bin(TimeGenerated, 1h)",
    "detection": "mailitemsaccessedtimeseries.yaml",
    "field": "tenantid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize HourlyCount=count(), TimeGeneratedMax = arg_max(TimeGenerated, *), IPAdressList = make_set(Client_IPAddress, 1000), SourceIPMax= arg_max(Client_IPAddress, *), ClientInfoStringList= make_set(ClientInfoString, 1000) by MailboxOwnerUPN, Logon_Type, TenantId, UserType, TimeGenerated = bin(TimeGenerated, 1h)",
    "detection": "mailitemsaccessedtimeseries.yaml",
    "field": "usertype",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend PercentofTotal = round(HourlyCount/Total, 2) * 100",
    "detection": "mailitemsaccessedtimeseries.yaml",
    "field": "percentoftotal",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(UserId, \"@\")[0]), AccountUPNSuffix = tostring(split(UserId, \"@\")[1])",
    "detection": "mailitemsaccessedtimeseries.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(UserId, \"@\")[0]), AccountUPNSuffix = tostring(split(UserId, \"@\")[1])",
    "detection": "mailitemsaccessedtimeseries.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case(",
    "detection": "manganese-vpn-iocs.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "manganese-vpn-iocs.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "manganese-vpn-iocs.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "manganese-vpn-iocs.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "manganese-vpn-iocs.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "manganese-vpn-iocs.yaml",
    "field": "deviceproduct",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "manganese-vpn-iocs.yaml",
    "field": "deviceaction",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "manganese-vpn-iocs.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "manganese-vpn-iocs.yaml",
    "field": "protocol",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "manganese-vpn-iocs.yaml",
    "field": "sourceport",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "manganese-vpn-iocs.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "manganese-vpn-iocs.yaml",
    "field": "deviceaddress",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "manganese-vpn-iocs.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "manganese-vpn-iocs.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"IP in Message Field\")",
    "detection": "manganese-vpn-iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"IP in Message Field\")",
    "detection": "manganese-vpn-iocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP = ClientIP, Account = UserId, Type, RecordType, OfficeWorkload, UserAgent, OfficeObjectId, IPMatch = \"ClientIP\"",
    "detection": "manganese-vpn-iocs.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP = ClientIP, Account = UserId, Type, RecordType, OfficeWorkload, UserAgent, OfficeObjectId, IPMatch = \"ClientIP\"",
    "detection": "manganese-vpn-iocs.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP = ClientIP, Account = UserId, Type, RecordType, OfficeWorkload, UserAgent, OfficeObjectId, IPMatch = \"ClientIP\"",
    "detection": "manganese-vpn-iocs.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP = ClientIP, Account = UserId, Type, RecordType, OfficeWorkload, UserAgent, OfficeObjectId, IPMatch = \"ClientIP\"",
    "detection": "manganese-vpn-iocs.yaml",
    "field": "recordtype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP = ClientIP, Account = UserId, Type, RecordType, OfficeWorkload, UserAgent, OfficeObjectId, IPMatch = \"ClientIP\"",
    "detection": "manganese-vpn-iocs.yaml",
    "field": "officeworkload",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP = ClientIP, Account = UserId, Type, RecordType, OfficeWorkload, UserAgent, OfficeObjectId, IPMatch = \"ClientIP\"",
    "detection": "manganese-vpn-iocs.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP = ClientIP, Account = UserId, Type, RecordType, OfficeWorkload, UserAgent, OfficeObjectId, IPMatch = \"ClientIP\"",
    "detection": "manganese-vpn-iocs.yaml",
    "field": "officeobjectid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, AccountCustomEntity = Account, IPCustomEntity = SourceIP",
    "detection": "manganese-vpn-iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, AccountCustomEntity = Account, IPCustomEntity = SourceIP",
    "detection": "manganese-vpn-iocs.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, AccountCustomEntity = Account, IPCustomEntity = SourceIP",
    "detection": "manganese-vpn-iocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270registryiocsep2022.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270registryiocsep2022.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270registryiocsep2022.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270registryiocsep2022.yaml",
    "field": "accountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270registryiocsep2022.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270registryiocsep2022.yaml",
    "field": "processnamefullpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270registryiocsep2022.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270registryiocsep2022.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270registryiocsep2022.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270registryiocsep2022.yaml",
    "field": "eventsourcename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270registryiocsep2022.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = strcat(InitiatingProcessAccountDomain, @'\\', InitiatingProcessAccountName), Computer = DeviceName",
    "detection": "dev-0270registryiocsep2022.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = strcat(InitiatingProcessAccountDomain, @'\\', InitiatingProcessAccountName), Computer = DeviceName",
    "detection": "dev-0270registryiocsep2022.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "dev-0270registryiocsep2022.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "dev-0270registryiocsep2022.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "dev-0270registryiocsep2022.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Account, @'\\')[1]), AccountNTDomain = tostring(split(Account, @'\\')[0])",
    "detection": "dev-0270registryiocsep2022.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Account, @'\\')[1]), AccountNTDomain = tostring(split(Account, @'\\')[0])",
    "detection": "dev-0270registryiocsep2022.yaml",
    "field": "accountntdomain",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventID, Computer,  TargetObject, Details",
    "detection": "registrypersistenceviaappcertdllmodification.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventID, Computer,  TargetObject, Details",
    "detection": "registrypersistenceviaappcertdllmodification.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventID, Computer,  TargetObject, Details",
    "detection": "registrypersistenceviaappcertdllmodification.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventID, Computer,  TargetObject, Details",
    "detection": "registrypersistenceviaappcertdllmodification.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventID, Computer,  TargetObject, Details",
    "detection": "registrypersistenceviaappcertdllmodification.yaml",
    "field": "targetobject",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventID, Computer,  TargetObject, Details",
    "detection": "registrypersistenceviaappcertdllmodification.yaml",
    "field": "details",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = iif(Computer has '.',substring(Computer,0,indexof(Computer,'.')),Computer) , DnsDomain = iif(Computer has '.',substring(Computer,indexof(Computer,'.')+1),'')",
    "detection": "registrypersistenceviaappcertdllmodification.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = iif(Computer has '.',substring(Computer,0,indexof(Computer,'.')),Computer) , DnsDomain = iif(Computer has '.',substring(Computer,indexof(Computer,'.')+1),'')",
    "detection": "registrypersistenceviaappcertdllmodification.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventData = parse_xml(EventData).EventData.Data",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "eventdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key = tostring(column_ifexists('@Name', \"\")), Value = column_ifexists('#text', \"\")",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "key",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key = tostring(column_ifexists('@Name', \"\")), Value = column_ifexists('#text', \"\")",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "value",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ObjectName = column_ifexists(\"ObjectName\", \"\"),",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "objectname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectUserName = column_ifexists(\"SubjectUserName\", \"\"),",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Process = split(ProcessName, '\\\\', -1)[-1],",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "objectname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "objecttype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend ObjectType = tostring(EventData.ObjectType)",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "objecttype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ObjectName = tostring(EventData.ObjectName)",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "objectname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ProcessName = tostring(EventData.ProcessName)",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Process = tostring(split(ProcessName, '\\\\')[-1])",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account =  strcat(tostring(EventData.SubjectDomainName),\"\\\\\", tostring(EventData.SubjectUserName))",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectUserName = tostring(EventData.SubjectUserName)",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectDomainName = tostring(EventData.SubjectDomainName)",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "objectname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "objecttype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Process = tostring(split(ProcessName, '\\\\', -1)[-1])",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "objectname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "objecttype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend ObjectType = tostring(EventData.ObjectType)",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "objecttype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ObjectName = tostring(EventData.ObjectName)",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "objectname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ProcessName = tostring(EventData.ProcessName)",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Process = tostring(split(ProcessName, '\\\\')[-1])",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account =  strcat(tostring(EventData.SubjectDomainName),\"\\\\\", tostring(EventData.SubjectUserName))",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectUserName = tostring(EventData.SubjectUserName)",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectDomainName = tostring(EventData.SubjectDomainName)",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "objectname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "objecttype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(Account, \"\\\\\")[1]), NTDomain = tostring(split(Account, \"\\\\\")[0])",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(Account, \"\\\\\")[1]), NTDomain = tostring(split(Account, \"\\\\\")[0])",
    "detection": "aadhealthmonagentregkeyaccess.yaml",
    "field": "ntdomain",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, Image, ProcessGuid, TargetFilename",
    "detection": "credentialdumpingtoolsfileartifacts.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, Image, ProcessGuid, TargetFilename",
    "detection": "credentialdumpingtoolsfileartifacts.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, Image, ProcessGuid, TargetFilename",
    "detection": "credentialdumpingtoolsfileartifacts.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, Image, ProcessGuid, TargetFilename",
    "detection": "credentialdumpingtoolsfileartifacts.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, Image, ProcessGuid, TargetFilename",
    "detection": "credentialdumpingtoolsfileartifacts.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, Image, ProcessGuid, TargetFilename",
    "detection": "credentialdumpingtoolsfileartifacts.yaml",
    "field": "processguid",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, Image, ProcessGuid, TargetFilename",
    "detection": "credentialdumpingtoolsfileartifacts.yaml",
    "field": "targetfilename",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = split(Computer, '.', 0)[0], DnsDomain = strcat_array(array_slice(split(Computer, '.'), 1, -1), '.')",
    "detection": "credentialdumpingtoolsfileartifacts.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = split(Computer, '.', 0)[0], DnsDomain = strcat_array(array_slice(split(Computer, '.'), 1, -1), '.')",
    "detection": "credentialdumpingtoolsfileartifacts.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectUserName, SubjectDomainName, SubjectAccount, SubjectUserSid, SubjectLogonId,",
    "detection": "fakecomputeraccountcreated.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectUserName, SubjectDomainName, SubjectAccount, SubjectUserSid, SubjectLogonId,",
    "detection": "fakecomputeraccountcreated.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectUserName, SubjectDomainName, SubjectAccount, SubjectUserSid, SubjectLogonId,",
    "detection": "fakecomputeraccountcreated.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectUserName, SubjectDomainName, SubjectAccount, SubjectUserSid, SubjectLogonId,",
    "detection": "fakecomputeraccountcreated.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectUserName, SubjectDomainName, SubjectAccount, SubjectUserSid, SubjectLogonId,",
    "detection": "fakecomputeraccountcreated.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectUserName, SubjectDomainName, SubjectAccount, SubjectUserSid, SubjectLogonId,",
    "detection": "fakecomputeraccountcreated.yaml",
    "field": "subjectaccount",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectUserName, SubjectDomainName, SubjectAccount, SubjectUserSid, SubjectLogonId,",
    "detection": "fakecomputeraccountcreated.yaml",
    "field": "subjectusersid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectUserName, SubjectDomainName, SubjectAccount, SubjectUserSid, SubjectLogonId,",
    "detection": "fakecomputeraccountcreated.yaml",
    "field": "subjectlogonid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "fakecomputeraccountcreated.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "fakecomputeraccountcreated.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "fakecomputeraccountcreated.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend FileName=tostring(split(NewProcessName, @'\\')[(-1)]),  ProcessCommandLine = CommandLine, InitiatingProcessFileName=ParentProcessName",
    "detection": "dev-0270powershellsep2022.yaml",
    "field": "filename",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend FileName=tostring(split(NewProcessName, @'\\')[(-1)]),  ProcessCommandLine = CommandLine, InitiatingProcessFileName=ParentProcessName",
    "detection": "dev-0270powershellsep2022.yaml",
    "field": "processcommandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend FileName=tostring(split(NewProcessName, @'\\')[(-1)]),  ProcessCommandLine = CommandLine, InitiatingProcessFileName=ParentProcessName",
    "detection": "dev-0270powershellsep2022.yaml",
    "field": "initiatingprocessfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, InitiatingProcessFileName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270powershellsep2022.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, InitiatingProcessFileName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270powershellsep2022.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, InitiatingProcessFileName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270powershellsep2022.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, InitiatingProcessFileName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270powershellsep2022.yaml",
    "field": "accountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, InitiatingProcessFileName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270powershellsep2022.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, InitiatingProcessFileName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270powershellsep2022.yaml",
    "field": "processnamefullpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, InitiatingProcessFileName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270powershellsep2022.yaml",
    "field": "initiatingprocessfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, InitiatingProcessFileName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270powershellsep2022.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, InitiatingProcessFileName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270powershellsep2022.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, InitiatingProcessFileName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270powershellsep2022.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, InitiatingProcessFileName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270powershellsep2022.yaml",
    "field": "eventsourcename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, InitiatingProcessFileName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270powershellsep2022.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = strcat(InitiatingProcessAccountDomain, @'\\', InitiatingProcessAccountName),  Computer = DeviceName",
    "detection": "dev-0270powershellsep2022.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = strcat(InitiatingProcessAccountDomain, @'\\', InitiatingProcessAccountName),  Computer = DeviceName",
    "detection": "dev-0270powershellsep2022.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "dev-0270powershellsep2022.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "dev-0270powershellsep2022.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "dev-0270powershellsep2022.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Account, @'\\')[1]), AccountNTDomain = tostring(split(Account, @'\\')[0])",
    "detection": "dev-0270powershellsep2022.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Account, @'\\')[1]), AccountNTDomain = tostring(split(Account, @'\\')[0])",
    "detection": "dev-0270powershellsep2022.yaml",
    "field": "accountntdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend EventData = parse_xml(EventData).EventData.Data",
    "detection": "adfsremoteauthsyncconnection.yaml",
    "field": "eventdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend InstanceId = tostring(EventData[0])",
    "detection": "adfsremoteauthsyncconnection.yaml",
    "field": "instanceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend EventData = parse_xml(EventData).EventData.Data",
    "detection": "adfsremoteauthsyncconnection.yaml",
    "field": "eventdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend InstanceId = tostring(EventData[0])",
    "detection": "adfsremoteauthsyncconnection.yaml",
    "field": "instanceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend ClaimsName = tostring(EventData[2])",
    "detection": "adfsremoteauthsyncconnection.yaml",
    "field": "claimsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend EventData = parse_xml(EventData).EventData.Data",
    "detection": "adfsremoteauthsyncconnection.yaml",
    "field": "eventdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend Key = tostring(column_ifexists('@Name', \"\")), Value = column_ifexists('#text', \"\")",
    "detection": "adfsremoteauthsyncconnection.yaml",
    "field": "key",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend Key = tostring(column_ifexists('@Name', \"\")), Value = column_ifexists('#text', \"\")",
    "detection": "adfsremoteauthsyncconnection.yaml",
    "field": "value",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend DestPort = column_ifexists(\"DestPort\", \"\"),",
    "detection": "adfsremoteauthsyncconnection.yaml",
    "field": "destport",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, ClaimsName, SourceAddress, SourcePort",
    "detection": "adfsremoteauthsyncconnection.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, ClaimsName, SourceAddress, SourcePort",
    "detection": "adfsremoteauthsyncconnection.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, ClaimsName, SourceAddress, SourcePort",
    "detection": "adfsremoteauthsyncconnection.yaml",
    "field": "claimsname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, ClaimsName, SourceAddress, SourcePort",
    "detection": "adfsremoteauthsyncconnection.yaml",
    "field": "sourceaddress",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, ClaimsName, SourceAddress, SourcePort",
    "detection": "adfsremoteauthsyncconnection.yaml",
    "field": "sourceport",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "adfsremoteauthsyncconnection.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "adfsremoteauthsyncconnection.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "adfsremoteauthsyncconnection.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(ClaimsName, @'\\')[1]), AccountNTDomain = tostring(split(ClaimsName, @'\\')[0])",
    "detection": "adfsremoteauthsyncconnection.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(ClaimsName, @'\\')[1]), AccountNTDomain = tostring(split(ClaimsName, @'\\')[0])",
    "detection": "adfsremoteauthsyncconnection.yaml",
    "field": "accountntdomain",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessId, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "accessibilityfeaturesmodification.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessId, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "accessibilityfeaturesmodification.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessId, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "accessibilityfeaturesmodification.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessId, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "accessibilityfeaturesmodification.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessId, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "accessibilityfeaturesmodification.yaml",
    "field": "user",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessId, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "accessibilityfeaturesmodification.yaml",
    "field": "parentimage",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessId, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "accessibilityfeaturesmodification.yaml",
    "field": "parentprocessguid",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessId, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "accessibilityfeaturesmodification.yaml",
    "field": "parentcommandline",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessId, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "accessibilityfeaturesmodification.yaml",
    "field": "parentuser",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessId, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "accessibilityfeaturesmodification.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessId, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "accessibilityfeaturesmodification.yaml",
    "field": "processid",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessId, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "accessibilityfeaturesmodification.yaml",
    "field": "processguid",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessId, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "accessibilityfeaturesmodification.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessId, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "accessibilityfeaturesmodification.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessId, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "accessibilityfeaturesmodification.yaml",
    "field": "originalfilename",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessId, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "accessibilityfeaturesmodification.yaml",
    "field": "currentdirectory",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessId, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "accessibilityfeaturesmodification.yaml",
    "field": "hashes",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "accessibilityfeaturesmodification.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "accessibilityfeaturesmodification.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "accessibilityfeaturesmodification.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(User, \"\\\\\")[1]), AccountNTDomain = tostring(split(User, \"\\\\\")[0])",
    "detection": "accessibilityfeaturesmodification.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(User, \"\\\\\")[1]), AccountNTDomain = tostring(split(User, \"\\\\\")[0])",
    "detection": "accessibilityfeaturesmodification.yaml",
    "field": "accountntdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend ImageFileName = tostring(split(Image, \"\\\\\")[-1])",
    "detection": "accessibilityfeaturesmodification.yaml",
    "field": "imagefilename",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend ImageDirectory = replace_string(Image, ImageFileName, \"\")",
    "detection": "accessibilityfeaturesmodification.yaml",
    "field": "imagedirectory",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": " | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description",
    "detection": "macroinvokingshellbrowserwindowcomobjects.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": " | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description",
    "detection": "macroinvokingshellbrowserwindowcomobjects.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": " | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description",
    "detection": "macroinvokingshellbrowserwindowcomobjects.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": " | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description",
    "detection": "macroinvokingshellbrowserwindowcomobjects.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": " | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description",
    "detection": "macroinvokingshellbrowserwindowcomobjects.yaml",
    "field": "user",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": " | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description",
    "detection": "macroinvokingshellbrowserwindowcomobjects.yaml",
    "field": "parentimage",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": " | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description",
    "detection": "macroinvokingshellbrowserwindowcomobjects.yaml",
    "field": "parentprocessguid",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": " | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description",
    "detection": "macroinvokingshellbrowserwindowcomobjects.yaml",
    "field": "parentcommandline",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": " | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description",
    "detection": "macroinvokingshellbrowserwindowcomobjects.yaml",
    "field": "parentuser",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": " | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description",
    "detection": "macroinvokingshellbrowserwindowcomobjects.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": " | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description",
    "detection": "macroinvokingshellbrowserwindowcomobjects.yaml",
    "field": "processguid",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": " | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description",
    "detection": "macroinvokingshellbrowserwindowcomobjects.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": " | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description",
    "detection": "macroinvokingshellbrowserwindowcomobjects.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": " | extend HostName = iif(Computer has '.',substring(Computer,0,indexof(Computer,'.')),Computer) , DnsDomain = iif(Computer has '.',substring(Computer,indexof(Computer,'.')+1),'')",
    "detection": "macroinvokingshellbrowserwindowcomobjects.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": " | extend HostName = iif(Computer has '.',substring(Computer,0,indexof(Computer,'.')),Computer) , DnsDomain = iif(Computer has '.',substring(Computer,indexof(Computer,'.')+1),'')",
    "detection": "macroinvokingshellbrowserwindowcomobjects.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectAccount, SubjectUserName, SubjectDomainName, SubjectUserSid, SubjectLogonId, ObjectDN, AttributeLDAPDisplayName",
    "detection": "potenialresourcebasedconstraineddelegationabuse.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectAccount, SubjectUserName, SubjectDomainName, SubjectUserSid, SubjectLogonId, ObjectDN, AttributeLDAPDisplayName",
    "detection": "potenialresourcebasedconstraineddelegationabuse.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectAccount, SubjectUserName, SubjectDomainName, SubjectUserSid, SubjectLogonId, ObjectDN, AttributeLDAPDisplayName",
    "detection": "potenialresourcebasedconstraineddelegationabuse.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectAccount, SubjectUserName, SubjectDomainName, SubjectUserSid, SubjectLogonId, ObjectDN, AttributeLDAPDisplayName",
    "detection": "potenialresourcebasedconstraineddelegationabuse.yaml",
    "field": "subjectaccount",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectAccount, SubjectUserName, SubjectDomainName, SubjectUserSid, SubjectLogonId, ObjectDN, AttributeLDAPDisplayName",
    "detection": "potenialresourcebasedconstraineddelegationabuse.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectAccount, SubjectUserName, SubjectDomainName, SubjectUserSid, SubjectLogonId, ObjectDN, AttributeLDAPDisplayName",
    "detection": "potenialresourcebasedconstraineddelegationabuse.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectAccount, SubjectUserName, SubjectDomainName, SubjectUserSid, SubjectLogonId, ObjectDN, AttributeLDAPDisplayName",
    "detection": "potenialresourcebasedconstraineddelegationabuse.yaml",
    "field": "subjectusersid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectAccount, SubjectUserName, SubjectDomainName, SubjectUserSid, SubjectLogonId, ObjectDN, AttributeLDAPDisplayName",
    "detection": "potenialresourcebasedconstraineddelegationabuse.yaml",
    "field": "subjectlogonid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectAccount, SubjectUserName, SubjectDomainName, SubjectUserSid, SubjectLogonId, ObjectDN, AttributeLDAPDisplayName",
    "detection": "potenialresourcebasedconstraineddelegationabuse.yaml",
    "field": "objectdn",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectAccount, SubjectUserName, SubjectDomainName, SubjectUserSid, SubjectLogonId, ObjectDN, AttributeLDAPDisplayName",
    "detection": "potenialresourcebasedconstraineddelegationabuse.yaml",
    "field": "attributeldapdisplayname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "potenialresourcebasedconstraineddelegationabuse.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "potenialresourcebasedconstraineddelegationabuse.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "potenialresourcebasedconstraineddelegationabuse.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by ParentProcessName,Process, Account, Computer, CommandLine, timekey= bin(TimeGenerated, time_window), TimeGenerated, SubjectLogonId",
    "detection": "potentialmercury-webshell.yaml",
    "field": "timekey",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by ParentProcessName, Account, Computer, ObjectName, ProcessName, timekey= bin(TimeGenerated, time_window), TimeGenerated, SubjectLogonId)",
    "detection": "potentialmercury-webshell.yaml",
    "field": "timekey",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = strcat(InitiatingProcessAccountDomain, @'\\', InitiatingProcessAccountName), Computer = DeviceName",
    "detection": "potentialmercury-webshell.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = strcat(InitiatingProcessAccountDomain, @'\\', InitiatingProcessAccountName), Computer = DeviceName",
    "detection": "potentialmercury-webshell.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname",
    "detection": "potentialmercury-webshell.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname",
    "detection": "potentialmercury-webshell.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Account, @'\\')[1]), AccountNTDomain = tostring(split(Account, @'\\')[0])",
    "detection": "potentialmercury-webshell.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Account, @'\\')[1]), AccountNTDomain = tostring(split(Account, @'\\')[0])",
    "detection": "potentialmercury-webshell.yaml",
    "field": "accountntdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "potentialmercury-webshell.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "potentialmercury-webshell.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "potentialmercury-webshell.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend NewProcessName = tostring(EventData.NewProcessName)",
    "detection": "chiacryptomining-windowsevent.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend ParentProcessName = tostring(EventData.ParentProcessName)",
    "detection": "chiacryptomining-windowsevent.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Computer, Account, File = tostring(split(NewProcessName, '\\\\', -1)[-1]), AlertDetail = 'Chia crypto IOC detected'",
    "detection": "chiacryptomining-windowsevent.yaml",
    "field": "file",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Computer, Account, File = tostring(split(NewProcessName, '\\\\', -1)[-1]), AlertDetail = 'Chia crypto IOC detected'",
    "detection": "chiacryptomining-windowsevent.yaml",
    "field": "alertdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend FilePath = replace_string(NewProcessName, File, '')",
    "detection": "chiacryptomining-windowsevent.yaml",
    "field": "filepath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, File, AlertDetail, FilePath,Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type",
    "detection": "chiacryptomining-windowsevent.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, File, AlertDetail, FilePath,Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type",
    "detection": "chiacryptomining-windowsevent.yaml",
    "field": "file",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, File, AlertDetail, FilePath,Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type",
    "detection": "chiacryptomining-windowsevent.yaml",
    "field": "alertdetail",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, File, AlertDetail, FilePath,Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type",
    "detection": "chiacryptomining-windowsevent.yaml",
    "field": "filepath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, File, AlertDetail, FilePath,Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type",
    "detection": "chiacryptomining-windowsevent.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, File, AlertDetail, FilePath,Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type",
    "detection": "chiacryptomining-windowsevent.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, File, AlertDetail, FilePath,Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type",
    "detection": "chiacryptomining-windowsevent.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, File, AlertDetail, FilePath,Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type",
    "detection": "chiacryptomining-windowsevent.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, File, AlertDetail, FilePath,Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type",
    "detection": "chiacryptomining-windowsevent.yaml",
    "field": "newprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, File, AlertDetail, FilePath,Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type",
    "detection": "chiacryptomining-windowsevent.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Account, @'\\')[1]), AccountNTDomain = tostring(split(Account, @'\\')[0])",
    "detection": "chiacryptomining-windowsevent.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Account, @'\\')[1]), AccountNTDomain = tostring(split(Account, @'\\')[0])",
    "detection": "chiacryptomining-windowsevent.yaml",
    "field": "accountntdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "chiacryptomining-windowsevent.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "chiacryptomining-windowsevent.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "chiacryptomining-windowsevent.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "   | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, TargetUserName, TargetLogonId, LogonType, IpAddress",
    "detection": "potentialremotedesktoptunneling.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "   | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, TargetUserName, TargetLogonId, LogonType, IpAddress",
    "detection": "potentialremotedesktoptunneling.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "   | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, TargetUserName, TargetLogonId, LogonType, IpAddress",
    "detection": "potentialremotedesktoptunneling.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "   | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, TargetUserName, TargetLogonId, LogonType, IpAddress",
    "detection": "potentialremotedesktoptunneling.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "   | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, TargetUserName, TargetLogonId, LogonType, IpAddress",
    "detection": "potentialremotedesktoptunneling.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "   | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, TargetUserName, TargetLogonId, LogonType, IpAddress",
    "detection": "potentialremotedesktoptunneling.yaml",
    "field": "targetlogonid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "   | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, TargetUserName, TargetLogonId, LogonType, IpAddress",
    "detection": "potentialremotedesktoptunneling.yaml",
    "field": "logontype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "   | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, TargetUserName, TargetLogonId, LogonType, IpAddress",
    "detection": "potentialremotedesktoptunneling.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "   | extend Name=tostring(split(TargetUserName, \"@\")[0]), UPNSuffix=tostring(split(TargetUserName, \"@\")[1])",
    "detection": "potentialremotedesktoptunneling.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "   | extend Name=tostring(split(TargetUserName, \"@\")[0]), UPNSuffix=tostring(split(TargetUserName, \"@\")[1])",
    "detection": "potentialremotedesktoptunneling.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "   | extend HostName = iif(Computer has '.',substring(Computer,0,indexof(Computer,'.')),Computer) , DnsDomain = iif(Computer has '.',substring(Computer,indexof(Computer,'.')+1),'')",
    "detection": "potentialremotedesktoptunneling.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "   | extend HostName = iif(Computer has '.',substring(Computer,0,indexof(Computer,'.')),Computer) , DnsDomain = iif(Computer has '.',substring(Computer,indexof(Computer,'.')+1),'')",
    "detection": "potentialremotedesktoptunneling.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventData=parse_xml(EventData)",
    "detection": "certifiedpreowned-backup-key-1.yaml",
    "field": "eventdata",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project KeyName=tostring(d[\"#text\"])",
    "detection": "certifiedpreowned-backup-key-1.yaml",
    "field": "keyname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project SubjectUserName=tostring(d[\"#text\"])",
    "detection": "certifiedpreowned-backup-key-1.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project Operation=tostring(d[\"#text\"])",
    "detection": "certifiedpreowned-backup-key-1.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Operation=iff(Operation == \"%%2458\", \"Read persisted key from file\", Operation)",
    "detection": "certifiedpreowned-backup-key-1.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Operation=iff(Operation == \"%%2459\", \"Write persisted key to file\", Operation)",
    "detection": "certifiedpreowned-backup-key-1.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ProcessId, Image, TargetObject, Details, _ResourceId",
    "detection": "dsrmaccountabuse.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ProcessId, Image, TargetObject, Details, _ResourceId",
    "detection": "dsrmaccountabuse.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ProcessId, Image, TargetObject, Details, _ResourceId",
    "detection": "dsrmaccountabuse.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ProcessId, Image, TargetObject, Details, _ResourceId",
    "detection": "dsrmaccountabuse.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ProcessId, Image, TargetObject, Details, _ResourceId",
    "detection": "dsrmaccountabuse.yaml",
    "field": "user",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ProcessId, Image, TargetObject, Details, _ResourceId",
    "detection": "dsrmaccountabuse.yaml",
    "field": "processid",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ProcessId, Image, TargetObject, Details, _ResourceId",
    "detection": "dsrmaccountabuse.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ProcessId, Image, TargetObject, Details, _ResourceId",
    "detection": "dsrmaccountabuse.yaml",
    "field": "targetobject",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ProcessId, Image, TargetObject, Details, _ResourceId",
    "detection": "dsrmaccountabuse.yaml",
    "field": "details",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ProcessId, Image, TargetObject, Details, _ResourceId",
    "detection": "dsrmaccountabuse.yaml",
    "field": "_resourceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "dsrmaccountabuse.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "dsrmaccountabuse.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "dsrmaccountabuse.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(User, \"\\\\\")[1]), AccountNTDomain = tostring(split(User, \"\\\\\")[0])",
    "detection": "dsrmaccountabuse.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(User, \"\\\\\")[1]), AccountNTDomain = tostring(split(User, \"\\\\\")[0])",
    "detection": "dsrmaccountabuse.yaml",
    "field": "accountntdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend ImageFileName = tostring(split(Image, \"\\\\\")[-1])",
    "detection": "dsrmaccountabuse.yaml",
    "field": "imagefilename",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend ImageDirectory = replace_string(Image, ImageFileName, \"\")",
    "detection": "dsrmaccountabuse.yaml",
    "field": "imagedirectory",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventData = parse_xml(EventData).DataItem.EventData.Data",
    "detection": "adfsremotehttpnetworkconnection.yaml",
    "field": "eventdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key = tostring(column_ifexists('@Name', \"\")), Value = column_ifexists('#text', \"\")",
    "detection": "adfsremotehttpnetworkconnection.yaml",
    "field": "key",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key = tostring(column_ifexists('@Name', \"\")), Value = column_ifexists('#text', \"\")",
    "detection": "adfsremotehttpnetworkconnection.yaml",
    "field": "value",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Image = column_ifexists(\"Image\", \"\")",
    "detection": "adfsremotehttpnetworkconnection.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend process = split(Image, '\\\\', -1)[-1]",
    "detection": "adfsremotehttpnetworkconnection.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend RenderedDescription = tostring(split(RenderedDescription, \":\")[0])",
    "detection": "adfsremotehttpnetworkconnection.yaml",
    "field": "rendereddescription",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventData = parse_xml(EventData).DataItem.EventData.Data",
    "detection": "adfsremotehttpnetworkconnection.yaml",
    "field": "eventdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key = tostring(column_ifexists('@Name', \"\")), Value = column_ifexists('#text', \"\")",
    "detection": "adfsremotehttpnetworkconnection.yaml",
    "field": "key",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key = tostring(column_ifexists('@Name', \"\")), Value = column_ifexists('#text', \"\")",
    "detection": "adfsremotehttpnetworkconnection.yaml",
    "field": "value",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend RuleName = column_ifexists(\"RuleName\", \"\"), TechniqueId = column_ifexists(\"TechniqueId\", \"\"),  TechniqueName = column_ifexists(\"TechniqueName\", \"\")",
    "detection": "adfsremotehttpnetworkconnection.yaml",
    "field": "rulename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend RuleName = column_ifexists(\"RuleName\", \"\"), TechniqueId = column_ifexists(\"TechniqueId\", \"\"),  TechniqueName = column_ifexists(\"TechniqueName\", \"\")",
    "detection": "adfsremotehttpnetworkconnection.yaml",
    "field": "techniqueid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend RuleName = column_ifexists(\"RuleName\", \"\"), TechniqueId = column_ifexists(\"TechniqueId\", \"\"),  TechniqueName = column_ifexists(\"TechniqueName\", \"\")",
    "detection": "adfsremotehttpnetworkconnection.yaml",
    "field": "techniquename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationPort = column_ifexists(\"DestinationPort\", \"\"), Image = column_ifexists(\"Image\", \"\"), Initiated = column_ifexists(\"Initiated\", \"\"), SourceIp = column_ifexists(\"DestinationIp\", \"\"), DestinationIp = column_ifexists(\"DestinationIp\", \"\")",
    "detection": "adfsremotehttpnetworkconnection.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationPort = column_ifexists(\"DestinationPort\", \"\"), Image = column_ifexists(\"Image\", \"\"), Initiated = column_ifexists(\"Initiated\", \"\"), SourceIp = column_ifexists(\"DestinationIp\", \"\"), DestinationIp = column_ifexists(\"DestinationIp\", \"\")",
    "detection": "adfsremotehttpnetworkconnection.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationPort = column_ifexists(\"DestinationPort\", \"\"), Image = column_ifexists(\"Image\", \"\"), Initiated = column_ifexists(\"Initiated\", \"\"), SourceIp = column_ifexists(\"DestinationIp\", \"\"), DestinationIp = column_ifexists(\"DestinationIp\", \"\")",
    "detection": "adfsremotehttpnetworkconnection.yaml",
    "field": "initiated",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationPort = column_ifexists(\"DestinationPort\", \"\"), Image = column_ifexists(\"Image\", \"\"), Initiated = column_ifexists(\"Initiated\", \"\"), SourceIp = column_ifexists(\"DestinationIp\", \"\"), DestinationIp = column_ifexists(\"DestinationIp\", \"\")",
    "detection": "adfsremotehttpnetworkconnection.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationPort = column_ifexists(\"DestinationPort\", \"\"), Image = column_ifexists(\"Image\", \"\"), Initiated = column_ifexists(\"Initiated\", \"\"), SourceIp = column_ifexists(\"DestinationIp\", \"\"), DestinationIp = column_ifexists(\"DestinationIp\", \"\")",
    "detection": "adfsremotehttpnetworkconnection.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend process = split(Image, '\\\\', -1)[-1]",
    "detection": "adfsremotehttpnetworkconnection.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Operation = RenderedDescription",
    "detection": "adfsremotehttpnetworkconnection.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "adfsremotehttpnetworkconnection.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "adfsremotehttpnetworkconnection.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "adfsremotehttpnetworkconnection.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(UserName, @'\\')[1]), AccountNTDomain = tostring(split(UserName, @'\\')[0])",
    "detection": "adfsremotehttpnetworkconnection.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(UserName, @'\\')[1]), AccountNTDomain = tostring(split(UserName, @'\\')[0])",
    "detection": "adfsremotehttpnetworkconnection.yaml",
    "field": "accountntdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend OIDs = extract_all(@\"<Data>([\\d+\\.]+)</Data>\", EventData)",
    "detection": "adfsabnormalenhancedkeyusageattribute-oid.yaml",
    "field": "oids",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend OID = tostring(OIDs)",
    "detection": "adfsabnormalenhancedkeyusageattribute-oid.yaml",
    "field": "oid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend OID_Length = strlen(OID)",
    "detection": "adfsabnormalenhancedkeyusageattribute-oid.yaml",
    "field": "oid_length",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, EventSourceName, EventID, OID, OID_Length, EventData",
    "detection": "adfsabnormalenhancedkeyusageattribute-oid.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, EventSourceName, EventID, OID, OID_Length, EventData",
    "detection": "adfsabnormalenhancedkeyusageattribute-oid.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, EventSourceName, EventID, OID, OID_Length, EventData",
    "detection": "adfsabnormalenhancedkeyusageattribute-oid.yaml",
    "field": "eventsourcename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, EventSourceName, EventID, OID, OID_Length, EventData",
    "detection": "adfsabnormalenhancedkeyusageattribute-oid.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, EventSourceName, EventID, OID, OID_Length, EventData",
    "detection": "adfsabnormalenhancedkeyusageattribute-oid.yaml",
    "field": "oid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, EventSourceName, EventID, OID, OID_Length, EventData",
    "detection": "adfsabnormalenhancedkeyusageattribute-oid.yaml",
    "field": "oid_length",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, EventSourceName, EventID, OID, OID_Length, EventData",
    "detection": "adfsabnormalenhancedkeyusageattribute-oid.yaml",
    "field": "eventdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "adfsabnormalenhancedkeyusageattribute-oid.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "adfsabnormalenhancedkeyusageattribute-oid.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "adfsabnormalenhancedkeyusageattribute-oid.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventData = parse_xml(EventData).EventData.Data",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "eventdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key = tostring(column_ifexists('@Name', \"\")), Value = column_ifexists('#text', \"\")",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "key",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key = tostring(column_ifexists('@Name', \"\")), Value = column_ifexists('#text', \"\")",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "value",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ObjectName = column_ifexists(\"ObjectName\", \"\"),",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "objectname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectUserName = column_ifexists(\"SubjectUserName\", \"\"),",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Process = split(ProcessName, '\\\\', -1)[-1],",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "objectname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "objecttype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend ObjectType = tostring(EventData.ObjectType)",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "objecttype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ObjectName = tostring(EventData.ObjectName)",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "objectname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ProcessName = tostring(EventData.ProcessName)",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Process = tostring(split(ProcessName, '\\\\')[-1])",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account =  strcat(tostring(EventData.SubjectDomainName),\"\\\\\", tostring(EventData.SubjectUserName))",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectUserName = tostring(EventData.SubjectUserName)",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectDomainName = tostring(EventData.SubjectDomainName)",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "objectname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "objecttype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Process = tostring(split(ProcessName, '\\\\', -1)[-1])",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "objectname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "objecttype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend ObjectType = tostring(EventData.ObjectType)",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "objecttype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ObjectName = tostring(EventData.ObjectName)",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "objectname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ProcessName = tostring(EventData.ProcessName)",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Process = tostring(split(ProcessName, '\\\\')[-1])",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account =  strcat(tostring(EventData.SubjectDomainName),\"\\\\\", tostring(EventData.SubjectUserName))",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectUserName = tostring(EventData.SubjectUserName)",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectDomainName = tostring(EventData.SubjectDomainName)",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "objectname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "objecttype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = max(TimeGenerated), EndTime = min(TimeGenerated), count() by EventID, Account, Computer, Process, SubjectUserName, SubjectDomainName, ObjectName, ObjectType, ProcessName",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(Account, \"\\\\\")[1]), NTDomain = tostring(split(Account, \"\\\\\")[0])",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(Account, \"\\\\\")[1]), NTDomain = tostring(split(Account, \"\\\\\")[0])",
    "detection": "aadhealthsvcagentregkeyaccess.yaml",
    "field": "ntdomain",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventID, Computer, TargetObject, Details",
    "detection": "registrypersistenceviaappint-dllsmodification.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventID, Computer, TargetObject, Details",
    "detection": "registrypersistenceviaappint-dllsmodification.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventID, Computer, TargetObject, Details",
    "detection": "registrypersistenceviaappint-dllsmodification.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventID, Computer, TargetObject, Details",
    "detection": "registrypersistenceviaappint-dllsmodification.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventID, Computer, TargetObject, Details",
    "detection": "registrypersistenceviaappint-dllsmodification.yaml",
    "field": "targetobject",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventID, Computer, TargetObject, Details",
    "detection": "registrypersistenceviaappint-dllsmodification.yaml",
    "field": "details",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = iif(Computer has '.',substring(Computer,0,indexof(Computer,'.')),Computer) , DnsDomain = iif(Computer has '.',substring(Computer,indexof(Computer,'.')+1),'')",
    "detection": "registrypersistenceviaappint-dllsmodification.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = iif(Computer has '.',substring(Computer,0,indexof(Computer,'.')),Computer) , DnsDomain = iif(Computer has '.',substring(Computer,indexof(Computer,'.')+1),'')",
    "detection": "registrypersistenceviaappint-dllsmodification.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend password = extract(@\"\\buser\\s+[^\\s]+\\s+([^\\s]+)\", 1, CommandLine)",
    "detection": "dev-0270newusersep2022.yaml",
    "field": "password",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270newusersep2022.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270newusersep2022.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270newusersep2022.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270newusersep2022.yaml",
    "field": "accountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270newusersep2022.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270newusersep2022.yaml",
    "field": "processnamefullpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270newusersep2022.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270newusersep2022.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270newusersep2022.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270newusersep2022.yaml",
    "field": "eventsourcename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270newusersep2022.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend password = extract(@\"\\buser\\s+[^\\s]+\\s+([^\\s]+)\", 1, InitiatingProcessCommandLine)",
    "detection": "dev-0270newusersep2022.yaml",
    "field": "password",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = strcat(InitiatingProcessAccountDomain, @'\\', InitiatingProcessAccountName), Computer = DeviceName",
    "detection": "dev-0270newusersep2022.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = strcat(InitiatingProcessAccountDomain, @'\\', InitiatingProcessAccountName), Computer = DeviceName",
    "detection": "dev-0270newusersep2022.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "dev-0270newusersep2022.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "dev-0270newusersep2022.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "dev-0270newusersep2022.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Account, @'\\')[1]), AccountNTDomain = tostring(split(Account, @'\\')[0])",
    "detection": "dev-0270newusersep2022.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Account, @'\\')[1]), AccountNTDomain = tostring(split(Account, @'\\')[0])",
    "detection": "dev-0270newusersep2022.yaml",
    "field": "accountntdomain",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize TimeGenerated=arg_min(TimeGenerated, *) by TargetUserName, Computer",
    "detection": "eatonunautorizedlogins.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize TimeGenerated=arg_min(TimeGenerated, *) by TargetUserName, Computer",
    "detection": "eatonunautorizedlogins.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize TimeGenerated=arg_min(TimeGenerated, *) by TargetUserName, Computer",
    "detection": "eatonunautorizedlogins.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, SubjectUserName, NewProcessName, Process, CommandLine",
    "detection": "windowsbinariesexecutedfromnon-defaultdirectory.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, SubjectUserName, NewProcessName, Process, CommandLine",
    "detection": "windowsbinariesexecutedfromnon-defaultdirectory.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, SubjectUserName, NewProcessName, Process, CommandLine",
    "detection": "windowsbinariesexecutedfromnon-defaultdirectory.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, SubjectUserName, NewProcessName, Process, CommandLine",
    "detection": "windowsbinariesexecutedfromnon-defaultdirectory.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, SubjectUserName, NewProcessName, Process, CommandLine",
    "detection": "windowsbinariesexecutedfromnon-defaultdirectory.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, SubjectUserName, NewProcessName, Process, CommandLine",
    "detection": "windowsbinariesexecutedfromnon-defaultdirectory.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, SubjectUserName, NewProcessName, Process, CommandLine",
    "detection": "windowsbinariesexecutedfromnon-defaultdirectory.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, SubjectUserName, NewProcessName, Process, CommandLine",
    "detection": "windowsbinariesexecutedfromnon-defaultdirectory.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name=tostring(split(SubjectUserName, \"@\")[0]), UPNSuffix=tostring(split(SubjectUserName, \"@\")[1])",
    "detection": "windowsbinariesexecutedfromnon-defaultdirectory.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name=tostring(split(SubjectUserName, \"@\")[0]), UPNSuffix=tostring(split(SubjectUserName, \"@\")[1])",
    "detection": "windowsbinariesexecutedfromnon-defaultdirectory.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = iif(Computer has '.',substring(Computer,0,indexof(Computer,'.')),Computer) , DnsDomain = iif(Computer has '.',substring(Computer,indexof(Computer,'.')+1),'')",
    "detection": "windowsbinariesexecutedfromnon-defaultdirectory.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = iif(Computer has '.',substring(Computer,0,indexof(Computer,'.')),Computer) , DnsDomain = iif(Computer has '.',substring(Computer,indexof(Computer,'.')+1),'')",
    "detection": "windowsbinariesexecutedfromnon-defaultdirectory.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, SourceProcessGUID, SourceImage, GrantedAccess, TargetImage, CallTrace",
    "detection": "dumpinglsassprocessintoafile.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, SourceProcessGUID, SourceImage, GrantedAccess, TargetImage, CallTrace",
    "detection": "dumpinglsassprocessintoafile.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, SourceProcessGUID, SourceImage, GrantedAccess, TargetImage, CallTrace",
    "detection": "dumpinglsassprocessintoafile.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, SourceProcessGUID, SourceImage, GrantedAccess, TargetImage, CallTrace",
    "detection": "dumpinglsassprocessintoafile.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, SourceProcessGUID, SourceImage, GrantedAccess, TargetImage, CallTrace",
    "detection": "dumpinglsassprocessintoafile.yaml",
    "field": "sourceprocessguid",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, SourceProcessGUID, SourceImage, GrantedAccess, TargetImage, CallTrace",
    "detection": "dumpinglsassprocessintoafile.yaml",
    "field": "sourceimage",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, SourceProcessGUID, SourceImage, GrantedAccess, TargetImage, CallTrace",
    "detection": "dumpinglsassprocessintoafile.yaml",
    "field": "grantedaccess",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, SourceProcessGUID, SourceImage, GrantedAccess, TargetImage, CallTrace",
    "detection": "dumpinglsassprocessintoafile.yaml",
    "field": "targetimage",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, SourceProcessGUID, SourceImage, GrantedAccess, TargetImage, CallTrace",
    "detection": "dumpinglsassprocessintoafile.yaml",
    "field": "calltrace",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = iif(Computer has '.',substring(Computer,0,indexof(Computer,'.')),Computer) , DnsDomain = iif(Computer has '.',substring(Computer,indexof(Computer,'.')+1),'')",
    "detection": "dumpinglsassprocessintoafile.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = iif(Computer has '.',substring(Computer,0,indexof(Computer,'.')),Computer) , DnsDomain = iif(Computer has '.',substring(Computer,indexof(Computer,'.')+1),'')",
    "detection": "dumpinglsassprocessintoafile.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventData=parse_xml(EventData)",
    "detection": "certifiedpreowned-backup-key-2.yaml",
    "field": "eventdata",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project KeyName=tostring(d[\"#text\"])",
    "detection": "certifiedpreowned-backup-key-2.yaml",
    "field": "keyname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project SubjectUserName=tostring(d[\"#text\"])",
    "detection": "certifiedpreowned-backup-key-2.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, ServiceName, ImagePath, AccountName",
    "detection": "credentialdumpingserviceinstallation.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, ServiceName, ImagePath, AccountName",
    "detection": "credentialdumpingserviceinstallation.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, ServiceName, ImagePath, AccountName",
    "detection": "credentialdumpingserviceinstallation.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, ServiceName, ImagePath, AccountName",
    "detection": "credentialdumpingserviceinstallation.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, ServiceName, ImagePath, AccountName",
    "detection": "credentialdumpingserviceinstallation.yaml",
    "field": "servicename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, ServiceName, ImagePath, AccountName",
    "detection": "credentialdumpingserviceinstallation.yaml",
    "field": "imagepath",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, ServiceName, ImagePath, AccountName",
    "detection": "credentialdumpingserviceinstallation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = split(Computer, '.', 0)[0], DnsDomain = strcat_array(array_slice(split(Computer, '.'), 1, -1), '.')",
    "detection": "credentialdumpingserviceinstallation.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = split(Computer, '.', 0)[0], DnsDomain = strcat_array(array_slice(split(Computer, '.'), 1, -1), '.')",
    "detection": "credentialdumpingserviceinstallation.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, ProcessCustomEntity = Process",
    "detection": "powershell-mercury.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, ProcessCustomEntity = Process",
    "detection": "powershell-mercury.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, ProcessCustomEntity = Process",
    "detection": "powershell-mercury.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, ProcessCustomEntity = Process",
    "detection": "powershell-mercury.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = AccountName, HostCustomEntity = DeviceName, ProcessCustomEntity = InitiatingProcessFileName",
    "detection": "powershell-mercury.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = AccountName, HostCustomEntity = DeviceName, ProcessCustomEntity = InitiatingProcessFileName",
    "detection": "powershell-mercury.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = AccountName, HostCustomEntity = DeviceName, ProcessCustomEntity = InitiatingProcessFileName",
    "detection": "powershell-mercury.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = AccountName, HostCustomEntity = DeviceName, ProcessCustomEntity = InitiatingProcessFileName",
    "detection": "powershell-mercury.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = ActorUsername, HostCustomEntity = DvcHostname, ProcessCustomEntity = Process",
    "detection": "powershell-mercury.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = ActorUsername, HostCustomEntity = DvcHostname, ProcessCustomEntity = Process",
    "detection": "powershell-mercury.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = ActorUsername, HostCustomEntity = DvcHostname, ProcessCustomEntity = Process",
    "detection": "powershell-mercury.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = ActorUsername, HostCustomEntity = DvcHostname, ProcessCustomEntity = Process",
    "detection": "powershell-mercury.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectAccount, ObjectDN, AttributeValue, SubjectUserName, SubjectDomainName, SubjectUserSid",
    "detection": "userprincipalnameassignedtouseraccount.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectAccount, ObjectDN, AttributeValue, SubjectUserName, SubjectDomainName, SubjectUserSid",
    "detection": "userprincipalnameassignedtouseraccount.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectAccount, ObjectDN, AttributeValue, SubjectUserName, SubjectDomainName, SubjectUserSid",
    "detection": "userprincipalnameassignedtouseraccount.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectAccount, ObjectDN, AttributeValue, SubjectUserName, SubjectDomainName, SubjectUserSid",
    "detection": "userprincipalnameassignedtouseraccount.yaml",
    "field": "subjectaccount",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectAccount, ObjectDN, AttributeValue, SubjectUserName, SubjectDomainName, SubjectUserSid",
    "detection": "userprincipalnameassignedtouseraccount.yaml",
    "field": "objectdn",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectAccount, ObjectDN, AttributeValue, SubjectUserName, SubjectDomainName, SubjectUserSid",
    "detection": "userprincipalnameassignedtouseraccount.yaml",
    "field": "attributevalue",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectAccount, ObjectDN, AttributeValue, SubjectUserName, SubjectDomainName, SubjectUserSid",
    "detection": "userprincipalnameassignedtouseraccount.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectAccount, ObjectDN, AttributeValue, SubjectUserName, SubjectDomainName, SubjectUserSid",
    "detection": "userprincipalnameassignedtouseraccount.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectAccount, ObjectDN, AttributeValue, SubjectUserName, SubjectDomainName, SubjectUserSid",
    "detection": "userprincipalnameassignedtouseraccount.yaml",
    "field": "subjectusersid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "userprincipalnameassignedtouseraccount.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "userprincipalnameassignedtouseraccount.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "userprincipalnameassignedtouseraccount.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270wmicdiscoverysep2022.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270wmicdiscoverysep2022.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270wmicdiscoverysep2022.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270wmicdiscoverysep2022.yaml",
    "field": "accountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270wmicdiscoverysep2022.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270wmicdiscoverysep2022.yaml",
    "field": "processnamefullpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270wmicdiscoverysep2022.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270wmicdiscoverysep2022.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270wmicdiscoverysep2022.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270wmicdiscoverysep2022.yaml",
    "field": "eventsourcename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "dev-0270wmicdiscoverysep2022.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = strcat(InitiatingProcessAccountDomain, @'\\', InitiatingProcessAccountName), Computer = DeviceName",
    "detection": "dev-0270wmicdiscoverysep2022.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = strcat(InitiatingProcessAccountDomain, @'\\', InitiatingProcessAccountName), Computer = DeviceName",
    "detection": "dev-0270wmicdiscoverysep2022.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "dev-0270wmicdiscoverysep2022.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "dev-0270wmicdiscoverysep2022.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "dev-0270wmicdiscoverysep2022.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Account, @'\\')[1]), AccountNTDomain = tostring(split(Account, @'\\')[0])",
    "detection": "dev-0270wmicdiscoverysep2022.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Account, @'\\')[1]), AccountNTDomain = tostring(split(Account, @'\\')[0])",
    "detection": "dev-0270wmicdiscoverysep2022.yaml",
    "field": "accountntdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend FileCustomEntity = \"TargetFileName\", HostCustomEntity = \"DvcHostName\", CustomProcessEntity = \"TargetProcessName\"",
    "detection": "suspected-pakistani-actor-reverserat-apparatus.yaml",
    "field": "filecustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend FileCustomEntity = \"TargetFileName\", HostCustomEntity = \"DvcHostName\", CustomProcessEntity = \"TargetProcessName\"",
    "detection": "suspected-pakistani-actor-reverserat-apparatus.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend FileCustomEntity = \"TargetFileName\", HostCustomEntity = \"DvcHostName\", CustomProcessEntity = \"TargetProcessName\"",
    "detection": "suspected-pakistani-actor-reverserat-apparatus.yaml",
    "field": "customprocessentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend EvData = parse_xml(EventData)",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "evdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventDetail = EvData.DataItem.EventData.Data",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend LoadedItems = parse_json(tostring(parse_json(tostring(EvData.DataItem)).EventData)).[\"Data\"]",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "loadeditems",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DLL = tostring(LoadedItems.[\"#text\"])",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "dll",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EvData = parse_xml(EventData)",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "evdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventDetail = EvData.DataItem.EventData.Data",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Images = parse_json(tostring(parse_json(tostring(EvData.DataItem)).EventData)).[\"Data\"]",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "images",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Image = tostring(Images.[\"#text\"])",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend LoadedItems = parse_json(tostring(parse_json(tostring(EvData.DataItem)).EventData)).[\"Data\"]",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "loadeditems",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DLL = tostring(LoadedItems.[\"#text\"])",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "dll",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Image = tostring(Image)",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ImageLoadTime = TimeGenerated",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "imageloadtime",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend RenderedDescription = tostring(split(RenderedDescription, \":\")[0])",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "rendereddescription",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventData = parse_xml(EventData).DataItem.EventData.Data",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "eventdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key = tostring(column_ifexists('@Name', \"\")), Value = column_ifexists('#text', \"\")",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "key",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key = tostring(column_ifexists('@Name', \"\")), Value = column_ifexists('#text', \"\")",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "value",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ParentImage = tostring(column_ifexists(\"ParentImage\", \"NotAvailable\"))",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "parentimage",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ProcessExecutionTime = TimeGenerated) on $left.Image == $right.ParentImage",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "processexecutiontime",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend delta =  ProcessExecutionTime - ImageLoadTime",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "delta",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ParentCommandLine = tostring(column_ifexists(\"ParentCommandLine\", \"NotAvailable\"))",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "parentcommandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Hashes = tostring(column_ifexists(\"Hashes\", \"NotAvailable, NotAvailable\"))",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "hashes",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Hashes = split(Hashes, \",\")",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "hashes",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SHA1 = tostring(FileHashes.SHA1)",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "sha1",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend HashAlgo = \"SHA1\"",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "hashalgo",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserName, \"\\\\\")[1]), NTDomain = tostring(split(UserName, \"\\\\\")[0])",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserName, \"\\\\\")[1]), NTDomain = tostring(split(UserName, \"\\\\\")[0])",
    "detection": "comeventsystemloadingnewdll.yaml",
    "field": "ntdomain",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "windowsbinarieslolbinsrenamed.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "windowsbinarieslolbinsrenamed.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "windowsbinarieslolbinsrenamed.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "windowsbinarieslolbinsrenamed.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "windowsbinarieslolbinsrenamed.yaml",
    "field": "user",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "windowsbinarieslolbinsrenamed.yaml",
    "field": "parentimage",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "windowsbinarieslolbinsrenamed.yaml",
    "field": "parentprocessguid",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "windowsbinarieslolbinsrenamed.yaml",
    "field": "parentcommandline",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "windowsbinarieslolbinsrenamed.yaml",
    "field": "parentuser",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "windowsbinarieslolbinsrenamed.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "windowsbinarieslolbinsrenamed.yaml",
    "field": "processguid",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "windowsbinarieslolbinsrenamed.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "windowsbinarieslolbinsrenamed.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "windowsbinarieslolbinsrenamed.yaml",
    "field": "originalfilename",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "windowsbinarieslolbinsrenamed.yaml",
    "field": "currentdirectory",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description, OriginalFileName, CurrentDirectory, Hashes",
    "detection": "windowsbinarieslolbinsrenamed.yaml",
    "field": "hashes",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = iif(Computer has '.',substring(Computer,0,indexof(Computer,'.')),Computer) , DnsDomain = iif(Computer has '.',substring(Computer,indexof(Computer,'.')+1),'')",
    "detection": "windowsbinarieslolbinsrenamed.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = iif(Computer has '.',substring(Computer,0,indexof(Computer,'.')),Computer) , DnsDomain = iif(Computer has '.',substring(Computer,indexof(Computer,'.')+1),'')",
    "detection": "windowsbinarieslolbinsrenamed.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description",
    "detection": "lateralmovementviadcom.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description",
    "detection": "lateralmovementviadcom.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description",
    "detection": "lateralmovementviadcom.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description",
    "detection": "lateralmovementviadcom.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description",
    "detection": "lateralmovementviadcom.yaml",
    "field": "user",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description",
    "detection": "lateralmovementviadcom.yaml",
    "field": "parentimage",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description",
    "detection": "lateralmovementviadcom.yaml",
    "field": "parentprocessguid",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description",
    "detection": "lateralmovementviadcom.yaml",
    "field": "parentcommandline",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description",
    "detection": "lateralmovementviadcom.yaml",
    "field": "parentuser",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description",
    "detection": "lateralmovementviadcom.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description",
    "detection": "lateralmovementviadcom.yaml",
    "field": "processguid",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description",
    "detection": "lateralmovementviadcom.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by EventID, Computer, User, ParentImage, ParentProcessGuid, ParentCommandLine, ParentUser, Image, ProcessGuid, CommandLine, Description",
    "detection": "lateralmovementviadcom.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = iif(Computer has '.',substring(Computer,0,indexof(Computer,'.')),Computer) , DnsDomain = iif(Computer has '.',substring(Computer,indexof(Computer,'.')+1),'')",
    "detection": "lateralmovementviadcom.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = iif(Computer has '.',substring(Computer,0,indexof(Computer,'.')),Computer) , DnsDomain = iif(Computer has '.',substring(Computer,indexof(Computer,'.')+1),'')",
    "detection": "lateralmovementviadcom.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventData = parse_xml(EventData).DataItem.EventData.Data",
    "detection": "gaincodeexecutionadfsviawmi.yaml",
    "field": "eventdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key=tostring(['@Name']), Value=['#text']",
    "detection": "gaincodeexecutionadfsviawmi.yaml",
    "field": "key",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key=tostring(['@Name']), Value=['#text']",
    "detection": "gaincodeexecutionadfsviawmi.yaml",
    "field": "value",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend process = split(Image, '\\\\', -1)[-1]",
    "detection": "gaincodeexecutionadfsviawmi.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, TargetAccount, CommandLine, Computer, Account, TargetLogonId",
    "detection": "gaincodeexecutionadfsviawmi.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, TargetAccount, CommandLine, Computer, Account, TargetLogonId",
    "detection": "gaincodeexecutionadfsviawmi.yaml",
    "field": "targetaccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, TargetAccount, CommandLine, Computer, Account, TargetLogonId",
    "detection": "gaincodeexecutionadfsviawmi.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, TargetAccount, CommandLine, Computer, Account, TargetLogonId",
    "detection": "gaincodeexecutionadfsviawmi.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, TargetAccount, CommandLine, Computer, Account, TargetLogonId",
    "detection": "gaincodeexecutionadfsviawmi.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, TargetAccount, CommandLine, Computer, Account, TargetLogonId",
    "detection": "gaincodeexecutionadfsviawmi.yaml",
    "field": "targetlogonid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer, AccountCustomEntity = Account",
    "detection": "gaincodeexecutionadfsviawmi.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer, AccountCustomEntity = Account",
    "detection": "gaincodeexecutionadfsviawmi.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer, AccountCustomEntity = Account",
    "detection": "gaincodeexecutionadfsviawmi.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TargetLogonId",
    "detection": "gaincodeexecutionadfsviawmi.yaml",
    "field": "targetlogonid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventData = parse_xml(EventData).DataItem.EventData.Data",
    "detection": "gaincodeexecutionadfsviawmi.yaml",
    "field": "eventdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key=tostring(['@Name']), Value=['#text']",
    "detection": "gaincodeexecutionadfsviawmi.yaml",
    "field": "key",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key=tostring(['@Name']), Value=['#text']",
    "detection": "gaincodeexecutionadfsviawmi.yaml",
    "field": "value",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventType, Image, Computer, UserName",
    "detection": "gaincodeexecutionadfsviawmi.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventType, Image, Computer, UserName",
    "detection": "gaincodeexecutionadfsviawmi.yaml",
    "field": "eventtype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventType, Image, Computer, UserName",
    "detection": "gaincodeexecutionadfsviawmi.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventType, Image, Computer, UserName",
    "detection": "gaincodeexecutionadfsviawmi.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventType, Image, Computer, UserName",
    "detection": "gaincodeexecutionadfsviawmi.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer, AccountCustomEntity = UserName",
    "detection": "gaincodeexecutionadfsviawmi.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer, AccountCustomEntity = UserName",
    "detection": "gaincodeexecutionadfsviawmi.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer, AccountCustomEntity = UserName",
    "detection": "gaincodeexecutionadfsviawmi.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend system = tolower(system), share = tolower(share)",
    "detection": "excessivesharepermissions.yaml",
    "field": "system",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend system = tolower(system), share = tolower(share)",
    "detection": "excessivesharepermissions.yaml",
    "field": "share",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize allowed_shares = make_set(share) by system;",
    "detection": "excessivesharepermissions.yaml",
    "field": "allowed_shares",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventXML = parse_xml(EventData)",
    "detection": "excessivesharepermissions.yaml",
    "field": "eventxml",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend OldSD = tostring(EventXML[\"EventData\"][\"Data\"][13][\"#text\"])     // Grab the previous Security Descriptor.",
    "detection": "excessivesharepermissions.yaml",
    "field": "oldsd",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend NewSD = tostring(EventXML[\"EventData\"][\"Data\"][14][\"#text\"])     // Grab the new Security Descriptor.",
    "detection": "excessivesharepermissions.yaml",
    "field": "newsd",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend system = tolower(Computer), share=tolower(ShareName)             // Normalize system and share name for matching with whitelist.",
    "detection": "excessivesharepermissions.yaml",
    "field": "system",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend system = tolower(Computer), share=tolower(ShareName)             // Normalize system and share name for matching with whitelist.",
    "detection": "excessivesharepermissions.yaml",
    "field": "share",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DACLS = extract_all(@\"(D:(?:\\((?:[\\w\\-]*;){5}(?:[\\w\\-]*)\\))*)\", tostring(NewSD)) // Grab all instances of D:(DACL), in case there are multiple sets.",
    "detection": "excessivesharepermissions.yaml",
    "field": "dacls",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DACLS = substring(DACLS,2)                                       // Strip the leading D:.",
    "detection": "excessivesharepermissions.yaml",
    "field": "dacls",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DACLS = split(DACLS, \")\")                                        // Split the sets of DACLS ()() to an array of individual DACLS (). This removes the trailing ) character.",
    "detection": "excessivesharepermissions.yaml",
    "field": "dacls",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DACLS = substring(DACLS, 1)                                      // Also remove the leading ( character.",
    "detection": "excessivesharepermissions.yaml",
    "field": "dacls",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend allowed_principal = tostring(split(DACLS,\";\",5)[0])              // Grab the SID what is affected by this DACL.",
    "detection": "excessivesharepermissions.yaml",
    "field": "allowed_principal",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend allowed_principal = iff(not(allowed_principal startswith \"S-\" and string_size(allowed_principal) > 15), allowed_principal, split(allowed_principal,\"-\",countof(allowed_principal,\"-\"))[0]) // This line takes only the last part (e.g., 513) of a long SID, so you can refer to groups/users without needing to supply the full SID above.",
    "detection": "excessivesharepermissions.yaml",
    "field": "allowed_principal",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Authorized_Public_Principals = make_set(Group_Name), take_any(*) by TimeGenerated, SourceComputerId, EventData // Summarize the fields back, making a set of the various group_name values for this record.",
    "detection": "excessivesharepermissions.yaml",
    "field": "authorized_public_principals",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Authorized_Public_Principals = make_set(Group_Name), take_any(*) by TimeGenerated, SourceComputerId, EventData // Summarize the fields back, making a set of the various group_name values for this record.",
    "detection": "excessivesharepermissions.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Authorized_Public_Principals = make_set(Group_Name), take_any(*) by TimeGenerated, SourceComputerId, EventData // Summarize the fields back, making a set of the various group_name values for this record.",
    "detection": "excessivesharepermissions.yaml",
    "field": "sourcecomputerid",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend CommandLine = tostring(EventData.CommandLine)",
    "detection": "sourgum-ioc-windowsevent.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend NewProcessName = tostring(EventData.NewProcessName)",
    "detection": "sourgum-ioc-windowsevent.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend ParentProcessName = tostring(EventData.ParentProcessName)",
    "detection": "sourgum-ioc-windowsevent.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = strcat(EventData.SubjectDomainName,\"\\\\\", EventData.SubjectUserName)",
    "detection": "sourgum-ioc-windowsevent.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend NewProcessId = tostring(EventData.NewProcessId)",
    "detection": "sourgum-ioc-windowsevent.yaml",
    "field": "newprocessid",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend IP = tostring(EventData.IpAddress)",
    "detection": "sourgum-ioc-windowsevent.yaml",
    "field": "ip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, IP",
    "detection": "sourgum-ioc-windowsevent.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, IP",
    "detection": "sourgum-ioc-windowsevent.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, IP",
    "detection": "sourgum-ioc-windowsevent.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, IP",
    "detection": "sourgum-ioc-windowsevent.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, IP",
    "detection": "sourgum-ioc-windowsevent.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, IP",
    "detection": "sourgum-ioc-windowsevent.yaml",
    "field": "newprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, IP",
    "detection": "sourgum-ioc-windowsevent.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, IP",
    "detection": "sourgum-ioc-windowsevent.yaml",
    "field": "ip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Alert = 'SOURGUM IOC detected'",
    "detection": "sourgum-ioc-windowsevent.yaml",
    "field": "alert",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Account, @'\\')[1]), AccountNTDomain = tostring(split(Account, @'\\')[0])",
    "detection": "sourgum-ioc-windowsevent.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Account, @'\\')[1]), AccountNTDomain = tostring(split(Account, @'\\')[0])",
    "detection": "sourgum-ioc-windowsevent.yaml",
    "field": "accountntdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "sourgum-ioc-windowsevent.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "sourgum-ioc-windowsevent.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "sourgum-ioc-windowsevent.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventID, Computer,  TargetObject, Details",
    "detection": "wdigestdowngradeattack.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventID, Computer,  TargetObject, Details",
    "detection": "wdigestdowngradeattack.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventID, Computer,  TargetObject, Details",
    "detection": "wdigestdowngradeattack.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventID, Computer,  TargetObject, Details",
    "detection": "wdigestdowngradeattack.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventID, Computer,  TargetObject, Details",
    "detection": "wdigestdowngradeattack.yaml",
    "field": "targetobject",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by EventID, Computer,  TargetObject, Details",
    "detection": "wdigestdowngradeattack.yaml",
    "field": "details",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = iif(Computer has '.',substring(Computer,0,indexof(Computer,'.')),Computer) , DnsDomain = iif(Computer has '.',substring(Computer,indexof(Computer,'.')+1),'')",
    "detection": "wdigestdowngradeattack.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = iif(Computer has '.',substring(Computer,0,indexof(Computer,'.')),Computer) , DnsDomain = iif(Computer has '.',substring(Computer,indexof(Computer,'.')+1),'')",
    "detection": "wdigestdowngradeattack.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectAccount, SubjectUserSid, SubjectLogonId, ObjectDN",
    "detection": "adminsdholder-modifications.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectAccount, SubjectUserSid, SubjectLogonId, ObjectDN",
    "detection": "adminsdholder-modifications.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectAccount, SubjectUserSid, SubjectLogonId, ObjectDN",
    "detection": "adminsdholder-modifications.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectAccount, SubjectUserSid, SubjectLogonId, ObjectDN",
    "detection": "adminsdholder-modifications.yaml",
    "field": "subjectaccount",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectAccount, SubjectUserSid, SubjectLogonId, ObjectDN",
    "detection": "adminsdholder-modifications.yaml",
    "field": "subjectusersid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectAccount, SubjectUserSid, SubjectLogonId, ObjectDN",
    "detection": "adminsdholder-modifications.yaml",
    "field": "subjectlogonid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Computer, SubjectAccount, SubjectUserSid, SubjectLogonId, ObjectDN",
    "detection": "adminsdholder-modifications.yaml",
    "field": "objectdn",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "adminsdholder-modifications.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "adminsdholder-modifications.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "adminsdholder-modifications.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(SubjectAccount, \"\\\\\")[1]), NTDomain = tostring(split(SubjectAccount, \"\\\\\")[0])",
    "detection": "adminsdholder-modifications.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(SubjectAccount, \"\\\\\")[1]), NTDomain = tostring(split(SubjectAccount, \"\\\\\")[0])",
    "detection": "adminsdholder-modifications.yaml",
    "field": "ntdomain",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceName = Computer, AccountName = SubjectUserName, AccountDomain = SubjectDomainName, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "europiumunusualidentity.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceName = Computer, AccountName = SubjectUserName, AccountDomain = SubjectDomainName, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "europiumunusualidentity.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceName = Computer, AccountName = SubjectUserName, AccountDomain = SubjectDomainName, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "europiumunusualidentity.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceName = Computer, AccountName = SubjectUserName, AccountDomain = SubjectDomainName, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "europiumunusualidentity.yaml",
    "field": "accountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceName = Computer, AccountName = SubjectUserName, AccountDomain = SubjectDomainName, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "europiumunusualidentity.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceName = Computer, AccountName = SubjectUserName, AccountDomain = SubjectDomainName, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "europiumunusualidentity.yaml",
    "field": "processnamefullpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceName = Computer, AccountName = SubjectUserName, AccountDomain = SubjectDomainName, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "europiumunusualidentity.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceName = Computer, AccountName = SubjectUserName, AccountDomain = SubjectDomainName, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "europiumunusualidentity.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceName = Computer, AccountName = SubjectUserName, AccountDomain = SubjectDomainName, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "europiumunusualidentity.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceName = Computer, AccountName = SubjectUserName, AccountDomain = SubjectDomainName, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "europiumunusualidentity.yaml",
    "field": "eventsourcename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceName = Computer, AccountName = SubjectUserName, AccountDomain = SubjectDomainName, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "europiumunusualidentity.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingProcessAccount = strcat(AccountDomain, \"\\\\\", AccountName)",
    "detection": "europiumunusualidentity.yaml",
    "field": "initiatingprocessaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountDomain = InitiatingProcessAccountDomain, AccountName = InitiatingProcessAccountName",
    "detection": "europiumunusualidentity.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountDomain = InitiatingProcessAccountDomain, AccountName = InitiatingProcessAccountName",
    "detection": "europiumunusualidentity.yaml",
    "field": "accountdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountDomain = InitiatingProcessAccountDomain, AccountName = InitiatingProcessAccountName",
    "detection": "europiumunusualidentity.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatingProcessAccount = strcat(AccountDomain, \"\\\\\", AccountName)",
    "detection": "europiumunusualidentity.yaml",
    "field": "initiatingprocessaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(DeviceName, \".\")[0]), DomainIndex = toint(indexof(DeviceName, '.'))",
    "detection": "europiumunusualidentity.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(DeviceName, \".\")[0]), DomainIndex = toint(indexof(DeviceName, '.'))",
    "detection": "europiumunusualidentity.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(DeviceName, DomainIndex + 1), DeviceName)",
    "detection": "europiumunusualidentity.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, TargetAccount, EventData=parse_xml(EventData)",
    "detection": "certifiedpreowned-tgts-requested.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, TargetAccount, EventData=parse_xml(EventData)",
    "detection": "certifiedpreowned-tgts-requested.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, TargetAccount, EventData=parse_xml(EventData)",
    "detection": "certifiedpreowned-tgts-requested.yaml",
    "field": "targetaccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, TargetAccount, EventData=parse_xml(EventData)",
    "detection": "certifiedpreowned-tgts-requested.yaml",
    "field": "eventdata",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project CIN=tostring(d[\"#text\"])",
    "detection": "certifiedpreowned-tgts-requested.yaml",
    "field": "cin",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, Activity, Properties, SubjectLogonId, Computer",
    "detection": "nondcactivedirectoryreplication.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, Activity, Properties, SubjectLogonId, Computer",
    "detection": "nondcactivedirectoryreplication.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, Activity, Properties, SubjectLogonId, Computer",
    "detection": "nondcactivedirectoryreplication.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, Activity, Properties, SubjectLogonId, Computer",
    "detection": "nondcactivedirectoryreplication.yaml",
    "field": "properties",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, Activity, Properties, SubjectLogonId, Computer",
    "detection": "nondcactivedirectoryreplication.yaml",
    "field": "subjectlogonid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, Activity, Properties, SubjectLogonId, Computer",
    "detection": "nondcactivedirectoryreplication.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "    | project TargetLogonId, IpAddress",
    "detection": "nondcactivedirectoryreplication.yaml",
    "field": "targetlogonid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TargetLogonId, IpAddress",
    "detection": "nondcactivedirectoryreplication.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "nondcactivedirectoryreplication.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "nondcactivedirectoryreplication.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "nondcactivedirectoryreplication.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Account, \"\\\\\")[0]), AccountNTDomain = tostring(split(Account, \"\\\\\")[1])",
    "detection": "nondcactivedirectoryreplication.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Account, \"\\\\\")[0]), AccountNTDomain = tostring(split(Account, \"\\\\\")[1])",
    "detection": "nondcactivedirectoryreplication.yaml",
    "field": "accountntdomain",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize TargetObjectNameAccessed=make_set(TargetObjectName), ActionPerformedOnObject=make_set(bag_pack(TargetObjectName,EventSubType)) by ActorUsername, bin(TimeGenerated, 5m)",
    "detection": "detected-user-accessing-multiple-secrets.yaml",
    "field": "targetobjectnameaccessed",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize TargetObjectNameAccessed=make_set(TargetObjectName), ActionPerformedOnObject=make_set(bag_pack(TargetObjectName,EventSubType)) by ActorUsername, bin(TimeGenerated, 5m)",
    "detection": "detected-user-accessing-multiple-secrets.yaml",
    "field": "actionperformedonobject",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize TargetObjectNameAccessed=make_set(TargetObjectName), ActionPerformedOnObject=make_set(bag_pack(TargetObjectName,EventSubType)) by ActorUsername, bin(TimeGenerated, 5m)",
    "detection": "detected-user-accessing-multiple-secrets.yaml",
    "field": "actorusername",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Fails=count() by ActorUsername, FailureTime=bin(TimeGenerated, 1m)",
    "detection": "multiple-failed-authentication-attempts-to-success.yaml",
    "field": "fails",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Fails=count() by ActorUsername, FailureTime=bin(TimeGenerated, 1m)",
    "detection": "multiple-failed-authentication-attempts-to-success.yaml",
    "field": "actorusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project CreatedUserTime = TimeGenerated, CreatedUserEventID = EventID, CreatedUserActivity = Activity, Computer = toupper(Computer),",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "createdusertime",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project CreatedUserTime = TimeGenerated, CreatedUserEventID = EventID, CreatedUserActivity = Activity, Computer = toupper(Computer),",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "createdusereventid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project CreatedUserTime = TimeGenerated, CreatedUserEventID = EventID, CreatedUserActivity = Activity, Computer = toupper(Computer),",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "createduseractivity",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project CreatedUserTime = TimeGenerated, CreatedUserEventID = EventID, CreatedUserActivity = Activity, Computer = toupper(Computer),",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SubjectUserSid = tostring(EventData.SubjectUserSid)",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "subjectusersid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend AccountType=case(EventData.SubjectUserName endswith \"$\" or SubjectUserSid in (\"S-1-5-18\", \"S-1-5-19\", \"S-1-5-20\"), \"Machine\", isempty(SubjectUserSid), \"\", \"User\")",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SubjectAccount = strcat(tostring(EventData.SubjectDomainName),\"\\\\\", tostring(EventData.SubjectUserName))",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "subjectaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SubjectDomainName = tostring(EventData.SubjectDomainName), SubjectUserName = tostring(EventData.SubjectUserName)",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SubjectDomainName = tostring(EventData.SubjectDomainName), SubjectUserName = tostring(EventData.SubjectUserName)",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TargetAccount = strcat(EventData.TargetDomainName,\"\\\\\", EventData.TargetUserName)",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "targetaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TargetUserName = tostring(EventData.TargetUserName), TargetDomainName = tostring(EventData.TargetDomainName)",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TargetUserName = tostring(EventData.TargetUserName), TargetDomainName = tostring(EventData.TargetDomainName)",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "targetdomainname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend Activity=\"4720 - A user account was created.\"",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TargetSid = tostring(EventData.TargetSid)",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "targetsid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project CreatedUserTime = TimeGenerated, CreatedUserEventID = EventID, CreatedUserActivity = Activity, Computer = toupper(Computer),",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "createdusertime",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project CreatedUserTime = TimeGenerated, CreatedUserEventID = EventID, CreatedUserActivity = Activity, Computer = toupper(Computer),",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "createdusereventid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project CreatedUserTime = TimeGenerated, CreatedUserEventID = EventID, CreatedUserActivity = Activity, Computer = toupper(Computer),",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "createduseractivity",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project CreatedUserTime = TimeGenerated, CreatedUserEventID = EventID, CreatedUserActivity = Activity, Computer = toupper(Computer),",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "    | project GroupAddTime = TimeGenerated, GroupAddEventID = EventID, GroupAddActivity = Activity, Computer = toupper(Computer), GroupName = tolower(TargetAccount),",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "groupaddtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project GroupAddTime = TimeGenerated, GroupAddEventID = EventID, GroupAddActivity = Activity, Computer = toupper(Computer), GroupName = tolower(TargetAccount),",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "groupaddeventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project GroupAddTime = TimeGenerated, GroupAddEventID = EventID, GroupAddActivity = Activity, Computer = toupper(Computer), GroupName = tolower(TargetAccount),",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "groupaddactivity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project GroupAddTime = TimeGenerated, GroupAddEventID = EventID, GroupAddActivity = Activity, Computer = toupper(Computer), GroupName = tolower(TargetAccount),",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "    | project GroupAddTime = TimeGenerated, GroupAddEventID = EventID, GroupAddActivity = Activity, Computer = toupper(Computer), GroupName = tolower(TargetAccount),",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "groupname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SubjectUserSid = tostring(EventData.SubjectUserSid)",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "subjectusersid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend AccountType=case(EventData.SubjectUserName endswith \"$\" or SubjectUserSid in (\"S-1-5-18\", \"S-1-5-19\", \"S-1-5-20\"), \"Machine\", isempty(SubjectUserSid), \"\", \"User\")",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TargetSid = tostring(EventData.TargetSid)",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "targetsid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SubjectAccount = strcat(tostring(EventData.SubjectDomainName),\"\\\\\", tostring(EventData.SubjectUserName))",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "subjectaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SubjectDomainName = tostring(EventData.SubjectDomainName), SubjectUserName = tostring(EventData.SubjectUserName)",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SubjectDomainName = tostring(EventData.SubjectDomainName), SubjectUserName = tostring(EventData.SubjectUserName)",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TargetAccount = strcat(EventData.TargetDomainName,\"\\\\\", EventData.TargetUserName)",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "targetaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend Activity=\"4732 - A member was added to a security-enabled local group.\"",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend MemberSid = tostring(EventData.MemberSid)",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "membersid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project GroupAddTime = TimeGenerated, GroupAddEventID = EventID, GroupAddActivity = Activity, Computer = toupper(Computer), GroupName = tolower(TargetAccount),",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "groupaddtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project GroupAddTime = TimeGenerated, GroupAddEventID = EventID, GroupAddActivity = Activity, Computer = toupper(Computer), GroupName = tolower(TargetAccount),",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "groupaddeventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project GroupAddTime = TimeGenerated, GroupAddEventID = EventID, GroupAddActivity = Activity, Computer = toupper(Computer), GroupName = tolower(TargetAccount),",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "groupaddactivity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project GroupAddTime = TimeGenerated, GroupAddEventID = EventID, GroupAddActivity = Activity, Computer = toupper(Computer), GroupName = tolower(TargetAccount),",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "    | project GroupAddTime = TimeGenerated, GroupAddEventID = EventID, GroupAddActivity = Activity, Computer = toupper(Computer), GroupName = tolower(TargetAccount),",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "groupname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Computer, CreatedUserTime, CreatedUserEventID, CreatedUserActivity, CreatedUser, CreatedUserSid, CreatedUserAccountName, CreatedUserDomainName,",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project Computer, CreatedUserTime, CreatedUserEventID, CreatedUserActivity, CreatedUser, CreatedUserSid, CreatedUserAccountName, CreatedUserDomainName,",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "createdusertime",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Computer, CreatedUserTime, CreatedUserEventID, CreatedUserActivity, CreatedUser, CreatedUserSid, CreatedUserAccountName, CreatedUserDomainName,",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "createdusereventid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Computer, CreatedUserTime, CreatedUserEventID, CreatedUserActivity, CreatedUser, CreatedUserSid, CreatedUserAccountName, CreatedUserDomainName,",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "createduseractivity",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Computer, CreatedUserTime, CreatedUserEventID, CreatedUserActivity, CreatedUser, CreatedUserSid, CreatedUserAccountName, CreatedUserDomainName,",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "createduser",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Computer, CreatedUserTime, CreatedUserEventID, CreatedUserActivity, CreatedUser, CreatedUserSid, CreatedUserAccountName, CreatedUserDomainName,",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "createdusersid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Computer, CreatedUserTime, CreatedUserEventID, CreatedUserActivity, CreatedUser, CreatedUserSid, CreatedUserAccountName, CreatedUserDomainName,",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "createduseraccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Computer, CreatedUserTime, CreatedUserEventID, CreatedUserActivity, CreatedUser, CreatedUserSid, CreatedUserAccountName, CreatedUserDomainName,",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "createduserdomainname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "usercreatedaddedtobuiltinadmins-1d.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TI_ipEntity = iff(isnotempty(NetworkIP), NetworkIP, NetworkDestinationIP)",
    "detection": "ipentity-azureactivity.yaml",
    "field": "ti_ipentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TI_ipEntity = iff(isempty(TI_ipEntity) and isnotempty(NetworkSourceIP), NetworkSourceIP, TI_ipEntity)",
    "detection": "ipentity-azureactivity.yaml",
    "field": "ti_ipentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TI_ipEntity = iff(isempty(TI_ipEntity) and isnotempty(EmailSourceIpAddress), EmailSourceIpAddress, TI_ipEntity)",
    "detection": "ipentity-azureactivity.yaml",
    "field": "ti_ipentity",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "ipentity-azureactivity.yaml",
    "field": "latestindicatortime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "ipentity-azureactivity.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend AzureActivity_TimeGenerated = TimeGenerated",
    "detection": "ipentity-azureactivity.yaml",
    "field": "azureactivity_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AzureActivity_TimeGenerated = arg_max(AzureActivity_TimeGenerated, *) by IndicatorId, CallerIpAddress",
    "detection": "ipentity-azureactivity.yaml",
    "field": "azureactivity_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AzureActivity_TimeGenerated = arg_max(AzureActivity_TimeGenerated, *) by IndicatorId, CallerIpAddress",
    "detection": "ipentity-azureactivity.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AzureActivity_TimeGenerated = arg_max(AzureActivity_TimeGenerated, *) by IndicatorId, CallerIpAddress",
    "detection": "ipentity-azureactivity.yaml",
    "field": "calleripaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project AzureActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, CallerIpAddress,",
    "detection": "ipentity-azureactivity.yaml",
    "field": "azureactivity_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AzureActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, CallerIpAddress,",
    "detection": "ipentity-azureactivity.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AzureActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, CallerIpAddress,",
    "detection": "ipentity-azureactivity.yaml",
    "field": "activitygroupnames",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AzureActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, CallerIpAddress,",
    "detection": "ipentity-azureactivity.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AzureActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, CallerIpAddress,",
    "detection": "ipentity-azureactivity.yaml",
    "field": "threattype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AzureActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, CallerIpAddress,",
    "detection": "ipentity-azureactivity.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AzureActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, CallerIpAddress,",
    "detection": "ipentity-azureactivity.yaml",
    "field": "expirationdatetime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AzureActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, CallerIpAddress,",
    "detection": "ipentity-azureactivity.yaml",
    "field": "confidencescore",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AzureActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, CallerIpAddress,",
    "detection": "ipentity-azureactivity.yaml",
    "field": "ti_ipentity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AzureActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, CallerIpAddress,",
    "detection": "ipentity-azureactivity.yaml",
    "field": "calleripaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = AzureActivity_TimeGenerated",
    "detection": "ipentity-azureactivity.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = iif(Caller has '@', tostring(split(Caller,'@',0)[0]), \"\")",
    "detection": "ipentity-azureactivity.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UPNSuffix = iif(Caller has '@', tostring(split(Caller,'@',1)[0]), \"\")",
    "detection": "ipentity-azureactivity.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AadUserId = iif(Caller !has '@', tostring(Caller), \"\")",
    "detection": "ipentity-azureactivity.yaml",
    "field": "aaduserid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), ComputerCountToday = dcount(Computer), ComputerSet = makeset(Computer), ProcessSet = makeset(ProcessName)",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), ComputerCountToday = dcount(Computer), ComputerSet = makeset(Computer), ProcessSet = makeset(ProcessName)",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), ComputerCountToday = dcount(Computer), ComputerSet = makeset(Computer), ProcessSet = makeset(ProcessName)",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "computercounttoday",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), ComputerCountToday = dcount(Computer), ComputerSet = makeset(Computer), ProcessSet = makeset(ProcessName)",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "computerset",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), ComputerCountToday = dcount(Computer), ComputerSet = makeset(Computer), ProcessSet = makeset(ProcessName)",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "processset",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend LogonType = tostring(EventData.LogonType)",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "logontype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ProcessName = tostring(EventData.ProcessName)",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = strcat(tostring(EventData.TargetDomainName),\"\\\\\", tostring(EventData.TargetUserName))",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend IpAddress = tostring(EventData.IpAddress)",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetUserSid = tostring(EventData.TargetUserSid)",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "targetusersid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountType=case(Account endswith \"$\" or TargetUserSid in (\"S-1-5-18\", \"S-1-5-19\", \"S-1-5-20\"), \"Machine\", isempty(TargetUserSid), \"\", \"User\")",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Activity=\"4624 - An account was successfully logged on.\"",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend LogonTypeName=\"10 - RemoteInteractive\"",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "logontypename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), ComputerCountToday = dcount(Computer), ComputerSet = makeset(Computer), ProcessSet = makeset(ProcessName)",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), ComputerCountToday = dcount(Computer), ComputerSet = makeset(Computer), ProcessSet = makeset(ProcessName)",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), ComputerCountToday = dcount(Computer), ComputerSet = makeset(Computer), ProcessSet = makeset(ProcessName)",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "computercounttoday",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), ComputerCountToday = dcount(Computer), ComputerSet = makeset(Computer), ProcessSet = makeset(ProcessName)",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "computerset",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), ComputerCountToday = dcount(Computer), ComputerSet = makeset(Computer), ProcessSet = makeset(ProcessName)",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "processset",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize ComputerCountPrev7Days = dcount(Computer) by Account = tolower(Account), IpAddress",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "computercountprev7days",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize ComputerCountPrev7Days = dcount(Computer) by Account = tolower(Account), IpAddress",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend LogonType = toint(EventData.LogonType)",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "logontype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = strcat(tostring(EventData.TargetDomainName),\"\\\\\", tostring(EventData.TargetUserName))",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend IpAddress = tostring(EventData.IpAddress)",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize ComputerCountPrev7Days = dcount(Computer) by Account = tolower(Account), IpAddress)",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "computercountprev7days",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Ratio = iff(isempty(ComputerCountPrev7Days), toreal(ComputerCountToday), ComputerCountToday / (ComputerCountPrev7Days * 1.0))",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "ratio",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Account, IpAddress, ComputerSet, ComputerCountToday, ComputerCountPrev7Days, Ratio, AccountType, Activity, LogonTypeName, ProcessSet",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Account, IpAddress, ComputerSet, ComputerCountToday, ComputerCountPrev7Days, Ratio, AccountType, Activity, LogonTypeName, ProcessSet",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Account, IpAddress, ComputerSet, ComputerCountToday, ComputerCountPrev7Days, Ratio, AccountType, Activity, LogonTypeName, ProcessSet",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Account, IpAddress, ComputerSet, ComputerCountToday, ComputerCountPrev7Days, Ratio, AccountType, Activity, LogonTypeName, ProcessSet",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Account, IpAddress, ComputerSet, ComputerCountToday, ComputerCountPrev7Days, Ratio, AccountType, Activity, LogonTypeName, ProcessSet",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "computerset",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Account, IpAddress, ComputerSet, ComputerCountToday, ComputerCountPrev7Days, Ratio, AccountType, Activity, LogonTypeName, ProcessSet",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "computercounttoday",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Account, IpAddress, ComputerSet, ComputerCountToday, ComputerCountPrev7Days, Ratio, AccountType, Activity, LogonTypeName, ProcessSet",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "computercountprev7days",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Account, IpAddress, ComputerSet, ComputerCountToday, ComputerCountPrev7Days, Ratio, AccountType, Activity, LogonTypeName, ProcessSet",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "ratio",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Account, IpAddress, ComputerSet, ComputerCountToday, ComputerCountPrev7Days, Ratio, AccountType, Activity, LogonTypeName, ProcessSet",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Account, IpAddress, ComputerSet, ComputerCountToday, ComputerCountPrev7Days, Ratio, AccountType, Activity, LogonTypeName, ProcessSet",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Account, IpAddress, ComputerSet, ComputerCountToday, ComputerCountPrev7Days, Ratio, AccountType, Activity, LogonTypeName, ProcessSet",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "logontypename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Account, IpAddress, ComputerSet, ComputerCountToday, ComputerCountPrev7Days, Ratio, AccountType, Activity, LogonTypeName, ProcessSet",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "processset",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Account, @\"\\\")[1]), AccountNTDomain = tostring(split(Account, @\"\\\")[0])",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Account, @\"\\\")[1]), AccountNTDomain = tostring(split(Account, @\"\\\")[0])",
    "detection": "rdp-multipleconnectionsfromsinglesystem.yaml",
    "field": "accountntdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "actiontype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "initiatingprocessaccountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "initiatingprocessaccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "initiatingprocesscommandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "initiatingprocessfolderpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "initiatingprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "initiatingprocessparentfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "initiatingprocessfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "initiatingprocesssha256",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "sha256",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = AccountName, Computer = DeviceName,  CommandLine = InitiatingProcessCommandLine, FileHash = case(InitiatingProcessSHA256 in (sha256Hashes), \"InitiatingProcessSHA256\", SHA256 in (sha256Hashes), \"SHA256\", \"No Match\")",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = AccountName, Computer = DeviceName,  CommandLine = InitiatingProcessCommandLine, FileHash = case(InitiatingProcessSHA256 in (sha256Hashes), \"InitiatingProcessSHA256\", SHA256 in (sha256Hashes), \"SHA256\", \"No Match\")",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = AccountName, Computer = DeviceName,  CommandLine = InitiatingProcessCommandLine, FileHash = case(InitiatingProcessSHA256 in (sha256Hashes), \"InitiatingProcessSHA256\", SHA256 in (sha256Hashes), \"SHA256\", \"No Match\")",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = AccountName, Computer = DeviceName,  CommandLine = InitiatingProcessCommandLine, FileHash = case(InitiatingProcessSHA256 in (sha256Hashes), \"InitiatingProcessSHA256\", SHA256 in (sha256Hashes), \"SHA256\", \"No Match\")",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = case(FileHash == \"InitiatingProcessSHA256\", InitiatingProcessSHA256, FileHash == \"SHA256\", SHA256, \"No Match\")",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = case(FileHash == \"InitiatingProcessSHA256\", InitiatingProcessSHA256, FileHash == \"SHA256\", SHA256, \"No Match\")",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = case(FileHash == \"InitiatingProcessSHA256\", InitiatingProcessSHA256, FileHash == \"SHA256\", SHA256, \"No Match\")",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = case(FileHash == \"InitiatingProcessSHA256\", InitiatingProcessSHA256, FileHash == \"SHA256\", SHA256, \"No Match\")",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = case(FileHash == \"InitiatingProcessSHA256\", InitiatingProcessSHA256, FileHash == \"SHA256\", SHA256, \"No Match\")",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, EventID",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, EventID",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, EventID",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, EventID",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, EventID",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, EventID",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "newprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, EventID",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, EventID",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = NewProcessName",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = NewProcessName",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = NewProcessName",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = NewProcessName",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Message, SourceUserID, FileHash, Type",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Message, SourceUserID, FileHash, Type",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Message, SourceUserID, FileHash, Type",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "sourceuserid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Message, SourceUserID, FileHash, Type",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Message, SourceUserID, FileHash, Type",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, FileHashCustomEntity = 'SHA256', Account = SourceUserID",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, FileHashCustomEntity = 'SHA256', Account = SourceUserID",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, FileHashCustomEntity = 'SHA256', Account = SourceUserID",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend EvData = parse_xml(EventData)",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "evdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventDetail = EvData.DataItem.EventData.Data",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Image = EventDetail.[4].[\"#text\"],  CommandLine = EventDetail.[10].[\"#text\"], Hashes = tostring(EventDetail.[17].[\"#text\"])",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Image = EventDetail.[4].[\"#text\"],  CommandLine = EventDetail.[10].[\"#text\"], Hashes = tostring(EventDetail.[17].[\"#text\"])",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Image = EventDetail.[4].[\"#text\"],  CommandLine = EventDetail.[10].[\"#text\"], Hashes = tostring(EventDetail.[17].[\"#text\"])",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "hashes",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Hashes = extract_all(@\"(?P<key>\\w+)=(?P<value>[a-zA-Z0-9]+)\", dynamic([\"key\",\"value\"]), Hashes)",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "hashes",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Hashes = column_ifexists(\"Hashes\", \"\"), CommandLine = column_ifexists(\"CommandLine\", \"\")",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "hashes",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Hashes = column_ifexists(\"Hashes\", \"\"), CommandLine = column_ifexists(\"CommandLine\", \"\")",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "source",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "hashes",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Type = strcat(Type, \": \", Source)",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), FileHashCustomEntity = tostring(Hashes)",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), FileHashCustomEntity = tostring(Hashes)",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), FileHashCustomEntity = tostring(Hashes)",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), FileHashCustomEntity = tostring(Hashes)",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), FileHashCustomEntity = tostring(Hashes)",
    "detection": "dev-0586-jan2022-ioc.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by SourceIP",
    "detection": "signinfirewallcorrelation.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SourceIP, AccountCustomEntity = UserPrincipalName",
    "detection": "signinfirewallcorrelation.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SourceIP, AccountCustomEntity = UserPrincipalName",
    "detection": "signinfirewallcorrelation.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SourceIP, AccountCustomEntity = UserPrincipalName",
    "detection": "signinfirewallcorrelation.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case(SourceIP in (IPList), \"SourceIP\", DestinationIP in (IPList), \"DestinationIP\", \"Message\")",
    "detection": "iridiumiocs.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "iridiumiocs.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "iridiumiocs.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "iridiumiocs.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "iridiumiocs.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "iridiumiocs.yaml",
    "field": "deviceproduct",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "iridiumiocs.yaml",
    "field": "deviceaction",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "iridiumiocs.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "iridiumiocs.yaml",
    "field": "protocol",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "iridiumiocs.yaml",
    "field": "sourceport",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "iridiumiocs.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "iridiumiocs.yaml",
    "field": "deviceaddress",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "iridiumiocs.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "iridiumiocs.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"IP in Message Field\")",
    "detection": "iridiumiocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"IP in Message Field\")",
    "detection": "iridiumiocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = SourceIPAddress , AccountCustomEntity = Account",
    "detection": "iridiumiocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = SourceIPAddress , AccountCustomEntity = Account",
    "detection": "iridiumiocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = SourceIPAddress , AccountCustomEntity = Account",
    "detection": "iridiumiocs.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = IPAddresses,  Host = Computer",
    "detection": "iridiumiocs.yaml",
    "field": "destinationipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = IPAddresses,  Host = Computer",
    "detection": "iridiumiocs.yaml",
    "field": "host",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIPAddress, HostCustomEntity = Host",
    "detection": "iridiumiocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIPAddress, HostCustomEntity = Host",
    "detection": "iridiumiocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIPAddress, HostCustomEntity = Host",
    "detection": "iridiumiocs.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = DnsResponseName,  Host = Dvc",
    "detection": "iridiumiocs.yaml",
    "field": "destinationipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = DnsResponseName,  Host = Dvc",
    "detection": "iridiumiocs.yaml",
    "field": "host",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SrcIpAddr, HostCustomEntity = Host",
    "detection": "iridiumiocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SrcIpAddr, HostCustomEntity = Host",
    "detection": "iridiumiocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SrcIpAddr, HostCustomEntity = Host",
    "detection": "iridiumiocs.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case( SourceIp in (IPList), \"SourceIP\", DestinationIp in (IPList), \"DestinationIP\", \"None\")",
    "detection": "iridiumiocs.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIp, IPMatch == \"DestinationIP\", DestinationIp, \"None\"), Host = Computer",
    "detection": "iridiumiocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIp, IPMatch == \"DestinationIP\", DestinationIp, \"None\"), Host = Computer",
    "detection": "iridiumiocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIp, IPMatch == \"DestinationIP\", DestinationIp, \"None\"), Host = Computer",
    "detection": "iridiumiocs.yaml",
    "field": "host",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend EvData = parse_xml(EventData)",
    "detection": "iridiumiocs.yaml",
    "field": "evdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventDetail = EvData.DataItem.EventData.Data",
    "detection": "iridiumiocs.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = EventDetail.[9].[\"#text\"], DestinationIP = EventDetail.[14].[\"#text\"]",
    "detection": "iridiumiocs.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = EventDetail.[9].[\"#text\"], DestinationIP = EventDetail.[14].[\"#text\"]",
    "detection": "iridiumiocs.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case( SourceIP in (IPList), \"SourceIP\", DestinationIP in (IPList), \"DestinationIP\", \"None\")",
    "detection": "iridiumiocs.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "iridiumiocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "iridiumiocs.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "iridiumiocs.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "iridiumiocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, IPCustomEntity = IPAddress",
    "detection": "iridiumiocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, IPCustomEntity = IPAddress",
    "detection": "iridiumiocs.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, IPCustomEntity = IPAddress",
    "detection": "iridiumiocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, IPCustomEntity = IPAddress",
    "detection": "iridiumiocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, IPCustomEntity = IPAddress",
    "detection": "iridiumiocs.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, IPCustomEntity = IPAddress",
    "detection": "iridiumiocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = cIP, HostCustomEntity = Computer, AccountCustomEntity = csUserName",
    "detection": "iridiumiocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = cIP, HostCustomEntity = Computer, AccountCustomEntity = csUserName",
    "detection": "iridiumiocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = cIP, HostCustomEntity = Computer, AccountCustomEntity = csUserName",
    "detection": "iridiumiocs.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = cIP, HostCustomEntity = Computer, AccountCustomEntity = csUserName",
    "detection": "iridiumiocs.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = CallerIpAddress, AccountCustomEntity = Caller",
    "detection": "iridiumiocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = CallerIpAddress, AccountCustomEntity = Caller",
    "detection": "iridiumiocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = CallerIpAddress, AccountCustomEntity = Caller",
    "detection": "iridiumiocs.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SourceIpAddress, AccountCustomEntity = UserIdentityUserName",
    "detection": "iridiumiocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SourceIpAddress, AccountCustomEntity = UserIdentityUserName",
    "detection": "iridiumiocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SourceIpAddress, AccountCustomEntity = UserIdentityUserName",
    "detection": "iridiumiocs.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIP = DestinationHost",
    "detection": "iridiumiocs.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SourceHost",
    "detection": "iridiumiocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIP = DestinationHost",
    "detection": "iridiumiocs.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SourceHost",
    "detection": "iridiumiocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountEntity = Account, HostEntity = Computer",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountEntity = Account, HostEntity = Computer",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "accountentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountEntity = Account, HostEntity = Computer",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "hostentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend CommandLine = tostring(EventData.CommandLine)",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account =  strcat(tostring(EventData.SubjectDomainName),\"\\\\\", tostring(EventData.SubjectUserName))",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectUserName = tostring(EventData.SubjectUserName)",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectDomainName = tostring(EventData.SubjectDomainName)",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend NewProcessName = tostring(EventData.NewProcessName)",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Process=tostring(split(NewProcessName, '\\\\')[-1])",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend ParentProcessName = tostring(EventData.ParentProcessName)",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountEntity = Account, HostEntity = Computer",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountEntity = Account, HostEntity = Computer",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "accountentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountEntity = Account, HostEntity = Computer",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "hostentity",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, DeviceName, AccountName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessFileName, InitiatingProcessParentFileName,  InitiatingProcessCommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, DeviceName, AccountName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessFileName, InitiatingProcessParentFileName,  InitiatingProcessCommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, DeviceName, AccountName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessFileName, InitiatingProcessParentFileName,  InitiatingProcessCommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, DeviceName, AccountName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessFileName, InitiatingProcessParentFileName,  InitiatingProcessCommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, DeviceName, AccountName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessFileName, InitiatingProcessParentFileName,  InitiatingProcessCommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "initiatingprocessaccountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, DeviceName, AccountName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessFileName, InitiatingProcessParentFileName,  InitiatingProcessCommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "initiatingprocessaccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, DeviceName, AccountName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessFileName, InitiatingProcessParentFileName,  InitiatingProcessCommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "initiatingprocessfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, DeviceName, AccountName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessFileName, InitiatingProcessParentFileName,  InitiatingProcessCommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "initiatingprocessparentfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, DeviceName, AccountName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessFileName, InitiatingProcessParentFileName,  InitiatingProcessCommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "initiatingprocesscommandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountDomain = InitiatingProcessAccountDomain, AccountName = InitiatingProcessAccountName, HostEntity = DeviceName",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountDomain = InitiatingProcessAccountDomain, AccountName = InitiatingProcessAccountName, HostEntity = DeviceName",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "accountdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountDomain = InitiatingProcessAccountDomain, AccountName = InitiatingProcessAccountName, HostEntity = DeviceName",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountDomain = InitiatingProcessAccountDomain, AccountName = InitiatingProcessAccountName, HostEntity = DeviceName",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "hostentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventData = parse_xml(EventData).DataItem.EventData.Data",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "eventdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key=tostring(['@Name']), Value=['#text']",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "key",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key=tostring(['@Name']), Value=['#text']",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "value",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Type = strcat(Type, \": \", Source)",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, User, Process, ParentImage, CommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, User, Process, ParentImage, CommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, User, Process, ParentImage, CommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, User, Process, ParentImage, CommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "user",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, User, Process, ParentImage, CommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, User, Process, ParentImage, CommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "parentimage",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, User, Process, ParentImage, CommandLine",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountEntity = User, HostEntity = Computer",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountEntity = User, HostEntity = Computer",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "accountentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountEntity = User, HostEntity = Computer",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "hostentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(HostEntity, \".\")[0]), DomainIndex = toint(indexof(HostEntity, '.'))",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(HostEntity, \".\")[0]), DomainIndex = toint(indexof(HostEntity, '.'))",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(HostEntity, DomainIndex + 1), HostEntity)",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(AccountEntity, @'\\')[1]), AccountDomain = tostring(split(AccountEntity, @'\\')[0])",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(AccountEntity, @'\\')[1]), AccountDomain = tostring(split(AccountEntity, @'\\')[0])",
    "detection": "emailaccessviaactivesync.yaml",
    "field": "accountdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Domain = tolower(extract(\"([^.]*).{0,7}$\", 1, Domain))",
    "detection": "multivendor-possibledgacontacts.yaml",
    "field": "domain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AllTriGrams = array_concat(extract_all(\"(...)\", Domain), extract_all(\"(...)\", substring(Domain, 1)), extract_all(\"(...)\", substring(Domain, 2)))",
    "detection": "multivendor-possibledgacontacts.yaml",
    "field": "alltrigrams",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize triCount=count() by tostring(Trigram)",
    "detection": "multivendor-possibledgacontacts.yaml",
    "field": "tricount",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tolower(DestinationHostName)",
    "detection": "multivendor-possibledgacontacts.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DGADomain = extract(\"([^.]*).{0,7}$\", 1, Name)",
    "detection": "multivendor-possibledgacontacts.yaml",
    "field": "dgadomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AllTriGrams = array_concat(extract_all(\"(...)\", DGADomain), extract_all(\"(...)\", substring(DGADomain, 1)), extract_all(\"(...)\", substring(DGADomain, 2)));",
    "detection": "multivendor-possibledgacontacts.yaml",
    "field": "alltrigrams",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize count() by tostring(AllTriGrams), DGADomain",
    "detection": "multivendor-possibledgacontacts.yaml",
    "field": "dgadomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend Trigram = tostring(AllTriGrams)",
    "detection": "multivendor-possibledgacontacts.yaml",
    "field": "trigram",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend DestinationHostName = tolower(DestinationHostName)",
    "detection": "multivendor-possibledgacontacts.yaml",
    "field": "destinationhostname",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize StartTime=min(TimeGenerated), EndTime=max(TimeGenerated) by Name, SourceIP, DestinationIP, DataSource",
    "detection": "multivendor-possibledgacontacts.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize StartTime=min(TimeGenerated), EndTime=max(TimeGenerated) by Name, SourceIP, DestinationIP, DataSource",
    "detection": "multivendor-possibledgacontacts.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize StartTime=min(TimeGenerated), EndTime=max(TimeGenerated) by Name, SourceIP, DestinationIP, DataSource",
    "detection": "multivendor-possibledgacontacts.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize StartTime=min(TimeGenerated), EndTime=max(TimeGenerated) by Name, SourceIP, DestinationIP, DataSource",
    "detection": "multivendor-possibledgacontacts.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize StartTime=min(TimeGenerated), EndTime=max(TimeGenerated) by Name, SourceIP, DestinationIP, DataSource",
    "detection": "multivendor-possibledgacontacts.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize StartTime=min(TimeGenerated), EndTime=max(TimeGenerated) by Name, SourceIP, DestinationIP, DataSource",
    "detection": "multivendor-possibledgacontacts.yaml",
    "field": "datasource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Name, DGADomain, SourceIP, DestinationIP, DataSource",
    "detection": "multivendor-possibledgacontacts.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Name, DGADomain, SourceIP, DestinationIP, DataSource",
    "detection": "multivendor-possibledgacontacts.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Name, DGADomain, SourceIP, DestinationIP, DataSource",
    "detection": "multivendor-possibledgacontacts.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Name, DGADomain, SourceIP, DestinationIP, DataSource",
    "detection": "multivendor-possibledgacontacts.yaml",
    "field": "dgadomain",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Name, DGADomain, SourceIP, DestinationIP, DataSource",
    "detection": "multivendor-possibledgacontacts.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Name, DGADomain, SourceIP, DestinationIP, DataSource",
    "detection": "multivendor-possibledgacontacts.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Name, DGADomain, SourceIP, DestinationIP, DataSource",
    "detection": "multivendor-possibledgacontacts.yaml",
    "field": "datasource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AlertId, RemoteUrl",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "alertid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AlertId, RemoteUrl",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "remoteurl",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AlertId, NetworkMessageId",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "alertid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AlertId, NetworkMessageId",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "networkmessageid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project  UrlClickedByUserSid = RemoteUrl,",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "urlclickedbyusersid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceVendor, DeviceProduct, DeviceAction, DestinationDnsDomain, DestinationIP, RequestURL, SourceIP, SourceHostName, RequestClientApplication",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceVendor, DeviceProduct, DeviceAction, DestinationDnsDomain, DestinationIP, RequestURL, SourceIP, SourceHostName, RequestClientApplication",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "devicevendor",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceVendor, DeviceProduct, DeviceAction, DestinationDnsDomain, DestinationIP, RequestURL, SourceIP, SourceHostName, RequestClientApplication",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "deviceproduct",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceVendor, DeviceProduct, DeviceAction, DestinationDnsDomain, DestinationIP, RequestURL, SourceIP, SourceHostName, RequestClientApplication",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "deviceaction",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceVendor, DeviceProduct, DeviceAction, DestinationDnsDomain, DestinationIP, RequestURL, SourceIP, SourceHostName, RequestClientApplication",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "destinationdnsdomain",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceVendor, DeviceProduct, DeviceAction, DestinationDnsDomain, DestinationIP, RequestURL, SourceIP, SourceHostName, RequestClientApplication",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceVendor, DeviceProduct, DeviceAction, DestinationDnsDomain, DestinationIP, RequestURL, SourceIP, SourceHostName, RequestClientApplication",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "requesturl",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceVendor, DeviceProduct, DeviceAction, DestinationDnsDomain, DestinationIP, RequestURL, SourceIP, SourceHostName, RequestClientApplication",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceVendor, DeviceProduct, DeviceAction, DestinationDnsDomain, DestinationIP, RequestURL, SourceIP, SourceHostName, RequestClientApplication",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "sourcehostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceVendor, DeviceProduct, DeviceAction, DestinationDnsDomain, DestinationIP, RequestURL, SourceIP, SourceHostName, RequestClientApplication",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "requestclientapplication",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SrcIpAddr, SrcPortNumber, DstIpAddr, DstPortNumber, DstBytes, SrcBytes",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SrcIpAddr, SrcPortNumber, DstIpAddr, DstPortNumber, DstBytes, SrcBytes",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "srcipaddr",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SrcIpAddr, SrcPortNumber, DstIpAddr, DstPortNumber, DstBytes, SrcBytes",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "srcportnumber",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SrcIpAddr, SrcPortNumber, DstIpAddr, DstPortNumber, DstBytes, SrcBytes",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "dstipaddr",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SrcIpAddr, SrcPortNumber, DstIpAddr, DstPortNumber, DstBytes, SrcBytes",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "dstportnumber",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SrcIpAddr, SrcPortNumber, DstIpAddr, DstPortNumber, DstBytes, SrcBytes",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "dstbytes",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SrcIpAddr, SrcPortNumber, DstIpAddr, DstPortNumber, DstBytes, SrcBytes",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "srcbytes",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by TimeGenerated, RecipientEmailAddress, UrlClickedByUserSid, InitiatingProcessAccountUpn, InitiatingProcessAccountName, InitiatingProcessAccountDomain,",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by TimeGenerated, RecipientEmailAddress, UrlClickedByUserSid, InitiatingProcessAccountUpn, InitiatingProcessAccountName, InitiatingProcessAccountDomain,",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "recipientemailaddress",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by TimeGenerated, RecipientEmailAddress, UrlClickedByUserSid, InitiatingProcessAccountUpn, InitiatingProcessAccountName, InitiatingProcessAccountDomain,",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "urlclickedbyusersid",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by TimeGenerated, RecipientEmailAddress, UrlClickedByUserSid, InitiatingProcessAccountUpn, InitiatingProcessAccountName, InitiatingProcessAccountDomain,",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "initiatingprocessaccountupn",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by TimeGenerated, RecipientEmailAddress, UrlClickedByUserSid, InitiatingProcessAccountUpn, InitiatingProcessAccountName, InitiatingProcessAccountDomain,",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "initiatingprocessaccountname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by TimeGenerated, RecipientEmailAddress, UrlClickedByUserSid, InitiatingProcessAccountUpn, InitiatingProcessAccountName, InitiatingProcessAccountDomain,",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "initiatingprocessaccountdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(DeviceName, \".\")[0]), DomainIndex = toint(indexof(DeviceName, '.'))",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(DeviceName, \".\")[0]), DomainIndex = toint(indexof(DeviceName, '.'))",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(DeviceName, DomainIndex + 1), DeviceName)",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend RecipientEmailName = tostring(split(RecipientEmailAddress,'@',0)[0]), RecipientEmailUPNSuffix = tostring(split(RecipientEmailAddress,'@',1)[0])",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "recipientemailname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend RecipientEmailName = tostring(split(RecipientEmailAddress,'@',0)[0]), RecipientEmailUPNSuffix = tostring(split(RecipientEmailAddress,'@',1)[0])",
    "detection": "possiblephishingwithcsl-networksession.yaml",
    "field": "recipientemailupnsuffix",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "emailentity-azureactivity.yaml",
    "field": "latestindicatortime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "emailentity-azureactivity.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend Caller = tolower(Caller)",
    "detection": "emailentity-azureactivity.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend AzureActivity_TimeGenerated = TimeGenerated",
    "detection": "emailentity-azureactivity.yaml",
    "field": "azureactivity_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AzureActivity_TimeGenerated = arg_max(AzureActivity_TimeGenerated, *) by IndicatorId, Caller",
    "detection": "emailentity-azureactivity.yaml",
    "field": "azureactivity_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AzureActivity_TimeGenerated = arg_max(AzureActivity_TimeGenerated, *) by IndicatorId, Caller",
    "detection": "emailentity-azureactivity.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize AzureActivity_TimeGenerated = arg_max(AzureActivity_TimeGenerated, *) by IndicatorId, Caller",
    "detection": "emailentity-azureactivity.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AzureActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, Url, EmailSenderName, EmailRecipient,",
    "detection": "emailentity-azureactivity.yaml",
    "field": "azureactivity_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AzureActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, Url, EmailSenderName, EmailRecipient,",
    "detection": "emailentity-azureactivity.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AzureActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, Url, EmailSenderName, EmailRecipient,",
    "detection": "emailentity-azureactivity.yaml",
    "field": "activitygroupnames",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AzureActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, Url, EmailSenderName, EmailRecipient,",
    "detection": "emailentity-azureactivity.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AzureActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, Url, EmailSenderName, EmailRecipient,",
    "detection": "emailentity-azureactivity.yaml",
    "field": "threattype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AzureActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, Url, EmailSenderName, EmailRecipient,",
    "detection": "emailentity-azureactivity.yaml",
    "field": "expirationdatetime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AzureActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, Url, EmailSenderName, EmailRecipient,",
    "detection": "emailentity-azureactivity.yaml",
    "field": "confidencescore",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AzureActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, Url, EmailSenderName, EmailRecipient,",
    "detection": "emailentity-azureactivity.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AzureActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, Url, EmailSenderName, EmailRecipient,",
    "detection": "emailentity-azureactivity.yaml",
    "field": "emailsendername",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AzureActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, Url, EmailSenderName, EmailRecipient,",
    "detection": "emailentity-azureactivity.yaml",
    "field": "emailrecipient",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(Caller, '@', 0)[0]), UPNSuffix = tostring(split(Caller, '@', 1)[0])",
    "detection": "emailentity-azureactivity.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(Caller, '@', 0)[0]), UPNSuffix = tostring(split(Caller, '@', 1)[0])",
    "detection": "emailentity-azureactivity.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = AzureActivity_TimeGenerated",
    "detection": "emailentity-azureactivity.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": " | extend Account = SourceUserID, Computer = DeviceName, IPAddress =  DestinationIP",
    "detection": "bariumdomainioc112020.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": " | extend Account = SourceUserID, Computer = DeviceName, IPAddress =  DestinationIP",
    "detection": "bariumdomainioc112020.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": " | extend Account = SourceUserID, Computer = DeviceName, IPAddress =  DestinationIP",
    "detection": "bariumdomainioc112020.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": " | extend DNSName = Name",
    "detection": "bariumdomainioc112020.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": " | extend IPAddress =  ClientIP",
    "detection": "bariumdomainioc112020.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": " | extend DNSName = DnsQuery",
    "detection": "bariumdomainioc112020.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": " | extend IPAddress =  SrcIpAddr, Computer = Dvc",
    "detection": "bariumdomainioc112020.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": " | extend IPAddress =  SrcIpAddr, Computer = Dvc",
    "detection": "bariumdomainioc112020.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": " | extend IPAddress = RemoteIp",
    "detection": "bariumdomainioc112020.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": " | extend IPAddress = RemoteIP",
    "detection": "bariumdomainioc112020.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": " | extend Computer = DeviceName",
    "detection": "bariumdomainioc112020.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": " | extend DNSName = Request_Name",
    "detection": "bariumdomainioc112020.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": " | extend IPAddress = ClientIP",
    "detection": "bariumdomainioc112020.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": " | extend DNSName = DestinationHost",
    "detection": "bariumdomainioc112020.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": " | extend IPAddress = SourceHost",
    "detection": "bariumdomainioc112020.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": " | extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IPAddress",
    "detection": "bariumdomainioc112020.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": " | extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IPAddress",
    "detection": "bariumdomainioc112020.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": " | extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IPAddress",
    "detection": "bariumdomainioc112020.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": " | extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IPAddress",
    "detection": "bariumdomainioc112020.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize arg_max(TimeGenerated, *) by AccountUPN",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "accountupn",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize Roles = make_list(AssignedRoles) by AccountUPN = tolower(AccountUPN)",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "roles",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "        | extend UserPrincipalName = tolower(UserPrincipalName)",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, Roles = tostring(Roles)",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, Roles = tostring(Roles)",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, Roles = tostring(Roles)",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "roles",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize arg_max(TimeGenerated, *) by AccountUPN",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "accountupn",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize Roles = make_list(AssignedRoles) by AccountUPN = tolower(AccountUPN)",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "roles",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "        | extend UserPrincipalName = tolower(UserPrincipalName)",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, Roles = tostring(Roles)",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, Roles = tostring(Roles)",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, Roles = tostring(Roles)",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "roles",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize Successful_Logon_IPs=make_set(IPAddress) by AccountUPN, Roles",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "successful_logon_ips",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize Successful_Logon_IPs=make_set(IPAddress) by AccountUPN, Roles",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "accountupn",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize Successful_Logon_IPs=make_set(IPAddress) by AccountUPN, Roles",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "roles",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend AnomalyHour = TimeGenerated",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "anomalyhour",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project UserPrincipalName, Roles, AnomalyHour, TimeGenerated, HourlyCount, baseline, anomalies, score;",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project UserPrincipalName, Roles, AnomalyHour, TimeGenerated, HourlyCount, baseline, anomalies, score;",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "roles",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project UserPrincipalName, Roles, AnomalyHour, TimeGenerated, HourlyCount, baseline, anomalies, score;",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "anomalyhour",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project UserPrincipalName, Roles, AnomalyHour, TimeGenerated, HourlyCount, baseline, anomalies, score;",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project UserPrincipalName, Roles, AnomalyHour, TimeGenerated, HourlyCount, baseline, anomalies, score;",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "hourlycount",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project UserPrincipalName, Roles, AnomalyHour, TimeGenerated, HourlyCount, baseline, anomalies, score;",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "baseline",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project UserPrincipalName, Roles, AnomalyHour, TimeGenerated, HourlyCount, baseline, anomalies, score;",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "anomalies",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend DateHour = bin(TimeGenerated, 1h)",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "datehour",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize PartialFailedSignins = count(), LatestAnomalyTime = arg_max(TimeGenerated, *) by bin(TimeGenerated, 1h), OperationName, Category, ResultType, ResultDescription, UserPrincipalName, Roles, UserDisplayName, AppDisplayName, ClientAppUsed, IPAddress, ResourceDisplayName",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "partialfailedsignins",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize PartialFailedSignins = count(), LatestAnomalyTime = arg_max(TimeGenerated, *) by bin(TimeGenerated, 1h), OperationName, Category, ResultType, ResultDescription, UserPrincipalName, Roles, UserDisplayName, AppDisplayName, ClientAppUsed, IPAddress, ResourceDisplayName",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "latestanomalytime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize PartialFailedSignins = count(), LatestAnomalyTime = arg_max(TimeGenerated, *) by bin(TimeGenerated, 1h), OperationName, Category, ResultType, ResultDescription, UserPrincipalName, Roles, UserDisplayName, AppDisplayName, ClientAppUsed, IPAddress, ResourceDisplayName",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize PartialFailedSignins = count(), LatestAnomalyTime = arg_max(TimeGenerated, *) by bin(TimeGenerated, 1h), OperationName, Category, ResultType, ResultDescription, UserPrincipalName, Roles, UserDisplayName, AppDisplayName, ClientAppUsed, IPAddress, ResourceDisplayName",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "category",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize PartialFailedSignins = count(), LatestAnomalyTime = arg_max(TimeGenerated, *) by bin(TimeGenerated, 1h), OperationName, Category, ResultType, ResultDescription, UserPrincipalName, Roles, UserDisplayName, AppDisplayName, ClientAppUsed, IPAddress, ResourceDisplayName",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "resulttype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize PartialFailedSignins = count(), LatestAnomalyTime = arg_max(TimeGenerated, *) by bin(TimeGenerated, 1h), OperationName, Category, ResultType, ResultDescription, UserPrincipalName, Roles, UserDisplayName, AppDisplayName, ClientAppUsed, IPAddress, ResourceDisplayName",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "resultdescription",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize PartialFailedSignins = count(), LatestAnomalyTime = arg_max(TimeGenerated, *) by bin(TimeGenerated, 1h), OperationName, Category, ResultType, ResultDescription, UserPrincipalName, Roles, UserDisplayName, AppDisplayName, ClientAppUsed, IPAddress, ResourceDisplayName",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize PartialFailedSignins = count(), LatestAnomalyTime = arg_max(TimeGenerated, *) by bin(TimeGenerated, 1h), OperationName, Category, ResultType, ResultDescription, UserPrincipalName, Roles, UserDisplayName, AppDisplayName, ClientAppUsed, IPAddress, ResourceDisplayName",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "roles",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize PartialFailedSignins = count(), LatestAnomalyTime = arg_max(TimeGenerated, *) by bin(TimeGenerated, 1h), OperationName, Category, ResultType, ResultDescription, UserPrincipalName, Roles, UserDisplayName, AppDisplayName, ClientAppUsed, IPAddress, ResourceDisplayName",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "userdisplayname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize PartialFailedSignins = count(), LatestAnomalyTime = arg_max(TimeGenerated, *) by bin(TimeGenerated, 1h), OperationName, Category, ResultType, ResultDescription, UserPrincipalName, Roles, UserDisplayName, AppDisplayName, ClientAppUsed, IPAddress, ResourceDisplayName",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize PartialFailedSignins = count(), LatestAnomalyTime = arg_max(TimeGenerated, *) by bin(TimeGenerated, 1h), OperationName, Category, ResultType, ResultDescription, UserPrincipalName, Roles, UserDisplayName, AppDisplayName, ClientAppUsed, IPAddress, ResourceDisplayName",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "clientappused",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize PartialFailedSignins = count(), LatestAnomalyTime = arg_max(TimeGenerated, *) by bin(TimeGenerated, 1h), OperationName, Category, ResultType, ResultDescription, UserPrincipalName, Roles, UserDisplayName, AppDisplayName, ClientAppUsed, IPAddress, ResourceDisplayName",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize PartialFailedSignins = count(), LatestAnomalyTime = arg_max(TimeGenerated, *) by bin(TimeGenerated, 1h), OperationName, Category, ResultType, ResultDescription, UserPrincipalName, Roles, UserDisplayName, AppDisplayName, ClientAppUsed, IPAddress, ResourceDisplayName",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "resourcedisplayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, Roles = todynamic(Roles), UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = HourlyCount, baseline, anomalies, score",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "latestanomalytime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, Roles = todynamic(Roles), UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = HourlyCount, baseline, anomalies, score",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "operationname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, Roles = todynamic(Roles), UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = HourlyCount, baseline, anomalies, score",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "category",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, Roles = todynamic(Roles), UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = HourlyCount, baseline, anomalies, score",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, Roles = todynamic(Roles), UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = HourlyCount, baseline, anomalies, score",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "roles",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, Roles = todynamic(Roles), UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = HourlyCount, baseline, anomalies, score",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "userdisplayname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, Roles = todynamic(Roles), UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = HourlyCount, baseline, anomalies, score",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "resulttype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, Roles = todynamic(Roles), UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = HourlyCount, baseline, anomalies, score",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "resultdescription",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, Roles = todynamic(Roles), UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = HourlyCount, baseline, anomalies, score",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, Roles = todynamic(Roles), UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = HourlyCount, baseline, anomalies, score",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "clientappused",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, Roles = todynamic(Roles), UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = HourlyCount, baseline, anomalies, score",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, Roles = todynamic(Roles), UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = HourlyCount, baseline, anomalies, score",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, Roles = todynamic(Roles), UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = HourlyCount, baseline, anomalies, score",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "location",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, Roles = todynamic(Roles), UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = HourlyCount, baseline, anomalies, score",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "authenticationrequirement",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, Roles = todynamic(Roles), UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = HourlyCount, baseline, anomalies, score",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "conditionalaccessstatus",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, Roles = todynamic(Roles), UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = HourlyCount, baseline, anomalies, score",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "resourcedisplayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, Roles = todynamic(Roles), UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = HourlyCount, baseline, anomalies, score",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "partialfailedsignins",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, Roles = todynamic(Roles), UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = HourlyCount, baseline, anomalies, score",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "totalfailedsignins",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, Roles = todynamic(Roles), UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = HourlyCount, baseline, anomalies, score",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "baseline",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, Roles = todynamic(Roles), UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = HourlyCount, baseline, anomalies, score",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "anomalies",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestAnomalyTime, OperationName, Category, UserPrincipalName, Roles = todynamic(Roles), UserDisplayName, ResultType, ResultDescription, AppDisplayName, ClientAppUsed, UserAgent, IPAddress, Location, AuthenticationRequirement, ConditionalAccessStatus, ResourceDisplayName, PartialFailedSignins, TotalFailedSignins = HourlyCount, baseline, anomalies, score",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "score",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = LatestAnomalyTime, Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = LatestAnomalyTime, Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = LatestAnomalyTime, Name = tostring(split(UserPrincipalName,'@',0)[0]), UPNSuffix = tostring(split(UserPrincipalName,'@',1)[0])",
    "detection": "privilegedaccountssigninfailurespikesfromunknownip.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectUserSid = tostring(EventData.SubjectUserSid)",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "subjectusersid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetUserName = tostring(EventData.TargetUserName)",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = strcat(tostring(EventData.SubjectDomainName),\"\\\\\", tostring(EventData.SubjectUserName))",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountType=case(Account endswith \"$\" or SubjectUserSid in (\"S-1-5-18\", \"S-1-5-19\", \"S-1-5-20\"), \"Machine\", isempty(SubjectUserSid), \"\", \"User\")",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "      | extend AccountType = tostring(TargetResource.type),",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountType = UserType, Account = OfficeObjectId",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountType = UserType, Account = OfficeObjectId",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountType = iif(SyslogMessage contains \"root\", \"Root\", \"Non-Root\")",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, AccountType, Account, Type, TargetUserName;",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, AccountType, Account, Type, TargetUserName;",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, AccountType, Account, Type, TargetUserName;",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, AccountType, Account, Type, TargetUserName;",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, AccountType, Account, Type, TargetUserName;",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Computerlist = make_set(Computer, 25), AccountType = make_set(AccountType, 25), Computer = arg_max(Computer , TimeGenerated), TargetUserList = make_set(TargetUserName, 25), TargetUserName = arg_max(TargetUserName, TimeGenerated), Total=count() by Account, Type",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Computerlist = make_set(Computer, 25), AccountType = make_set(AccountType, 25), Computer = arg_max(Computer , TimeGenerated), TargetUserList = make_set(TargetUserName, 25), TargetUserName = arg_max(TargetUserName, TimeGenerated), Total=count() by Account, Type",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Computerlist = make_set(Computer, 25), AccountType = make_set(AccountType, 25), Computer = arg_max(Computer , TimeGenerated), TargetUserList = make_set(TargetUserName, 25), TargetUserName = arg_max(TargetUserName, TimeGenerated), Total=count() by Account, Type",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "computerlist",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Computerlist = make_set(Computer, 25), AccountType = make_set(AccountType, 25), Computer = arg_max(Computer , TimeGenerated), TargetUserList = make_set(TargetUserName, 25), TargetUserName = arg_max(TargetUserName, TimeGenerated), Total=count() by Account, Type",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Computerlist = make_set(Computer, 25), AccountType = make_set(AccountType, 25), Computer = arg_max(Computer , TimeGenerated), TargetUserList = make_set(TargetUserName, 25), TargetUserName = arg_max(TargetUserName, TimeGenerated), Total=count() by Account, Type",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Computerlist = make_set(Computer, 25), AccountType = make_set(AccountType, 25), Computer = arg_max(Computer , TimeGenerated), TargetUserList = make_set(TargetUserName, 25), TargetUserName = arg_max(TargetUserName, TimeGenerated), Total=count() by Account, Type",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "targetuserlist",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Computerlist = make_set(Computer, 25), AccountType = make_set(AccountType, 25), Computer = arg_max(Computer , TimeGenerated), TargetUserList = make_set(TargetUserName, 25), TargetUserName = arg_max(TargetUserName, TimeGenerated), Total=count() by Account, Type",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Computerlist = make_set(Computer, 25), AccountType = make_set(AccountType, 25), Computer = arg_max(Computer , TimeGenerated), TargetUserList = make_set(TargetUserName, 25), TargetUserName = arg_max(TargetUserName, TimeGenerated), Total=count() by Account, Type",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "total",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Computerlist = make_set(Computer, 25), AccountType = make_set(AccountType, 25), Computer = arg_max(Computer , TimeGenerated), TargetUserList = make_set(TargetUserName, 25), TargetUserName = arg_max(TargetUserName, TimeGenerated), Total=count() by Account, Type",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), Computerlist = make_set(Computer, 25), AccountType = make_set(AccountType, 25), Computer = arg_max(Computer , TimeGenerated), TargetUserList = make_set(TargetUserName, 25), TargetUserName = arg_max(TargetUserName, TimeGenerated), Total=count() by Account, Type",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ResetPivot = \"PerUserReset\"),",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "resetpivot",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ComputerList = make_set(Computer, 25), AccountList = make_set(Account, 25), AccountType = make_set(AccountType, 25), Computer = arg_max(Computer , TimeGenerated), TargetUserList = make_set(TargetUserName, 25), TargetUserName = arg_max(TargetUserName, TimeGenerated), Total=count() by Type",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ComputerList = make_set(Computer, 25), AccountList = make_set(Account, 25), AccountType = make_set(AccountType, 25), Computer = arg_max(Computer , TimeGenerated), TargetUserList = make_set(TargetUserName, 25), TargetUserName = arg_max(TargetUserName, TimeGenerated), Total=count() by Type",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ComputerList = make_set(Computer, 25), AccountList = make_set(Account, 25), AccountType = make_set(AccountType, 25), Computer = arg_max(Computer , TimeGenerated), TargetUserList = make_set(TargetUserName, 25), TargetUserName = arg_max(TargetUserName, TimeGenerated), Total=count() by Type",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "computerlist",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ComputerList = make_set(Computer, 25), AccountList = make_set(Account, 25), AccountType = make_set(AccountType, 25), Computer = arg_max(Computer , TimeGenerated), TargetUserList = make_set(TargetUserName, 25), TargetUserName = arg_max(TargetUserName, TimeGenerated), Total=count() by Type",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "accountlist",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ComputerList = make_set(Computer, 25), AccountList = make_set(Account, 25), AccountType = make_set(AccountType, 25), Computer = arg_max(Computer , TimeGenerated), TargetUserList = make_set(TargetUserName, 25), TargetUserName = arg_max(TargetUserName, TimeGenerated), Total=count() by Type",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ComputerList = make_set(Computer, 25), AccountList = make_set(Account, 25), AccountType = make_set(AccountType, 25), Computer = arg_max(Computer , TimeGenerated), TargetUserList = make_set(TargetUserName, 25), TargetUserName = arg_max(TargetUserName, TimeGenerated), Total=count() by Type",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ComputerList = make_set(Computer, 25), AccountList = make_set(Account, 25), AccountType = make_set(AccountType, 25), Computer = arg_max(Computer , TimeGenerated), TargetUserList = make_set(TargetUserName, 25), TargetUserName = arg_max(TargetUserName, TimeGenerated), Total=count() by Type",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "targetuserlist",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ComputerList = make_set(Computer, 25), AccountList = make_set(Account, 25), AccountType = make_set(AccountType, 25), Computer = arg_max(Computer , TimeGenerated), TargetUserList = make_set(TargetUserName, 25), TargetUserName = arg_max(TargetUserName, TimeGenerated), Total=count() by Type",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ComputerList = make_set(Computer, 25), AccountList = make_set(Account, 25), AccountType = make_set(AccountType, 25), Computer = arg_max(Computer , TimeGenerated), TargetUserList = make_set(TargetUserName, 25), TargetUserName = arg_max(TargetUserName, TimeGenerated), Total=count() by Type",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "total",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), ComputerList = make_set(Computer, 25), AccountList = make_set(Account, 25), AccountType = make_set(AccountType, 25), Computer = arg_max(Computer , TimeGenerated), TargetUserList = make_set(TargetUserName, 25), TargetUserName = arg_max(TargetUserName, TimeGenerated), Total=count() by Type",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ResetPivot = \"TotalUserReset\")",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "resetpivot",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, HostName = tostring(split(Computer, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.')), Name = tostring(split(Account, '@', 0)[0]), UPNSuffix = tostring(split(Account, '@', 1)[0]), TargetName = tostring(split(TargetUserName,'@',0)[0]), TargetUPNSuffix = tostring(split(TargetUserName,'@',1)[0])",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, HostName = tostring(split(Computer, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.')), Name = tostring(split(Account, '@', 0)[0]), UPNSuffix = tostring(split(Account, '@', 1)[0]), TargetName = tostring(split(TargetUserName,'@',0)[0]), TargetUPNSuffix = tostring(split(TargetUserName,'@',1)[0])",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, HostName = tostring(split(Computer, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.')), Name = tostring(split(Account, '@', 0)[0]), UPNSuffix = tostring(split(Account, '@', 1)[0]), TargetName = tostring(split(TargetUserName,'@',0)[0]), TargetUPNSuffix = tostring(split(TargetUserName,'@',1)[0])",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, HostName = tostring(split(Computer, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.')), Name = tostring(split(Account, '@', 0)[0]), UPNSuffix = tostring(split(Account, '@', 1)[0]), TargetName = tostring(split(TargetUserName,'@',0)[0]), TargetUPNSuffix = tostring(split(TargetUserName,'@',1)[0])",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, HostName = tostring(split(Computer, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.')), Name = tostring(split(Account, '@', 0)[0]), UPNSuffix = tostring(split(Account, '@', 1)[0]), TargetName = tostring(split(TargetUserName,'@',0)[0]), TargetUPNSuffix = tostring(split(TargetUserName,'@',1)[0])",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, HostName = tostring(split(Computer, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.')), Name = tostring(split(Account, '@', 0)[0]), UPNSuffix = tostring(split(Account, '@', 1)[0]), TargetName = tostring(split(TargetUserName,'@',0)[0]), TargetUPNSuffix = tostring(split(TargetUserName,'@',1)[0])",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "targetname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, HostName = tostring(split(Computer, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.')), Name = tostring(split(Account, '@', 0)[0]), UPNSuffix = tostring(split(Account, '@', 1)[0]), TargetName = tostring(split(TargetUserName,'@',0)[0]), TargetUPNSuffix = tostring(split(TargetUserName,'@',1)[0])",
    "detection": "multiplepasswordresetsbyuser.yaml",
    "field": "targetupnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SimpleMemberName = iff(MemberName == \"-\", MemberName, substring(MemberName, 3, indexof_regex(MemberName, @\",OU|,CN\") - 3))",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "simplemembername",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventID, Activity, Computer, SimpleMemberName, MemberName, MemberSid, TargetAccount, TargetUserName, TargetDomainName, TargetSid, UserPrincipalName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventID, Activity, Computer, SimpleMemberName, MemberName, MemberSid, TargetAccount, TargetUserName, TargetDomainName, TargetSid, UserPrincipalName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventID, Activity, Computer, SimpleMemberName, MemberName, MemberSid, TargetAccount, TargetUserName, TargetDomainName, TargetSid, UserPrincipalName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventID, Activity, Computer, SimpleMemberName, MemberName, MemberSid, TargetAccount, TargetUserName, TargetDomainName, TargetSid, UserPrincipalName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventID, Activity, Computer, SimpleMemberName, MemberName, MemberSid, TargetAccount, TargetUserName, TargetDomainName, TargetSid, UserPrincipalName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "simplemembername",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventID, Activity, Computer, SimpleMemberName, MemberName, MemberSid, TargetAccount, TargetUserName, TargetDomainName, TargetSid, UserPrincipalName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "membername",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventID, Activity, Computer, SimpleMemberName, MemberName, MemberSid, TargetAccount, TargetUserName, TargetDomainName, TargetSid, UserPrincipalName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "membersid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventID, Activity, Computer, SimpleMemberName, MemberName, MemberSid, TargetAccount, TargetUserName, TargetDomainName, TargetSid, UserPrincipalName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "targetaccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventID, Activity, Computer, SimpleMemberName, MemberName, MemberSid, TargetAccount, TargetUserName, TargetDomainName, TargetSid, UserPrincipalName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventID, Activity, Computer, SimpleMemberName, MemberName, MemberSid, TargetAccount, TargetUserName, TargetDomainName, TargetSid, UserPrincipalName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "targetdomainname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventID, Activity, Computer, SimpleMemberName, MemberName, MemberSid, TargetAccount, TargetUserName, TargetDomainName, TargetSid, UserPrincipalName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "targetsid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventID, Activity, Computer, SimpleMemberName, MemberName, MemberSid, TargetAccount, TargetUserName, TargetDomainName, TargetSid, UserPrincipalName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectUserSid = tostring(EventData.SubjectUserSid)",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "subjectusersid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account =  strcat(tostring(EventData.SubjectDomainName),\"\\\\\", tostring(EventData.SubjectUserName))",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountType=case(Account endswith \"$\" or SubjectUserSid in (\"S-1-5-18\", \"S-1-5-19\", \"S-1-5-20\"), \"Machine\", isempty(SubjectUserSid), \"\", \"User\")",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend MemberName = tostring(EventData.MemberName)",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "membername",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetSid = tostring(EventData.TargetSid)",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "targetsid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SimpleMemberName = iff(MemberName == \"-\", MemberName, substring(MemberName, 3, indexof_regex(MemberName, @\",OU|,CN\") - 3))",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "simplemembername",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend MemberSid = tostring(EventData.MemberSid)",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "membersid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetUserName = tostring(EventData.TargetUserName), TargetDomainName = tostring(EventData.TargetDomainName),",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetUserName = tostring(EventData.TargetUserName), TargetDomainName = tostring(EventData.TargetDomainName),",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "targetdomainname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserPrincipalName = tostring(EventData.UserPrincipalName)",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectUserName = tostring(EventData.SubjectUserName), SubjectDomainName = tostring(EventData.SubjectDomainName),",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectUserName = tostring(EventData.SubjectUserName), SubjectDomainName = tostring(EventData.SubjectDomainName),",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventID, Computer, SimpleMemberName, MemberName, MemberSid, TargetAccount, TargetUserName, TargetDomainName, TargetSid, UserPrincipalName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventID, Computer, SimpleMemberName, MemberName, MemberSid, TargetAccount, TargetUserName, TargetDomainName, TargetSid, UserPrincipalName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventID, Computer, SimpleMemberName, MemberName, MemberSid, TargetAccount, TargetUserName, TargetDomainName, TargetSid, UserPrincipalName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventID, Computer, SimpleMemberName, MemberName, MemberSid, TargetAccount, TargetUserName, TargetDomainName, TargetSid, UserPrincipalName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "simplemembername",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventID, Computer, SimpleMemberName, MemberName, MemberSid, TargetAccount, TargetUserName, TargetDomainName, TargetSid, UserPrincipalName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "membername",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventID, Computer, SimpleMemberName, MemberName, MemberSid, TargetAccount, TargetUserName, TargetDomainName, TargetSid, UserPrincipalName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "membersid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventID, Computer, SimpleMemberName, MemberName, MemberSid, TargetAccount, TargetUserName, TargetDomainName, TargetSid, UserPrincipalName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "targetaccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventID, Computer, SimpleMemberName, MemberName, MemberSid, TargetAccount, TargetUserName, TargetDomainName, TargetSid, UserPrincipalName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventID, Computer, SimpleMemberName, MemberName, MemberSid, TargetAccount, TargetUserName, TargetDomainName, TargetSid, UserPrincipalName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "targetdomainname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventID, Computer, SimpleMemberName, MemberName, MemberSid, TargetAccount, TargetUserName, TargetDomainName, TargetSid, UserPrincipalName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "targetsid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventID, Computer, SimpleMemberName, MemberName, MemberSid, TargetAccount, TargetUserName, TargetDomainName, TargetSid, UserPrincipalName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend GroupAddedMemberTo = TargetAccount, AddedByAccount = SubjectAccount, AddedByAccountName = SubjectUserName, AddedByAccountDomainName = SubjectDomainName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "groupaddedmemberto",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend GroupAddedMemberTo = TargetAccount, AddedByAccount = SubjectAccount, AddedByAccountName = SubjectUserName, AddedByAccountDomainName = SubjectDomainName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "addedbyaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend GroupAddedMemberTo = TargetAccount, AddedByAccount = SubjectAccount, AddedByAccountName = SubjectUserName, AddedByAccountDomainName = SubjectDomainName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "addedbyaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend GroupAddedMemberTo = TargetAccount, AddedByAccount = SubjectAccount, AddedByAccountName = SubjectUserName, AddedByAccountDomainName = SubjectDomainName,",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "addedbyaccountdomainname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "useraccountaddedtoprivlegegroup-1h.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "  | extend ClientIPValues = extract_all(@'\\[?(::ffff:)?(?P<IPAddress>(\\d+\\.\\d+\\.\\d+\\.\\d+)|[^\\]%]+)(%\\d+)?\\]?([-:](?P<Port>\\d+))?', dynamic([\"IPAddress\", \"Port\"]), ClientIP)[0]",
    "detection": "ipentity-officeactivity.yaml",
    "field": "clientipvalues",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend IPAddress = iff(array_length(ClientIPValues) > 0, tostring(ClientIPValues[0]), '')",
    "detection": "ipentity-officeactivity.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TI_ipEntity = coalesce(NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress)",
    "detection": "ipentity-officeactivity.yaml",
    "field": "ti_ipentity",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "ipentity-officeactivity.yaml",
    "field": "latestindicatortime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "ipentity-officeactivity.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize OfficeActivity_TimeGenerated = arg_max(OfficeActivity_TimeGenerated, *) by IndicatorId",
    "detection": "ipentity-officeactivity.yaml",
    "field": "officeactivity_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize OfficeActivity_TimeGenerated = arg_max(OfficeActivity_TimeGenerated, *) by IndicatorId",
    "detection": "ipentity-officeactivity.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, ClientIP, UserId, Operation, ResultStatus, RecordType, OfficeObjectId, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-officeactivity.yaml",
    "field": "officeactivity_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, ClientIP, UserId, Operation, ResultStatus, RecordType, OfficeObjectId, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-officeactivity.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, ClientIP, UserId, Operation, ResultStatus, RecordType, OfficeObjectId, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-officeactivity.yaml",
    "field": "activitygroupnames",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, ClientIP, UserId, Operation, ResultStatus, RecordType, OfficeObjectId, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-officeactivity.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, ClientIP, UserId, Operation, ResultStatus, RecordType, OfficeObjectId, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-officeactivity.yaml",
    "field": "threattype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, ClientIP, UserId, Operation, ResultStatus, RecordType, OfficeObjectId, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-officeactivity.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, ClientIP, UserId, Operation, ResultStatus, RecordType, OfficeObjectId, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-officeactivity.yaml",
    "field": "expirationdatetime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, ClientIP, UserId, Operation, ResultStatus, RecordType, OfficeObjectId, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-officeactivity.yaml",
    "field": "confidencescore",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, ClientIP, UserId, Operation, ResultStatus, RecordType, OfficeObjectId, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-officeactivity.yaml",
    "field": "ti_ipentity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, ClientIP, UserId, Operation, ResultStatus, RecordType, OfficeObjectId, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-officeactivity.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, ClientIP, UserId, Operation, ResultStatus, RecordType, OfficeObjectId, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-officeactivity.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, ClientIP, UserId, Operation, ResultStatus, RecordType, OfficeObjectId, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-officeactivity.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, ClientIP, UserId, Operation, ResultStatus, RecordType, OfficeObjectId, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-officeactivity.yaml",
    "field": "resultstatus",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, ClientIP, UserId, Operation, ResultStatus, RecordType, OfficeObjectId, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-officeactivity.yaml",
    "field": "recordtype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, ClientIP, UserId, Operation, ResultStatus, RecordType, OfficeObjectId, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-officeactivity.yaml",
    "field": "officeobjectid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, ClientIP, UserId, Operation, ResultStatus, RecordType, OfficeObjectId, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-officeactivity.yaml",
    "field": "networkip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, ClientIP, UserId, Operation, ResultStatus, RecordType, OfficeObjectId, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-officeactivity.yaml",
    "field": "networkdestinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, ClientIP, UserId, Operation, ResultStatus, RecordType, OfficeObjectId, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-officeactivity.yaml",
    "field": "networksourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, ClientIP, UserId, Operation, ResultStatus, RecordType, OfficeObjectId, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-officeactivity.yaml",
    "field": "emailsourceipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, ClientIP, UserId, Operation, ResultStatus, RecordType, OfficeObjectId, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-officeactivity.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = OfficeActivity_TimeGenerated, Name = tostring(split(UserId, '@', 0)[0]), UPNSuffix = tostring(split(UserId, '@', 1)[0])",
    "detection": "ipentity-officeactivity.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = OfficeActivity_TimeGenerated, Name = tostring(split(UserId, '@', 0)[0]), UPNSuffix = tostring(split(UserId, '@', 1)[0])",
    "detection": "ipentity-officeactivity.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = OfficeActivity_TimeGenerated, Name = tostring(split(UserId, '@', 0)[0]), UPNSuffix = tostring(split(UserId, '@', 1)[0])",
    "detection": "ipentity-officeactivity.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by BuildParentProcess=ParentProcessName, BuildProcess=Process, BuildAccount = Account, Computer, BuildCommand=CommandLine, timekey= bin(TimeGenerated, time_window), BuildProcessTime=TimeGenerated",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "buildprocess",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by BuildParentProcess=ParentProcessName, BuildProcess=Process, BuildAccount = Account, Computer, BuildCommand=CommandLine, timekey= bin(TimeGenerated, time_window), BuildProcessTime=TimeGenerated",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "buildaccount",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by BuildParentProcess=ParentProcessName, BuildProcess=Process, BuildAccount = Account, Computer, BuildCommand=CommandLine, timekey= bin(TimeGenerated, time_window), BuildProcessTime=TimeGenerated",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "buildcommand",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by BuildParentProcess=ParentProcessName, BuildProcess=Process, BuildAccount = Account, Computer, BuildCommand=CommandLine, timekey= bin(TimeGenerated, time_window), BuildProcessTime=TimeGenerated",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "timekey",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by BuildParentProcess=ParentProcessName, BuildProcess=Process, BuildAccount = Account, Computer, BuildCommand=CommandLine, timekey= bin(TimeGenerated, time_window), BuildProcessTime=TimeGenerated",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "buildprocesstime",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by FileEditParentProcess=ParentProcessName, FileEditAccount = Account, Computer, FileEdited=ObjectName, FileEditProcess=ProcessName, timekey= bin(TimeGenerated, time_window), FileEditTime=TimeGenerated)",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "fileeditaccount",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by FileEditParentProcess=ParentProcessName, FileEditAccount = Account, Computer, FileEdited=ObjectName, FileEditProcess=ProcessName, timekey= bin(TimeGenerated, time_window), FileEditTime=TimeGenerated)",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "fileedited",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by FileEditParentProcess=ParentProcessName, FileEditAccount = Account, Computer, FileEdited=ObjectName, FileEditProcess=ProcessName, timekey= bin(TimeGenerated, time_window), FileEditTime=TimeGenerated)",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "fileeditprocess",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by FileEditParentProcess=ParentProcessName, FileEditAccount = Account, Computer, FileEdited=ObjectName, FileEditProcess=ProcessName, timekey= bin(TimeGenerated, time_window), FileEditTime=TimeGenerated)",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "timekey",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize make_set(FileEdited), make_set(FileEditProcess), make_set(FileEditAccount) by timekey, Computer, BuildParentProcess, BuildProcess",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "timekey",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize make_set(FileEdited), make_set(FileEditProcess), make_set(FileEditAccount) by timekey, Computer, BuildParentProcess, BuildProcess",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize make_set(FileEdited), make_set(FileEditProcess), make_set(FileEditAccount) by timekey, Computer, BuildParentProcess, BuildProcess",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "buildparentprocess",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize make_set(FileEdited), make_set(FileEditProcess), make_set(FileEditAccount) by timekey, Computer, BuildParentProcess, BuildProcess",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "buildprocess",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend NewProcessName = tostring(EventData.NewProcessName)",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Process=tostring(split(NewProcessName, '\\\\')[-1])",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend ParentProcessName = tostring(EventData.ParentProcessName)",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account =  strcat(tostring(EventData.SubjectDomainName),\"\\\\\", tostring(EventData.SubjectUserName))",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend CommandLine = tostring(EventData.CommandLine)",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by BuildParentProcess=ParentProcessName, BuildProcess=Process, BuildAccount = Account, Computer, BuildCommand=CommandLine, timekey= bin(TimeGenerated, time_window), BuildProcessTime=TimeGenerated",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "buildprocess",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by BuildParentProcess=ParentProcessName, BuildProcess=Process, BuildAccount = Account, Computer, BuildCommand=CommandLine, timekey= bin(TimeGenerated, time_window), BuildProcessTime=TimeGenerated",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "buildaccount",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by BuildParentProcess=ParentProcessName, BuildProcess=Process, BuildAccount = Account, Computer, BuildCommand=CommandLine, timekey= bin(TimeGenerated, time_window), BuildProcessTime=TimeGenerated",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "buildcommand",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by BuildParentProcess=ParentProcessName, BuildProcess=Process, BuildAccount = Account, Computer, BuildCommand=CommandLine, timekey= bin(TimeGenerated, time_window), BuildProcessTime=TimeGenerated",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "timekey",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by BuildParentProcess=ParentProcessName, BuildProcess=Process, BuildAccount = Account, Computer, BuildCommand=CommandLine, timekey= bin(TimeGenerated, time_window), BuildProcessTime=TimeGenerated",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "buildprocesstime",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend NewProcessName = tostring(EventData.NewProcessName)",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Process=tostring(split(NewProcessName, '\\\\')[-1])",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend ObjectName = tostring(EventData.ObjectName)",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "objectname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccessMask = tostring(EventData.AccessMask)",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "accessmask",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ParentProcessName = tostring(EventData.ParentProcessName)",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account =  strcat(tostring(EventData.SubjectDomainName),\"\\\\\", tostring(EventData.SubjectUserName))",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend ProcessName = tostring(EventData.ProcessName)",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by FileEditParentProcess=ParentProcessName, FileEditAccount = Account, Computer, FileEdited=ObjectName, FileEditProcess=ProcessName, timekey= bin(TimeGenerated, time_window), FileEditTime=TimeGenerated)",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "fileeditaccount",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by FileEditParentProcess=ParentProcessName, FileEditAccount = Account, Computer, FileEdited=ObjectName, FileEditProcess=ProcessName, timekey= bin(TimeGenerated, time_window), FileEditTime=TimeGenerated)",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "fileedited",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by FileEditParentProcess=ParentProcessName, FileEditAccount = Account, Computer, FileEdited=ObjectName, FileEditProcess=ProcessName, timekey= bin(TimeGenerated, time_window), FileEditTime=TimeGenerated)",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "fileeditprocess",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by FileEditParentProcess=ParentProcessName, FileEditAccount = Account, Computer, FileEdited=ObjectName, FileEditProcess=ProcessName, timekey= bin(TimeGenerated, time_window), FileEditTime=TimeGenerated)",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "timekey",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize make_set(FileEdited), make_set(FileEditProcess), make_set(FileEditAccount) by timekey, Computer, BuildParentProcess, BuildProcess",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "timekey",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize make_set(FileEdited), make_set(FileEditProcess), make_set(FileEditAccount) by timekey, Computer, BuildParentProcess, BuildProcess",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize make_set(FileEdited), make_set(FileEditProcess), make_set(FileEditAccount) by timekey, Computer, BuildParentProcess, BuildProcess",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "buildparentprocess",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize make_set(FileEdited), make_set(FileEditProcess), make_set(FileEditAccount) by timekey, Computer, BuildParentProcess, BuildProcess",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "buildprocess",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "potentialbuildprocesscompromise.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventData = parse_xml(EventData).DataItem.EventData.Data",
    "detection": "solorigatenamedpipe.yaml",
    "field": "eventdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key = tostring(column_ifexists('@Name', \"\")), Value = column_ifexists('#text', \"\")",
    "detection": "solorigatenamedpipe.yaml",
    "field": "key",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key = tostring(column_ifexists('@Name', \"\")), Value = column_ifexists('#text', \"\")",
    "detection": "solorigatenamedpipe.yaml",
    "field": "value",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend PipeName = column_ifexists(\"PipeName\", \"\")",
    "detection": "solorigatenamedpipe.yaml",
    "field": "pipename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = User",
    "detection": "solorigatenamedpipe.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(User, @\"\\\")[1]), AccountNTDomain = tostring(split(User, @\"\\\")[0])",
    "detection": "solorigatenamedpipe.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(User, @\"\\\")[1]), AccountNTDomain = tostring(split(User, @\"\\\")[0])",
    "detection": "solorigatenamedpipe.yaml",
    "field": "accountntdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = SubjectUserName, AccountNTDomain = SubjectDomainName",
    "detection": "solorigatenamedpipe.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = SubjectUserName, AccountNTDomain = SubjectDomainName",
    "detection": "solorigatenamedpipe.yaml",
    "field": "accountntdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccessList= tostring(EventData.AccessList)",
    "detection": "solorigatenamedpipe.yaml",
    "field": "accesslist",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend RelativeTargetName= tostring(EventData.RelativeTargetName)",
    "detection": "solorigatenamedpipe.yaml",
    "field": "relativetargetname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account =  strcat(tostring(EventData.SubjectDomainName),\"\\\\\", tostring(EventData.SubjectUserName))",
    "detection": "solorigatenamedpipe.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(EventData.SubjectUserName), AccountNTDomain = tostring(EventData.SubjectDomainName)",
    "detection": "solorigatenamedpipe.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(EventData.SubjectUserName), AccountNTDomain = tostring(EventData.SubjectDomainName)",
    "detection": "solorigatenamedpipe.yaml",
    "field": "accountntdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "solorigatenamedpipe.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "solorigatenamedpipe.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "solorigatenamedpipe.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Count=count() by SrcIpAddr, bin(TimeGenerated,5m)",
    "detection": "excessivehttpfailuresfromsource.yaml",
    "field": "count",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Count=count() by SrcIpAddr, bin(TimeGenerated,5m)",
    "detection": "excessivehttpfailuresfromsource.yaml",
    "field": "srcipaddr",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, threshold",
    "detection": "excessivehttpfailuresfromsource.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project GroupAddTime = TimeGenerated, GroupAddEventID = EventID, GroupAddActivity = Activity, GroupAddComputer = Computer,",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "groupaddtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project GroupAddTime = TimeGenerated, GroupAddEventID = EventID, GroupAddActivity = Activity, GroupAddComputer = Computer,",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "groupaddeventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project GroupAddTime = TimeGenerated, GroupAddEventID = EventID, GroupAddActivity = Activity, GroupAddComputer = Computer,",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "groupaddactivity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project GroupAddTime = TimeGenerated, GroupAddEventID = EventID, GroupAddActivity = Activity, GroupAddComputer = Computer,",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "groupaddcomputer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectUserSid = tostring(EventData.SubjectUserSid)",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "subjectusersid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = strcat(tostring(EventData.SubjectDomainName),\"\\\\\", tostring(EventData.SubjectUserName))",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountType=case(Account endswith \"$\" or SubjectUserSid in (\"S-1-5-18\", \"S-1-5-19\", \"S-1-5-20\"), \"Machine\", isempty(SubjectUserSid), \"\", \"User\")",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend MemberName = tostring(EventData.MemberName)",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "membername",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetSid = tostring(EventData.TargetSid)",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "targetsid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetAccount = strcat(EventData.TargetDomainName,\"\\\\\", EventData.TargetUserName)",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "targetaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend MemberSid = tostring(EventData.MemberSid)",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "membersid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Activity= \"GroupAddActivity\"",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project GroupAddTime = TimeGenerated, GroupAddEventID = EventID, GroupAddActivity = Activity, GroupAddComputer = Computer,",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "groupaddtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project GroupAddTime = TimeGenerated, GroupAddEventID = EventID, GroupAddActivity = Activity, GroupAddComputer = Computer,",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "groupaddeventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project GroupAddTime = TimeGenerated, GroupAddEventID = EventID, GroupAddActivity = Activity, GroupAddComputer = Computer,",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "groupaddactivity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project GroupAddTime = TimeGenerated, GroupAddEventID = EventID, GroupAddActivity = Activity, GroupAddComputer = Computer,",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "groupaddcomputer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project GroupCreateTime = TimeGenerated, GroupCreateEventID = EventID, GroupCreateActivity = Activity, GroupCreateComputer = Computer,",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "groupcreatetime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project GroupCreateTime = TimeGenerated, GroupCreateEventID = EventID, GroupCreateActivity = Activity, GroupCreateComputer = Computer,",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "groupcreateeventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project GroupCreateTime = TimeGenerated, GroupCreateEventID = EventID, GroupCreateActivity = Activity, GroupCreateComputer = Computer,",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "groupcreateactivity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project GroupCreateTime = TimeGenerated, GroupCreateEventID = EventID, GroupCreateActivity = Activity, GroupCreateComputer = Computer,",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "groupcreatecomputer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectUserSid = tostring(EventData.SubjectUserSid)",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "subjectusersid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = strcat(tostring(EventData.SubjectDomainName),\"\\\\\", tostring(EventData.SubjectUserName))",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountType=case(Account endswith \"$\", \"Machine\", iff(SubjectUserSid in (\"S-1-5-18\", \"S-1-5-19\", \"S-1-5-20\"), \"Machine\", iff(isempty(SubjectUserSid), \"\", \"User\")))",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetAccount = strcat(EventData.TargetDomainName,\"\\\\\", EventData.TargetUserName)",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "targetaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectAccount = strcat(EventData.SubjectDomainName,\"\\\\\", EventData.SubjectUserName)",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "subjectaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetSid = tostring(EventData.TargetSid)",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "targetsid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Activity= \"GroupAddActivity\"",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project GroupCreateTime = TimeGenerated, GroupCreateEventID = EventID, GroupCreateActivity = Activity, GroupCreateComputer = Computer,",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "groupcreatetime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project GroupCreateTime = TimeGenerated, GroupCreateEventID = EventID, GroupCreateActivity = Activity, GroupCreateComputer = Computer,",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "groupcreateeventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project GroupCreateTime = TimeGenerated, GroupCreateEventID = EventID, GroupCreateActivity = Activity, GroupCreateComputer = Computer,",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "groupcreateactivity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project GroupCreateTime = TimeGenerated, GroupCreateEventID = EventID, GroupCreateActivity = Activity, GroupCreateComputer = Computer,",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "groupcreatecomputer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend GroupCreateHostName = tostring(split(GroupCreateComputer , \".\")[0]), DomainIndex = toint(indexof(GroupCreateComputer , '.'))",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "groupcreatehostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend GroupCreateHostName = tostring(split(GroupCreateComputer , \".\")[0]), DomainIndex = toint(indexof(GroupCreateComputer , '.'))",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend GroupCreateHostNameDomain = iff(DomainIndex != -1, substring(GroupCreateComputer , DomainIndex + 1), GroupCreateComputer)",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "groupcreatehostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend GroupAddHostName = tostring(split(GroupAddComputer , \".\")[0]), DomainIndex = toint(indexof(GroupAddComputer , '.'))",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "groupaddhostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend GroupAddHostName = tostring(split(GroupAddComputer , \".\")[0]), DomainIndex = toint(indexof(GroupAddComputer , '.'))",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend GroupAddHostNameDomain = iff(DomainIndex != -1, substring(GroupAddComputer , DomainIndex + 1), GroupAddComputer)",
    "detection": "groupcreatedaddedtoprivlegegroup-1h.yaml",
    "field": "groupaddhostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend MessageIP = extract(IPRegex, 0, Message)",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "messageip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case(SourceIP in (IPList), \"SourceIP\", DestinationIP in (IPList), \"DestinationIP\", MessageIP in (IPList), \"Message\", RequestURL in (domains), \"RequestUrl\", SourceIP in (ips), \"SourceIP\", DestinationIP in (ips), \"DestinationIP\", MessageIP in (IPList), \"Message\", \"NoMatch\")",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, IPMatch == \"Message\", MessageIP, \"NoMatch\"), AccountCustomEntity = SourceUserID",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, IPMatch == \"Message\", MessageIP, \"NoMatch\"), AccountCustomEntity = SourceUserID",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, IPMatch == \"Message\", MessageIP, \"NoMatch\"), AccountCustomEntity = SourceUserID",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = IPAddresses, DNSName = Name, Host = Computer",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "destinationipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = IPAddresses, DNSName = Name, Host = Computer",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = IPAddresses, DNSName = Name, Host = Computer",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "host",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIPAddress, HostCustomEntity = Host",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIPAddress, HostCustomEntity = Host",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIPAddress, HostCustomEntity = Host",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case( SourceIp in (IPList), \"SourceIP\", DestinationIp in (IPList), \"DestinationIP\",  SourceIp in (ips), \"SourceIP\", DestinationIp in (ips), \"DestinationIP\", \"None\")",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIp, IPMatch == \"DestinationIP\", DestinationIp, \"NoMatch\"), HostCustomEntity = Computer",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIp, IPMatch == \"DestinationIP\", DestinationIp, \"NoMatch\"), HostCustomEntity = Computer",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIp, IPMatch == \"DestinationIP\", DestinationIp, \"NoMatch\"), HostCustomEntity = Computer",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend EvData = parse_xml(EventData)",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "evdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventDetail = EvData.DataItem.EventData.Data",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = EventDetail.[9].[\"#text\"], DestinationIP = EventDetail.[14].[\"#text\"]",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = EventDetail.[9].[\"#text\"], DestinationIP = EventDetail.[14].[\"#text\"]",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case( SourceIP in (IPList), \"SourceIP\", DestinationIP in (IPList), \"DestinationIP\", \"None\")",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = ClientIP, AccountCustomEntity = UserId",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = ClientIP, AccountCustomEntity = UserId",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = ClientIP, AccountCustomEntity = UserId",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = RemoteUrl, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = RemoteUrl, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = RemoteUrl, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = RemoteUrl, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case( SourceIP in (IPList), \"SourceIP\", DestinationIP in (IPList), \"DestinationIP\", SourceIP in (ips), \"SourceIP\", DestinationIP in (ips), \"DestinationIP\", \"None\")",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = Request_Name, IPCustomEntity = ClientIP",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = Request_Name, IPCustomEntity = ClientIP",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = Request_Name, IPCustomEntity = ClientIP",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = DestinationHost, IPCustomEntity = SourceHost",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = DestinationHost, IPCustomEntity = SourceHost",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = DestinationHost, IPCustomEntity = SourceHost",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend EvData = parse_xml(EventData)",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "evdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventDetail = EvData.DataItem.EventData.Data",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Type = strcat(Type, \": \", Source), Account = UserName, FileHash = SHA256",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Type = strcat(Type, \": \", Source), Account = UserName, FileHash = SHA256",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Type = strcat(Type, \": \", Source), Account = UserName, FileHash = SHA256",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, FileHash",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, FileHash",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, FileHash",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, FileHash",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, FileHash",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = RequestAccountName, Computer = DeviceName, IPAddress = RequestSourceIP, CommandLine = InitiatingProcessCommandLine, FileHash = SHA256",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = RequestAccountName, Computer = DeviceName, IPAddress = RequestSourceIP, CommandLine = InitiatingProcessCommandLine, FileHash = SHA256",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = RequestAccountName, Computer = DeviceName, IPAddress = RequestSourceIP, CommandLine = InitiatingProcessCommandLine, FileHash = SHA256",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = RequestAccountName, Computer = DeviceName, IPAddress = RequestSourceIP, CommandLine = InitiatingProcessCommandLine, FileHash = SHA256",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = RequestAccountName, Computer = DeviceName, IPAddress = RequestSourceIP, CommandLine = InitiatingProcessCommandLine, FileHash = SHA256",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "nobelium-iocsmay2021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventID4722Time = TimeGenerated",
    "detection": "password-not-set.yaml",
    "field": "eventid4722time",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Time_Event4722 = TimeGenerated, TargetAccount, TargetSid, SubjectAccount_Event4722 = SubjectAccount, SubjectUserSid_Event4722 = SubjectUserSid, Activity_4722 = Activity, Computer_4722 = Computer;",
    "detection": "password-not-set.yaml",
    "field": "time_event4722",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Time_Event4722 = TimeGenerated, TargetAccount, TargetSid, SubjectAccount_Event4722 = SubjectAccount, SubjectUserSid_Event4722 = SubjectUserSid, Activity_4722 = Activity, Computer_4722 = Computer;",
    "detection": "password-not-set.yaml",
    "field": "targetaccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Time_Event4722 = TimeGenerated, TargetAccount, TargetSid, SubjectAccount_Event4722 = SubjectAccount, SubjectUserSid_Event4722 = SubjectUserSid, Activity_4722 = Activity, Computer_4722 = Computer;",
    "detection": "password-not-set.yaml",
    "field": "targetsid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Time_Event4722 = TimeGenerated, TargetAccount, TargetSid, SubjectAccount_Event4722 = SubjectAccount, SubjectUserSid_Event4722 = SubjectUserSid, Activity_4722 = Activity, Computer_4722 = Computer;",
    "detection": "password-not-set.yaml",
    "field": "subjectaccount_event4722",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Time_Event4722 = TimeGenerated, TargetAccount, TargetSid, SubjectAccount_Event4722 = SubjectAccount, SubjectUserSid_Event4722 = SubjectUserSid, Activity_4722 = Activity, Computer_4722 = Computer;",
    "detection": "password-not-set.yaml",
    "field": "subjectusersid_event4722",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Time_Event4722 = TimeGenerated, TargetAccount, TargetSid, SubjectAccount_Event4722 = SubjectAccount, SubjectUserSid_Event4722 = SubjectUserSid, Activity_4722 = Activity, Computer_4722 = Computer;",
    "detection": "password-not-set.yaml",
    "field": "activity_4722",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Time_Event4722 = TimeGenerated, TargetAccount, TargetSid, SubjectAccount_Event4722 = SubjectAccount, SubjectUserSid_Event4722 = SubjectUserSid, Activity_4722 = Activity, Computer_4722 = Computer;",
    "detection": "password-not-set.yaml",
    "field": "computer_4722",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project Time_Event4723 = TimeGenerated, TargetAccount, TargetSid, SubjectAccount_Event4723 = SubjectAccount, SubjectUserSid_Event4723 = SubjectUserSid, Activity_4723 = Activity, Computer_4723 = Computer;",
    "detection": "password-not-set.yaml",
    "field": "time_event4723",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Time_Event4723 = TimeGenerated, TargetAccount, TargetSid, SubjectAccount_Event4723 = SubjectAccount, SubjectUserSid_Event4723 = SubjectUserSid, Activity_4723 = Activity, Computer_4723 = Computer;",
    "detection": "password-not-set.yaml",
    "field": "targetaccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Time_Event4723 = TimeGenerated, TargetAccount, TargetSid, SubjectAccount_Event4723 = SubjectAccount, SubjectUserSid_Event4723 = SubjectUserSid, Activity_4723 = Activity, Computer_4723 = Computer;",
    "detection": "password-not-set.yaml",
    "field": "targetsid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Time_Event4723 = TimeGenerated, TargetAccount, TargetSid, SubjectAccount_Event4723 = SubjectAccount, SubjectUserSid_Event4723 = SubjectUserSid, Activity_4723 = Activity, Computer_4723 = Computer;",
    "detection": "password-not-set.yaml",
    "field": "subjectaccount_event4723",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Time_Event4723 = TimeGenerated, TargetAccount, TargetSid, SubjectAccount_Event4723 = SubjectAccount, SubjectUserSid_Event4723 = SubjectUserSid, Activity_4723 = Activity, Computer_4723 = Computer;",
    "detection": "password-not-set.yaml",
    "field": "subjectusersid_event4723",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Time_Event4723 = TimeGenerated, TargetAccount, TargetSid, SubjectAccount_Event4723 = SubjectAccount, SubjectUserSid_Event4723 = SubjectUserSid, Activity_4723 = Activity, Computer_4723 = Computer;",
    "detection": "password-not-set.yaml",
    "field": "activity_4723",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Time_Event4723 = TimeGenerated, TargetAccount, TargetSid, SubjectAccount_Event4723 = SubjectAccount, SubjectUserSid_Event4723 = SubjectUserSid, Activity_4723 = Activity, Computer_4723 = Computer;",
    "detection": "password-not-set.yaml",
    "field": "computer_4723",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend PasswordSetAttemptDelta_Min = datetime_diff('minute', Time_Event4723, Time_Event4722)",
    "detection": "password-not-set.yaml",
    "field": "passwordsetattemptdelta_min",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Reason = @\"User either has not yet attempted to set the initial password after account was enabled or it occurred after 48 hours\"",
    "detection": "password-not-set.yaml",
    "field": "reason",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Computer = coalesce(Computer_4723, Computer_4722)",
    "detection": "password-not-set.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "password-not-set.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "password-not-set.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "password-not-set.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(TargetAccount, \"\\\\\")[1]), AccountNTDomain = tostring(split(TargetAccount, \"\\\\\")[0])",
    "detection": "password-not-set.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(TargetAccount, \"\\\\\")[1]), AccountNTDomain = tostring(split(TargetAccount, \"\\\\\")[0])",
    "detection": "password-not-set.yaml",
    "field": "accountntdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, Process, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousscriptregistrywrite.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, Process, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousscriptregistrywrite.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, Process, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousscriptregistrywrite.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, Process, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousscriptregistrywrite.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, Process, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousscriptregistrywrite.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, Process, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousscriptregistrywrite.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, Process, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousscriptregistrywrite.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, Process, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousscriptregistrywrite.yaml",
    "field": "_resourceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend CommandLine = tostring(EventData.CommandLine)",
    "detection": "nobelium-suspiciousscriptregistrywrite.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account =  strcat(EventData.SubjectDomainName,\"\\\\\", EventData.SubjectUserName)",
    "detection": "nobelium-suspiciousscriptregistrywrite.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend NewProcessName = tostring(EventData.NewProcessName)",
    "detection": "nobelium-suspiciousscriptregistrywrite.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Process=tostring(split(NewProcessName, '\\\\')[-1])",
    "detection": "nobelium-suspiciousscriptregistrywrite.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend ParentProcessName = tostring(EventData.ParentProcessName)",
    "detection": "nobelium-suspiciousscriptregistrywrite.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(Account, \"\\\\\")[1]), NTDomain = tostring(split(Account, \"\\\\\")[0])",
    "detection": "nobelium-suspiciousscriptregistrywrite.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(Account, \"\\\\\")[1]), NTDomain = tostring(split(Account, \"\\\\\")[0])",
    "detection": "nobelium-suspiciousscriptregistrywrite.yaml",
    "field": "ntdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.')), HostName = tostring(split(Computer, '.', 0)[0]))",
    "detection": "nobelium-suspiciousscriptregistrywrite.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.')), HostName = tostring(split(Computer, '.', 0)[0]))",
    "detection": "nobelium-suspiciousscriptregistrywrite.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), max(CallerIpAddress), make_list(ActivityStatusValue) by CorrelationId, Authorization, Caller",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), max(CallerIpAddress), make_list(ActivityStatusValue) by CorrelationId, Authorization, Caller",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), max(CallerIpAddress), make_list(ActivityStatusValue) by CorrelationId, Authorization, Caller",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), max(CallerIpAddress), make_list(ActivityStatusValue) by CorrelationId, Authorization, Caller",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "authorization",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), max(CallerIpAddress), make_list(ActivityStatusValue) by CorrelationId, Authorization, Caller",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Authorization_d = parse_json(Authorization)",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "authorization_d",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Scope = Authorization_d.scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "scope",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Scope_s = split(Scope, \"/\")",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "scope_s",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Subscription = tostring(Scope_s[2])",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "subscription",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend VirtualMachineName = tostring(Scope_s[-1])",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "virtualmachinename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Subscription, VirtualMachineName, CorrelationId, Caller, CallerIpAddress=max_CallerIpAddress, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Subscription, VirtualMachineName, CorrelationId, Caller, CallerIpAddress=max_CallerIpAddress, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Subscription, VirtualMachineName, CorrelationId, Caller, CallerIpAddress=max_CallerIpAddress, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "subscription",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Subscription, VirtualMachineName, CorrelationId, Caller, CallerIpAddress=max_CallerIpAddress, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "virtualmachinename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Subscription, VirtualMachineName, CorrelationId, Caller, CallerIpAddress=max_CallerIpAddress, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Subscription, VirtualMachineName, CorrelationId, Caller, CallerIpAddress=max_CallerIpAddress, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Subscription, VirtualMachineName, CorrelationId, Caller, CallerIpAddress=max_CallerIpAddress, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "calleripaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, Subscription, VirtualMachineName, CorrelationId, Caller, CallerIpAddress=max_CallerIpAddress, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "scope",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend VirtualMachineName = tostring(split(DeviceName, \".\")[0])",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "virtualmachinename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project VirtualMachineName, PowershellFileCreatedTimestamp=TimeGenerated, FileName, FileSize, InitiatingProcessAccountName, InitiatingProcessAccountDomain, InitiatingProcessFolderPath, InitiatingProcessId",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "virtualmachinename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project VirtualMachineName, PowershellFileCreatedTimestamp=TimeGenerated, FileName, FileSize, InitiatingProcessAccountName, InitiatingProcessAccountDomain, InitiatingProcessFolderPath, InitiatingProcessId",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "powershellfilecreatedtimestamp",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "    | project VirtualMachineName, PowershellFileCreatedTimestamp=TimeGenerated, FileName, FileSize, InitiatingProcessAccountName, InitiatingProcessAccountDomain, InitiatingProcessFolderPath, InitiatingProcessId",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "filename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "    | project VirtualMachineName, PowershellFileCreatedTimestamp=TimeGenerated, FileName, FileSize, InitiatingProcessAccountName, InitiatingProcessAccountDomain, InitiatingProcessFolderPath, InitiatingProcessId",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "filesize",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "    | project VirtualMachineName, PowershellFileCreatedTimestamp=TimeGenerated, FileName, FileSize, InitiatingProcessAccountName, InitiatingProcessAccountDomain, InitiatingProcessFolderPath, InitiatingProcessId",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "initiatingprocessaccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project VirtualMachineName, PowershellFileCreatedTimestamp=TimeGenerated, FileName, FileSize, InitiatingProcessAccountName, InitiatingProcessAccountDomain, InitiatingProcessFolderPath, InitiatingProcessId",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "initiatingprocessaccountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project VirtualMachineName, PowershellFileCreatedTimestamp=TimeGenerated, FileName, FileSize, InitiatingProcessAccountName, InitiatingProcessAccountDomain, InitiatingProcessFolderPath, InitiatingProcessId",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "initiatingprocessfolderpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "    | project VirtualMachineName, PowershellFileCreatedTimestamp=TimeGenerated, FileName, FileSize, InitiatingProcessAccountName, InitiatingProcessAccountDomain, InitiatingProcessFolderPath, InitiatingProcessId",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "initiatingprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, PowershellFileCreatedTimestamp, VirtualMachineName, Caller, CallerIpAddress, FileName, FileSize, InitiatingProcessId, InitiatingProcessAccountDomain, InitiatingProcessFolderPath, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, PowershellFileCreatedTimestamp, VirtualMachineName, Caller, CallerIpAddress, FileName, FileSize, InitiatingProcessId, InitiatingProcessAccountDomain, InitiatingProcessFolderPath, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, PowershellFileCreatedTimestamp, VirtualMachineName, Caller, CallerIpAddress, FileName, FileSize, InitiatingProcessId, InitiatingProcessAccountDomain, InitiatingProcessFolderPath, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "powershellfilecreatedtimestamp",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, PowershellFileCreatedTimestamp, VirtualMachineName, Caller, CallerIpAddress, FileName, FileSize, InitiatingProcessId, InitiatingProcessAccountDomain, InitiatingProcessFolderPath, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "virtualmachinename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, PowershellFileCreatedTimestamp, VirtualMachineName, Caller, CallerIpAddress, FileName, FileSize, InitiatingProcessId, InitiatingProcessAccountDomain, InitiatingProcessFolderPath, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, PowershellFileCreatedTimestamp, VirtualMachineName, Caller, CallerIpAddress, FileName, FileSize, InitiatingProcessId, InitiatingProcessAccountDomain, InitiatingProcessFolderPath, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "calleripaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, PowershellFileCreatedTimestamp, VirtualMachineName, Caller, CallerIpAddress, FileName, FileSize, InitiatingProcessId, InitiatingProcessAccountDomain, InitiatingProcessFolderPath, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "filename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, PowershellFileCreatedTimestamp, VirtualMachineName, Caller, CallerIpAddress, FileName, FileSize, InitiatingProcessId, InitiatingProcessAccountDomain, InitiatingProcessFolderPath, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "filesize",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, PowershellFileCreatedTimestamp, VirtualMachineName, Caller, CallerIpAddress, FileName, FileSize, InitiatingProcessId, InitiatingProcessAccountDomain, InitiatingProcessFolderPath, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "initiatingprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, PowershellFileCreatedTimestamp, VirtualMachineName, Caller, CallerIpAddress, FileName, FileSize, InitiatingProcessId, InitiatingProcessAccountDomain, InitiatingProcessFolderPath, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "initiatingprocessaccountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, PowershellFileCreatedTimestamp, VirtualMachineName, Caller, CallerIpAddress, FileName, FileSize, InitiatingProcessId, InitiatingProcessAccountDomain, InitiatingProcessFolderPath, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "initiatingprocessfolderpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, PowershellFileCreatedTimestamp, VirtualMachineName, Caller, CallerIpAddress, FileName, FileSize, InitiatingProcessId, InitiatingProcessAccountDomain, InitiatingProcessFolderPath, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "scope",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend VirtualMachineName = tostring(split(DeviceName, \".\")[0])",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "virtualmachinename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend PowershellFileName = extract(@\"\\-File\\s(script[0-9]{1,9}\\.ps1)\", 1, InitiatingProcessCommandLine)",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "powershellfilename",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "    | extend PSCommand = tostring(parse_json(AdditionalFields).Command)",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "pscommand",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "    | extend PSCommand = toupper(PSCommand)",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "pscommand",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize PowershellExecStartTime=min(TimeGenerated), PowershellExecEnd=max(TimeGenerated), make_list(PSCommand) by PowershellFileName, InitiatingProcessCommandLine",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "powershellexecstarttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize PowershellExecStartTime=min(TimeGenerated), PowershellExecEnd=max(TimeGenerated), make_list(PSCommand) by PowershellFileName, InitiatingProcessCommandLine",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "powershellexecend",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize PowershellExecStartTime=min(TimeGenerated), PowershellExecEnd=max(TimeGenerated), make_list(PSCommand) by PowershellFileName, InitiatingProcessCommandLine",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "powershellfilename",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize PowershellExecStartTime=min(TimeGenerated), PowershellExecEnd=max(TimeGenerated), make_list(PSCommand) by PowershellFileName, InitiatingProcessCommandLine",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "initiatingprocesscommandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, PowershellFileCreatedTimestamp, PowershellExecStartTime, PowershellExecEnd, PowershellFileName, PowershellScriptCommands=list_PSCommand, Caller, CallerIpAddress, InitiatingProcessCommandLine, PowershellFileSize=FileSize, VirtualMachineName, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, PowershellFileCreatedTimestamp, PowershellExecStartTime, PowershellExecEnd, PowershellFileName, PowershellScriptCommands=list_PSCommand, Caller, CallerIpAddress, InitiatingProcessCommandLine, PowershellFileSize=FileSize, VirtualMachineName, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, PowershellFileCreatedTimestamp, PowershellExecStartTime, PowershellExecEnd, PowershellFileName, PowershellScriptCommands=list_PSCommand, Caller, CallerIpAddress, InitiatingProcessCommandLine, PowershellFileSize=FileSize, VirtualMachineName, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "powershellfilecreatedtimestamp",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, PowershellFileCreatedTimestamp, PowershellExecStartTime, PowershellExecEnd, PowershellFileName, PowershellScriptCommands=list_PSCommand, Caller, CallerIpAddress, InitiatingProcessCommandLine, PowershellFileSize=FileSize, VirtualMachineName, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "powershellexecstarttime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, PowershellFileCreatedTimestamp, PowershellExecStartTime, PowershellExecEnd, PowershellFileName, PowershellScriptCommands=list_PSCommand, Caller, CallerIpAddress, InitiatingProcessCommandLine, PowershellFileSize=FileSize, VirtualMachineName, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "powershellexecend",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, PowershellFileCreatedTimestamp, PowershellExecStartTime, PowershellExecEnd, PowershellFileName, PowershellScriptCommands=list_PSCommand, Caller, CallerIpAddress, InitiatingProcessCommandLine, PowershellFileSize=FileSize, VirtualMachineName, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "powershellfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, PowershellFileCreatedTimestamp, PowershellExecStartTime, PowershellExecEnd, PowershellFileName, PowershellScriptCommands=list_PSCommand, Caller, CallerIpAddress, InitiatingProcessCommandLine, PowershellFileSize=FileSize, VirtualMachineName, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "powershellscriptcommands",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, PowershellFileCreatedTimestamp, PowershellExecStartTime, PowershellExecEnd, PowershellFileName, PowershellScriptCommands=list_PSCommand, Caller, CallerIpAddress, InitiatingProcessCommandLine, PowershellFileSize=FileSize, VirtualMachineName, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, PowershellFileCreatedTimestamp, PowershellExecStartTime, PowershellExecEnd, PowershellFileName, PowershellScriptCommands=list_PSCommand, Caller, CallerIpAddress, InitiatingProcessCommandLine, PowershellFileSize=FileSize, VirtualMachineName, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "calleripaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, PowershellFileCreatedTimestamp, PowershellExecStartTime, PowershellExecEnd, PowershellFileName, PowershellScriptCommands=list_PSCommand, Caller, CallerIpAddress, InitiatingProcessCommandLine, PowershellFileSize=FileSize, VirtualMachineName, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "initiatingprocesscommandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, PowershellFileCreatedTimestamp, PowershellExecStartTime, PowershellExecEnd, PowershellFileName, PowershellScriptCommands=list_PSCommand, Caller, CallerIpAddress, InitiatingProcessCommandLine, PowershellFileSize=FileSize, VirtualMachineName, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "powershellfilesize",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, PowershellFileCreatedTimestamp, PowershellExecStartTime, PowershellExecEnd, PowershellFileName, PowershellScriptCommands=list_PSCommand, Caller, CallerIpAddress, InitiatingProcessCommandLine, PowershellFileSize=FileSize, VirtualMachineName, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "virtualmachinename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, PowershellFileCreatedTimestamp, PowershellExecStartTime, PowershellExecEnd, PowershellFileName, PowershellScriptCommands=list_PSCommand, Caller, CallerIpAddress, InitiatingProcessCommandLine, PowershellFileSize=FileSize, VirtualMachineName, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "scope",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TempFingerprintString = strcat(PowershellScriptCommands, PowershellFileSize)",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "tempfingerprintstring",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ScriptFingerprintHash = hash_sha256(tostring(PowershellScriptCommands)));",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "scriptfingerprinthash",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HashCount=count() by ScriptFingerprintHash;",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "hashcount",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Prevalence = toreal(HashCount) / toreal(totals) * 100",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "prevalence",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTime",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend CallerName = tostring(split(Caller, \"@\")[0]), CallerUPNSuffix = tostring(split(Caller, \"@\")[1])",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "callername",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend CallerName = tostring(split(Caller, \"@\")[0]), CallerUPNSuffix = tostring(split(Caller, \"@\")[1])",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "callerupnsuffix",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, StartTime, EndTime, PowershellFileName, VirtualMachineName, Caller, CallerName, CallerUPNSuffix, CallerIpAddress, PowershellScriptCommands, PowershellFileSize, ScriptFingerprintHash, Prevalence, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, StartTime, EndTime, PowershellFileName, VirtualMachineName, Caller, CallerName, CallerUPNSuffix, CallerIpAddress, PowershellScriptCommands, PowershellFileSize, ScriptFingerprintHash, Prevalence, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, StartTime, EndTime, PowershellFileName, VirtualMachineName, Caller, CallerName, CallerUPNSuffix, CallerIpAddress, PowershellScriptCommands, PowershellFileSize, ScriptFingerprintHash, Prevalence, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, StartTime, EndTime, PowershellFileName, VirtualMachineName, Caller, CallerName, CallerUPNSuffix, CallerIpAddress, PowershellScriptCommands, PowershellFileSize, ScriptFingerprintHash, Prevalence, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "powershellfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, StartTime, EndTime, PowershellFileName, VirtualMachineName, Caller, CallerName, CallerUPNSuffix, CallerIpAddress, PowershellScriptCommands, PowershellFileSize, ScriptFingerprintHash, Prevalence, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "virtualmachinename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, StartTime, EndTime, PowershellFileName, VirtualMachineName, Caller, CallerName, CallerUPNSuffix, CallerIpAddress, PowershellScriptCommands, PowershellFileSize, ScriptFingerprintHash, Prevalence, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, StartTime, EndTime, PowershellFileName, VirtualMachineName, Caller, CallerName, CallerUPNSuffix, CallerIpAddress, PowershellScriptCommands, PowershellFileSize, ScriptFingerprintHash, Prevalence, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "callername",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, StartTime, EndTime, PowershellFileName, VirtualMachineName, Caller, CallerName, CallerUPNSuffix, CallerIpAddress, PowershellScriptCommands, PowershellFileSize, ScriptFingerprintHash, Prevalence, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "callerupnsuffix",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, StartTime, EndTime, PowershellFileName, VirtualMachineName, Caller, CallerName, CallerUPNSuffix, CallerIpAddress, PowershellScriptCommands, PowershellFileSize, ScriptFingerprintHash, Prevalence, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "calleripaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, StartTime, EndTime, PowershellFileName, VirtualMachineName, Caller, CallerName, CallerUPNSuffix, CallerIpAddress, PowershellScriptCommands, PowershellFileSize, ScriptFingerprintHash, Prevalence, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "powershellscriptcommands",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, StartTime, EndTime, PowershellFileName, VirtualMachineName, Caller, CallerName, CallerUPNSuffix, CallerIpAddress, PowershellScriptCommands, PowershellFileSize, ScriptFingerprintHash, Prevalence, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "powershellfilesize",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, StartTime, EndTime, PowershellFileName, VirtualMachineName, Caller, CallerName, CallerUPNSuffix, CallerIpAddress, PowershellScriptCommands, PowershellFileSize, ScriptFingerprintHash, Prevalence, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "scriptfingerprinthash",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, StartTime, EndTime, PowershellFileName, VirtualMachineName, Caller, CallerName, CallerUPNSuffix, CallerIpAddress, PowershellScriptCommands, PowershellFileSize, ScriptFingerprintHash, Prevalence, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "prevalence",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp, StartTime, EndTime, PowershellFileName, VirtualMachineName, Caller, CallerName, CallerUPNSuffix, CallerIpAddress, PowershellScriptCommands, PowershellFileSize, ScriptFingerprintHash, Prevalence, Scope",
    "detection": "rareruncommandpowershellscript.yaml",
    "field": "scope",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), ConnectionCount = count()",
    "detection": "rdp-rareconnection.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), ConnectionCount = count()",
    "detection": "rdp-rareconnection.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), ConnectionCount = count()",
    "detection": "rdp-rareconnection.yaml",
    "field": "connectioncount",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend LogonType = tostring(EventData.LogonType)",
    "detection": "rdp-rareconnection.yaml",
    "field": "logontype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = strcat(tostring(EventData.TargetDomainName),\"\\\\\", tostring(EventData.TargetUserName))",
    "detection": "rdp-rareconnection.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend ProcessName = tostring(EventData.ProcessName)",
    "detection": "rdp-rareconnection.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend IpAddress = tostring(EventData.IpAddress)",
    "detection": "rdp-rareconnection.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetUserSid = tostring(EventData.TargetUserSid)",
    "detection": "rdp-rareconnection.yaml",
    "field": "targetusersid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountType=case(Account endswith \"$\" or TargetUserSid in (\"S-1-5-18\", \"S-1-5-19\", \"S-1-5-20\"), \"Machine\", isempty(TargetUserSid), \"\", \"User\")",
    "detection": "rdp-rareconnection.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Activity=\"4624 - An account was successfully logged on.\"",
    "detection": "rdp-rareconnection.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend LogonTypeName=\"10 - RemoteInteractive\"",
    "detection": "rdp-rareconnection.yaml",
    "field": "logontypename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), ConnectionCount = count()",
    "detection": "rdp-rareconnection.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), ConnectionCount = count()",
    "detection": "rdp-rareconnection.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), ConnectionCount = count()",
    "detection": "rdp-rareconnection.yaml",
    "field": "connectioncount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by Computer = toupper(Computer), IpAddress, Account = tolower(Account)",
    "detection": "rdp-rareconnection.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend IpAddress = tostring(EventData.IpAddress)",
    "detection": "rdp-rareconnection.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = strcat(tostring(EventData.TargetDomainName),\"\\\\\", tostring(EventData.TargetUserName))",
    "detection": "rdp-rareconnection.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize by Computer = toupper(Computer), IpAddress, Account = tolower(Account)",
    "detection": "rdp-rareconnection.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(StartTime), EndTime = max(EndTime), ConnectionCount = sum(ConnectionCount)",
    "detection": "rdp-rareconnection.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(StartTime), EndTime = max(EndTime), ConnectionCount = sum(ConnectionCount)",
    "detection": "rdp-rareconnection.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(StartTime), EndTime = max(EndTime), ConnectionCount = sum(ConnectionCount)",
    "detection": "rdp-rareconnection.yaml",
    "field": "connectioncount",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "rdp-rareconnection.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "rdp-rareconnection.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "rdp-rareconnection.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Account, @\"\\\")[1]), AccountNTDomain = tostring(split(Account, @\"\\\")[0])",
    "detection": "rdp-rareconnection.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Account, @\"\\\")[1]), AccountNTDomain = tostring(split(Account, @\"\\\")[0])",
    "detection": "rdp-rareconnection.yaml",
    "field": "accountntdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IpAddress",
    "detection": "hafniumumservicesuspiciousfile.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IpAddress",
    "detection": "hafniumumservicesuspiciousfile.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IpAddress",
    "detection": "hafniumumservicesuspiciousfile.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IpAddress",
    "detection": "hafniumumservicesuspiciousfile.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = ActorUsername, HostCustomEntity = DvcHostname",
    "detection": "hafniumumservicesuspiciousfile.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = ActorUsername, HostCustomEntity = DvcHostname",
    "detection": "hafniumumservicesuspiciousfile.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = ActorUsername, HostCustomEntity = DvcHostname",
    "detection": "hafniumumservicesuspiciousfile.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = InitiatingProcessAccountUpn, HostCustomEntity = DeviceName, IPCustomEntity = RequestSourceIP)",
    "detection": "hafniumumservicesuspiciousfile.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case(SourceIP in (IPList), \"SourceIP\", DestinationIP in (IPList), \"DestinationIP\", \"Message\")",
    "detection": "bariumipioc112020.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "bariumipioc112020.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "bariumipioc112020.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "bariumipioc112020.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "bariumipioc112020.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "bariumipioc112020.yaml",
    "field": "deviceproduct",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "bariumipioc112020.yaml",
    "field": "deviceaction",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "bariumipioc112020.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "bariumipioc112020.yaml",
    "field": "protocol",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "bariumipioc112020.yaml",
    "field": "sourceport",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "bariumipioc112020.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "bariumipioc112020.yaml",
    "field": "deviceaddress",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "bariumipioc112020.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "bariumipioc112020.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"IP in Message Field\")",
    "detection": "bariumipioc112020.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"IP in Message Field\")",
    "detection": "bariumipioc112020.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = SourceIPAddress , AccountCustomEntity = Account",
    "detection": "bariumipioc112020.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = SourceIPAddress , AccountCustomEntity = Account",
    "detection": "bariumipioc112020.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = SourceIPAddress , AccountCustomEntity = Account",
    "detection": "bariumipioc112020.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = IPAddresses,  Host = Computer",
    "detection": "bariumipioc112020.yaml",
    "field": "destinationipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = IPAddresses,  Host = Computer",
    "detection": "bariumipioc112020.yaml",
    "field": "host",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIPAddress, HostCustomEntity = Host",
    "detection": "bariumipioc112020.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIPAddress, HostCustomEntity = Host",
    "detection": "bariumipioc112020.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIPAddress, HostCustomEntity = Host",
    "detection": "bariumipioc112020.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = ResponseName,  Host = SrcIpAddr",
    "detection": "bariumipioc112020.yaml",
    "field": "destinationipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = ResponseName,  Host = SrcIpAddr",
    "detection": "bariumipioc112020.yaml",
    "field": "host",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIPAddress, HostCustomEntity = Host",
    "detection": "bariumipioc112020.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIPAddress, HostCustomEntity = Host",
    "detection": "bariumipioc112020.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIPAddress, HostCustomEntity = Host",
    "detection": "bariumipioc112020.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case( SourceIp in (IPList), \"SourceIP\", DestinationIp in (IPList), \"DestinationIP\", \"None\")",
    "detection": "bariumipioc112020.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIp, IPMatch == \"DestinationIP\", DestinationIp, \"None\"), Host = Computer",
    "detection": "bariumipioc112020.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIp, IPMatch == \"DestinationIP\", DestinationIp, \"None\"), Host = Computer",
    "detection": "bariumipioc112020.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIp, IPMatch == \"DestinationIP\", DestinationIp, \"None\"), Host = Computer",
    "detection": "bariumipioc112020.yaml",
    "field": "host",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend EvData = parse_xml(EventData)",
    "detection": "bariumipioc112020.yaml",
    "field": "evdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventDetail = EvData.DataItem.EventData.Data",
    "detection": "bariumipioc112020.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = EventDetail.[9].[\"#text\"], DestinationIP = EventDetail.[14].[\"#text\"]",
    "detection": "bariumipioc112020.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = EventDetail.[9].[\"#text\"], DestinationIP = EventDetail.[14].[\"#text\"]",
    "detection": "bariumipioc112020.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case( SourceIP in (IPList), \"SourceIP\", DestinationIP in (IPList), \"DestinationIP\", \"None\")",
    "detection": "bariumipioc112020.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "bariumipioc112020.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "bariumipioc112020.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "bariumipioc112020.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "bariumipioc112020.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = Computer",
    "detection": "bariumipioc112020.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = Computer",
    "detection": "bariumipioc112020.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = Computer",
    "detection": "bariumipioc112020.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, IPCustomEntity = IPAddress",
    "detection": "bariumipioc112020.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, IPCustomEntity = IPAddress",
    "detection": "bariumipioc112020.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, IPCustomEntity = IPAddress",
    "detection": "bariumipioc112020.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, IPCustomEntity = IPAddress",
    "detection": "bariumipioc112020.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, IPCustomEntity = IPAddress",
    "detection": "bariumipioc112020.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, IPCustomEntity = IPAddress",
    "detection": "bariumipioc112020.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = cIP, HostCustomEntity = Computer, AccountCustomEntity = csUserName",
    "detection": "bariumipioc112020.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = cIP, HostCustomEntity = Computer, AccountCustomEntity = csUserName",
    "detection": "bariumipioc112020.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = cIP, HostCustomEntity = Computer, AccountCustomEntity = csUserName",
    "detection": "bariumipioc112020.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = cIP, HostCustomEntity = Computer, AccountCustomEntity = csUserName",
    "detection": "bariumipioc112020.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = CallerIpAddress, AccountCustomEntity = Caller",
    "detection": "bariumipioc112020.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = CallerIpAddress, AccountCustomEntity = Caller",
    "detection": "bariumipioc112020.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = CallerIpAddress, AccountCustomEntity = Caller",
    "detection": "bariumipioc112020.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SourceIpAddress, AccountCustomEntity = UserIdentityUserName",
    "detection": "bariumipioc112020.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SourceIpAddress, AccountCustomEntity = UserIdentityUserName",
    "detection": "bariumipioc112020.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SourceIpAddress, AccountCustomEntity = UserIdentityUserName",
    "detection": "bariumipioc112020.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName",
    "detection": "bariumipioc112020.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName",
    "detection": "bariumipioc112020.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName",
    "detection": "bariumipioc112020.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIP = DestinationHost",
    "detection": "bariumipioc112020.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SourceHost",
    "detection": "bariumipioc112020.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIP = DestinationHost",
    "detection": "bariumipioc112020.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SourceHost",
    "detection": "bariumipioc112020.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "urlentity-officeactivity.yaml",
    "field": "latestindicatortime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "urlentity-officeactivity.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Url = iif(OfficeWorkload == \"AzureActiveDirectory\",extract(\"(http[s]?://(?:[a-zA-Z]|[0-9]|[$-_@.&+]|[!*\\\\(\\\\),]|(?:%[0-9a-fA-F][0-9a-fA-F]))+);\", 1,ModifiedProperties),tostring(parse_json(ModifiedProperties)[12].NewValue))",
    "detection": "urlentity-officeactivity.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Url = tostring(split(Url, ';')[0])",
    "detection": "urlentity-officeactivity.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend OfficeActivity_TimeGenerated = TimeGenerated",
    "detection": "urlentity-officeactivity.yaml",
    "field": "officeactivity_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend User = iif(isnotempty(UserId), UserId, iif(isnotempty(Actor), tostring(parse_json(Actor)[0].ID), tostring(parse_json(Parameters)[0].Value)))",
    "detection": "urlentity-officeactivity.yaml",
    "field": "user",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize OfficeActivity_TimeGenerated = arg_max(OfficeActivity_TimeGenerated, *) by IndicatorId, Url",
    "detection": "urlentity-officeactivity.yaml",
    "field": "officeactivity_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize OfficeActivity_TimeGenerated = arg_max(OfficeActivity_TimeGenerated, *) by IndicatorId, Url",
    "detection": "urlentity-officeactivity.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize OfficeActivity_TimeGenerated = arg_max(OfficeActivity_TimeGenerated, *) by IndicatorId, Url",
    "detection": "urlentity-officeactivity.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, Operation,",
    "detection": "urlentity-officeactivity.yaml",
    "field": "officeactivity_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, Operation,",
    "detection": "urlentity-officeactivity.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, Operation,",
    "detection": "urlentity-officeactivity.yaml",
    "field": "activitygroupnames",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, Operation,",
    "detection": "urlentity-officeactivity.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, Operation,",
    "detection": "urlentity-officeactivity.yaml",
    "field": "threattype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, Operation,",
    "detection": "urlentity-officeactivity.yaml",
    "field": "expirationdatetime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, Operation,",
    "detection": "urlentity-officeactivity.yaml",
    "field": "confidencescore",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, Operation,",
    "detection": "urlentity-officeactivity.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = OfficeActivity_TimeGenerated, Name = tostring(split(User, '@', 0)[0]), UPNSuffix = tostring(split(User, '@', 1)[0])",
    "detection": "urlentity-officeactivity.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = OfficeActivity_TimeGenerated, Name = tostring(split(User, '@', 0)[0]), UPNSuffix = tostring(split(User, '@', 1)[0])",
    "detection": "urlentity-officeactivity.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = OfficeActivity_TimeGenerated, Name = tostring(split(User, '@', 0)[0]), UPNSuffix = tostring(split(User, '@', 1)[0])",
    "detection": "urlentity-officeactivity.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by IpAddress",
    "detection": "hostaadcorrelation.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend LogonType = tostring(EventData.LogonType)",
    "detection": "hostaadcorrelation.yaml",
    "field": "logontype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IpAddress = tostring(EventData.IpAddress)",
    "detection": "hostaadcorrelation.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by IpAddress",
    "detection": "hostaadcorrelation.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = extract(\"(([0-9]{1,3})\\\\.([0-9]{1,3})\\\\.([0-9]{1,3})\\\\.(([0-9]{1,3})))\",1,SyslogMessage)",
    "detection": "hostaadcorrelation.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by SourceIP",
    "detection": "hostaadcorrelation.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Reason=  \"Multiple failed host logins from IP address with successful Azure AD login\"",
    "detection": "hostaadcorrelation.yaml",
    "field": "reason",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, Type = Type",
    "detection": "hostaadcorrelation.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, Type = Type",
    "detection": "hostaadcorrelation.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(UserPrincipalName, \"@\")[0]), AccountUPNSuffix = tostring(split(UserPrincipalName, \"@\")[1])",
    "detection": "hostaadcorrelation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(UserPrincipalName, \"@\")[0]), AccountUPNSuffix = tostring(split(UserPrincipalName, \"@\")[1])",
    "detection": "hostaadcorrelation.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "emailentity-securityevent.yaml",
    "field": "latestindicatortime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "emailentity-securityevent.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetUserName = tolower(TargetUserName)",
    "detection": "emailentity-securityevent.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend SecurityEvent_TimeGenerated = TimeGenerated",
    "detection": "emailentity-securityevent.yaml",
    "field": "securityevent_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetUserName = tostring(EventData.TargetUserName)",
    "detection": "emailentity-securityevent.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetUserName = tolower(TargetUserName)",
    "detection": "emailentity-securityevent.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend SecurityEvent_TimeGenerated = TimeGenerated",
    "detection": "emailentity-securityevent.yaml",
    "field": "securityevent_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SecurityEvent_TimeGenerated = arg_max(SecurityEvent_TimeGenerated, *) by IndicatorId, TargetUserName",
    "detection": "emailentity-securityevent.yaml",
    "field": "securityevent_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SecurityEvent_TimeGenerated = arg_max(SecurityEvent_TimeGenerated, *) by IndicatorId, TargetUserName",
    "detection": "emailentity-securityevent.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SecurityEvent_TimeGenerated = arg_max(SecurityEvent_TimeGenerated, *) by IndicatorId, TargetUserName",
    "detection": "emailentity-securityevent.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project SecurityEvent_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "emailentity-securityevent.yaml",
    "field": "securityevent_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SecurityEvent_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "emailentity-securityevent.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SecurityEvent_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "emailentity-securityevent.yaml",
    "field": "activitygroupnames",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SecurityEvent_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "emailentity-securityevent.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SecurityEvent_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "emailentity-securityevent.yaml",
    "field": "threattype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SecurityEvent_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "emailentity-securityevent.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SecurityEvent_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "emailentity-securityevent.yaml",
    "field": "expirationdatetime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SecurityEvent_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "emailentity-securityevent.yaml",
    "field": "confidencescore",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.'))",
    "detection": "emailentity-securityevent.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.'))",
    "detection": "emailentity-securityevent.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = SecurityEvent_TimeGenerated",
    "detection": "emailentity-securityevent.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TicketEncryptionType = tostring(EventData.TicketEncryptionType)",
    "detection": "potentialkerberoast.yaml",
    "field": "ticketencryptiontype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TicketOptions = tostring(EventData.TicketOptions)",
    "detection": "potentialkerberoast.yaml",
    "field": "ticketoptions",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Status = tostring(EventData.Status)",
    "detection": "potentialkerberoast.yaml",
    "field": "status",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ServiceName = tostring(EventData.ServiceName)",
    "detection": "potentialkerberoast.yaml",
    "field": "servicename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetUserName = tostring(EventData.TargetUserName)",
    "detection": "potentialkerberoast.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend ClientIPAddress = tostring(EventData.IpAddress)",
    "detection": "potentialkerberoast.yaml",
    "field": "clientipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize ServiceNameCountPrev23h = dcount(ServiceName), ServiceNameSet23h = makeset(ServiceName)",
    "detection": "potentialkerberoast.yaml",
    "field": "servicenamecountprev23h",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize ServiceNameCountPrev23h = dcount(ServiceName), ServiceNameSet23h = makeset(ServiceName)",
    "detection": "potentialkerberoast.yaml",
    "field": "servicenameset23h",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize min(TimeGenerated), max(TimeGenerated), ServiceNameCountPrev1h = dcount(ServiceName), ServiceNameSet1h = makeset(ServiceName)",
    "detection": "potentialkerberoast.yaml",
    "field": "servicenamecountprev1h",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize min(TimeGenerated), max(TimeGenerated), ServiceNameCountPrev1h = dcount(ServiceName), ServiceNameSet1h = makeset(ServiceName)",
    "detection": "potentialkerberoast.yaml",
    "field": "servicenameset1h",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime = min_TimeGenerated, EndTime = max_TimeGenerated, TargetUserName, Computer, ClientIPAddress, TicketOptions,",
    "detection": "potentialkerberoast.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime = min_TimeGenerated, EndTime = max_TimeGenerated, TargetUserName, Computer, ClientIPAddress, TicketOptions,",
    "detection": "potentialkerberoast.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime = min_TimeGenerated, EndTime = max_TimeGenerated, TargetUserName, Computer, ClientIPAddress, TicketOptions,",
    "detection": "potentialkerberoast.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime = min_TimeGenerated, EndTime = max_TimeGenerated, TargetUserName, Computer, ClientIPAddress, TicketOptions,",
    "detection": "potentialkerberoast.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime = min_TimeGenerated, EndTime = max_TimeGenerated, TargetUserName, Computer, ClientIPAddress, TicketOptions,",
    "detection": "potentialkerberoast.yaml",
    "field": "clientipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime = min_TimeGenerated, EndTime = max_TimeGenerated, TargetUserName, Computer, ClientIPAddress, TicketOptions,",
    "detection": "potentialkerberoast.yaml",
    "field": "ticketoptions",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "potentialkerberoast.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "potentialkerberoast.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "potentialkerberoast.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetAccount = strcat(TargetDomainName,  \"\\\\\", TargetUserName)",
    "detection": "potentialkerberoast.yaml",
    "field": "targetaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Status = todynamic(Status), LocationDetails = todynamic(LocationDetails)));",
    "detection": "ipentity-signinlogs.yaml",
    "field": "status",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Status = todynamic(Status), LocationDetails = todynamic(LocationDetails)));",
    "detection": "ipentity-signinlogs.yaml",
    "field": "locationdetails",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TI_ipEntity = coalesce(NetworkIP, EmailSourceIpAddress, NetworkDestinationIP, NetworkSourceIP)",
    "detection": "ipentity-signinlogs.yaml",
    "field": "ti_ipentity",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "ipentity-signinlogs.yaml",
    "field": "latestindicatortime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "ipentity-signinlogs.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend StatusCode = tostring(Status.errorCode), StatusDetails = tostring(Status.additionalDetails), StatusReason = tostring(Status.failureReason)",
    "detection": "ipentity-signinlogs.yaml",
    "field": "statuscode",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend StatusCode = tostring(Status.errorCode), StatusDetails = tostring(Status.additionalDetails), StatusReason = tostring(Status.failureReason)",
    "detection": "ipentity-signinlogs.yaml",
    "field": "statusdetails",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend StatusCode = tostring(Status.errorCode), StatusDetails = tostring(Status.additionalDetails), StatusReason = tostring(Status.failureReason)",
    "detection": "ipentity-signinlogs.yaml",
    "field": "statusreason",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SigninLogs_TimeGenerated = arg_max(SigninLogs_TimeGenerated, *) by IndicatorId, IPAddress",
    "detection": "ipentity-signinlogs.yaml",
    "field": "signinlogs_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SigninLogs_TimeGenerated = arg_max(SigninLogs_TimeGenerated, *) by IndicatorId, IPAddress",
    "detection": "ipentity-signinlogs.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SigninLogs_TimeGenerated = arg_max(SigninLogs_TimeGenerated, *) by IndicatorId, IPAddress",
    "detection": "ipentity-signinlogs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, StatusReason, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-signinlogs.yaml",
    "field": "signinlogs_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, StatusReason, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-signinlogs.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, StatusReason, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-signinlogs.yaml",
    "field": "activitygroupnames",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, StatusReason, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-signinlogs.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, StatusReason, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-signinlogs.yaml",
    "field": "threattype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, StatusReason, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-signinlogs.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, StatusReason, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-signinlogs.yaml",
    "field": "expirationdatetime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, StatusReason, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-signinlogs.yaml",
    "field": "confidencescore",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, StatusReason, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-signinlogs.yaml",
    "field": "ti_ipentity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, StatusReason, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-signinlogs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, StatusReason, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-signinlogs.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, StatusReason, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-signinlogs.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, StatusReason, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-signinlogs.yaml",
    "field": "statuscode",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, StatusReason, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-signinlogs.yaml",
    "field": "statusdetails",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, StatusReason, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-signinlogs.yaml",
    "field": "statusreason",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, StatusReason, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-signinlogs.yaml",
    "field": "networkip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, StatusReason, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-signinlogs.yaml",
    "field": "networkdestinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, StatusReason, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-signinlogs.yaml",
    "field": "networksourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, StatusReason, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-signinlogs.yaml",
    "field": "emailsourceipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, TI_ipEntity, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, StatusReason, NetworkIP, NetworkDestinationIP, NetworkSourceIP, EmailSourceIpAddress, Type",
    "detection": "ipentity-signinlogs.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = SigninLogs_TimeGenerated, Name = tostring(split(UserPrincipalName, '@', 0)[0]), UPNSuffix = tostring(split(UserPrincipalName, '@', 1)[0])",
    "detection": "ipentity-signinlogs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = SigninLogs_TimeGenerated, Name = tostring(split(UserPrincipalName, '@', 0)[0]), UPNSuffix = tostring(split(UserPrincipalName, '@', 1)[0])",
    "detection": "ipentity-signinlogs.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = SigninLogs_TimeGenerated, Name = tostring(split(UserPrincipalName, '@', 0)[0]), UPNSuffix = tostring(split(UserPrincipalName, '@', 1)[0])",
    "detection": "ipentity-signinlogs.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend BeaconPercent = MostFrequentTimeDeltaCount/toreal(TotalEvents) * 100",
    "detection": "possiblebeaconingactivity.yaml",
    "field": "beaconpercent",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "        | extend LogonType = tostring(EventData.LogonType)",
    "detection": "rdp-nesting.yaml",
    "field": "logontype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "        | extend Account = strcat(tostring(EventData.TargetDomainName), \"\\\\\", tostring(EventData.TargetUserName))",
    "detection": "rdp-nesting.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "        | extend IpAddress = tostring(EventData.IpAddress)",
    "detection": "rdp-nesting.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "            | extend LogonType = toint(EventData.LogonType)",
    "detection": "rdp-nesting.yaml",
    "field": "logontype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "            | extend Account = strcat(tostring(EventData.TargetDomainName), \"\\\\\", tostring(EventData.TargetUserName))",
    "detection": "rdp-nesting.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "            | extend IpAddress = tostring(EventData.IpAddress)",
    "detection": "rdp-nesting.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "    | extend ClientIP = tostring(parse_json(IPAddresses[0]).IPAddress)",
    "detection": "rdp-nesting.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project Computer=toupper(Computer), ResolvedIP = ClientIP;",
    "detection": "rdp-nesting.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "    | project Computer=toupper(Computer), ResolvedIP = ClientIP;",
    "detection": "rdp-nesting.yaml",
    "field": "resolvedip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "        | summarize make_set(Computer), ComputerCount = dcount(Computer) by bin(TimeGenerated, 1d), Account = tolower(Account), IpAddress",
    "detection": "rdp-nesting.yaml",
    "field": "computercount",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "        | summarize make_set(Computer), ComputerCount = dcount(Computer) by bin(TimeGenerated, 1d), Account = tolower(Account), IpAddress",
    "detection": "rdp-nesting.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "        | extend Computer = toupper(set_Computer)",
    "detection": "rdp-nesting.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "        | extend LogonType = tostring(EventData.LogonType)",
    "detection": "rdp-nesting.yaml",
    "field": "logontype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "        | extend Account = strcat(tostring(EventData.TargetDomainName), \"\\\\\", tostring(EventData.TargetUserName))",
    "detection": "rdp-nesting.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "        | extend IpAddress = tostring(EventData.IpAddress)",
    "detection": "rdp-nesting.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "        | summarize make_set(Computer), ComputerCount = dcount(Computer) by bin(TimeGenerated, 1d), Account = tolower(Account), IpAddress",
    "detection": "rdp-nesting.yaml",
    "field": "computercount",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "        | summarize make_set(Computer), ComputerCount = dcount(Computer) by bin(TimeGenerated, 1d), Account = tolower(Account), IpAddress",
    "detection": "rdp-nesting.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "        | extend Computer = toupper(set_Computer)",
    "detection": "rdp-nesting.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstHopFirstSeen = min(FirstHop), FirstHopLastSeen = max(FirstHop)",
    "detection": "rdp-nesting.yaml",
    "field": "firsthopfirstseen",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FirstHopFirstSeen = min(FirstHop), FirstHopLastSeen = max(FirstHop)",
    "detection": "rdp-nesting.yaml",
    "field": "firsthoplastseen",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain1 = iff(DomainIndex != -1, substring(FirstComputer, DomainIndex + 1), FirstComputer)",
    "detection": "rdp-nesting.yaml",
    "field": "hostnamedomain1",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain2 = iff(DomainIndex != -1, substring(SecondComputer, DomainIndex + 1), SecondComputer)",
    "detection": "rdp-nesting.yaml",
    "field": "hostnamedomain2",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Message, SourceUserID, RequestURL, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Message, SourceUserID, RequestURL, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Message, SourceUserID, RequestURL, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Message, SourceUserID, RequestURL, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Message, SourceUserID, RequestURL, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "sourceuserid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Message, SourceUserID, RequestURL, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "requesturl",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Message, SourceUserID, RequestURL, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend MessageIP = extract(IPRegex, 0, Message)",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "messageip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case(SourceIP in (IPList), \"SourceIP\", DestinationIP in (IPList), \"DestinationIP\", MessageIP in (IPList), \"Message\", RequestURL in (IPList), \"RequestUrl\",\"NoMatch\"), AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case(SourceIP in (IPList), \"SourceIP\", DestinationIP in (IPList), \"DestinationIP\", MessageIP in (IPList), \"Message\", RequestURL in (IPList), \"RequestUrl\",\"NoMatch\"), AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "alertdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, IPMatch == \"Message\", MessageIP, IPMatch == \"RequestUrl\", RequestURL, \"NoMatch\"), AccountCustomEntity = SourceUserID",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, IPMatch == \"Message\", MessageIP, IPMatch == \"RequestUrl\", RequestURL, \"NoMatch\"), AccountCustomEntity = SourceUserID",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, IPMatch == \"Message\", MessageIP, IPMatch == \"RequestUrl\", RequestURL, \"NoMatch\"), AccountCustomEntity = SourceUserID",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, IPAddresses, Name, ClientIP, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, IPAddresses, Name, ClientIP, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, IPAddresses, Name, ClientIP, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "ipaddresses",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, IPAddresses, Name, ClientIP, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, IPAddresses, Name, ClientIP, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, IPAddresses, Name, ClientIP, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = IPAddresses, DNSName = Name, Host = Computer , AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "destinationipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = IPAddresses, DNSName = Name, Host = Computer , AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = IPAddresses, DNSName = Name, Host = Computer , AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "host",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = IPAddresses, DNSName = Name, Host = Computer , AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "alertdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIPAddress, HostCustomEntity = Host",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIPAddress, HostCustomEntity = Host",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIPAddress, HostCustomEntity = Host",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Direction, ProcessName, SourceIp, DestinationIp, DestinationPort, RemoteDnsQuestions, DNSName,BytesSent, BytesReceived, RemoteCountry, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Direction, ProcessName, SourceIp, DestinationIp, DestinationPort, RemoteDnsQuestions, DNSName,BytesSent, BytesReceived, RemoteCountry, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Direction, ProcessName, SourceIp, DestinationIp, DestinationPort, RemoteDnsQuestions, DNSName,BytesSent, BytesReceived, RemoteCountry, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "direction",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Direction, ProcessName, SourceIp, DestinationIp, DestinationPort, RemoteDnsQuestions, DNSName,BytesSent, BytesReceived, RemoteCountry, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Direction, ProcessName, SourceIp, DestinationIp, DestinationPort, RemoteDnsQuestions, DNSName,BytesSent, BytesReceived, RemoteCountry, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Direction, ProcessName, SourceIp, DestinationIp, DestinationPort, RemoteDnsQuestions, DNSName,BytesSent, BytesReceived, RemoteCountry, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Direction, ProcessName, SourceIp, DestinationIp, DestinationPort, RemoteDnsQuestions, DNSName,BytesSent, BytesReceived, RemoteCountry, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Direction, ProcessName, SourceIp, DestinationIp, DestinationPort, RemoteDnsQuestions, DNSName,BytesSent, BytesReceived, RemoteCountry, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "remotednsquestions",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Direction, ProcessName, SourceIp, DestinationIp, DestinationPort, RemoteDnsQuestions, DNSName,BytesSent, BytesReceived, RemoteCountry, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Direction, ProcessName, SourceIp, DestinationIp, DestinationPort, RemoteDnsQuestions, DNSName,BytesSent, BytesReceived, RemoteCountry, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "bytessent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Direction, ProcessName, SourceIp, DestinationIp, DestinationPort, RemoteDnsQuestions, DNSName,BytesSent, BytesReceived, RemoteCountry, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "bytesreceived",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Direction, ProcessName, SourceIp, DestinationIp, DestinationPort, RemoteDnsQuestions, DNSName,BytesSent, BytesReceived, RemoteCountry, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "remotecountry",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Direction, ProcessName, SourceIp, DestinationIp, DestinationPort, RemoteDnsQuestions, DNSName,BytesSent, BytesReceived, RemoteCountry, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case( SourceIp in (IPList), \"SourceIP\", DestinationIp in (IPList), \"DestinationIP\", \"None\") , AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case( SourceIp in (IPList), \"SourceIP\", DestinationIp in (IPList), \"DestinationIP\", \"None\") , AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "alertdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIp, IPMatch == \"DestinationIP\", DestinationIp, \"NoMatch\"), HostCustomEntity = Computer, ProcessCustomEntity = ProcessName",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIp, IPMatch == \"DestinationIP\", DestinationIp, \"NoMatch\"), HostCustomEntity = Computer, ProcessCustomEntity = ProcessName",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIp, IPMatch == \"DestinationIP\", DestinationIp, \"NoMatch\"), HostCustomEntity = Computer, ProcessCustomEntity = ProcessName",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIp, IPMatch == \"DestinationIP\", DestinationIp, \"NoMatch\"), HostCustomEntity = Computer, ProcessCustomEntity = ProcessName",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend EvData = parse_xml(EventData)",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "evdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventDetail = EvData.DataItem.EventData.Data",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = EventDetail.[9].[\"#text\"], DestinationIP = EventDetail.[14].[\"#text\"], Image = EventDetail.[4].[\"#text\"]",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = EventDetail.[9].[\"#text\"], DestinationIP = EventDetail.[14].[\"#text\"], Image = EventDetail.[4].[\"#text\"]",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = EventDetail.[9].[\"#text\"], DestinationIP = EventDetail.[14].[\"#text\"], Image = EventDetail.[4].[\"#text\"]",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Image, UserName, Computer, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Image, UserName, Computer, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Image, UserName, Computer, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Image, UserName, Computer, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Image, UserName, Computer, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Image, UserName, Computer, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Image, UserName, Computer, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case( SourceIP in (IPList), \"SourceIP\", DestinationIP in (IPList), \"DestinationIP\", \"None\") , AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case( SourceIP in (IPList), \"SourceIP\", DestinationIP in (IPList), \"DestinationIP\", \"None\") , AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "alertdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserAgent, Operation, RecordType, UserId, ClientIP, AlertDetail = 'Dev-0322 IOC match', Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserAgent, Operation, RecordType, UserId, ClientIP, AlertDetail = 'Dev-0322 IOC match', Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserAgent, Operation, RecordType, UserId, ClientIP, AlertDetail = 'Dev-0322 IOC match', Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserAgent, Operation, RecordType, UserId, ClientIP, AlertDetail = 'Dev-0322 IOC match', Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "recordtype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserAgent, Operation, RecordType, UserId, ClientIP, AlertDetail = 'Dev-0322 IOC match', Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserAgent, Operation, RecordType, UserId, ClientIP, AlertDetail = 'Dev-0322 IOC match', Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserAgent, Operation, RecordType, UserId, ClientIP, AlertDetail = 'Dev-0322 IOC match', Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "alertdetail",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserAgent, Operation, RecordType, UserId, ClientIP, AlertDetail = 'Dev-0322 IOC match', Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = ClientIP, AccountCustomEntity = UserId",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = ClientIP, AccountCustomEntity = UserId",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = ClientIP, AccountCustomEntity = UserId",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "actiontype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocessaccountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocessaccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocesscommandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocessfolderpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocessparentfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocessfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "remoteip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "remoteurl",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "remoteport",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "localip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName,  AlertDetail = 'Dev-0322 IOC match', UrlCustomEntity =RemoteUrl, ProcessCustomEntity = InitiatingProcessFileName",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName,  AlertDetail = 'Dev-0322 IOC match', UrlCustomEntity =RemoteUrl, ProcessCustomEntity = InitiatingProcessFileName",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName,  AlertDetail = 'Dev-0322 IOC match', UrlCustomEntity =RemoteUrl, ProcessCustomEntity = InitiatingProcessFileName",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName,  AlertDetail = 'Dev-0322 IOC match', UrlCustomEntity =RemoteUrl, ProcessCustomEntity = InitiatingProcessFileName",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "alertdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName,  AlertDetail = 'Dev-0322 IOC match', UrlCustomEntity =RemoteUrl, ProcessCustomEntity = InitiatingProcessFileName",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "urlcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName,  AlertDetail = 'Dev-0322 IOC match', UrlCustomEntity =RemoteUrl, ProcessCustomEntity = InitiatingProcessFileName",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, CommunicationDirection, SourceIP, DestinationIP, SourcePort, DestinationPort, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, CommunicationDirection, SourceIP, DestinationIP, SourcePort, DestinationPort, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, CommunicationDirection, SourceIP, DestinationIP, SourcePort, DestinationPort, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "communicationdirection",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, CommunicationDirection, SourceIP, DestinationIP, SourcePort, DestinationPort, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, CommunicationDirection, SourceIP, DestinationIP, SourcePort, DestinationPort, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, CommunicationDirection, SourceIP, DestinationIP, SourcePort, DestinationPort, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "sourceport",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, CommunicationDirection, SourceIP, DestinationIP, SourcePort, DestinationPort, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, CommunicationDirection, SourceIP, DestinationIP, SourcePort, DestinationPort, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case( SourceIP in (IPList), \"SourceIP\", DestinationIP in (IPList), \"DestinationIP\", \"None\"), AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case( SourceIP in (IPList), \"SourceIP\", DestinationIP in (IPList), \"DestinationIP\", \"None\"), AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "alertdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,Resource, msg_s, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,Resource, msg_s, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,Resource, msg_s, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "msg_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,Resource, msg_s, Type",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = Request_Name, IPCustomEntity = ClientIP, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = Request_Name, IPCustomEntity = ClientIP, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = Request_Name, IPCustomEntity = ClientIP, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = Request_Name, IPCustomEntity = ClientIP, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "alertdetail",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,Resource, msg_s",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,Resource, msg_s",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,Resource, msg_s",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "msg_s",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = DestinationHost, IPCustomEntity = SourceHost, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = DestinationHost, IPCustomEntity = SourceHost, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = DestinationHost, IPCustomEntity = SourceHost, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = DestinationHost, IPCustomEntity = SourceHost, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "alertdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EvData = parse_xml(EventData)",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "evdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventDetail = EvData.DataItem.EventData.Data",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ParentImage = EventDetail.[20].[\"#text\"], Image = EventDetail.[4].[\"#text\"]",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "parentimage",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ParentImage = EventDetail.[20].[\"#text\"], Image = EventDetail.[4].[\"#text\"]",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, SHA256,Image, ParentImage",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, SHA256,Image, ParentImage",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, SHA256,Image, ParentImage",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, SHA256,Image, ParentImage",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, SHA256,Image, ParentImage",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, SHA256,Image, ParentImage",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "source",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, SHA256,Image, ParentImage",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "sha256",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, SHA256,Image, ParentImage",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, SHA256,Image, ParentImage",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "parentimage",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Type = strcat(Type, \": \", Source), Account = UserName, FileHash = SHA256, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Type = strcat(Type, \": \", Source), Account = UserName, FileHash = SHA256, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Type = strcat(Type, \": \", Source), Account = UserName, FileHash = SHA256, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Type = strcat(Type, \": \", Source), Account = UserName, FileHash = SHA256, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "alertdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), FileHashCustomEntity = FileHash",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), FileHashCustomEntity = FileHash",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), FileHashCustomEntity = FileHash",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), FileHashCustomEntity = FileHash",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), FileHashCustomEntity = FileHash",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend CommandLineIP = extract(IPRegex, 0,InitiatingProcessCommandLine)",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "commandlineip",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "actiontype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocessaccountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocessaccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocesscommandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocessfolderpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocessparentfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocessfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "requestaccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "requestsourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocesssha256",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "commandlineip",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = RequestAccountName, Computer = DeviceName, IPAddress = RequestSourceIP, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = RequestAccountName, Computer = DeviceName, IPAddress = RequestSourceIP, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = RequestAccountName, Computer = DeviceName, IPAddress = RequestSourceIP, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = RequestAccountName, Computer = DeviceName, IPAddress = RequestSourceIP, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = RequestAccountName, Computer = DeviceName, IPAddress = RequestSourceIP, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = RequestAccountName, Computer = DeviceName, IPAddress = RequestSourceIP, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "alertdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = FileHash, IPCustomEntity = CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = FileHash, IPCustomEntity = CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = FileHash, IPCustomEntity = CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = FileHash, IPCustomEntity = CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = FileHash, IPCustomEntity = CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = FileHash, IPCustomEntity = CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend CommandLineIP = extract(IPRegex, 0,InitiatingProcessCommandLine)",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "commandlineip",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "actiontype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocessaccountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocessaccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocesscommandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocessfolderpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocessparentfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocessfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocesssha256",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "commandlineip",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = InitiatingProcessAccountName, Computer = DeviceName, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256, Image = InitiatingProcessFolderPath, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = InitiatingProcessAccountName, Computer = DeviceName, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256, Image = InitiatingProcessFolderPath, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = InitiatingProcessAccountName, Computer = DeviceName, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256, Image = InitiatingProcessFolderPath, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = InitiatingProcessAccountName, Computer = DeviceName, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256, Image = InitiatingProcessFolderPath, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = InitiatingProcessAccountName, Computer = DeviceName, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256, Image = InitiatingProcessFolderPath, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = InitiatingProcessAccountName, Computer = DeviceName, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256, Image = InitiatingProcessFolderPath, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "alertdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = FileHash, IPCustomEntity = CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = FileHash, IPCustomEntity = CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = FileHash, IPCustomEntity = CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = FileHash, IPCustomEntity = CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = FileHash, IPCustomEntity = CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = FileHash, IPCustomEntity = CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend CommandLineIP = extract(IPRegex, 0,InitiatingProcessCommandLine)",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "commandlineip",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, CommandLineIP, AccountName",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, CommandLineIP, AccountName",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "actiontype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, CommandLineIP, AccountName",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, CommandLineIP, AccountName",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, CommandLineIP, AccountName",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocessaccountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, CommandLineIP, AccountName",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocessaccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, CommandLineIP, AccountName",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocesscommandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, CommandLineIP, AccountName",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocessfolderpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, CommandLineIP, AccountName",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, CommandLineIP, AccountName",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocessparentfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, CommandLineIP, AccountName",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocessfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, CommandLineIP, AccountName",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "initiatingprocesssha256",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, CommandLineIP, AccountName",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, CommandLineIP, AccountName",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "commandlineip",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, CommandLineIP, AccountName",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = AccountName, Computer = DeviceName, IPAddress = CommandLineIP, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = AccountName, Computer = DeviceName, IPAddress = CommandLineIP, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = AccountName, Computer = DeviceName, IPAddress = CommandLineIP, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = AccountName, Computer = DeviceName, IPAddress = CommandLineIP, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = AccountName, Computer = DeviceName, IPAddress = CommandLineIP, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = AccountName, Computer = DeviceName, IPAddress = CommandLineIP, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256, AlertDetail = 'Dev-0322 IOC match'",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "alertdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = FileHash, IPCustomEntity = IPAddress",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = FileHash, IPCustomEntity = IPAddress",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = FileHash, IPCustomEntity = IPAddress",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = FileHash, IPCustomEntity = IPAddress",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = FileHash, IPCustomEntity = IPAddress",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = FileHash, IPCustomEntity = IPAddress",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend CommandLineIP = extract(IPRegex, 0, CommandLine)",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "commandlineip",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, CommandLine, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, CommandLine, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, CommandLine, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, CommandLine, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, CommandLine, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, CommandLine, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "newprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, CommandLine, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, CommandLine, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, CommandLine, CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "commandlineip",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = NewProcessName, AlertDetail = 'Dev-0322 IOC match', IPCustomEntity = CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = NewProcessName, AlertDetail = 'Dev-0322 IOC match', IPCustomEntity = CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = NewProcessName, AlertDetail = 'Dev-0322 IOC match', IPCustomEntity = CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = NewProcessName, AlertDetail = 'Dev-0322 IOC match', IPCustomEntity = CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = NewProcessName, AlertDetail = 'Dev-0322 IOC match', IPCustomEntity = CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "alertdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = NewProcessName, AlertDetail = 'Dev-0322 IOC match', IPCustomEntity = CommandLineIP",
    "detection": "dev-0322-solarwinds-serv-u-ioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), count() by Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName,",
    "detection": "base64-encoded-pefile.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), count() by Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName,",
    "detection": "base64-encoded-pefile.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), count() by Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName,",
    "detection": "base64-encoded-pefile.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend CommandLine = tostring(EventData.CommandLine)",
    "detection": "base64-encoded-pefile.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend ParentProcessName = tostring(EventData.ParentProcessName)",
    "detection": "base64-encoded-pefile.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend NewProcessName = tostring(EventData.NewProcessName)",
    "detection": "base64-encoded-pefile.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Process=tostring(split(NewProcessName, '\\\\')[-1])",
    "detection": "base64-encoded-pefile.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectUserName = tostring(EventData.SubjectUserName)",
    "detection": "base64-encoded-pefile.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectDomainName = tostring(EventData.SubjectDomainName)",
    "detection": "base64-encoded-pefile.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), count() by Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName,",
    "detection": "base64-encoded-pefile.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), count() by Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName,",
    "detection": "base64-encoded-pefile.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), count() by Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName,",
    "detection": "base64-encoded-pefile.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = iif(Computer has '.',substring(Computer,0,indexof(Computer,'.')),Computer) , DnsDomain = iif(Computer has '.',substring(Computer,indexof(Computer,'.')+1),'')",
    "detection": "base64-encoded-pefile.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = iif(Computer has '.',substring(Computer,0,indexof(Computer,'.')),Computer) , DnsDomain = iif(Computer has '.',substring(Computer,indexof(Computer,'.')+1),'')",
    "detection": "base64-encoded-pefile.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "emailentity-securityalert.yaml",
    "field": "latestindicatortime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "emailentity-securityalert.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend MSTI = case(AlertName has \"TI map\" and VendorName == \"Microsoft\" and ProductName == 'Azure Sentinel', true, false)",
    "detection": "emailentity-securityalert.yaml",
    "field": "msti",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend EntitiesDynamicArray = parse_json(Entities) | mv-expand EntitiesDynamicArray",
    "detection": "emailentity-securityalert.yaml",
    "field": "entitiesdynamicarray",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend Entitytype = tostring(parse_json(EntitiesDynamicArray).Type), EntityName = tostring(parse_json(EntitiesDynamicArray).Name),",
    "detection": "emailentity-securityalert.yaml",
    "field": "entitytype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend Entitytype = tostring(parse_json(EntitiesDynamicArray).Type), EntityName = tostring(parse_json(EntitiesDynamicArray).Name),",
    "detection": "emailentity-securityalert.yaml",
    "field": "entityname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend EntityEmail = tolower(strcat(EntityName, \"@\", EntityUPNSuffix))",
    "detection": "emailentity-securityalert.yaml",
    "field": "entityemail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend Alert_TimeGenerated = TimeGenerated",
    "detection": "emailentity-securityalert.yaml",
    "field": "alert_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Alert_TimeGenerated = arg_max(Alert_TimeGenerated, *) by IndicatorId, AlertName",
    "detection": "emailentity-securityalert.yaml",
    "field": "alert_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Alert_TimeGenerated = arg_max(Alert_TimeGenerated, *) by IndicatorId, AlertName",
    "detection": "emailentity-securityalert.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Alert_TimeGenerated = arg_max(Alert_TimeGenerated, *) by IndicatorId, AlertName",
    "detection": "emailentity-securityalert.yaml",
    "field": "alertname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Alert_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "emailentity-securityalert.yaml",
    "field": "alert_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Alert_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "emailentity-securityalert.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Alert_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "emailentity-securityalert.yaml",
    "field": "activitygroupnames",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Alert_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "emailentity-securityalert.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Alert_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "emailentity-securityalert.yaml",
    "field": "threattype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Alert_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "emailentity-securityalert.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Alert_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "emailentity-securityalert.yaml",
    "field": "expirationdatetime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Alert_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "emailentity-securityalert.yaml",
    "field": "confidencescore",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(EntityEmail, '@', 0)[0]), UPNSuffix = tostring(split(EntityEmail, '@', 1)[0])",
    "detection": "emailentity-securityalert.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(EntityEmail, '@', 0)[0]), UPNSuffix = tostring(split(EntityEmail, '@', 1)[0])",
    "detection": "emailentity-securityalert.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = Alert_TimeGenerated",
    "detection": "emailentity-securityalert.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend shortFileName = tolower(tostring(split(NewProcessName, '\\\\')[-1]))",
    "detection": "networkendpointcorrelation.yaml",
    "field": "shortfilename",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "  | extend  NewProcessName = tostring(EventData.NewProcessName)",
    "detection": "networkendpointcorrelation.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "  | extend shortFileName = tolower(tostring(split(NewProcessName, '\\\\')[-1]))",
    "detection": "networkendpointcorrelation.yaml",
    "field": "shortfilename",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetUserName = tostring(EventData.TargetUserName)",
    "detection": "networkendpointcorrelation.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Activity , RequestURL , SourceIP, DestinationIP",
    "detection": "networkendpointcorrelation.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Activity , RequestURL , SourceIP, DestinationIP",
    "detection": "networkendpointcorrelation.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Activity , RequestURL , SourceIP, DestinationIP",
    "detection": "networkendpointcorrelation.yaml",
    "field": "requesturl",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Activity , RequestURL , SourceIP, DestinationIP",
    "detection": "networkendpointcorrelation.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Activity , RequestURL , SourceIP, DestinationIP",
    "detection": "networkendpointcorrelation.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend suspectExeName = tolower(tostring(split(RequestURL, '/')[-1]))",
    "detection": "networkendpointcorrelation.yaml",
    "field": "suspectexename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.'))",
    "detection": "networkendpointcorrelation.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.'))",
    "detection": "networkendpointcorrelation.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend FileName = Process, ProcessCommandLine = CommandLine",
    "detection": "mshtmlvuln.yaml",
    "field": "filename",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend FileName = Process, ProcessCommandLine = CommandLine",
    "detection": "mshtmlvuln.yaml",
    "field": "processcommandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer",
    "detection": "mshtmlvuln.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer",
    "detection": "mshtmlvuln.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer",
    "detection": "mshtmlvuln.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = InitiatingProcessAccountUpn, HostCustomEntity = DeviceName",
    "detection": "mshtmlvuln.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = InitiatingProcessAccountUpn, HostCustomEntity = DeviceName",
    "detection": "mshtmlvuln.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = InitiatingProcessAccountUpn, HostCustomEntity = DeviceName",
    "detection": "mshtmlvuln.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventData = parse_xml(EventData).DataItem.EventData.Data",
    "detection": "mshtmlvuln.yaml",
    "field": "eventdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key = tostring(column_ifexists('@Name', \"\")), Value = column_ifexists('#text', \"\")",
    "detection": "mshtmlvuln.yaml",
    "field": "key",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key = tostring(column_ifexists('@Name', \"\")), Value = column_ifexists('#text', \"\")",
    "detection": "mshtmlvuln.yaml",
    "field": "value",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Image = column_ifexists(\"Image\", \"\"), ProcessCommandLine = column_ifexists(\"CommandLine\", \"\")",
    "detection": "mshtmlvuln.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Image = column_ifexists(\"Image\", \"\"), ProcessCommandLine = column_ifexists(\"CommandLine\", \"\")",
    "detection": "mshtmlvuln.yaml",
    "field": "processcommandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend FileName = split(Image, '\\\\', -1)[-1]",
    "detection": "mshtmlvuln.yaml",
    "field": "filename",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, HostCustomEntity = Computer",
    "detection": "mshtmlvuln.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, HostCustomEntity = Computer",
    "detection": "mshtmlvuln.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, HostCustomEntity = Computer",
    "detection": "mshtmlvuln.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "urlentity-syslog.yaml",
    "field": "latestindicatortime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "urlentity-syslog.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Url = extract(\"(http[s]?://(?:[a-zA-Z]|[0-9]|[$-_@.&+]|[!*\\\\(\\\\),]|(?:%[0-9a-fA-F][0-9a-fA-F]))+)\", 1,SyslogMessage)",
    "detection": "urlentity-syslog.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Syslog_TimeGenerated = TimeGenerated",
    "detection": "urlentity-syslog.yaml",
    "field": "syslog_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Syslog_TimeGenerated  = arg_max(Syslog_TimeGenerated , *) by IndicatorId, Url",
    "detection": "urlentity-syslog.yaml",
    "field": "syslog_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Syslog_TimeGenerated  = arg_max(Syslog_TimeGenerated , *) by IndicatorId, Url",
    "detection": "urlentity-syslog.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Syslog_TimeGenerated  = arg_max(Syslog_TimeGenerated , *) by IndicatorId, Url",
    "detection": "urlentity-syslog.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = Syslog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, SyslogMessage, Computer, ProcessName, Url, HostIP",
    "detection": "urlentity-syslog.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = Syslog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, SyslogMessage, Computer, ProcessName, Url, HostIP",
    "detection": "urlentity-syslog.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = Syslog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, SyslogMessage, Computer, ProcessName, Url, HostIP",
    "detection": "urlentity-syslog.yaml",
    "field": "activitygroupnames",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = Syslog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, SyslogMessage, Computer, ProcessName, Url, HostIP",
    "detection": "urlentity-syslog.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = Syslog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, SyslogMessage, Computer, ProcessName, Url, HostIP",
    "detection": "urlentity-syslog.yaml",
    "field": "threattype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = Syslog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, SyslogMessage, Computer, ProcessName, Url, HostIP",
    "detection": "urlentity-syslog.yaml",
    "field": "expirationdatetime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = Syslog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, SyslogMessage, Computer, ProcessName, Url, HostIP",
    "detection": "urlentity-syslog.yaml",
    "field": "confidencescore",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = Syslog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, SyslogMessage, Computer, ProcessName, Url, HostIP",
    "detection": "urlentity-syslog.yaml",
    "field": "syslogmessage",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = Syslog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, SyslogMessage, Computer, ProcessName, Url, HostIP",
    "detection": "urlentity-syslog.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = Syslog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, SyslogMessage, Computer, ProcessName, Url, HostIP",
    "detection": "urlentity-syslog.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = Syslog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, SyslogMessage, Computer, ProcessName, Url, HostIP",
    "detection": "urlentity-syslog.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = Syslog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, SyslogMessage, Computer, ProcessName, Url, HostIP",
    "detection": "urlentity-syslog.yaml",
    "field": "hostip",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = SourceUserID, Computer = DeviceName, IPAddress = SourceIP",
    "detection": "ceriumoct292020iocs.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = SourceUserID, Computer = DeviceName, IPAddress = SourceIP",
    "detection": "ceriumoct292020iocs.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = SourceUserID, Computer = DeviceName, IPAddress = SourceIP",
    "detection": "ceriumoct292020iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DNSName = Name",
    "detection": "ceriumoct292020iocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPAddress = ClientIP",
    "detection": "ceriumoct292020iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPAddress = RemoteIp",
    "detection": "ceriumoct292020iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DNSName = Request_Name",
    "detection": "ceriumoct292020iocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPAddress = ClientIP",
    "detection": "ceriumoct292020iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DNSName = DestinationHost",
    "detection": "ceriumoct292020iocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPAddress = SourceHost",
    "detection": "ceriumoct292020iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IPAddress",
    "detection": "ceriumoct292020iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IPAddress",
    "detection": "ceriumoct292020iocs.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IPAddress",
    "detection": "ceriumoct292020iocs.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IPAddress",
    "detection": "ceriumoct292020iocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "    | project EnableTime = TimeGenerated, EnableEventID = EventID, EnableActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "enabletime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project EnableTime = TimeGenerated, EnableEventID = EventID, EnableActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "enableeventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project EnableTime = TimeGenerated, EnableEventID = EventID, EnableActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "enableactivity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project EnableTime = TimeGenerated, EnableEventID = EventID, EnableActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SubjectUserSid = tostring(EventData.SubjectUserSid)",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "subjectusersid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend AccountType=case(EventData.SubjectUserName endswith \"$\" or SubjectUserSid in (\"S-1-5-18\", \"S-1-5-19\", \"S-1-5-20\"), \"Machine\", isempty(SubjectUserSid), \"\", \"User\")",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SubjectAccount = strcat(tostring(EventData.SubjectDomainName),\"\\\\\", tostring(EventData.SubjectUserName))",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "subjectaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SubjectDomainName = tostring(EventData.SubjectDomainName), SubjectUserName = tostring(EventData.SubjectUserName)",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SubjectDomainName = tostring(EventData.SubjectDomainName), SubjectUserName = tostring(EventData.SubjectUserName)",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TargetAccount = strcat(EventData.TargetDomainName,\"\\\\\", EventData.TargetUserName)",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "targetaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend Activity=\"4722 - A user account was enabled.\"",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TargetUserName = tostring(EventData.TargetUserName), TargetDomainName = tostring(EventData.TargetDomainName)",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TargetUserName = tostring(EventData.TargetUserName), TargetDomainName = tostring(EventData.TargetDomainName)",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "targetdomainname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TargetSid = tostring(EventData.TargetSid)",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "targetsid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend UserPrincipalName = tostring(EventData.UserPrincipalName)",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project EnableTime = TimeGenerated, EnableEventID = EventID, EnableActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "enabletime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project EnableTime = TimeGenerated, EnableEventID = EventID, EnableActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "enableeventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project EnableTime = TimeGenerated, EnableEventID = EventID, EnableActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "enableactivity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project EnableTime = TimeGenerated, EnableEventID = EventID, EnableActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "    | project DisableTime = TimeGenerated, DisableEventID = EventID, DisableActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "disabletime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project DisableTime = TimeGenerated, DisableEventID = EventID, DisableActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "disableeventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project DisableTime = TimeGenerated, DisableEventID = EventID, DisableActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "disableactivity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project DisableTime = TimeGenerated, DisableEventID = EventID, DisableActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SubjectUserSid = tostring(EventData.SubjectUserSid)",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "subjectusersid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend AccountType=case(EventData.SubjectUserName endswith \"$\" or SubjectUserSid in (\"S-1-5-18\", \"S-1-5-19\", \"S-1-5-20\"), \"Machine\", isempty(SubjectUserSid), \"\", \"User\")",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SubjectAccount = strcat(tostring(EventData.SubjectDomainName),\"\\\\\", tostring(EventData.SubjectUserName))",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "subjectaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SubjectDomainName = tostring(EventData.SubjectDomainName), SubjectUserName = tostring(EventData.SubjectUserName)",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SubjectDomainName = tostring(EventData.SubjectDomainName), SubjectUserName = tostring(EventData.SubjectUserName)",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TargetAccount = strcat(EventData.TargetDomainName,\"\\\\\", EventData.TargetUserName)",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "targetaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TargetUserName = tostring(EventData.TargetUserName), TargetDomainName = tostring(EventData.TargetDomainName)",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TargetUserName = tostring(EventData.TargetUserName), TargetDomainName = tostring(EventData.TargetDomainName)",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "targetdomainname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TargetSid = tostring(EventData.TargetSid)",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "targetsid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend UserPrincipalName = tostring(EventData.UserPrincipalName)",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend Activity = \"4725 - A user account was disabled.\"",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project DisableTime = TimeGenerated, DisableEventID = EventID, DisableActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "disabletime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project DisableTime = TimeGenerated, DisableEventID = EventID, DisableActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "disableeventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project DisableTime = TimeGenerated, DisableEventID = EventID, DisableActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "disableactivity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project DisableTime = TimeGenerated, DisableEventID = EventID, DisableActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend TimeDelta = DisableTime - EnableTime",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "timedelta",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeDelta, EnableTime, EnableEventID, EnableActivity, Computer, TargetAccount, TargetSid, TargetUserName, TargetDomainName, UserPrincipalName,",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "timedelta",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeDelta, EnableTime, EnableEventID, EnableActivity, Computer, TargetAccount, TargetSid, TargetUserName, TargetDomainName, UserPrincipalName,",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "enabletime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeDelta, EnableTime, EnableEventID, EnableActivity, Computer, TargetAccount, TargetSid, TargetUserName, TargetDomainName, UserPrincipalName,",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "enableeventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeDelta, EnableTime, EnableEventID, EnableActivity, Computer, TargetAccount, TargetSid, TargetUserName, TargetDomainName, UserPrincipalName,",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "enableactivity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeDelta, EnableTime, EnableEventID, EnableActivity, Computer, TargetAccount, TargetSid, TargetUserName, TargetDomainName, UserPrincipalName,",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeDelta, EnableTime, EnableEventID, EnableActivity, Computer, TargetAccount, TargetSid, TargetUserName, TargetDomainName, UserPrincipalName,",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "targetaccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeDelta, EnableTime, EnableEventID, EnableActivity, Computer, TargetAccount, TargetSid, TargetUserName, TargetDomainName, UserPrincipalName,",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "targetsid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeDelta, EnableTime, EnableEventID, EnableActivity, Computer, TargetAccount, TargetSid, TargetUserName, TargetDomainName, UserPrincipalName,",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeDelta, EnableTime, EnableEventID, EnableActivity, Computer, TargetAccount, TargetSid, TargetUserName, TargetDomainName, UserPrincipalName,",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "targetdomainname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeDelta, EnableTime, EnableEventID, EnableActivity, Computer, TargetAccount, TargetSid, TargetUserName, TargetDomainName, UserPrincipalName,",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "useraccountenableddisabled-10m.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), FailedLogonCount = count() by bin(TimeGenerated,10m), EventID,",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), FailedLogonCount = count() by bin(TimeGenerated,10m), EventID,",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), FailedLogonCount = count() by bin(TimeGenerated,10m), EventID,",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "failedlogoncount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), FailedLogonCount = count() by bin(TimeGenerated,10m), EventID,",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TargetAccount = strcat(tostring(EventData.TargetDomainName), \"\\\\\", tostring(EventData.TargetUserName))",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "targetaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TargetUserSid = tostring(EventData.TargetUserSid)",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "targetusersid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend AccountType=case(EventData.TargetUserName endswith \"$\" or TargetUserSid in (\"S-1-5-18\", \"S-1-5-19\", \"S-1-5-20\"), \"Machine\", isempty(TargetUserSid), \"\", \"User\")",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SubStatus = tostring(EventData.SubStatus)",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "substatus",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend Activity=\"4625 - An account failed to log on.\"",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TargetUserName = tostring(EventData.TargetUserName)",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TargetDomainName = tostring(EventData.TargetDomainName)",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "targetdomainname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend LogonType = tostring(EventData.LogonType)",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "logontype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend Status= tostring(EventData.Status)",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "status",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend LogonProcessName = tostring(EventData.LogonProcessName)",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "logonprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "    | extend WorkstationName = tostring(EventData.WorkstationName)",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "workstationname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend IpAddress = tostring(EventData.IpAddress)",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "    | extend LogonTypeName=case(",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "logontypename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), FailedLogonCount = count() by bin(TimeGenerated,10m), EventID,",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), FailedLogonCount = count() by bin(TimeGenerated,10m), EventID,",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), FailedLogonCount = count() by bin(TimeGenerated,10m), EventID,",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "failedlogoncount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), FailedLogonCount = count() by bin(TimeGenerated,10m), EventID,",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(TimeGenerated, *) by Computer, TargetAccount, TargetUserName, TargetDomainName",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(TimeGenerated, *) by Computer, TargetAccount, TargetUserName, TargetDomainName",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "targetaccount",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(TimeGenerated, *) by Computer, TargetAccount, TargetUserName, TargetDomainName",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(TimeGenerated, *) by Computer, TargetAccount, TargetUserName, TargetDomainName",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "targetdomainname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "gte-6-failedlogons-10m.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "filehashentity-commonsecuritylog.yaml",
    "field": "latestindicatortime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "filehashentity-commonsecuritylog.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend CommonSecurityLog_TimeGenerated = TimeGenerated",
    "detection": "filehashentity-commonsecuritylog.yaml",
    "field": "commonsecuritylog_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize CommonSecurityLog_TimeGenerated = arg_max(CommonSecurityLog_TimeGenerated, *) by IndicatorId, FileHashValue",
    "detection": "filehashentity-commonsecuritylog.yaml",
    "field": "commonsecuritylog_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize CommonSecurityLog_TimeGenerated = arg_max(CommonSecurityLog_TimeGenerated, *) by IndicatorId, FileHashValue",
    "detection": "filehashentity-commonsecuritylog.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize CommonSecurityLog_TimeGenerated = arg_max(CommonSecurityLog_TimeGenerated, *) by IndicatorId, FileHashValue",
    "detection": "filehashentity-commonsecuritylog.yaml",
    "field": "filehashvalue",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project CommonSecurityLog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "filehashentity-commonsecuritylog.yaml",
    "field": "commonsecuritylog_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project CommonSecurityLog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "filehashentity-commonsecuritylog.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project CommonSecurityLog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "filehashentity-commonsecuritylog.yaml",
    "field": "activitygroupnames",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project CommonSecurityLog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "filehashentity-commonsecuritylog.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project CommonSecurityLog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "filehashentity-commonsecuritylog.yaml",
    "field": "threattype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project CommonSecurityLog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "filehashentity-commonsecuritylog.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project CommonSecurityLog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "filehashentity-commonsecuritylog.yaml",
    "field": "expirationdatetime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project CommonSecurityLog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "filehashentity-commonsecuritylog.yaml",
    "field": "confidencescore",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(DeviceName, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(DeviceName, '.'), 1, -1), '.'))",
    "detection": "filehashentity-commonsecuritylog.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(DeviceName, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(DeviceName, '.'), 1, -1), '.'))",
    "detection": "filehashentity-commonsecuritylog.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(SourceUserName, '@', 0)[0]), UPNSuffix = tostring(split(SourceUserName, '@', 1)[0])",
    "detection": "filehashentity-commonsecuritylog.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(SourceUserName, '@', 0)[0]), UPNSuffix = tostring(split(SourceUserName, '@', 1)[0])",
    "detection": "filehashentity-commonsecuritylog.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = CommonSecurityLog_TimeGenerated",
    "detection": "filehashentity-commonsecuritylog.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = SubjectUserName, AccountDomain = SubjectDomainName",
    "detection": "adfs-dkm-masterkey-export.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = SubjectUserName, AccountDomain = SubjectDomainName",
    "detection": "adfs-dkm-masterkey-export.yaml",
    "field": "accountdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DeviceName = Computer",
    "detection": "adfs-dkm-masterkey-export.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DeviceName = Computer",
    "detection": "adfs-dkm-masterkey-export.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ObjectServer = tostring(EventData.ObjectServer)",
    "detection": "adfs-dkm-masterkey-export.yaml",
    "field": "objectserver",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend OperationType = tostring(EventData.OperationType)",
    "detection": "adfs-dkm-masterkey-export.yaml",
    "field": "operationtype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ObjectType = tostring(EventData.ObjectType)",
    "detection": "adfs-dkm-masterkey-export.yaml",
    "field": "objecttype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Properties = tostring(EventData.Properties)",
    "detection": "adfs-dkm-masterkey-export.yaml",
    "field": "properties",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(EventData.SubjectUserName), AccountDomain = tostring(EventData.SubjectDomainName)",
    "detection": "adfs-dkm-masterkey-export.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(EventData.SubjectUserName), AccountDomain = tostring(EventData.SubjectDomainName)",
    "detection": "adfs-dkm-masterkey-export.yaml",
    "field": "accountdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DeviceName = Computer",
    "detection": "adfs-dkm-masterkey-export.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DeviceName = Computer",
    "detection": "adfs-dkm-masterkey-export.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountName = InitiatingProcessAccountName, AccountDomain = InitiatingProcessAccountDomain",
    "detection": "adfs-dkm-masterkey-export.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountName = InitiatingProcessAccountName, AccountDomain = InitiatingProcessAccountDomain",
    "detection": "adfs-dkm-masterkey-export.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountName = InitiatingProcessAccountName, AccountDomain = InitiatingProcessAccountDomain",
    "detection": "adfs-dkm-masterkey-export.yaml",
    "field": "accountdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = strcat(AccountDomain, \"\\\\\", AccountName)",
    "detection": "adfs-dkm-masterkey-export.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend  SourceIP = extract('((\\\\d{1,3}\\\\.){3}\\\\d{1,3}).*?((\\\\d{1,3}\\\\.){3}\\\\d{1,3})', 1, SyslogMessage)",
    "detection": "log4j-detection.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = sIP, DestinationHostName = sSiteName, UserAgent = csUserAgent),",
    "detection": "log4j-detection.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = ClientIP),",
    "detection": "log4j-detection.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = clientIP_s, DestinationIP = host_s, UserAgent = userAgent_s)",
    "detection": "log4j-detection.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = SourceUserID, Computer = DeviceName, IPAddress = SourceIP",
    "detection": "zincjan272021iocs.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = SourceUserID, Computer = DeviceName, IPAddress = SourceIP",
    "detection": "zincjan272021iocs.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = SourceUserID, Computer = DeviceName, IPAddress = SourceIP",
    "detection": "zincjan272021iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, FileHash, DNSName",
    "detection": "zincjan272021iocs.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, FileHash, DNSName",
    "detection": "zincjan272021iocs.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, FileHash, DNSName",
    "detection": "zincjan272021iocs.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, FileHash, DNSName",
    "detection": "zincjan272021iocs.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, FileHash, DNSName",
    "detection": "zincjan272021iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, FileHash, DNSName",
    "detection": "zincjan272021iocs.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, FileHash, DNSName",
    "detection": "zincjan272021iocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DNSName = Name",
    "detection": "zincjan272021iocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Type = \"DnsEvents\", IPAddress = ClientIP",
    "detection": "zincjan272021iocs.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Type = \"DnsEvents\", IPAddress = ClientIP",
    "detection": "zincjan272021iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, IPAddress, DNSName",
    "detection": "zincjan272021iocs.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, IPAddress, DNSName",
    "detection": "zincjan272021iocs.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, IPAddress, DNSName",
    "detection": "zincjan272021iocs.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, IPAddress, DNSName",
    "detection": "zincjan272021iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, IPAddress, DNSName",
    "detection": "zincjan272021iocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DNSName = DnsQuery",
    "detection": "zincjan272021iocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Type = \"imDns\", IPAddress = SrcIpAddr, Computer=Dvc",
    "detection": "zincjan272021iocs.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Type = \"imDns\", IPAddress = SrcIpAddr, Computer=Dvc",
    "detection": "zincjan272021iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Type = \"imDns\", IPAddress = SrcIpAddr, Computer=Dvc",
    "detection": "zincjan272021iocs.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, IPAddress, DNSName",
    "detection": "zincjan272021iocs.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, IPAddress, DNSName",
    "detection": "zincjan272021iocs.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, IPAddress, DNSName",
    "detection": "zincjan272021iocs.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, IPAddress, DNSName",
    "detection": "zincjan272021iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, IPAddress, DNSName",
    "detection": "zincjan272021iocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPAddress = RemoteIp",
    "detection": "zincjan272021iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, IPAddress, DNSName",
    "detection": "zincjan272021iocs.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, IPAddress, DNSName",
    "detection": "zincjan272021iocs.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, IPAddress, DNSName",
    "detection": "zincjan272021iocs.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, IPAddress, DNSName",
    "detection": "zincjan272021iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, IPAddress, DNSName",
    "detection": "zincjan272021iocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EvData = parse_xml(EventData)",
    "detection": "zincjan272021iocs.yaml",
    "field": "evdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventDetail = EvData.DataItem.EventData.Data",
    "detection": "zincjan272021iocs.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Hashes = EventDetail.[16].[\"#text\"]",
    "detection": "zincjan272021iocs.yaml",
    "field": "hashes",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Type = strcat(Type, \": \", Source), Account = UserName, FileHash = Hashes",
    "detection": "zincjan272021iocs.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Type = strcat(Type, \": \", Source), Account = UserName, FileHash = Hashes",
    "detection": "zincjan272021iocs.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Type = strcat(Type, \": \", Source), Account = UserName, FileHash = Hashes",
    "detection": "zincjan272021iocs.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, FileHash",
    "detection": "zincjan272021iocs.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, FileHash",
    "detection": "zincjan272021iocs.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, FileHash",
    "detection": "zincjan272021iocs.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, FileHash",
    "detection": "zincjan272021iocs.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, FileHash",
    "detection": "zincjan272021iocs.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = RequestAccountName, Computer = DeviceName, IPAddress = RequestSourceIP, CommandLine = InitiatingProcessCommandLine, FileHash = SHA256",
    "detection": "zincjan272021iocs.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = RequestAccountName, Computer = DeviceName, IPAddress = RequestSourceIP, CommandLine = InitiatingProcessCommandLine, FileHash = SHA256",
    "detection": "zincjan272021iocs.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = RequestAccountName, Computer = DeviceName, IPAddress = RequestSourceIP, CommandLine = InitiatingProcessCommandLine, FileHash = SHA256",
    "detection": "zincjan272021iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = RequestAccountName, Computer = DeviceName, IPAddress = RequestSourceIP, CommandLine = InitiatingProcessCommandLine, FileHash = SHA256",
    "detection": "zincjan272021iocs.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = RequestAccountName, Computer = DeviceName, IPAddress = RequestSourceIP, CommandLine = InitiatingProcessCommandLine, FileHash = SHA256",
    "detection": "zincjan272021iocs.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "zincjan272021iocs.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "zincjan272021iocs.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "zincjan272021iocs.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "zincjan272021iocs.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "zincjan272021iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "zincjan272021iocs.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "zincjan272021iocs.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "zincjan272021iocs.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "zincjan272021iocs.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "zincjan272021iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "zincjan272021iocs.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "zincjan272021iocs.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "zincjan272021iocs.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "zincjan272021iocs.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "zincjan272021iocs.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "zincjan272021iocs.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "zincjan272021iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "zincjan272021iocs.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "zincjan272021iocs.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Computer = DeviceName, IPAddress = LocalIP, Account = InitiatingProcessAccountName",
    "detection": "zincjan272021iocs.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Computer = DeviceName, IPAddress = LocalIP, Account = InitiatingProcessAccountName",
    "detection": "zincjan272021iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Computer = DeviceName, IPAddress = LocalIP, Account = InitiatingProcessAccountName",
    "detection": "zincjan272021iocs.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, RemoteUrl",
    "detection": "zincjan272021iocs.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, RemoteUrl",
    "detection": "zincjan272021iocs.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, RemoteUrl",
    "detection": "zincjan272021iocs.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, RemoteUrl",
    "detection": "zincjan272021iocs.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, RemoteUrl",
    "detection": "zincjan272021iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, RemoteUrl",
    "detection": "zincjan272021iocs.yaml",
    "field": "remoteurl",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Computer = tostring(parse_json(Entities)[0].HostName)",
    "detection": "zincjan272021iocs.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer",
    "detection": "zincjan272021iocs.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer",
    "detection": "zincjan272021iocs.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer",
    "detection": "zincjan272021iocs.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Computer = DeviceName, Account = AccountName, CommandLine = ProcessCommandLine",
    "detection": "zincjan272021iocs.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Computer = DeviceName, Account = AccountName, CommandLine = ProcessCommandLine",
    "detection": "zincjan272021iocs.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Computer = DeviceName, Account = AccountName, CommandLine = ProcessCommandLine",
    "detection": "zincjan272021iocs.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, CommandLine, FileName",
    "detection": "zincjan272021iocs.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, CommandLine, FileName",
    "detection": "zincjan272021iocs.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, CommandLine, FileName",
    "detection": "zincjan272021iocs.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, CommandLine, FileName",
    "detection": "zincjan272021iocs.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, CommandLine, FileName",
    "detection": "zincjan272021iocs.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, CommandLine, FileName",
    "detection": "zincjan272021iocs.yaml",
    "field": "filename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, ProcessName, CommandLine",
    "detection": "zincjan272021iocs.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, ProcessName, CommandLine",
    "detection": "zincjan272021iocs.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, ProcessName, CommandLine",
    "detection": "zincjan272021iocs.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, ProcessName, CommandLine",
    "detection": "zincjan272021iocs.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, ProcessName, CommandLine",
    "detection": "zincjan272021iocs.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, ProcessName, CommandLine",
    "detection": "zincjan272021iocs.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend DNSName = Request_Name",
    "detection": "zincjan272021iocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPAddress = ClientIP",
    "detection": "zincjan272021iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DNSName = DestinationHost",
    "detection": "zincjan272021iocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPAddress = SourceHost",
    "detection": "zincjan272021iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IPAddress",
    "detection": "zincjan272021iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IPAddress",
    "detection": "zincjan272021iocs.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IPAddress",
    "detection": "zincjan272021iocs.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IPAddress",
    "detection": "zincjan272021iocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AccountCustomEntity = SourceUserID, HostCustomEntity = DeviceName, IPCustomEntity = SourceIP",
    "detection": "solorigate-network-beacon.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AccountCustomEntity = SourceUserID, HostCustomEntity = DeviceName, IPCustomEntity = SourceIP",
    "detection": "solorigate-network-beacon.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AccountCustomEntity = SourceUserID, HostCustomEntity = DeviceName, IPCustomEntity = SourceIP",
    "detection": "solorigate-network-beacon.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend DNSName = Name",
    "detection": "solorigate-network-beacon.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend IPCustomEntity = ClientIP",
    "detection": "solorigate-network-beacon.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend DNSName = DnsQuery",
    "detection": "solorigate-network-beacon.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend IPCustomEntity = SrcIpAddr",
    "detection": "solorigate-network-beacon.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend IPCustomEntity = RemoteIp",
    "detection": "solorigate-network-beacon.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend DNSName = RemoteUrl",
    "detection": "solorigate-network-beacon.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend IPCustomEntity = RemoteIP",
    "detection": "solorigate-network-beacon.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend HostCustomEntity = DeviceName",
    "detection": "solorigate-network-beacon.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "  | extend DNSName = Request_Name",
    "detection": "solorigate-network-beacon.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend IPCustomEntity = ClientIP",
    "detection": "solorigate-network-beacon.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend DNSName = DestinationHost",
    "detection": "solorigate-network-beacon.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend IPCustomEntity = SourceHost",
    "detection": "solorigate-network-beacon.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TI_ipEntity = iff(isnotempty(NetworkIP), NetworkIP, NetworkDestinationIP)",
    "detection": "ipentity-awscloudtrail.yaml",
    "field": "ti_ipentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TI_ipEntity = iff(isempty(TI_ipEntity) and isnotempty(NetworkSourceIP), NetworkSourceIP, TI_ipEntity)",
    "detection": "ipentity-awscloudtrail.yaml",
    "field": "ti_ipentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TI_ipEntity = iff(isempty(TI_ipEntity) and isnotempty(EmailSourceIpAddress), EmailSourceIpAddress, TI_ipEntity)",
    "detection": "ipentity-awscloudtrail.yaml",
    "field": "ti_ipentity",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "ipentity-awscloudtrail.yaml",
    "field": "latestindicatortime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "ipentity-awscloudtrail.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend AWSCloudTrail_TimeGenerated = TimeGenerated // Rename time column for clarity",
    "detection": "ipentity-awscloudtrail.yaml",
    "field": "awscloudtrail_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize AWSCloudTrail_TimeGenerated = arg_max(AWSCloudTrail_TimeGenerated, *) by IndicatorId, SourceIpAddress",
    "detection": "ipentity-awscloudtrail.yaml",
    "field": "awscloudtrail_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize AWSCloudTrail_TimeGenerated = arg_max(AWSCloudTrail_TimeGenerated, *) by IndicatorId, SourceIpAddress",
    "detection": "ipentity-awscloudtrail.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize AWSCloudTrail_TimeGenerated = arg_max(AWSCloudTrail_TimeGenerated, *) by IndicatorId, SourceIpAddress",
    "detection": "ipentity-awscloudtrail.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "  | project AWSCloudTrail_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "ipentity-awscloudtrail.yaml",
    "field": "awscloudtrail_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project AWSCloudTrail_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "ipentity-awscloudtrail.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project AWSCloudTrail_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "ipentity-awscloudtrail.yaml",
    "field": "activitygroupnames",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project AWSCloudTrail_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "ipentity-awscloudtrail.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project AWSCloudTrail_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "ipentity-awscloudtrail.yaml",
    "field": "threattype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project AWSCloudTrail_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "ipentity-awscloudtrail.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project AWSCloudTrail_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "ipentity-awscloudtrail.yaml",
    "field": "expirationdatetime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project AWSCloudTrail_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "ipentity-awscloudtrail.yaml",
    "field": "confidencescore",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend timestamp = AWSCloudTrail_TimeGenerated",
    "detection": "ipentity-awscloudtrail.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventDetail = EvData.DataItem.EventData.Data",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = tostring(EventDetail.[9].[\"#text\"]), DestinationIP = tostring(EventDetail.[14].[\"#text\"])",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = tostring(EventDetail.[9].[\"#text\"]), DestinationIP = tostring(EventDetail.[14].[\"#text\"])",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Message, SourceUserID, RequestURL, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Message, SourceUserID, RequestURL, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Message, SourceUserID, RequestURL, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Message, SourceUserID, RequestURL, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Message, SourceUserID, RequestURL, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "sourceuserid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Message, SourceUserID, RequestURL, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "requesturl",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Message, SourceUserID, RequestURL, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend MessageIP = extract(IPRegex, 0, Message)",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "messageip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case(SourceIP in (ipMatch), \"SourceIP\", DestinationIP in (ipMatch), \"DestinationIP\", MessageIP in (ipMatch), \"Message\", \"No Match\")",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, IPMatch == \"Message\", MessageIP, \"No Match\")",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, IPMatch == \"Message\", MessageIP, \"No Match\")",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "ipentity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserAgent, Operation, RecordType, UserId, ClientIP, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserAgent, Operation, RecordType, UserId, ClientIP, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserAgent, Operation, RecordType, UserId, ClientIP, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserAgent, Operation, RecordType, UserId, ClientIP, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "recordtype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserAgent, Operation, RecordType, UserId, ClientIP, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserAgent, Operation, RecordType, UserId, ClientIP, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserAgent, Operation, RecordType, UserId, ClientIP, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIPAddress = ClientIP, Account = UserId",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIPAddress = ClientIP, Account = UserId",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPEntity = SourceIPAddress , AccountEntity = Account",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPEntity = SourceIPAddress , AccountEntity = Account",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "ipentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPEntity = SourceIPAddress , AccountEntity = Account",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "accountentity",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, IPAddresses, Name, ClientIP, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, IPAddresses, Name, ClientIP, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, IPAddresses, Name, ClientIP, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "ipaddresses",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, IPAddresses, Name, ClientIP, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, IPAddresses, Name, ClientIP, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, IPAddresses, Name, ClientIP, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = IPAddresses,  Host = Computer",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "destinationipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = IPAddresses,  Host = Computer",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "host",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPEntity = DestinationIPAddress, HostEntity = Host",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPEntity = DestinationIPAddress, HostEntity = Host",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "ipentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPEntity = DestinationIPAddress, HostEntity = Host",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "hostentity",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SourceIp, DestinationIp, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SourceIp, DestinationIp, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SourceIp, DestinationIp, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SourceIp, DestinationIp, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SourceIp, DestinationIp, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case( SourceIp in (ipMatch), \"SourceIP\", DestinationIp in (ipMatch), \"DestinationIP\", \"None\")",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPEntity = case(IPMatch == \"SourceIP\", SourceIp, IPMatch == \"DestinationIP\", DestinationIp, \"None\"), Host = Computer",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPEntity = case(IPMatch == \"SourceIP\", SourceIp, IPMatch == \"DestinationIP\", DestinationIp, \"None\"), Host = Computer",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "ipentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPEntity = case(IPMatch == \"SourceIP\", SourceIp, IPMatch == \"DestinationIP\", DestinationIp, \"None\"), Host = Computer",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "host",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventData, UserName, Computer, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventData, UserName, Computer, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "eventdata",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventData, UserName, Computer, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventData, UserName, Computer, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventData, UserName, Computer, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EvData = parse_xml(EventData)",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "evdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventDetail = EvData.DataItem.EventData.Data",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = tostring(EventDetail.[9].[\"#text\"]), DestinationIP = tostring(EventDetail.[14].[\"#text\"])",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = tostring(EventDetail.[9].[\"#text\"]), DestinationIP = tostring(EventDetail.[14].[\"#text\"])",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case( SourceIP in (ipMatch), \"SourceIP\", DestinationIP in (ipMatch), \"DestinationIP\", \"None\")",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountEntity = UserName, HostEntity = Computer , IPEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountEntity = UserName, HostEntity = Computer , IPEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "accountentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountEntity = UserName, HostEntity = Computer , IPEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "hostentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountEntity = UserName, HostEntity = Computer , IPEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "ipentity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserPrincipalName, IPAddress, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserPrincipalName, IPAddress, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserPrincipalName, IPAddress, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserPrincipalName, IPAddress, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountEntity = UserPrincipalName, IPEntity = IPAddress",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountEntity = UserPrincipalName, IPEntity = IPAddress",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "accountentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountEntity = UserPrincipalName, IPEntity = IPAddress",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "ipentity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserPrincipalName, IPAddress, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserPrincipalName, IPAddress, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserPrincipalName, IPAddress, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserPrincipalName, IPAddress, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountEntity = UserPrincipalName, IPEntity = IPAddress",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountEntity = UserPrincipalName, IPEntity = IPAddress",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "accountentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountEntity = UserPrincipalName, IPEntity = IPAddress",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "ipentity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, cIP, csUserName, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, cIP, csUserName, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, cIP, csUserName, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "cip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, cIP, csUserName, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "csusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, cIP, csUserName, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPEntity = cIP, HostEntity = Computer, AccountEntity = csUserName",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPEntity = cIP, HostEntity = Computer, AccountEntity = csUserName",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "ipentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPEntity = cIP, HostEntity = Computer, AccountEntity = csUserName",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "hostentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPEntity = cIP, HostEntity = Computer, AccountEntity = csUserName",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "accountentity",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, CallerIpAddress, Caller, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, CallerIpAddress, Caller, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "calleripaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, CallerIpAddress, Caller, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "caller",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, CallerIpAddress, Caller, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPEntity = CallerIpAddress, AccountEntity = Caller",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPEntity = CallerIpAddress, AccountEntity = Caller",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "ipentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPEntity = CallerIpAddress, AccountEntity = Caller",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "accountentity",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIpAddress, UserIdentityUserName, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIpAddress, UserIdentityUserName, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIpAddress, UserIdentityUserName, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "useridentityusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIpAddress, UserIdentityUserName, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPEntity = SourceIpAddress, AccountEntity = UserIdentityUserName",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPEntity = SourceIpAddress, AccountEntity = UserIdentityUserName",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "ipentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPEntity = SourceIpAddress, AccountEntity = UserIdentityUserName",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "accountentity",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, RemoteIP, DeviceName, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, RemoteIP, DeviceName, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "remoteip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, RemoteIP, DeviceName, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, RemoteIP, DeviceName, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPEntity = RemoteIP, HostEntity = DeviceName",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPEntity = RemoteIP, HostEntity = DeviceName",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "ipentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPEntity = RemoteIP, HostEntity = DeviceName",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "hostentity",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, msg_s, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, msg_s, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "msg_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, msg_s, Type",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPEntity = DestinationIP",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPEntity = DestinationIP",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "ipentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(AccountEntity, '@', 0)[0]), UPNSuffix = tostring(split(AccountEntity, '@', 1)[0])",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(AccountEntity, '@', 0)[0]), UPNSuffix = tostring(split(AccountEntity, '@', 1)[0])",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(HostEntity, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(HostEntity, '.'), 1, -1), '.'))",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(HostEntity, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(HostEntity, '.'), 1, -1), '.'))",
    "detection": "log4j-ipioc-dec112021.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": " | extend Value_2089 = iff(UserAccountControl has \"%%2089\",\"'Don't Expire Password' - Enabled\", \"Not Changed\")",
    "detection": "password-never-expires.yaml",
    "field": "value_2089",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": " | extend Value_2050 = iff(UserAccountControl has \"%%2050\",\"'Password Not Required' - Disabled\", \"Not Changed\")",
    "detection": "password-never-expires.yaml",
    "field": "value_2050",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": " | extend Value_2082 = iff(UserAccountControl has \"%%2082\",\"'Password Not Required' - Enabled\", \"Not Changed\")",
    "detection": "password-never-expires.yaml",
    "field": "value_2082",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": " | project StartTime = TimeGenerated, EventID, Activity, Computer, TargetAccount, TargetUserName, TargetDomainName, TargetSid,",
    "detection": "password-never-expires.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": " | project StartTime = TimeGenerated, EventID, Activity, Computer, TargetAccount, TargetUserName, TargetDomainName, TargetSid,",
    "detection": "password-never-expires.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": " | project StartTime = TimeGenerated, EventID, Activity, Computer, TargetAccount, TargetUserName, TargetDomainName, TargetSid,",
    "detection": "password-never-expires.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": " | project StartTime = TimeGenerated, EventID, Activity, Computer, TargetAccount, TargetUserName, TargetDomainName, TargetSid,",
    "detection": "password-never-expires.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": " | project StartTime = TimeGenerated, EventID, Activity, Computer, TargetAccount, TargetUserName, TargetDomainName, TargetSid,",
    "detection": "password-never-expires.yaml",
    "field": "targetaccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": " | project StartTime = TimeGenerated, EventID, Activity, Computer, TargetAccount, TargetUserName, TargetDomainName, TargetSid,",
    "detection": "password-never-expires.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": " | project StartTime = TimeGenerated, EventID, Activity, Computer, TargetAccount, TargetUserName, TargetDomainName, TargetSid,",
    "detection": "password-never-expires.yaml",
    "field": "targetdomainname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": " | project StartTime = TimeGenerated, EventID, Activity, Computer, TargetAccount, TargetUserName, TargetDomainName, TargetSid,",
    "detection": "password-never-expires.yaml",
    "field": "targetsid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": " | extend UserAccountControl = tostring(EventData.UserAccountControl)",
    "detection": "password-never-expires.yaml",
    "field": "useraccountcontrol",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": " | extend Value_2089 = iff(UserAccountControl has \"%%2089\",\"'Don't Expire Password' - Enabled\", \"Not Changed\")",
    "detection": "password-never-expires.yaml",
    "field": "value_2089",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": " | extend Value_2050 = iff(UserAccountControl has \"%%2050\",\"'Password Not Required' - Disabled\", \"Not Changed\")",
    "detection": "password-never-expires.yaml",
    "field": "value_2050",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": " | extend Value_2082 = iff(UserAccountControl has \"%%2082\",\"'Password Not Required' - Enabled\", \"Not Changed\")",
    "detection": "password-never-expires.yaml",
    "field": "value_2082",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": " | extend Activity=\"4738 - A user account was changed.\"",
    "detection": "password-never-expires.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": " | extend TargetAccount = strcat(EventData.TargetDomainName,\"\\\\\", EventData.TargetUserName)",
    "detection": "password-never-expires.yaml",
    "field": "targetaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": " | extend TargetSid = tostring(EventData.TargetSid)",
    "detection": "password-never-expires.yaml",
    "field": "targetsid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": " | extend SubjectAccount = strcat(EventData.SubjectDomainName,\"\\\\\", EventData.SubjectUserName)",
    "detection": "password-never-expires.yaml",
    "field": "subjectaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": " | extend SubjectUserSid = tostring(EventData.SubjectUserSid)",
    "detection": "password-never-expires.yaml",
    "field": "subjectusersid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": " | extend AccountType=case(SubjectAccount endswith \"$\" or SubjectUserSid in (\"S-1-5-18\", \"S-1-5-19\", \"S-1-5-20\"), \"Machine\", isempty(SubjectUserSid), \"\", \"User\")",
    "detection": "password-never-expires.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": " | project StartTime = TimeGenerated, EventID, Activity, Computer, TargetAccount, TargetUserName = tostring(EventData.TargetUserName), TargetDomainName = tostring(EventData.TargetDomainName), TargetSid,",
    "detection": "password-never-expires.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": " | project StartTime = TimeGenerated, EventID, Activity, Computer, TargetAccount, TargetUserName = tostring(EventData.TargetUserName), TargetDomainName = tostring(EventData.TargetDomainName), TargetSid,",
    "detection": "password-never-expires.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": " | project StartTime = TimeGenerated, EventID, Activity, Computer, TargetAccount, TargetUserName = tostring(EventData.TargetUserName), TargetDomainName = tostring(EventData.TargetDomainName), TargetSid,",
    "detection": "password-never-expires.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": " | project StartTime = TimeGenerated, EventID, Activity, Computer, TargetAccount, TargetUserName = tostring(EventData.TargetUserName), TargetDomainName = tostring(EventData.TargetDomainName), TargetSid,",
    "detection": "password-never-expires.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": " | project StartTime = TimeGenerated, EventID, Activity, Computer, TargetAccount, TargetUserName = tostring(EventData.TargetUserName), TargetDomainName = tostring(EventData.TargetDomainName), TargetSid,",
    "detection": "password-never-expires.yaml",
    "field": "targetaccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": " | project StartTime = TimeGenerated, EventID, Activity, Computer, TargetAccount, TargetUserName = tostring(EventData.TargetUserName), TargetDomainName = tostring(EventData.TargetDomainName), TargetSid,",
    "detection": "password-never-expires.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": " | project StartTime = TimeGenerated, EventID, Activity, Computer, TargetAccount, TargetUserName = tostring(EventData.TargetUserName), TargetDomainName = tostring(EventData.TargetDomainName), TargetSid,",
    "detection": "password-never-expires.yaml",
    "field": "targetdomainname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": " | project StartTime = TimeGenerated, EventID, Activity, Computer, TargetAccount, TargetUserName = tostring(EventData.TargetUserName), TargetDomainName = tostring(EventData.TargetDomainName), TargetSid,",
    "detection": "password-never-expires.yaml",
    "field": "targetsid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": " | extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "password-never-expires.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": " | extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "password-never-expires.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": " | extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "password-never-expires.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend LoginResult = tostring(parse_json(ResponseElements).ConsoleLogin)",
    "detection": "awsconsoleaadcorrelation.yaml",
    "field": "loginresult",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by SourceIpAddress",
    "detection": "awsconsoleaadcorrelation.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Reason = \"Multiple failed AWS Console logins from IP address\"",
    "detection": "awsconsoleaadcorrelation.yaml",
    "field": "reason",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountName = tostring(split(UserPrincipalName, \"@\")[0]), AccountUPNSuffix = tostring(split(UserPrincipalName, \"@\")[1])",
    "detection": "awsconsoleaadcorrelation.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountName = tostring(split(UserPrincipalName, \"@\")[0]), AccountUPNSuffix = tostring(split(UserPrincipalName, \"@\")[1])",
    "detection": "awsconsoleaadcorrelation.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountName = tostring(split(UserPrincipalName, \"@\")[0]), AccountUPNSuffix = tostring(split(UserPrincipalName, \"@\")[1])",
    "detection": "awsconsoleaadcorrelation.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, AccountType, Account, Process",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, AccountType, Account, Process",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, AccountType, Account, Process",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, AccountType, Account, Process",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, AccountType, Account, Process",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Process, TimeGenerated, Total, baseline, anomalies, score",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Process, TimeGenerated, Total, baseline, anomalies, score",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Process, TimeGenerated, Total, baseline, anomalies, score",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "total",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Process, TimeGenerated, Total, baseline, anomalies, score",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "baseline",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Process, TimeGenerated, Total, baseline, anomalies, score",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "anomalies",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Process, TimeGenerated, Total, baseline, anomalies, score",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "score",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DateHour = bin(TimeGenerated, 1h) // create a new column and round to hour",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "datehour",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize CommandlineCount = count() by bin(TimeGenerated, 1h), Process, CommandLine, Computer, Account",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "commandlinecount",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize CommandlineCount = count() by bin(TimeGenerated, 1h), Process, CommandLine, Computer, Account",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize CommandlineCount = count() by bin(TimeGenerated, 1h), Process, CommandLine, Computer, Account",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize CommandlineCount = count() by bin(TimeGenerated, 1h), Process, CommandLine, Computer, Account",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize CommandlineCount = count() by bin(TimeGenerated, 1h), Process, CommandLine, Computer, Account",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AnomalyHour = TimeGenerated, Computer, Account, Process, CommandLine, CommandlineCount, Total, baseline, anomalies, score",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "anomalyhour",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AnomalyHour = TimeGenerated, Computer, Account, Process, CommandLine, CommandlineCount, Total, baseline, anomalies, score",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project AnomalyHour = TimeGenerated, Computer, Account, Process, CommandLine, CommandlineCount, Total, baseline, anomalies, score",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AnomalyHour = TimeGenerated, Computer, Account, Process, CommandLine, CommandlineCount, Total, baseline, anomalies, score",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project AnomalyHour = TimeGenerated, Computer, Account, Process, CommandLine, CommandlineCount, Total, baseline, anomalies, score",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project AnomalyHour = TimeGenerated, Computer, Account, Process, CommandLine, CommandlineCount, Total, baseline, anomalies, score",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "commandlinecount",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project AnomalyHour = TimeGenerated, Computer, Account, Process, CommandLine, CommandlineCount, Total, baseline, anomalies, score",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "total",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AnomalyHour = TimeGenerated, Computer, Account, Process, CommandLine, CommandlineCount, Total, baseline, anomalies, score",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "baseline",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AnomalyHour = TimeGenerated, Computer, Account, Process, CommandLine, CommandlineCount, Total, baseline, anomalies, score",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "anomalies",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AnomalyHour = TimeGenerated, Computer, Account, Process, CommandLine, CommandlineCount, Total, baseline, anomalies, score",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "score",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = AnomalyHour, NTDomain = split(Account, '\\\\', 0)[0], Name = split(Account, '\\\\', 1)[0], HostName = tostring(split(Computer, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.'))",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = AnomalyHour, NTDomain = split(Account, '\\\\', 0)[0], Name = split(Account, '\\\\', 1)[0], HostName = tostring(split(Computer, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.'))",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "ntdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = AnomalyHour, NTDomain = split(Account, '\\\\', 0)[0], Name = split(Account, '\\\\', 1)[0], HostName = tostring(split(Computer, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.'))",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = AnomalyHour, NTDomain = split(Account, '\\\\', 0)[0], Name = split(Account, '\\\\', 1)[0], HostName = tostring(split(Computer, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.'))",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = AnomalyHour, NTDomain = split(Account, '\\\\', 0)[0], Name = split(Account, '\\\\', 1)[0], HostName = tostring(split(Computer, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.'))",
    "detection": "timeseriesanomaly-processexecutions.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend MSTI = case(AlertName has \"TI map\" and VendorName == \"Microsoft\" and ProductName == 'Azure Sentinel', true, false)",
    "detection": "urlentity-securityalerts.yaml",
    "field": "msti",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Url = coalesce(Entities.Url, Entities.Urls)",
    "detection": "urlentity-securityalerts.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Url = tolower(Url)",
    "detection": "urlentity-securityalerts.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Compromised_Host = tostring(parse_json(ExtendedProperties).[\"Compromised Host\"])",
    "detection": "urlentity-securityalerts.yaml",
    "field": "compromised_host",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Alert_TimeGenerated = TimeGenerated);",
    "detection": "urlentity-securityalerts.yaml",
    "field": "alert_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Url = tolower(Url)",
    "detection": "urlentity-securityalerts.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "urlentity-securityalerts.yaml",
    "field": "latestindicatortime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "urlentity-securityalerts.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Alert_TimeGenerated = arg_max(Alert_TimeGenerated, *) by IndicatorId, AlertName",
    "detection": "urlentity-securityalerts.yaml",
    "field": "alert_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Alert_TimeGenerated = arg_max(Alert_TimeGenerated, *) by IndicatorId, AlertName",
    "detection": "urlentity-securityalerts.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Alert_TimeGenerated = arg_max(Alert_TimeGenerated, *) by IndicatorId, AlertName",
    "detection": "urlentity-securityalerts.yaml",
    "field": "alertname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = Alert_TimeGenerated, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, AlertName, AlertSeverity, Description, Url, Compromised_Host",
    "detection": "urlentity-securityalerts.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = Alert_TimeGenerated, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, AlertName, AlertSeverity, Description, Url, Compromised_Host",
    "detection": "urlentity-securityalerts.yaml",
    "field": "activitygroupnames",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = Alert_TimeGenerated, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, AlertName, AlertSeverity, Description, Url, Compromised_Host",
    "detection": "urlentity-securityalerts.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = Alert_TimeGenerated, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, AlertName, AlertSeverity, Description, Url, Compromised_Host",
    "detection": "urlentity-securityalerts.yaml",
    "field": "threattype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = Alert_TimeGenerated, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, AlertName, AlertSeverity, Description, Url, Compromised_Host",
    "detection": "urlentity-securityalerts.yaml",
    "field": "expirationdatetime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = Alert_TimeGenerated, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, AlertName, AlertSeverity, Description, Url, Compromised_Host",
    "detection": "urlentity-securityalerts.yaml",
    "field": "confidencescore",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = Alert_TimeGenerated, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, AlertName, AlertSeverity, Description, Url, Compromised_Host",
    "detection": "urlentity-securityalerts.yaml",
    "field": "alertname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = Alert_TimeGenerated, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, AlertName, AlertSeverity, Description, Url, Compromised_Host",
    "detection": "urlentity-securityalerts.yaml",
    "field": "alertseverity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = Alert_TimeGenerated, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, AlertName, AlertSeverity, Description, Url, Compromised_Host",
    "detection": "urlentity-securityalerts.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = Alert_TimeGenerated, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, AlertName, AlertSeverity, Description, Url, Compromised_Host",
    "detection": "urlentity-securityalerts.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = Alert_TimeGenerated, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, AlertName, AlertSeverity, Description, Url, Compromised_Host",
    "detection": "urlentity-securityalerts.yaml",
    "field": "compromised_host",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case(SourceIP in (IPList), \"SourceIP\", DestinationIP in (IPList), \"DestinationIP\", \"Message\")",
    "detection": "poloniumipioc.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "poloniumipioc.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "poloniumipioc.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "poloniumipioc.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "poloniumipioc.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "poloniumipioc.yaml",
    "field": "deviceproduct",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "poloniumipioc.yaml",
    "field": "deviceaction",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "poloniumipioc.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "poloniumipioc.yaml",
    "field": "protocol",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "poloniumipioc.yaml",
    "field": "sourceport",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "poloniumipioc.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "poloniumipioc.yaml",
    "field": "deviceaddress",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "poloniumipioc.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "poloniumipioc.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"IP in Message Field\")",
    "detection": "poloniumipioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"IP in Message Field\")",
    "detection": "poloniumipioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = SourceIPAddress , AccountCustomEntity = Account",
    "detection": "poloniumipioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = SourceIPAddress , AccountCustomEntity = Account",
    "detection": "poloniumipioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = SourceIPAddress , AccountCustomEntity = Account",
    "detection": "poloniumipioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = ResponseName,  Host = SrcIpAddr",
    "detection": "poloniumipioc.yaml",
    "field": "destinationipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = ResponseName,  Host = SrcIpAddr",
    "detection": "poloniumipioc.yaml",
    "field": "host",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIPAddress, HostCustomEntity = Host",
    "detection": "poloniumipioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIPAddress, HostCustomEntity = Host",
    "detection": "poloniumipioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIPAddress, HostCustomEntity = Host",
    "detection": "poloniumipioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": " | extend timestamp = TimeGenerated, IPCustomEntity = SrcIpAddr, HostCustomEntity = Hostname, AccountCustomEntity=User",
    "detection": "poloniumipioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": " | extend timestamp = TimeGenerated, IPCustomEntity = SrcIpAddr, HostCustomEntity = Hostname, AccountCustomEntity=User",
    "detection": "poloniumipioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": " | extend timestamp = TimeGenerated, IPCustomEntity = SrcIpAddr, HostCustomEntity = Hostname, AccountCustomEntity=User",
    "detection": "poloniumipioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": " | extend timestamp = TimeGenerated, IPCustomEntity = SrcIpAddr, HostCustomEntity = Hostname, AccountCustomEntity=User",
    "detection": "poloniumipioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DstIpAddr, HostCustomEntity = Hostname , AccountCustomEntity = User",
    "detection": "poloniumipioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DstIpAddr, HostCustomEntity = Hostname , AccountCustomEntity = User",
    "detection": "poloniumipioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DstIpAddr, HostCustomEntity = Hostname , AccountCustomEntity = User",
    "detection": "poloniumipioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DstIpAddr, HostCustomEntity = Hostname , AccountCustomEntity = User",
    "detection": "poloniumipioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = Computer",
    "detection": "poloniumipioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = Computer",
    "detection": "poloniumipioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = Computer",
    "detection": "poloniumipioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, IPCustomEntity = IPAddress",
    "detection": "poloniumipioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, IPCustomEntity = IPAddress",
    "detection": "poloniumipioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, IPCustomEntity = IPAddress",
    "detection": "poloniumipioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, IPCustomEntity = IPAddress",
    "detection": "poloniumipioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, IPCustomEntity = IPAddress",
    "detection": "poloniumipioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, IPCustomEntity = IPAddress",
    "detection": "poloniumipioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = cIP, HostCustomEntity = Computer, AccountCustomEntity = csUserName",
    "detection": "poloniumipioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = cIP, HostCustomEntity = Computer, AccountCustomEntity = csUserName",
    "detection": "poloniumipioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = cIP, HostCustomEntity = Computer, AccountCustomEntity = csUserName",
    "detection": "poloniumipioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = cIP, HostCustomEntity = Computer, AccountCustomEntity = csUserName",
    "detection": "poloniumipioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = CallerIpAddress, AccountCustomEntity = Caller",
    "detection": "poloniumipioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = CallerIpAddress, AccountCustomEntity = Caller",
    "detection": "poloniumipioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = CallerIpAddress, AccountCustomEntity = Caller",
    "detection": "poloniumipioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SourceIpAddress, AccountCustomEntity = UserIdentityUserName",
    "detection": "poloniumipioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SourceIpAddress, AccountCustomEntity = UserIdentityUserName",
    "detection": "poloniumipioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SourceIpAddress, AccountCustomEntity = UserIdentityUserName",
    "detection": "poloniumipioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName",
    "detection": "poloniumipioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName",
    "detection": "poloniumipioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName",
    "detection": "poloniumipioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIP = DestinationHost",
    "detection": "poloniumipioc.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SourceHost",
    "detection": "poloniumipioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIP = DestinationHost",
    "detection": "poloniumipioc.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SourceHost",
    "detection": "poloniumipioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIP = DestinationIp",
    "detection": "poloniumipioc.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SourceIp",
    "detection": "poloniumipioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIP = Fqdn",
    "detection": "poloniumipioc.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SourceIp",
    "detection": "poloniumipioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Message, SourceUserID, RequestURL",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Message, SourceUserID, RequestURL",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Message, SourceUserID, RequestURL",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Message, SourceUserID, RequestURL",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Message, SourceUserID, RequestURL",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "sourceuserid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Message, SourceUserID, RequestURL",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "requesturl",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend MessageIP = extract(IPRegex, 0, Message)",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "messageip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case(SourceIP in (IPList), \"SourceIP\", DestinationIP in (IPList), \"DestinationIP\", MessageIP in (IPList), \"Message\", MessageIP in (IPList), \"Message\", \"NoMatch\")",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, IPMatch == \"Message\", MessageIP, \"NoMatch\"), AccountCustomEntity = SourceUserID",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, IPMatch == \"Message\", MessageIP, \"NoMatch\"), AccountCustomEntity = SourceUserID",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, IPMatch == \"Message\", MessageIP, \"NoMatch\"), AccountCustomEntity = SourceUserID",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "actiontype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "initiatingprocessaccountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "initiatingprocessaccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "initiatingprocesscommandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "initiatingprocessfolderpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "initiatingprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "initiatingprocessparentfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "initiatingprocessfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "remoteip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "remoteurl",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "remoteport",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, RemotePort, LocalIP",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "localip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = RemoteUrl, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = RemoteUrl, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = RemoteUrl, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = RemoteUrl, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, CommunicationDirection, SourceIP, DestinationIP, SourcePort, DestinationPort",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, CommunicationDirection, SourceIP, DestinationIP, SourcePort, DestinationPort",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, CommunicationDirection, SourceIP, DestinationIP, SourcePort, DestinationPort",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "communicationdirection",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, CommunicationDirection, SourceIP, DestinationIP, SourcePort, DestinationPort",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, CommunicationDirection, SourceIP, DestinationIP, SourcePort, DestinationPort",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, CommunicationDirection, SourceIP, DestinationIP, SourcePort, DestinationPort",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "sourceport",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, CommunicationDirection, SourceIP, DestinationIP, SourcePort, DestinationPort",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case( SourceIP in (IPList), \"SourceIP\", DestinationIP in (IPList), \"DestinationIP\", \"None\")",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,Resource, msg_s",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,Resource, msg_s",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,Resource, msg_s",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "msg_s",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = DestinationHost, IPCustomEntity = SourceHost",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = DestinationHost, IPCustomEntity = SourceHost",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = DestinationHost, IPCustomEntity = SourceHost",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "actiontype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "initiatingprocessaccountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "initiatingprocessaccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "initiatingprocesscommandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "initiatingprocessfolderpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "initiatingprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "initiatingprocessparentfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "initiatingprocessfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "requestaccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "requestsourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "initiatingprocesssha256",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = RequestAccountName, Computer = DeviceName, IPAddress = RequestSourceIP, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = RequestAccountName, Computer = DeviceName, IPAddress = RequestSourceIP, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = RequestAccountName, Computer = DeviceName, IPAddress = RequestSourceIP, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = RequestAccountName, Computer = DeviceName, IPAddress = RequestSourceIP, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = RequestAccountName, Computer = DeviceName, IPAddress = RequestSourceIP, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = FileHash",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = FileHash",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = FileHash",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = FileHash",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = FileHash",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "algorithmcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = FileHash",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,  Message, SourceUserID, FileHash",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,  Message, SourceUserID, FileHash",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,  Message, SourceUserID, FileHash",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "sourceuserid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,  Message, SourceUserID, FileHash",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = FileHash",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = FileHash",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "algorithmcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = FileHash",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "actiontype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "initiatingprocessaccountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "initiatingprocessaccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "initiatingprocesscommandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "initiatingprocessfolderpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "initiatingprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "initiatingprocessparentfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "initiatingprocessfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "initiatingprocesssha256",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = InitiatingProcessAccountName, Computer = DeviceName, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256, Image = InitiatingProcessFolderPath",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = InitiatingProcessAccountName, Computer = DeviceName, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256, Image = InitiatingProcessFolderPath",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = InitiatingProcessAccountName, Computer = DeviceName, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256, Image = InitiatingProcessFolderPath",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = InitiatingProcessAccountName, Computer = DeviceName, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256, Image = InitiatingProcessFolderPath",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = InitiatingProcessAccountName, Computer = DeviceName, CommandLine = InitiatingProcessCommandLine, FileHash = InitiatingProcessSHA256, Image = InitiatingProcessFolderPath",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = FileHash",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = FileHash",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = FileHash",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = FileHash",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = FileHash",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "algorithmcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = FileHash",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "newprocessid",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = NewProcessName",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = NewProcessName",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = NewProcessName",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = NewProcessName",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend NewProcessName = tostring(EventData.NewProcessName)",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend ParentProcessName = tostring(EventData.ParentProcessName)",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account =  strcat(EventData.SubjectDomainName,\"\\\\\", EventData.SubjectUserName)",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend NewProcessId = tostring(EventData.NewProcessId)",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "newprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "newprocessid",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = NewProcessName",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = NewProcessName",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = NewProcessName",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = NewProcessName",
    "detection": "wslmalwarecorrelation.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "        | extend Country = tostring(todynamic(LocationDetails)['countryOrRegion'])",
    "detection": "anomalousipusagefollowedbyteamsaction.yaml",
    "field": "country",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "        | summarize CountCountrySignin = count() by Country",
    "detection": "anomalousipusagefollowedbyteamsaction.yaml",
    "field": "countcountrysignin",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "        | summarize CountCountrySignin = count() by Country",
    "detection": "anomalousipusagefollowedbyteamsaction.yaml",
    "field": "country",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "        | extend TotalSignin = toscalar(signinData | summarize count())",
    "detection": "anomalousipusagefollowedbyteamsaction.yaml",
    "field": "totalsignin",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "        | extend CountryPrevalence = toreal(CountCountrySignin) / toreal(TotalSignin) * 100;",
    "detection": "anomalousipusagefollowedbyteamsaction.yaml",
    "field": "countryprevalence",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "        | summarize CountIPSignin = count(), Country = any(Country), ListSigninTimeGenerated = make_list(TimeGenerated) by IPAddress, UserPrincipalName;",
    "detection": "anomalousipusagefollowedbyteamsaction.yaml",
    "field": "countipsignin",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "        | summarize CountIPSignin = count(), Country = any(Country), ListSigninTimeGenerated = make_list(TimeGenerated) by IPAddress, UserPrincipalName;",
    "detection": "anomalousipusagefollowedbyteamsaction.yaml",
    "field": "country",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "        | summarize CountIPSignin = count(), Country = any(Country), ListSigninTimeGenerated = make_list(TimeGenerated) by IPAddress, UserPrincipalName;",
    "detection": "anomalousipusagefollowedbyteamsaction.yaml",
    "field": "listsignintimegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "        | summarize CountIPSignin = count(), Country = any(Country), ListSigninTimeGenerated = make_list(TimeGenerated) by IPAddress, UserPrincipalName;",
    "detection": "anomalousipusagefollowedbyteamsaction.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "        | summarize MaxIPSignin = max(CountIPSignin), MinIPSignin = min(CountIPSignin), DistinctCountries = dcount(Country), make_set(Country) by UserPrincipalName",
    "detection": "anomalousipusagefollowedbyteamsaction.yaml",
    "field": "maxipsignin",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "        | summarize MaxIPSignin = max(CountIPSignin), MinIPSignin = min(CountIPSignin), DistinctCountries = dcount(Country), make_set(Country) by UserPrincipalName",
    "detection": "anomalousipusagefollowedbyteamsaction.yaml",
    "field": "minipsignin",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "        | summarize MaxIPSignin = max(CountIPSignin), MinIPSignin = min(CountIPSignin), DistinctCountries = dcount(Country), make_set(Country) by UserPrincipalName",
    "detection": "anomalousipusagefollowedbyteamsaction.yaml",
    "field": "distinctcountries",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "        | summarize MaxIPSignin = max(CountIPSignin), MinIPSignin = min(CountIPSignin), DistinctCountries = dcount(Country), make_set(Country) by UserPrincipalName",
    "detection": "anomalousipusagefollowedbyteamsaction.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "        | extend UserIPDelta = toreal(MaxIPSignin - MinIPSignin) / toreal(MaxIPSignin) * 100;",
    "detection": "anomalousipusagefollowedbyteamsaction.yaml",
    "field": "useripdelta",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project OperationTimeGenerated = TimeGenerated, UserId = tolower(UserId), Operation",
    "detection": "anomalousipusagefollowedbyteamsaction.yaml",
    "field": "operationtimegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project OperationTimeGenerated = TimeGenerated, UserId = tolower(UserId), Operation",
    "detection": "anomalousipusagefollowedbyteamsaction.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project OperationTimeGenerated = TimeGenerated, UserId = tolower(UserId), Operation",
    "detection": "anomalousipusagefollowedbyteamsaction.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SigninTimeGenerated = todatetime(SigninTimeGenerated)",
    "detection": "anomalousipusagefollowedbyteamsaction.yaml",
    "field": "signintimegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(SigninTimeGenerated, *) by UserPrincipalName, SuspiciousIP, OperationTimeGenerated",
    "detection": "anomalousipusagefollowedbyteamsaction.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(SigninTimeGenerated, *) by UserPrincipalName, SuspiciousIP, OperationTimeGenerated",
    "detection": "anomalousipusagefollowedbyteamsaction.yaml",
    "field": "suspiciousip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize arg_max(SigninTimeGenerated, *) by UserPrincipalName, SuspiciousIP, OperationTimeGenerated",
    "detection": "anomalousipusagefollowedbyteamsaction.yaml",
    "field": "operationtimegenerated",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(UserPrincipalName, \"@\")[0]), AccountUPNSuffix = tostring(split(UserPrincipalName, \"@\")[1])",
    "detection": "anomalousipusagefollowedbyteamsaction.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(UserPrincipalName, \"@\")[0]), AccountUPNSuffix = tostring(split(UserPrincipalName, \"@\")[1])",
    "detection": "anomalousipusagefollowedbyteamsaction.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by IPAddress",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = extract(\"(([0-9]{1,3})\\\\.([0-9]{1,3})\\\\.([0-9]{1,3})\\\\.(([0-9]{1,3})))\",1,SyslogMessage)",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Reason = \"Multiple failed AAD logins from IP address\"",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "reason",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, HostIP, IpAddress = SourceIP, SyslogMessage, Facility, ProcessName, Reason;",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, HostIP, IpAddress = SourceIP, SyslogMessage, Facility, ProcessName, Reason;",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, HostIP, IpAddress = SourceIP, SyslogMessage, Facility, ProcessName, Reason;",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "hostip",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, HostIP, IpAddress = SourceIP, SyslogMessage, Facility, ProcessName, Reason;",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, HostIP, IpAddress = SourceIP, SyslogMessage, Facility, ProcessName, Reason;",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "syslogmessage",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, HostIP, IpAddress = SourceIP, SyslogMessage, Facility, ProcessName, Reason;",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "facility",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, HostIP, IpAddress = SourceIP, SyslogMessage, Facility, ProcessName, Reason;",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Reason = \"Multiple failed AAD logins from IP address\"",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "reason",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, LogonTypeName, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, LogonTypeName, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, LogonTypeName, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, LogonTypeName, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, LogonTypeName, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, LogonTypeName, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, LogonTypeName, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "logonprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, LogonTypeName, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, LogonTypeName, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "logontypename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, LogonTypeName, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "targetusersid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, LogonTypeName, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, LogonTypeName, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "targetdomainname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, LogonTypeName, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "_resourceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, LogonTypeName, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "reason",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend LogonType = tostring(EventData.LogonType)",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "logontype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend  IpAddress = tostring(EventData.IpAddress)",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Reason = \"Multiple failed AAD logins from IP address\"",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "reason",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Activity = \"4624 - An account was successfully logged on.\"",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetUserName = tostring(EventData.TargetUserName), TargetDomainName = tostring(EventData.TargetDomainName)",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetUserName = tostring(EventData.TargetUserName), TargetDomainName = tostring(EventData.TargetDomainName)",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "targetdomainname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account =  strcat(TargetDomainName,\"\\\\\", TargetUserName)",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetUserSid = tostring(EventData.TargetUserSid)",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "targetusersid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetAccount = strcat(EventData.TargetDomainName,\"\\\\\", EventData.TargetUserName)",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "targetaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountType =case(Account endswith \"$\" or TargetUserSid in (\"S-1-5-18\", \"S-1-5-19\", \"S-1-5-20\"), \"Machine\", isempty(TargetUserSid), \"\", \"User\")",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend LogonProcessName = tostring(EventData.LogonProcessName)",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "logonprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "logonprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "targetusersid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "targetdomainname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "_resourceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, AccountType, Computer, Activity, EventID, LogonProcessName, IpAddress, TargetUserSid, TargetUserName, TargetDomainName, _ResourceId, Reason",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "reason",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex+1), Computer)",
    "detection": "aadhostlogincorrelation.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TI_ipEntity = iff(isnotempty(NetworkIP), NetworkIP, NetworkDestinationIP)",
    "detection": "ipentity-vmconnection.yaml",
    "field": "ti_ipentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TI_ipEntity = iff(isempty(TI_ipEntity) and isnotempty(NetworkSourceIP), NetworkSourceIP, TI_ipEntity)",
    "detection": "ipentity-vmconnection.yaml",
    "field": "ti_ipentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TI_ipEntity = iff(isempty(TI_ipEntity) and isnotempty(EmailSourceIpAddress), EmailSourceIpAddress, TI_ipEntity)",
    "detection": "ipentity-vmconnection.yaml",
    "field": "ti_ipentity",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "ipentity-vmconnection.yaml",
    "field": "latestindicatortime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "ipentity-vmconnection.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend VMConnection_TimeGenerated = TimeGenerated",
    "detection": "ipentity-vmconnection.yaml",
    "field": "vmconnection_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize VMConnection_TimeGenerated = arg_max(VMConnection_TimeGenerated, *) by IndicatorId, RemoteIp",
    "detection": "ipentity-vmconnection.yaml",
    "field": "vmconnection_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize VMConnection_TimeGenerated = arg_max(VMConnection_TimeGenerated, *) by IndicatorId, RemoteIp",
    "detection": "ipentity-vmconnection.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "  | summarize VMConnection_TimeGenerated = arg_max(VMConnection_TimeGenerated, *) by IndicatorId, RemoteIp",
    "detection": "ipentity-vmconnection.yaml",
    "field": "remoteip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project VMConnection_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "ipentity-vmconnection.yaml",
    "field": "vmconnection_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project VMConnection_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "ipentity-vmconnection.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project VMConnection_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "ipentity-vmconnection.yaml",
    "field": "activitygroupnames",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project VMConnection_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "ipentity-vmconnection.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project VMConnection_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "ipentity-vmconnection.yaml",
    "field": "threattype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project VMConnection_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "ipentity-vmconnection.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project VMConnection_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "ipentity-vmconnection.yaml",
    "field": "expirationdatetime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project VMConnection_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "ipentity-vmconnection.yaml",
    "field": "confidencescore",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend timestamp = VMConnection_TimeGenerated, HostName = tostring(split(Computer, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.'))",
    "detection": "ipentity-vmconnection.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend timestamp = VMConnection_TimeGenerated, HostName = tostring(split(Computer, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.'))",
    "detection": "ipentity-vmconnection.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "  | extend timestamp = VMConnection_TimeGenerated, HostName = tostring(split(Computer, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.'))",
    "detection": "ipentity-vmconnection.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ParentProcessName = tostring(EventData.ParentProcessName)",
    "detection": "hafniumnewumservicechildprocess.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend NewProcessName = tostring(EventData.NewProcessName)",
    "detection": "hafniumnewumservicechildprocess.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = strcat(tostring(EventData.SubjectDomainName),\"\\\\\", tostring(EventData.SubjectUserName))",
    "detection": "hafniumnewumservicechildprocess.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend IpAddress = tostring(EventData.IpAddress)",
    "detection": "hafniumnewumservicechildprocess.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend ParentProcessName = tostring(EventData.ParentProcessName)",
    "detection": "hafniumnewumservicechildprocess.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend NewProcessName = tostring(EventData.NewProcessName)",
    "detection": "hafniumnewumservicechildprocess.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = strcat(tostring(EventData.SubjectDomainName),\"\\\\\", tostring(EventData.SubjectUserName))",
    "detection": "hafniumnewumservicechildprocess.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend IpAddress = tostring(EventData.IpAddress)) on NewProcessName",
    "detection": "hafniumnewumservicechildprocess.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "hafniumnewumservicechildprocess.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "hafniumnewumservicechildprocess.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "hafniumnewumservicechildprocess.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectUserName = tostring(EventData.SubjectUserName), SubjectDomainName = tostring(EventData.SubjectDomainName)",
    "detection": "hafniumnewumservicechildprocess.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectUserName = tostring(EventData.SubjectUserName), SubjectDomainName = tostring(EventData.SubjectDomainName)",
    "detection": "hafniumnewumservicechildprocess.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = ActorUsername, HostCustomEntity = DvcHostname",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = ActorUsername, HostCustomEntity = DvcHostname",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = ActorUsername, HostCustomEntity = DvcHostname",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = InitiatingProcessAccountName, HostCustomEntity = DeviceName",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = InitiatingProcessAccountName, HostCustomEntity = DeviceName",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = InitiatingProcessAccountName, HostCustomEntity = DeviceName",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = InitiatingProcessAccountName, HostCustomEntity = DeviceName",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = InitiatingProcessAccountName, HostCustomEntity = DeviceName",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = InitiatingProcessAccountName, HostCustomEntity = DeviceName",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EvData = parse_xml(EventData)",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "evdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventDetail = EvData.DataItem.EventData.Data",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Hashes = EventDetail.[16].[\"#text\"]",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "hashes",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Type = strcat(Type, \": \", Source), Account = UserName, FileHash = Hashes",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Type = strcat(Type, \": \", Source), Account = UserName, FileHash = Hashes",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Type = strcat(Type, \": \", Source), Account = UserName, FileHash = Hashes",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case(SourceIP in (ips), \"SourceIP\", DestinationIP in (ips), \"DestinationIP\", \"Message\")",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "deviceproduct",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "deviceaction",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "protocol",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "sourceport",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "deviceaddress",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"IP in Message Field\")",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"IP in Message Field\")",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case( SourceIp in (ips), \"SourceIP\", DestinationIp in (ips), \"DestinationIP\", \"None\")",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIp, IPMatch == \"DestinationIP\", DestinationIp, \"None\"), Host = Computer",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIp, IPMatch == \"DestinationIP\", DestinationIp, \"None\"), Host = Computer",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIp, IPMatch == \"DestinationIP\", DestinationIp, \"None\"), Host = Computer",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "host",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend EvData = parse_xml(EventData)",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "evdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventDetail = EvData.DataItem.EventData.Data",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = EventDetail.[9].[\"#text\"], DestinationIP = EventDetail.[14].[\"#text\"]",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = EventDetail.[9].[\"#text\"], DestinationIP = EventDetail.[14].[\"#text\"]",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case( SourceIP in (ips), \"SourceIP\", DestinationIP in (ips), \"DestinationIP\", \"None\")",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, HostCustomEntity = Computer , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = Computer",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = Computer",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = Computer",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = cIP, HostCustomEntity = Computer, AccountCustomEntity = csUserName",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = cIP, HostCustomEntity = Computer, AccountCustomEntity = csUserName",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = cIP, HostCustomEntity = Computer, AccountCustomEntity = csUserName",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = cIP, HostCustomEntity = Computer, AccountCustomEntity = csUserName",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case( SourceIP in (ips), \"SourceIP\", DestinationIP in (ips), \"DestinationIP\", \"None\")",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = ClientIP, HostCustomEntity = Computer",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = ClientIP, HostCustomEntity = Computer",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = ClientIP, HostCustomEntity = Computer",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SrcIpAddr, HostCustomEntity = Dvc",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SrcIpAddr, HostCustomEntity = Dvc",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SrcIpAddr, HostCustomEntity = Dvc",
    "detection": "exchangeservervulnerabilitiesmarch2021iocs.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = SourceIp, DestinationIP = DestinationIp",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = SourceIp, DestinationIP = DestinationIp",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceVendor = \"VMConnection\"",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "devicevendor",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, BytesSent, DeviceVendor",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, BytesSent, DeviceVendor",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "bytessent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, BytesSent, DeviceVendor",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "devicevendor",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SentBytes, DeviceVendor",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SentBytes, DeviceVendor",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "sentbytes",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SentBytes, DeviceVendor",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "devicevendor",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TotalBytesSentinMBperHour = round(((TotalBytesSent / 1024)/1024),2), baselinebytessentperHour = round(((baseline / 1024)/1024),2), score = round(score,2)",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "totalbytessentinmbperhour",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TotalBytesSentinMBperHour = round(((TotalBytesSent / 1024)/1024),2), baselinebytessentperHour = round(((baseline / 1024)/1024),2), score = round(score,2)",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "baselinebytessentperhour",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TotalBytesSentinMBperHour = round(((TotalBytesSent / 1024)/1024),2), baselinebytessentperHour = round(((baseline / 1024)/1024),2), score = round(score,2)",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "score",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DateHour = bin(TimeGenerated, 1h) // create a new column and round to hour",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "datehour",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SentBytesinMB = ((SentBytes / 1024)/1024), ReceivedBytesinMB = ((ReceivedBytes / 1024)/1024)",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "sentbytesinmb",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SentBytesinMB = ((SentBytes / 1024)/1024), ReceivedBytesinMB = ((ReceivedBytes / 1024)/1024)",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "receivedbytesinmb",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount = count(), TimeGeneratedMax=arg_max(TimeGenerated, *), DestinationIPList=make_set(DestinationIP, 100), DestinationPortList = make_set(DestinationPort,100), TotalSentBytesinMB = sum(SentBytesinMB), TotalReceivedBytesinMB = sum(ReceivedBytesinMB) by SourceIP, DeviceVendor, TimeGeneratedHour=bin(TimeGenerated,1h)",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "hourlycount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount = count(), TimeGeneratedMax=arg_max(TimeGenerated, *), DestinationIPList=make_set(DestinationIP, 100), DestinationPortList = make_set(DestinationPort,100), TotalSentBytesinMB = sum(SentBytesinMB), TotalReceivedBytesinMB = sum(ReceivedBytesinMB) by SourceIP, DeviceVendor, TimeGeneratedHour=bin(TimeGenerated,1h)",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "timegeneratedmax",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount = count(), TimeGeneratedMax=arg_max(TimeGenerated, *), DestinationIPList=make_set(DestinationIP, 100), DestinationPortList = make_set(DestinationPort,100), TotalSentBytesinMB = sum(SentBytesinMB), TotalReceivedBytesinMB = sum(ReceivedBytesinMB) by SourceIP, DeviceVendor, TimeGeneratedHour=bin(TimeGenerated,1h)",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "destinationiplist",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount = count(), TimeGeneratedMax=arg_max(TimeGenerated, *), DestinationIPList=make_set(DestinationIP, 100), DestinationPortList = make_set(DestinationPort,100), TotalSentBytesinMB = sum(SentBytesinMB), TotalReceivedBytesinMB = sum(ReceivedBytesinMB) by SourceIP, DeviceVendor, TimeGeneratedHour=bin(TimeGenerated,1h)",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "destinationportlist",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount = count(), TimeGeneratedMax=arg_max(TimeGenerated, *), DestinationIPList=make_set(DestinationIP, 100), DestinationPortList = make_set(DestinationPort,100), TotalSentBytesinMB = sum(SentBytesinMB), TotalReceivedBytesinMB = sum(ReceivedBytesinMB) by SourceIP, DeviceVendor, TimeGeneratedHour=bin(TimeGenerated,1h)",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "totalsentbytesinmb",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount = count(), TimeGeneratedMax=arg_max(TimeGenerated, *), DestinationIPList=make_set(DestinationIP, 100), DestinationPortList = make_set(DestinationPort,100), TotalSentBytesinMB = sum(SentBytesinMB), TotalReceivedBytesinMB = sum(ReceivedBytesinMB) by SourceIP, DeviceVendor, TimeGeneratedHour=bin(TimeGenerated,1h)",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "totalreceivedbytesinmb",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount = count(), TimeGeneratedMax=arg_max(TimeGenerated, *), DestinationIPList=make_set(DestinationIP, 100), DestinationPortList = make_set(DestinationPort,100), TotalSentBytesinMB = sum(SentBytesinMB), TotalReceivedBytesinMB = sum(ReceivedBytesinMB) by SourceIP, DeviceVendor, TimeGeneratedHour=bin(TimeGenerated,1h)",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount = count(), TimeGeneratedMax=arg_max(TimeGenerated, *), DestinationIPList=make_set(DestinationIP, 100), DestinationPortList = make_set(DestinationPort,100), TotalSentBytesinMB = sum(SentBytesinMB), TotalReceivedBytesinMB = sum(ReceivedBytesinMB) by SourceIP, DeviceVendor, TimeGeneratedHour=bin(TimeGenerated,1h)",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "devicevendor",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Rank=row_number(1, prev(TimeGeneratedHour) != TimeGeneratedHour) // Ranking the dataset per Hourly Partition",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "rank",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, TimeGeneratedHour, TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, Rank",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "devicevendor",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, TimeGeneratedHour, TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, Rank",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "timegeneratedhour",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, TimeGeneratedHour, TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, Rank",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "timegeneratedmax",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, TimeGeneratedHour, TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, Rank",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, TimeGeneratedHour, TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, Rank",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "destinationiplist",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, TimeGeneratedHour, TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, Rank",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "destinationportlist",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, TimeGeneratedHour, TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, Rank",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "totalsentbytesinmb",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, TimeGeneratedHour, TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, Rank",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "totalreceivedbytesinmb",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, TimeGeneratedHour, TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, Rank",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "rank",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DateHour = bin(TimeGenerated, 1h) // create a new column and round to hour",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "datehour",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = SourceIp, DestinationIP = DestinationIp",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = SourceIp, DestinationIP = DestinationIp",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SentBytesinMB = ((BytesSent / 1024)/1024), ReceivedBytesinMB = ((BytesReceived / 1024)/1024)",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "sentbytesinmb",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SentBytesinMB = ((BytesSent / 1024)/1024), ReceivedBytesinMB = ((BytesReceived / 1024)/1024)",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "receivedbytesinmb",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount = count(),TimeGeneratedMax=arg_max(TimeGenerated, *), DestinationIPList=make_set(DestinationIP, 100), DestinationPortList = make_set(DestinationPort, 100), TotalSentBytesinMB = sum(SentBytesinMB),TotalReceivedBytesinMB = sum(ReceivedBytesinMB) by SourceIP, DeviceVendor, TimeGeneratedHour=bin(TimeGenerated,1h)",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "hourlycount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount = count(),TimeGeneratedMax=arg_max(TimeGenerated, *), DestinationIPList=make_set(DestinationIP, 100), DestinationPortList = make_set(DestinationPort, 100), TotalSentBytesinMB = sum(SentBytesinMB),TotalReceivedBytesinMB = sum(ReceivedBytesinMB) by SourceIP, DeviceVendor, TimeGeneratedHour=bin(TimeGenerated,1h)",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "timegeneratedmax",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount = count(),TimeGeneratedMax=arg_max(TimeGenerated, *), DestinationIPList=make_set(DestinationIP, 100), DestinationPortList = make_set(DestinationPort, 100), TotalSentBytesinMB = sum(SentBytesinMB),TotalReceivedBytesinMB = sum(ReceivedBytesinMB) by SourceIP, DeviceVendor, TimeGeneratedHour=bin(TimeGenerated,1h)",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "destinationiplist",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount = count(),TimeGeneratedMax=arg_max(TimeGenerated, *), DestinationIPList=make_set(DestinationIP, 100), DestinationPortList = make_set(DestinationPort, 100), TotalSentBytesinMB = sum(SentBytesinMB),TotalReceivedBytesinMB = sum(ReceivedBytesinMB) by SourceIP, DeviceVendor, TimeGeneratedHour=bin(TimeGenerated,1h)",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "destinationportlist",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount = count(),TimeGeneratedMax=arg_max(TimeGenerated, *), DestinationIPList=make_set(DestinationIP, 100), DestinationPortList = make_set(DestinationPort, 100), TotalSentBytesinMB = sum(SentBytesinMB),TotalReceivedBytesinMB = sum(ReceivedBytesinMB) by SourceIP, DeviceVendor, TimeGeneratedHour=bin(TimeGenerated,1h)",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "totalsentbytesinmb",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount = count(),TimeGeneratedMax=arg_max(TimeGenerated, *), DestinationIPList=make_set(DestinationIP, 100), DestinationPortList = make_set(DestinationPort, 100), TotalSentBytesinMB = sum(SentBytesinMB),TotalReceivedBytesinMB = sum(ReceivedBytesinMB) by SourceIP, DeviceVendor, TimeGeneratedHour=bin(TimeGenerated,1h)",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "totalreceivedbytesinmb",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount = count(),TimeGeneratedMax=arg_max(TimeGenerated, *), DestinationIPList=make_set(DestinationIP, 100), DestinationPortList = make_set(DestinationPort, 100), TotalSentBytesinMB = sum(SentBytesinMB),TotalReceivedBytesinMB = sum(ReceivedBytesinMB) by SourceIP, DeviceVendor, TimeGeneratedHour=bin(TimeGenerated,1h)",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount = count(),TimeGeneratedMax=arg_max(TimeGenerated, *), DestinationIPList=make_set(DestinationIP, 100), DestinationPortList = make_set(DestinationPort, 100), TotalSentBytesinMB = sum(SentBytesinMB),TotalReceivedBytesinMB = sum(ReceivedBytesinMB) by SourceIP, DeviceVendor, TimeGeneratedHour=bin(TimeGenerated,1h)",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "devicevendor",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Rank=row_number(1, prev(TimeGeneratedHour) != TimeGeneratedHour) // Ranking the dataset per Hourly Partition",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "rank",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, TimeGeneratedHour, TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, Rank",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "devicevendor",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, TimeGeneratedHour, TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, Rank",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "timegeneratedhour",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, TimeGeneratedHour, TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, Rank",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "timegeneratedmax",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, TimeGeneratedHour, TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, Rank",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, TimeGeneratedHour, TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, Rank",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "destinationiplist",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, TimeGeneratedHour, TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, Rank",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "destinationportlist",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, TimeGeneratedHour, TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, Rank",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "totalsentbytesinmb",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, TimeGeneratedHour, TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, Rank",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "totalreceivedbytesinmb",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, TimeGeneratedHour, TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, Rank",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "rank",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour,TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "devicevendor",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour,TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "anomalyhour",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour,TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "timegeneratedmax",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour,TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour,TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "destinationiplist",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour,TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "destinationportlist",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour,TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "totalsentbytesinmb",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour,TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "totalreceivedbytesinmb",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour,TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "totalbytessentinmbperhour",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour,TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "baselinebytessentperhour",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour,TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour,TimeGeneratedMax, SourceIP, DestinationIPList, DestinationPortList, TotalSentBytesinMB, TotalReceivedBytesinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "anomalies",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount = count(), StartTimeUtc= min(TimeGeneratedMax), EndTimeUtc= max(TimeGeneratedMax), SourceIPMax= arg_max(SourceIP,*), TotalBytesSentinMB = sum(TotalSentBytesinMB), TotalBytesReceivedinMB = sum(TotalReceivedBytesinMB), SourceIPList = make_set(SourceIP, 100), DestinationIPList = make_set(DestinationIPList, 100) by AnomalyHour,TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "eventcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount = count(), StartTimeUtc= min(TimeGeneratedMax), EndTimeUtc= max(TimeGeneratedMax), SourceIPMax= arg_max(SourceIP,*), TotalBytesSentinMB = sum(TotalSentBytesinMB), TotalBytesReceivedinMB = sum(TotalReceivedBytesinMB), SourceIPList = make_set(SourceIP, 100), DestinationIPList = make_set(DestinationIPList, 100) by AnomalyHour,TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount = count(), StartTimeUtc= min(TimeGeneratedMax), EndTimeUtc= max(TimeGeneratedMax), SourceIPMax= arg_max(SourceIP,*), TotalBytesSentinMB = sum(TotalSentBytesinMB), TotalBytesReceivedinMB = sum(TotalReceivedBytesinMB), SourceIPList = make_set(SourceIP, 100), DestinationIPList = make_set(DestinationIPList, 100) by AnomalyHour,TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount = count(), StartTimeUtc= min(TimeGeneratedMax), EndTimeUtc= max(TimeGeneratedMax), SourceIPMax= arg_max(SourceIP,*), TotalBytesSentinMB = sum(TotalSentBytesinMB), TotalBytesReceivedinMB = sum(TotalReceivedBytesinMB), SourceIPList = make_set(SourceIP, 100), DestinationIPList = make_set(DestinationIPList, 100) by AnomalyHour,TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "sourceipmax",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount = count(), StartTimeUtc= min(TimeGeneratedMax), EndTimeUtc= max(TimeGeneratedMax), SourceIPMax= arg_max(SourceIP,*), TotalBytesSentinMB = sum(TotalSentBytesinMB), TotalBytesReceivedinMB = sum(TotalReceivedBytesinMB), SourceIPList = make_set(SourceIP, 100), DestinationIPList = make_set(DestinationIPList, 100) by AnomalyHour,TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "totalbytessentinmb",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount = count(), StartTimeUtc= min(TimeGeneratedMax), EndTimeUtc= max(TimeGeneratedMax), SourceIPMax= arg_max(SourceIP,*), TotalBytesSentinMB = sum(TotalSentBytesinMB), TotalBytesReceivedinMB = sum(TotalReceivedBytesinMB), SourceIPList = make_set(SourceIP, 100), DestinationIPList = make_set(DestinationIPList, 100) by AnomalyHour,TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "totalbytesreceivedinmb",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount = count(), StartTimeUtc= min(TimeGeneratedMax), EndTimeUtc= max(TimeGeneratedMax), SourceIPMax= arg_max(SourceIP,*), TotalBytesSentinMB = sum(TotalSentBytesinMB), TotalBytesReceivedinMB = sum(TotalReceivedBytesinMB), SourceIPList = make_set(SourceIP, 100), DestinationIPList = make_set(DestinationIPList, 100) by AnomalyHour,TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "sourceiplist",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount = count(), StartTimeUtc= min(TimeGeneratedMax), EndTimeUtc= max(TimeGeneratedMax), SourceIPMax= arg_max(SourceIP,*), TotalBytesSentinMB = sum(TotalSentBytesinMB), TotalBytesReceivedinMB = sum(TotalReceivedBytesinMB), SourceIPList = make_set(SourceIP, 100), DestinationIPList = make_set(DestinationIPList, 100) by AnomalyHour,TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "destinationiplist",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount = count(), StartTimeUtc= min(TimeGeneratedMax), EndTimeUtc= max(TimeGeneratedMax), SourceIPMax= arg_max(SourceIP,*), TotalBytesSentinMB = sum(TotalSentBytesinMB), TotalBytesReceivedinMB = sum(TotalReceivedBytesinMB), SourceIPList = make_set(SourceIP, 100), DestinationIPList = make_set(DestinationIPList, 100) by AnomalyHour,TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "anomalyhour",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount = count(), StartTimeUtc= min(TimeGeneratedMax), EndTimeUtc= max(TimeGeneratedMax), SourceIPMax= arg_max(SourceIP,*), TotalBytesSentinMB = sum(TotalSentBytesinMB), TotalBytesReceivedinMB = sum(TotalReceivedBytesinMB), SourceIPList = make_set(SourceIP, 100), DestinationIPList = make_set(DestinationIPList, 100) by AnomalyHour,TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "totalbytessentinmbperhour",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount = count(), StartTimeUtc= min(TimeGeneratedMax), EndTimeUtc= max(TimeGeneratedMax), SourceIPMax= arg_max(SourceIP,*), TotalBytesSentinMB = sum(TotalSentBytesinMB), TotalBytesReceivedinMB = sum(TotalReceivedBytesinMB), SourceIPList = make_set(SourceIP, 100), DestinationIPList = make_set(DestinationIPList, 100) by AnomalyHour,TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "baselinebytessentperhour",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount = count(), StartTimeUtc= min(TimeGeneratedMax), EndTimeUtc= max(TimeGeneratedMax), SourceIPMax= arg_max(SourceIP,*), TotalBytesSentinMB = sum(TotalSentBytesinMB), TotalBytesReceivedinMB = sum(TotalReceivedBytesinMB), SourceIPList = make_set(SourceIP, 100), DestinationIPList = make_set(DestinationIPList, 100) by AnomalyHour,TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "score",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize EventCount = count(), StartTimeUtc= min(TimeGeneratedMax), EndTimeUtc= max(TimeGeneratedMax), SourceIPMax= arg_max(SourceIP,*), TotalBytesSentinMB = sum(TotalSentBytesinMB), TotalBytesReceivedinMB = sum(TotalReceivedBytesinMB), SourceIPList = make_set(SourceIP, 100), DestinationIPList = make_set(DestinationIPList, 100) by AnomalyHour,TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "anomalies",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour, StartTimeUtc, EndTimeUtc, SourceIPMax, SourceIPList, DestinationIPList, DestinationPortList, TotalBytesSentinMB, TotalBytesReceivedinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies, EventCount",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "devicevendor",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour, StartTimeUtc, EndTimeUtc, SourceIPMax, SourceIPList, DestinationIPList, DestinationPortList, TotalBytesSentinMB, TotalBytesReceivedinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies, EventCount",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "anomalyhour",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour, StartTimeUtc, EndTimeUtc, SourceIPMax, SourceIPList, DestinationIPList, DestinationPortList, TotalBytesSentinMB, TotalBytesReceivedinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies, EventCount",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour, StartTimeUtc, EndTimeUtc, SourceIPMax, SourceIPList, DestinationIPList, DestinationPortList, TotalBytesSentinMB, TotalBytesReceivedinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies, EventCount",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour, StartTimeUtc, EndTimeUtc, SourceIPMax, SourceIPList, DestinationIPList, DestinationPortList, TotalBytesSentinMB, TotalBytesReceivedinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies, EventCount",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "sourceipmax",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour, StartTimeUtc, EndTimeUtc, SourceIPMax, SourceIPList, DestinationIPList, DestinationPortList, TotalBytesSentinMB, TotalBytesReceivedinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies, EventCount",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "sourceiplist",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour, StartTimeUtc, EndTimeUtc, SourceIPMax, SourceIPList, DestinationIPList, DestinationPortList, TotalBytesSentinMB, TotalBytesReceivedinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies, EventCount",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "destinationiplist",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour, StartTimeUtc, EndTimeUtc, SourceIPMax, SourceIPList, DestinationIPList, DestinationPortList, TotalBytesSentinMB, TotalBytesReceivedinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies, EventCount",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "destinationportlist",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour, StartTimeUtc, EndTimeUtc, SourceIPMax, SourceIPList, DestinationIPList, DestinationPortList, TotalBytesSentinMB, TotalBytesReceivedinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies, EventCount",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "totalbytessentinmb",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour, StartTimeUtc, EndTimeUtc, SourceIPMax, SourceIPList, DestinationIPList, DestinationPortList, TotalBytesSentinMB, TotalBytesReceivedinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies, EventCount",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "totalbytesreceivedinmb",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour, StartTimeUtc, EndTimeUtc, SourceIPMax, SourceIPList, DestinationIPList, DestinationPortList, TotalBytesSentinMB, TotalBytesReceivedinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies, EventCount",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "totalbytessentinmbperhour",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour, StartTimeUtc, EndTimeUtc, SourceIPMax, SourceIPList, DestinationIPList, DestinationPortList, TotalBytesSentinMB, TotalBytesReceivedinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies, EventCount",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "baselinebytessentperhour",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour, StartTimeUtc, EndTimeUtc, SourceIPMax, SourceIPList, DestinationIPList, DestinationPortList, TotalBytesSentinMB, TotalBytesReceivedinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies, EventCount",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour, StartTimeUtc, EndTimeUtc, SourceIPMax, SourceIPList, DestinationIPList, DestinationPortList, TotalBytesSentinMB, TotalBytesReceivedinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies, EventCount",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "anomalies",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor, AnomalyHour, StartTimeUtc, EndTimeUtc, SourceIPMax, SourceIPList, DestinationIPList, DestinationPortList, TotalBytesSentinMB, TotalBytesReceivedinMB, TotalBytesSentinMBperHour, baselinebytessentperHour, score, anomalies, EventCount",
    "detection": "timeseriesanomaly-multivendor-dataexfiltration.yaml",
    "field": "eventcount",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = SourceUserID, Computer = DeviceName, IPAddress = SourceIP",
    "detection": "zincoct292020iocs.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = SourceUserID, Computer = DeviceName, IPAddress = SourceIP",
    "detection": "zincoct292020iocs.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = SourceUserID, Computer = DeviceName, IPAddress = SourceIP",
    "detection": "zincoct292020iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend EvData = parse_xml(EventData)",
    "detection": "zincoct292020iocs.yaml",
    "field": "evdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventDetail = EvData.DataItem.EventData.Data",
    "detection": "zincoct292020iocs.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Hashes = EventDetail.[16].[\"#text\"]",
    "detection": "zincoct292020iocs.yaml",
    "field": "hashes",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = UserName",
    "detection": "zincoct292020iocs.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IPAddress",
    "detection": "zincoct292020iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IPAddress",
    "detection": "zincoct292020iocs.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IPAddress",
    "detection": "zincoct292020iocs.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IPAddress",
    "detection": "zincoct292020iocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventData = parse_xml(EventData).EventData.Data",
    "detection": "exchangeoabvirtualdirectoryattributecontainingpotentialwebshell.yaml",
    "field": "eventdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key = tostring(column_ifexists('@Name', \"\")), Value = column_ifexists('#text', \"\")",
    "detection": "exchangeoabvirtualdirectoryattributecontainingpotentialwebshell.yaml",
    "field": "key",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key = tostring(column_ifexists('@Name', \"\")), Value = column_ifexists('#text', \"\")",
    "detection": "exchangeoabvirtualdirectoryattributecontainingpotentialwebshell.yaml",
    "field": "value",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ObjectClass = column_ifexists(\"ObjectClass\", \"\")",
    "detection": "exchangeoabvirtualdirectoryattributecontainingpotentialwebshell.yaml",
    "field": "objectclass",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttributeLDAPDisplayName = column_ifexists(\"AttributeLDAPDisplayName\", \"\")",
    "detection": "exchangeoabvirtualdirectoryattributecontainingpotentialwebshell.yaml",
    "field": "attributeldapdisplayname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AttributeValue = column_ifexists(\"AttributeValue\", \"\")",
    "detection": "exchangeoabvirtualdirectoryattributecontainingpotentialwebshell.yaml",
    "field": "attributevalue",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ObjectDN = column_ifexists(\"ObjectDN\", \"\")",
    "detection": "exchangeoabvirtualdirectoryattributecontainingpotentialwebshell.yaml",
    "field": "objectdn",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = LastSeen",
    "detection": "exchangeoabvirtualdirectoryattributecontainingpotentialwebshell.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "exchangeoabvirtualdirectoryattributecontainingpotentialwebshell.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "exchangeoabvirtualdirectoryattributecontainingpotentialwebshell.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "exchangeoabvirtualdirectoryattributecontainingpotentialwebshell.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Account, @'\\')[1]), AccountNTDomain = tostring(split(Account, @'\\')[0])",
    "detection": "exchangeoabvirtualdirectoryattributecontainingpotentialwebshell.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Account, @'\\')[1]), AccountNTDomain = tostring(split(Account, @'\\')[0])",
    "detection": "exchangeoabvirtualdirectoryattributecontainingpotentialwebshell.yaml",
    "field": "accountntdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend DomainName = tolower(DomainName)",
    "detection": "domainentity-paloalto.yaml",
    "field": "domainname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend parts = split(DomainName, '.')",
    "detection": "domainentity-paloalto.yaml",
    "field": "parts",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend tld = parts[(array_length(parts)-1)]",
    "detection": "domainentity-paloalto.yaml",
    "field": "tld",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "domainentity-paloalto.yaml",
    "field": "latestindicatortime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "domainentity-paloalto.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "        | extend IngestionTime = ingestion_time()",
    "detection": "domainentity-paloalto.yaml",
    "field": "ingestiontime",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "        | extend PA_Url = columnifexists(\"RequestURL\", \"None\")",
    "detection": "domainentity-paloalto.yaml",
    "field": "pa_url",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "        | extend PA_Url = iif(isempty(PA_Url) and AdditionalExtensions !startswith \"PanOS\", extract(\"([^\\\"]+)\", 1, tolower(AdditionalExtensions)), trim('\"', PA_Url))",
    "detection": "domainentity-paloalto.yaml",
    "field": "pa_url",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "        | extend PA_Url = iif(PA_Url !startswith \"http://\" and ApplicationProtocol !~ \"ssl\", strcat('http://', PA_Url), iif(PA_Url !startswith \"https://\" and ApplicationProtocol =~ \"ssl\", strcat('https://', PA_Url), PA_Url))",
    "detection": "domainentity-paloalto.yaml",
    "field": "pa_url",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "        | extend Domain = trim(@\"\"\"\",tostring(parse_url(PA_Url).Host))",
    "detection": "domainentity-paloalto.yaml",
    "field": "domain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "        | extend Domain = tolower(Domain)",
    "detection": "domainentity-paloalto.yaml",
    "field": "domain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "        | extend parts = split(Domain, '.')",
    "detection": "domainentity-paloalto.yaml",
    "field": "parts",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "        | extend tld = parts[(array_length(parts)-1)]",
    "detection": "domainentity-paloalto.yaml",
    "field": "tld",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "        | extend CommonSecurityLog_TimeGenerated = TimeGenerated",
    "detection": "domainentity-paloalto.yaml",
    "field": "commonsecuritylog_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project LatestIndicatorTime, Description, ActivityGroupNames, PA_Url, Domain, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, CommonSecurityLog_TimeGenerated, DeviceAction, DestinationIP, DestinationPort, DeviceName, SourceIP, SourcePort, ApplicationProtocol, RequestMethod",
    "detection": "domainentity-paloalto.yaml",
    "field": "latestindicatortime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project LatestIndicatorTime, Description, ActivityGroupNames, PA_Url, Domain, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, CommonSecurityLog_TimeGenerated, DeviceAction, DestinationIP, DestinationPort, DeviceName, SourceIP, SourcePort, ApplicationProtocol, RequestMethod",
    "detection": "domainentity-paloalto.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project LatestIndicatorTime, Description, ActivityGroupNames, PA_Url, Domain, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, CommonSecurityLog_TimeGenerated, DeviceAction, DestinationIP, DestinationPort, DeviceName, SourceIP, SourcePort, ApplicationProtocol, RequestMethod",
    "detection": "domainentity-paloalto.yaml",
    "field": "activitygroupnames",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project LatestIndicatorTime, Description, ActivityGroupNames, PA_Url, Domain, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, CommonSecurityLog_TimeGenerated, DeviceAction, DestinationIP, DestinationPort, DeviceName, SourceIP, SourcePort, ApplicationProtocol, RequestMethod",
    "detection": "domainentity-paloalto.yaml",
    "field": "pa_url",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project LatestIndicatorTime, Description, ActivityGroupNames, PA_Url, Domain, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, CommonSecurityLog_TimeGenerated, DeviceAction, DestinationIP, DestinationPort, DeviceName, SourceIP, SourcePort, ApplicationProtocol, RequestMethod",
    "detection": "domainentity-paloalto.yaml",
    "field": "domain",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project LatestIndicatorTime, Description, ActivityGroupNames, PA_Url, Domain, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, CommonSecurityLog_TimeGenerated, DeviceAction, DestinationIP, DestinationPort, DeviceName, SourceIP, SourcePort, ApplicationProtocol, RequestMethod",
    "detection": "domainentity-paloalto.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project LatestIndicatorTime, Description, ActivityGroupNames, PA_Url, Domain, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, CommonSecurityLog_TimeGenerated, DeviceAction, DestinationIP, DestinationPort, DeviceName, SourceIP, SourcePort, ApplicationProtocol, RequestMethod",
    "detection": "domainentity-paloalto.yaml",
    "field": "threattype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project LatestIndicatorTime, Description, ActivityGroupNames, PA_Url, Domain, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, CommonSecurityLog_TimeGenerated, DeviceAction, DestinationIP, DestinationPort, DeviceName, SourceIP, SourcePort, ApplicationProtocol, RequestMethod",
    "detection": "domainentity-paloalto.yaml",
    "field": "expirationdatetime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project LatestIndicatorTime, Description, ActivityGroupNames, PA_Url, Domain, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, CommonSecurityLog_TimeGenerated, DeviceAction, DestinationIP, DestinationPort, DeviceName, SourceIP, SourcePort, ApplicationProtocol, RequestMethod",
    "detection": "domainentity-paloalto.yaml",
    "field": "confidencescore",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project LatestIndicatorTime, Description, ActivityGroupNames, PA_Url, Domain, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, CommonSecurityLog_TimeGenerated, DeviceAction, DestinationIP, DestinationPort, DeviceName, SourceIP, SourcePort, ApplicationProtocol, RequestMethod",
    "detection": "domainentity-paloalto.yaml",
    "field": "commonsecuritylog_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project LatestIndicatorTime, Description, ActivityGroupNames, PA_Url, Domain, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, CommonSecurityLog_TimeGenerated, DeviceAction, DestinationIP, DestinationPort, DeviceName, SourceIP, SourcePort, ApplicationProtocol, RequestMethod",
    "detection": "domainentity-paloalto.yaml",
    "field": "deviceaction",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project LatestIndicatorTime, Description, ActivityGroupNames, PA_Url, Domain, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, CommonSecurityLog_TimeGenerated, DeviceAction, DestinationIP, DestinationPort, DeviceName, SourceIP, SourcePort, ApplicationProtocol, RequestMethod",
    "detection": "domainentity-paloalto.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project LatestIndicatorTime, Description, ActivityGroupNames, PA_Url, Domain, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, CommonSecurityLog_TimeGenerated, DeviceAction, DestinationIP, DestinationPort, DeviceName, SourceIP, SourcePort, ApplicationProtocol, RequestMethod",
    "detection": "domainentity-paloalto.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "    | project LatestIndicatorTime, Description, ActivityGroupNames, PA_Url, Domain, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, CommonSecurityLog_TimeGenerated, DeviceAction, DestinationIP, DestinationPort, DeviceName, SourceIP, SourcePort, ApplicationProtocol, RequestMethod",
    "detection": "domainentity-paloalto.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project LatestIndicatorTime, Description, ActivityGroupNames, PA_Url, Domain, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, CommonSecurityLog_TimeGenerated, DeviceAction, DestinationIP, DestinationPort, DeviceName, SourceIP, SourcePort, ApplicationProtocol, RequestMethod",
    "detection": "domainentity-paloalto.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project LatestIndicatorTime, Description, ActivityGroupNames, PA_Url, Domain, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, CommonSecurityLog_TimeGenerated, DeviceAction, DestinationIP, DestinationPort, DeviceName, SourceIP, SourcePort, ApplicationProtocol, RequestMethod",
    "detection": "domainentity-paloalto.yaml",
    "field": "sourceport",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "    | project LatestIndicatorTime, Description, ActivityGroupNames, PA_Url, Domain, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, CommonSecurityLog_TimeGenerated, DeviceAction, DestinationIP, DestinationPort, DeviceName, SourceIP, SourcePort, ApplicationProtocol, RequestMethod",
    "detection": "domainentity-paloalto.yaml",
    "field": "applicationprotocol",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "    | project LatestIndicatorTime, Description, ActivityGroupNames, PA_Url, Domain, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, CommonSecurityLog_TimeGenerated, DeviceAction, DestinationIP, DestinationPort, DeviceName, SourceIP, SourcePort, ApplicationProtocol, RequestMethod",
    "detection": "domainentity-paloalto.yaml",
    "field": "requestmethod",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend timestamp = CommonSecurityLog_TimeGenerated, IPCustomEntity = SourceIP, HostCustomEntity = DeviceName, URLCustomEntity = PA_Url",
    "detection": "domainentity-paloalto.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend timestamp = CommonSecurityLog_TimeGenerated, IPCustomEntity = SourceIP, HostCustomEntity = DeviceName, URLCustomEntity = PA_Url",
    "detection": "domainentity-paloalto.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "    | extend timestamp = CommonSecurityLog_TimeGenerated, IPCustomEntity = SourceIP, HostCustomEntity = DeviceName, URLCustomEntity = PA_Url",
    "detection": "domainentity-paloalto.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "    | extend timestamp = CommonSecurityLog_TimeGenerated, IPCustomEntity = SourceIP, HostCustomEntity = DeviceName, URLCustomEntity = PA_Url",
    "detection": "domainentity-paloalto.yaml",
    "field": "urlcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Url = extract(\"(http[s]?://(?:[a-zA-Z]|[0-9]|[$-_@.&+]|[!*\\\\(\\\\),]|(?:%[0-9a-fA-F][0-9a-fA-F]))+)\", 1,tostring(TargetResources))",
    "detection": "urlentity-auditlogs.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend userPrincipalName = tostring(parse_json(tostring(InitiatedBy.user)).userPrincipalName)",
    "detection": "urlentity-auditlogs.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend TargetResourceDisplayName = tostring(TargetResources[0].displayName)",
    "detection": "urlentity-auditlogs.yaml",
    "field": "targetresourcedisplayname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend Audit_TimeGenerated = TimeGenerated);",
    "detection": "urlentity-auditlogs.yaml",
    "field": "audit_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "urlentity-auditlogs.yaml",
    "field": "latestindicatortime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "urlentity-auditlogs.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Audit_TimeGenerated = arg_max(Audit_TimeGenerated, *) by IndicatorId, Url",
    "detection": "urlentity-auditlogs.yaml",
    "field": "audit_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Audit_TimeGenerated = arg_max(Audit_TimeGenerated, *) by IndicatorId, Url",
    "detection": "urlentity-auditlogs.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize Audit_TimeGenerated = arg_max(Audit_TimeGenerated, *) by IndicatorId, Url",
    "detection": "urlentity-auditlogs.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Audit_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore,",
    "detection": "urlentity-auditlogs.yaml",
    "field": "audit_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Audit_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore,",
    "detection": "urlentity-auditlogs.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Audit_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore,",
    "detection": "urlentity-auditlogs.yaml",
    "field": "activitygroupnames",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Audit_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore,",
    "detection": "urlentity-auditlogs.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Audit_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore,",
    "detection": "urlentity-auditlogs.yaml",
    "field": "threattype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Audit_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore,",
    "detection": "urlentity-auditlogs.yaml",
    "field": "expirationdatetime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Audit_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore,",
    "detection": "urlentity-auditlogs.yaml",
    "field": "confidencescore",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(userPrincipalName, \"@\")[0]), AccountUPNSuffix = tostring(split(userPrincipalName, \"@\")[1])",
    "detection": "urlentity-auditlogs.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(userPrincipalName, \"@\")[0]), AccountUPNSuffix = tostring(split(userPrincipalName, \"@\")[1])",
    "detection": "urlentity-auditlogs.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(TargetResourceDisplayName, \".\")[0]), DomainIndex = toint(indexof(TargetResourceDisplayName, '.'))",
    "detection": "urlentity-auditlogs.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(TargetResourceDisplayName, \".\")[0]), DomainIndex = toint(indexof(TargetResourceDisplayName, '.'))",
    "detection": "urlentity-auditlogs.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(TargetResourceDisplayName, DomainIndex + 1), TargetResourceDisplayName)",
    "detection": "urlentity-auditlogs.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = SourceUserID, Computer = DeviceName, IPAddress = SourceIP",
    "detection": "galliumiocs.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = SourceUserID, Computer = DeviceName, IPAddress = SourceIP",
    "detection": "galliumiocs.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = SourceUserID, Computer = DeviceName, IPAddress = SourceIP",
    "detection": "galliumiocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DNSName = Name",
    "detection": "galliumiocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPAddress = ClientIP",
    "detection": "galliumiocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DNSName = DnsQuery",
    "detection": "galliumiocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPAddress = SrcIpAddr",
    "detection": "galliumiocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPAddress = RemoteIp",
    "detection": "galliumiocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend EvData = parse_xml(EventData)",
    "detection": "galliumiocs.yaml",
    "field": "evdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventDetail = EvData.DataItem.EventData.Data",
    "detection": "galliumiocs.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Hashes = EventDetail.[16].[\"#text\"]",
    "detection": "galliumiocs.yaml",
    "field": "hashes",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = UserName",
    "detection": "galliumiocs.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Computer = tostring(parse_json(Entities)[0].HostName)",
    "detection": "galliumiocs.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend DNSName = Request_Name",
    "detection": "galliumiocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPAddress = ClientIP",
    "detection": "galliumiocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DNSName = DestinationHost",
    "detection": "galliumiocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPAddress = SourceHost",
    "detection": "galliumiocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IPAddress",
    "detection": "galliumiocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IPAddress",
    "detection": "galliumiocs.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IPAddress",
    "detection": "galliumiocs.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IPAddress",
    "detection": "galliumiocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,SourceIP, DestinationIP, DeviceVendor",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,SourceIP, DestinationIP, DeviceVendor",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,SourceIP, DestinationIP, DeviceVendor",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,SourceIP, DestinationIP, DeviceVendor",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "devicevendor",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DateHour = bin(TimeGenerated, 1h) // create a new column and round to hour",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "datehour",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount = count(), TimeGeneratedMax = arg_max(TimeGenerated, *), DestinationIPlist = make_set(DestinationIP, 100), DestinationPortlist = make_set(DestinationPort, 100) by DeviceVendor, SourceIP, TimeGeneratedHour= bin(TimeGenerated, 1h)",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "hourlycount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount = count(), TimeGeneratedMax = arg_max(TimeGenerated, *), DestinationIPlist = make_set(DestinationIP, 100), DestinationPortlist = make_set(DestinationPort, 100) by DeviceVendor, SourceIP, TimeGeneratedHour= bin(TimeGenerated, 1h)",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "timegeneratedmax",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount = count(), TimeGeneratedMax = arg_max(TimeGenerated, *), DestinationIPlist = make_set(DestinationIP, 100), DestinationPortlist = make_set(DestinationPort, 100) by DeviceVendor, SourceIP, TimeGeneratedHour= bin(TimeGenerated, 1h)",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "destinationiplist",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount = count(), TimeGeneratedMax = arg_max(TimeGenerated, *), DestinationIPlist = make_set(DestinationIP, 100), DestinationPortlist = make_set(DestinationPort, 100) by DeviceVendor, SourceIP, TimeGeneratedHour= bin(TimeGenerated, 1h)",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "destinationportlist",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount = count(), TimeGeneratedMax = arg_max(TimeGenerated, *), DestinationIPlist = make_set(DestinationIP, 100), DestinationPortlist = make_set(DestinationPort, 100) by DeviceVendor, SourceIP, TimeGeneratedHour= bin(TimeGenerated, 1h)",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "devicevendor",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount = count(), TimeGeneratedMax = arg_max(TimeGenerated, *), DestinationIPlist = make_set(DestinationIP, 100), DestinationPortlist = make_set(DestinationPort, 100) by DeviceVendor, SourceIP, TimeGeneratedHour= bin(TimeGenerated, 1h)",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AnomalyHour = TimeGeneratedHour",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "anomalyhour",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend PercentTotal = round((HourlyCount / Total) * 100, 3)",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "percenttotal",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor , AnomalyHour, TimeGeneratedMax, SourceIP, DestinationIPlist, DestinationPortlist, HourlyCount, PercentTotal, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "devicevendor",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor , AnomalyHour, TimeGeneratedMax, SourceIP, DestinationIPlist, DestinationPortlist, HourlyCount, PercentTotal, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "anomalyhour",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor , AnomalyHour, TimeGeneratedMax, SourceIP, DestinationIPlist, DestinationPortlist, HourlyCount, PercentTotal, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "timegeneratedmax",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor , AnomalyHour, TimeGeneratedMax, SourceIP, DestinationIPlist, DestinationPortlist, HourlyCount, PercentTotal, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor , AnomalyHour, TimeGeneratedMax, SourceIP, DestinationIPlist, DestinationPortlist, HourlyCount, PercentTotal, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "destinationiplist",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor , AnomalyHour, TimeGeneratedMax, SourceIP, DestinationIPlist, DestinationPortlist, HourlyCount, PercentTotal, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "destinationportlist",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor , AnomalyHour, TimeGeneratedMax, SourceIP, DestinationIPlist, DestinationPortlist, HourlyCount, PercentTotal, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "hourlycount",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor , AnomalyHour, TimeGeneratedMax, SourceIP, DestinationIPlist, DestinationPortlist, HourlyCount, PercentTotal, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "percenttotal",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor , AnomalyHour, TimeGeneratedMax, SourceIP, DestinationIPlist, DestinationPortlist, HourlyCount, PercentTotal, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "total",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor , AnomalyHour, TimeGeneratedMax, SourceIP, DestinationIPlist, DestinationPortlist, HourlyCount, PercentTotal, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "baseline",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor , AnomalyHour, TimeGeneratedMax, SourceIP, DestinationIPlist, DestinationPortlist, HourlyCount, PercentTotal, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor , AnomalyHour, TimeGeneratedMax, SourceIP, DestinationIPlist, DestinationPortlist, HourlyCount, PercentTotal, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "anomalies",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount=sum(HourlyCount), StartTimeUtc=min(TimeGeneratedMax), EndTimeUtc=max(TimeGeneratedMax), SourceIPlist = make_set(SourceIP, 100), SourceIPMax= arg_max(SourceIP, *), DestinationIPlist = make_set(DestinationIPlist, 100), DestinationPortlist = make_set(DestinationPortlist, 100) by DeviceVendor , AnomalyHour, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "hourlycount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount=sum(HourlyCount), StartTimeUtc=min(TimeGeneratedMax), EndTimeUtc=max(TimeGeneratedMax), SourceIPlist = make_set(SourceIP, 100), SourceIPMax= arg_max(SourceIP, *), DestinationIPlist = make_set(DestinationIPlist, 100), DestinationPortlist = make_set(DestinationPortlist, 100) by DeviceVendor , AnomalyHour, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount=sum(HourlyCount), StartTimeUtc=min(TimeGeneratedMax), EndTimeUtc=max(TimeGeneratedMax), SourceIPlist = make_set(SourceIP, 100), SourceIPMax= arg_max(SourceIP, *), DestinationIPlist = make_set(DestinationIPlist, 100), DestinationPortlist = make_set(DestinationPortlist, 100) by DeviceVendor , AnomalyHour, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount=sum(HourlyCount), StartTimeUtc=min(TimeGeneratedMax), EndTimeUtc=max(TimeGeneratedMax), SourceIPlist = make_set(SourceIP, 100), SourceIPMax= arg_max(SourceIP, *), DestinationIPlist = make_set(DestinationIPlist, 100), DestinationPortlist = make_set(DestinationPortlist, 100) by DeviceVendor , AnomalyHour, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "sourceiplist",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount=sum(HourlyCount), StartTimeUtc=min(TimeGeneratedMax), EndTimeUtc=max(TimeGeneratedMax), SourceIPlist = make_set(SourceIP, 100), SourceIPMax= arg_max(SourceIP, *), DestinationIPlist = make_set(DestinationIPlist, 100), DestinationPortlist = make_set(DestinationPortlist, 100) by DeviceVendor , AnomalyHour, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "sourceipmax",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount=sum(HourlyCount), StartTimeUtc=min(TimeGeneratedMax), EndTimeUtc=max(TimeGeneratedMax), SourceIPlist = make_set(SourceIP, 100), SourceIPMax= arg_max(SourceIP, *), DestinationIPlist = make_set(DestinationIPlist, 100), DestinationPortlist = make_set(DestinationPortlist, 100) by DeviceVendor , AnomalyHour, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "destinationiplist",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount=sum(HourlyCount), StartTimeUtc=min(TimeGeneratedMax), EndTimeUtc=max(TimeGeneratedMax), SourceIPlist = make_set(SourceIP, 100), SourceIPMax= arg_max(SourceIP, *), DestinationIPlist = make_set(DestinationIPlist, 100), DestinationPortlist = make_set(DestinationPortlist, 100) by DeviceVendor , AnomalyHour, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "destinationportlist",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount=sum(HourlyCount), StartTimeUtc=min(TimeGeneratedMax), EndTimeUtc=max(TimeGeneratedMax), SourceIPlist = make_set(SourceIP, 100), SourceIPMax= arg_max(SourceIP, *), DestinationIPlist = make_set(DestinationIPlist, 100), DestinationPortlist = make_set(DestinationPortlist, 100) by DeviceVendor , AnomalyHour, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "devicevendor",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount=sum(HourlyCount), StartTimeUtc=min(TimeGeneratedMax), EndTimeUtc=max(TimeGeneratedMax), SourceIPlist = make_set(SourceIP, 100), SourceIPMax= arg_max(SourceIP, *), DestinationIPlist = make_set(DestinationIPlist, 100), DestinationPortlist = make_set(DestinationPortlist, 100) by DeviceVendor , AnomalyHour, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "anomalyhour",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount=sum(HourlyCount), StartTimeUtc=min(TimeGeneratedMax), EndTimeUtc=max(TimeGeneratedMax), SourceIPlist = make_set(SourceIP, 100), SourceIPMax= arg_max(SourceIP, *), DestinationIPlist = make_set(DestinationIPlist, 100), DestinationPortlist = make_set(DestinationPortlist, 100) by DeviceVendor , AnomalyHour, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "total",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount=sum(HourlyCount), StartTimeUtc=min(TimeGeneratedMax), EndTimeUtc=max(TimeGeneratedMax), SourceIPlist = make_set(SourceIP, 100), SourceIPMax= arg_max(SourceIP, *), DestinationIPlist = make_set(DestinationIPlist, 100), DestinationPortlist = make_set(DestinationPortlist, 100) by DeviceVendor , AnomalyHour, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "baseline",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount=sum(HourlyCount), StartTimeUtc=min(TimeGeneratedMax), EndTimeUtc=max(TimeGeneratedMax), SourceIPlist = make_set(SourceIP, 100), SourceIPMax= arg_max(SourceIP, *), DestinationIPlist = make_set(DestinationIPlist, 100), DestinationPortlist = make_set(DestinationPortlist, 100) by DeviceVendor , AnomalyHour, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "score",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize HourlyCount=sum(HourlyCount), StartTimeUtc=min(TimeGeneratedMax), EndTimeUtc=max(TimeGeneratedMax), SourceIPlist = make_set(SourceIP, 100), SourceIPMax= arg_max(SourceIP, *), DestinationIPlist = make_set(DestinationIPlist, 100), DestinationPortlist = make_set(DestinationPortlist, 100) by DeviceVendor , AnomalyHour, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "anomalies",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor , AnomalyHour, EndTimeUtc, SourceIPMax ,SourceIPlist, DestinationIPlist, DestinationPortlist, HourlyCount, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "devicevendor",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor , AnomalyHour, EndTimeUtc, SourceIPMax ,SourceIPlist, DestinationIPlist, DestinationPortlist, HourlyCount, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "anomalyhour",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor , AnomalyHour, EndTimeUtc, SourceIPMax ,SourceIPlist, DestinationIPlist, DestinationPortlist, HourlyCount, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor , AnomalyHour, EndTimeUtc, SourceIPMax ,SourceIPlist, DestinationIPlist, DestinationPortlist, HourlyCount, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "sourceipmax",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor , AnomalyHour, EndTimeUtc, SourceIPMax ,SourceIPlist, DestinationIPlist, DestinationPortlist, HourlyCount, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "sourceiplist",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor , AnomalyHour, EndTimeUtc, SourceIPMax ,SourceIPlist, DestinationIPlist, DestinationPortlist, HourlyCount, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "destinationiplist",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor , AnomalyHour, EndTimeUtc, SourceIPMax ,SourceIPlist, DestinationIPlist, DestinationPortlist, HourlyCount, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "destinationportlist",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor , AnomalyHour, EndTimeUtc, SourceIPMax ,SourceIPlist, DestinationIPlist, DestinationPortlist, HourlyCount, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "hourlycount",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor , AnomalyHour, EndTimeUtc, SourceIPMax ,SourceIPlist, DestinationIPlist, DestinationPortlist, HourlyCount, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "total",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor , AnomalyHour, EndTimeUtc, SourceIPMax ,SourceIPlist, DestinationIPlist, DestinationPortlist, HourlyCount, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "baseline",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor , AnomalyHour, EndTimeUtc, SourceIPMax ,SourceIPlist, DestinationIPlist, DestinationPortlist, HourlyCount, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "score",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project DeviceVendor , AnomalyHour, EndTimeUtc, SourceIPMax ,SourceIPlist, DestinationIPlist, DestinationPortlist, HourlyCount, Total, baseline, score, anomalies",
    "detection": "timeseriesanomaly-multivendor-networktraffic.yaml",
    "field": "anomalies",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent, SourceIP = ClientIP, Account = UserId, Type, Operation",
    "detection": "useragentsearch-log4j.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent, SourceIP = ClientIP, Account = UserId, Type, Operation",
    "detection": "useragentsearch-log4j.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent, SourceIP = ClientIP, Account = UserId, Type, Operation",
    "detection": "useragentsearch-log4j.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent, SourceIP = ClientIP, Account = UserId, Type, Operation",
    "detection": "useragentsearch-log4j.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent, SourceIP = ClientIP, Account = UserId, Type, Operation",
    "detection": "useragentsearch-log4j.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent = userAgent_s, SourceIP = column_ifexists(\"clientIp_s\",clientIP_s), Type, column_ifexists(\"originalHost_s\",host_s), Url = requestUri_s, HttpStatus = column_ifexists(\"httpStatusDetails_s\",httpStatus_d), column_ifexists(\"transactionId_g\",trackingReference_s), ruleName_s, ResourceType, ResourceId",
    "detection": "useragentsearch-log4j.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent = userAgent_s, SourceIP = column_ifexists(\"clientIp_s\",clientIP_s), Type, column_ifexists(\"originalHost_s\",host_s), Url = requestUri_s, HttpStatus = column_ifexists(\"httpStatusDetails_s\",httpStatus_d), column_ifexists(\"transactionId_g\",trackingReference_s), ruleName_s, ResourceType, ResourceId",
    "detection": "useragentsearch-log4j.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent = userAgent_s, SourceIP = column_ifexists(\"clientIp_s\",clientIP_s), Type, column_ifexists(\"originalHost_s\",host_s), Url = requestUri_s, HttpStatus = column_ifexists(\"httpStatusDetails_s\",httpStatus_d), column_ifexists(\"transactionId_g\",trackingReference_s), ruleName_s, ResourceType, ResourceId",
    "detection": "useragentsearch-log4j.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent = userAgent_s, SourceIP = column_ifexists(\"clientIp_s\",clientIP_s), Type, column_ifexists(\"originalHost_s\",host_s), Url = requestUri_s, HttpStatus = column_ifexists(\"httpStatusDetails_s\",httpStatus_d), column_ifexists(\"transactionId_g\",trackingReference_s), ruleName_s, ResourceType, ResourceId",
    "detection": "useragentsearch-log4j.yaml",
    "field": "rulename_s",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent = userAgent_s, SourceIP = column_ifexists(\"clientIp_s\",clientIP_s), Type, column_ifexists(\"originalHost_s\",host_s), Url = requestUri_s, HttpStatus = column_ifexists(\"httpStatusDetails_s\",httpStatus_d), column_ifexists(\"transactionId_g\",trackingReference_s), ruleName_s, ResourceType, ResourceId",
    "detection": "useragentsearch-log4j.yaml",
    "field": "resourcetype",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent = userAgent_s, SourceIP = column_ifexists(\"clientIp_s\",clientIP_s), Type, column_ifexists(\"originalHost_s\",host_s), Url = requestUri_s, HttpStatus = column_ifexists(\"httpStatusDetails_s\",httpStatus_d), column_ifexists(\"transactionId_g\",trackingReference_s), ruleName_s, ResourceType, ResourceId",
    "detection": "useragentsearch-log4j.yaml",
    "field": "resourceid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent = csUserAgent, SourceIP = cIP, Account = csUserName, Type, sSiteName, csMethod, Url = csUriStem",
    "detection": "useragentsearch-log4j.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent = csUserAgent, SourceIP = cIP, Account = csUserName, Type, sSiteName, csMethod, Url = csUriStem",
    "detection": "useragentsearch-log4j.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent = csUserAgent, SourceIP = cIP, Account = csUserName, Type, sSiteName, csMethod, Url = csUriStem",
    "detection": "useragentsearch-log4j.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent = csUserAgent, SourceIP = cIP, Account = csUserName, Type, sSiteName, csMethod, Url = csUriStem",
    "detection": "useragentsearch-log4j.yaml",
    "field": "ssitename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent = csUserAgent, SourceIP = cIP, Account = csUserName, Type, sSiteName, csMethod, Url = csUriStem",
    "detection": "useragentsearch-log4j.yaml",
    "field": "csmethod",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent, SourceIP = SourceIpAddress, Account = UserIdentityUserName, Type, EventName",
    "detection": "useragentsearch-log4j.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent, SourceIP = SourceIpAddress, Account = UserIdentityUserName, Type, EventName",
    "detection": "useragentsearch-log4j.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent, SourceIP = SourceIpAddress, Account = UserIdentityUserName, Type, EventName",
    "detection": "useragentsearch-log4j.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent, SourceIP = SourceIpAddress, Account = UserIdentityUserName, Type, EventName",
    "detection": "useragentsearch-log4j.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent, SourceIP = SourceIpAddress, Account = UserIdentityUserName, Type, EventName",
    "detection": "useragentsearch-log4j.yaml",
    "field": "eventname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent, SourceIP = IPAddress, Account = UserPrincipalName, Type, Operation = OperationName, tostring(LocationDetails), tostring(DeviceDetail),    AppDisplayName, ClientAppUsed",
    "detection": "useragentsearch-log4j.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent, SourceIP = IPAddress, Account = UserPrincipalName, Type, Operation = OperationName, tostring(LocationDetails), tostring(DeviceDetail),    AppDisplayName, ClientAppUsed",
    "detection": "useragentsearch-log4j.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent, SourceIP = IPAddress, Account = UserPrincipalName, Type, Operation = OperationName, tostring(LocationDetails), tostring(DeviceDetail),    AppDisplayName, ClientAppUsed",
    "detection": "useragentsearch-log4j.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent, SourceIP = IPAddress, Account = UserPrincipalName, Type, Operation = OperationName, tostring(LocationDetails), tostring(DeviceDetail),    AppDisplayName, ClientAppUsed",
    "detection": "useragentsearch-log4j.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent, SourceIP = IPAddress, Account = UserPrincipalName, Type, Operation = OperationName, tostring(LocationDetails), tostring(DeviceDetail),    AppDisplayName, ClientAppUsed",
    "detection": "useragentsearch-log4j.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent, SourceIP = IPAddress, Account = UserPrincipalName, Type, Operation = OperationName, tostring(LocationDetails), tostring(DeviceDetail),    AppDisplayName, ClientAppUsed",
    "detection": "useragentsearch-log4j.yaml",
    "field": "clientappused",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent, SourceIP = IPAddress, Account = UserPrincipalName, Type, Operation = OperationName, tostring(LocationDetails), tostring(DeviceDetail), AppDisplayName, ClientAppUsed",
    "detection": "useragentsearch-log4j.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent, SourceIP = IPAddress, Account = UserPrincipalName, Type, Operation = OperationName, tostring(LocationDetails), tostring(DeviceDetail), AppDisplayName, ClientAppUsed",
    "detection": "useragentsearch-log4j.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent, SourceIP = IPAddress, Account = UserPrincipalName, Type, Operation = OperationName, tostring(LocationDetails), tostring(DeviceDetail), AppDisplayName, ClientAppUsed",
    "detection": "useragentsearch-log4j.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent, SourceIP = IPAddress, Account = UserPrincipalName, Type, Operation = OperationName, tostring(LocationDetails), tostring(DeviceDetail), AppDisplayName, ClientAppUsed",
    "detection": "useragentsearch-log4j.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent, SourceIP = IPAddress, Account = UserPrincipalName, Type, Operation = OperationName, tostring(LocationDetails), tostring(DeviceDetail), AppDisplayName, ClientAppUsed",
    "detection": "useragentsearch-log4j.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by UserAgent, SourceIP = IPAddress, Account = UserPrincipalName, Type, Operation = OperationName, tostring(LocationDetails), tostring(DeviceDetail), AppDisplayName, ClientAppUsed",
    "detection": "useragentsearch-log4j.yaml",
    "field": "clientappused",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by HttpUserAgent, SourceIP = SrcIpAddr, DstIpAddr, Account = SrcUsername, Url, Type",
    "detection": "useragentsearch-log4j.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by HttpUserAgent, SourceIP = SrcIpAddr, DstIpAddr, Account = SrcUsername, Url, Type",
    "detection": "useragentsearch-log4j.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by HttpUserAgent, SourceIP = SrcIpAddr, DstIpAddr, Account = SrcUsername, Url, Type",
    "detection": "useragentsearch-log4j.yaml",
    "field": "httpuseragent",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by HttpUserAgent, SourceIP = SrcIpAddr, DstIpAddr, Account = SrcUsername, Url, Type",
    "detection": "useragentsearch-log4j.yaml",
    "field": "dstipaddr",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by HttpUserAgent, SourceIP = SrcIpAddr, DstIpAddr, Account = SrcUsername, Url, Type",
    "detection": "useragentsearch-log4j.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by HttpUserAgent, SourceIP = SrcIpAddr, DstIpAddr, Account = SrcUsername, Url, Type",
    "detection": "useragentsearch-log4j.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend MessageIP = extract(IPRegex, 0, Message)",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "messageip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case(SourceIP in (IPList), \"SourceIP\", DestinationIP in (IPList), \"DestinationIP\", MessageIP in (IPList), \"Message\", RequestURL in (DomainNames), \"RequestUrl\", \"NoMatch\")",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, IPMatch == \"Message\", MessageIP, \"NoMatch\"), AccountCustomEntity = SourceUserID",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, IPMatch == \"Message\", MessageIP, \"NoMatch\"), AccountCustomEntity = SourceUserID",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, IPMatch == \"Message\", MessageIP, \"NoMatch\"), AccountCustomEntity = SourceUserID",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = IPAddresses, DNSName = Name, Host = Computer",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "destinationipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = IPAddresses, DNSName = Name, Host = Computer",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = IPAddresses, DNSName = Name, Host = Computer",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "host",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIPAddress, HostCustomEntity = Host",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIPAddress, HostCustomEntity = Host",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIPAddress, HostCustomEntity = Host",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = DnsResponseName, DNSName = DnsQuery, Host = Dvc",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "destinationipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = DnsResponseName, DNSName = DnsQuery, Host = Dvc",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = DnsResponseName, DNSName = DnsQuery, Host = Dvc",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "host",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIPAddress, HostCustomEntity = Host",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIPAddress, HostCustomEntity = Host",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIPAddress, HostCustomEntity = Host",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case( SourceIp in (IPList), \"SourceIP\", DestinationIp in (IPList), \"DestinationIP\", \"None\")",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIp, IPMatch == \"DestinationIP\", DestinationIp, \"NoMatch\"), HostCustomEntity = Computer",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIp, IPMatch == \"DestinationIP\", DestinationIp, \"NoMatch\"), HostCustomEntity = Computer",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIp, IPMatch == \"DestinationIP\", DestinationIp, \"NoMatch\"), HostCustomEntity = Computer",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = ClientIP, AccountCustomEntity = UserId",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = ClientIP, AccountCustomEntity = UserId",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = ClientIP, AccountCustomEntity = UserId",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = RemoteUrl, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = RemoteUrl, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = RemoteUrl, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = RemoteUrl, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = Request_Name, IPCustomEntity = ClientIP",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = Request_Name, IPCustomEntity = ClientIP",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = Request_Name, IPCustomEntity = ClientIP",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = DestinationHost, IPCustomEntity = SourceHost",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = DestinationHost, IPCustomEntity = SourceHost",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = DestinationHost, IPCustomEntity = SourceHost",
    "detection": "nobelium-domainiocsmarch2021.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubCategory = tostring(split(subcategorytoken, \"\\\"\")[1]) , Toggle =  tostring(split(subcategorytoken, \"\\\"\")[2])",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "subcategory",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubCategory = tostring(split(subcategorytoken, \"\\\"\")[1]) , Toggle =  tostring(split(subcategorytoken, \"\\\"\")[2])",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "toggle",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "subcategory",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, SubjectDomainName, SubjectUserName, Process, ParentProcessName, CommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "toggle",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountName = SubjectUserName, AccountDomain = SubjectDomainName, DeviceName = Computer",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountName = SubjectUserName, AccountDomain = SubjectDomainName, DeviceName = Computer",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountName = SubjectUserName, AccountDomain = SubjectDomainName, DeviceName = Computer",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "accountdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountName = SubjectUserName, AccountDomain = SubjectDomainName, DeviceName = Computer",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubCategory = tostring(split(subcategorytoken, \"\\\"\")[1]) , Toggle =  tostring(split(subcategorytoken, \"\\\"\")[2])",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "subcategory",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubCategory = tostring(split(subcategorytoken, \"\\\"\")[1]) , Toggle =  tostring(split(subcategorytoken, \"\\\"\")[2])",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "toggle",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceName, AccountName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessFileName, InitiatingProcessParentFileName,  InitiatingProcessCommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceName, AccountName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessFileName, InitiatingProcessParentFileName,  InitiatingProcessCommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceName, AccountName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessFileName, InitiatingProcessParentFileName,  InitiatingProcessCommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceName, AccountName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessFileName, InitiatingProcessParentFileName,  InitiatingProcessCommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "initiatingprocessaccountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceName, AccountName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessFileName, InitiatingProcessParentFileName,  InitiatingProcessCommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "initiatingprocessaccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceName, AccountName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessFileName, InitiatingProcessParentFileName,  InitiatingProcessCommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "initiatingprocessfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceName, AccountName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessFileName, InitiatingProcessParentFileName,  InitiatingProcessCommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "initiatingprocessparentfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceName, AccountName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessFileName, InitiatingProcessParentFileName,  InitiatingProcessCommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "initiatingprocesscommandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceName, AccountName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessFileName, InitiatingProcessParentFileName,  InitiatingProcessCommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "subcategory",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DeviceName, AccountName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessFileName, InitiatingProcessParentFileName,  InitiatingProcessCommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "toggle",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountName = InitiatingProcessAccountName, AccountDomain = InitiatingProcessAccountDomain",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountName = InitiatingProcessAccountName, AccountDomain = InitiatingProcessAccountDomain",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountName = InitiatingProcessAccountName, AccountDomain = InitiatingProcessAccountDomain",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "accountdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventData = parse_xml(EventData).DataItem.EventData.Data",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "eventdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key=tostring(['@Name']), Value=['#text']",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "key",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key=tostring(['@Name']), Value=['#text']",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "value",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubCategory = tostring(split(subcategorytoken, \"\\\"\")[1]) , Toggle =  tostring(split(subcategorytoken, \"\\\"\")[2])",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "subcategory",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubCategory = tostring(split(subcategorytoken, \"\\\"\")[1]) , Toggle =  tostring(split(subcategorytoken, \"\\\"\")[2])",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "toggle",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, User, Process, ParentImage, CommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, User, Process, ParentImage, CommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, User, Process, ParentImage, CommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "user",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, User, Process, ParentImage, CommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, User, Process, ParentImage, CommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "parentimage",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, User, Process, ParentImage, CommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, User, Process, ParentImage, CommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "subcategory",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, User, Process, ParentImage, CommandLine, SubCategory, Toggle",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "toggle",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountName = tostring(split(User, @'\\')[1]), AccountUPNSuffix = tostring(split(User, @'\\')[0]), DeviceName = Computer",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountName = tostring(split(User, @'\\')[1]), AccountUPNSuffix = tostring(split(User, @'\\')[0]), DeviceName = Computer",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountName = tostring(split(User, @'\\')[1]), AccountUPNSuffix = tostring(split(User, @'\\')[0]), DeviceName = Computer",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "accountupnsuffix",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountName = tostring(split(User, @'\\')[1]), AccountUPNSuffix = tostring(split(User, @'\\')[0]), DeviceName = Computer",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = strcat(AccountDomain, \"\\\\\", AccountName)",
    "detection": "auditpolicymanipulation-using-auditpol.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Outcome = iff(EventID == 4624, \"Success\", \"Failure\")",
    "detection": "multiplefailedfollowedbysuccess.yaml",
    "field": "outcome",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize OutcomeCount=count() by bin(TimeGenerated, 10m), Account, IpAddress, Computer, Outcome",
    "detection": "multiplefailedfollowedbysuccess.yaml",
    "field": "outcomecount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize OutcomeCount=count() by bin(TimeGenerated, 10m), Account, IpAddress, Computer, Outcome",
    "detection": "multiplefailedfollowedbysuccess.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize OutcomeCount=count() by bin(TimeGenerated, 10m), Account, IpAddress, Computer, Outcome",
    "detection": "multiplefailedfollowedbysuccess.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize OutcomeCount=count() by bin(TimeGenerated, 10m), Account, IpAddress, Computer, Outcome",
    "detection": "multiplefailedfollowedbysuccess.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize OutcomeCount=count() by bin(TimeGenerated, 10m), Account, IpAddress, Computer, Outcome",
    "detection": "multiplefailedfollowedbysuccess.yaml",
    "field": "outcome",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, IpAddress, Computer, Outcome, OutcomeCount",
    "detection": "multiplefailedfollowedbysuccess.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, IpAddress, Computer, Outcome, OutcomeCount",
    "detection": "multiplefailedfollowedbysuccess.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, IpAddress, Computer, Outcome, OutcomeCount",
    "detection": "multiplefailedfollowedbysuccess.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, IpAddress, Computer, Outcome, OutcomeCount",
    "detection": "multiplefailedfollowedbysuccess.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, IpAddress, Computer, Outcome, OutcomeCount",
    "detection": "multiplefailedfollowedbysuccess.yaml",
    "field": "outcome",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, IpAddress, Computer, Outcome, OutcomeCount",
    "detection": "multiplefailedfollowedbysuccess.yaml",
    "field": "outcomecount",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SessionStartedUtc = row_window_session(TimeGenerated, timeRange, authenticationWindow, Account != prev(Account) or prev(Outcome) == \"Success\")",
    "detection": "multiplefailedfollowedbysuccess.yaml",
    "field": "sessionstartedutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailureCountBeforeSuccess=sumif(OutcomeCount, Outcome == \"Failure\"), StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), make_list(Outcome, 128), make_set(Computer, 128), make_set(IpAddress, 128) by SessionStartedUtc, Account",
    "detection": "multiplefailedfollowedbysuccess.yaml",
    "field": "failurecountbeforesuccess",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailureCountBeforeSuccess=sumif(OutcomeCount, Outcome == \"Failure\"), StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), make_list(Outcome, 128), make_set(Computer, 128), make_set(IpAddress, 128) by SessionStartedUtc, Account",
    "detection": "multiplefailedfollowedbysuccess.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailureCountBeforeSuccess=sumif(OutcomeCount, Outcome == \"Failure\"), StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), make_list(Outcome, 128), make_set(Computer, 128), make_set(IpAddress, 128) by SessionStartedUtc, Account",
    "detection": "multiplefailedfollowedbysuccess.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailureCountBeforeSuccess=sumif(OutcomeCount, Outcome == \"Failure\"), StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), make_list(Outcome, 128), make_set(Computer, 128), make_set(IpAddress, 128) by SessionStartedUtc, Account",
    "detection": "multiplefailedfollowedbysuccess.yaml",
    "field": "sessionstartedutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize FailureCountBeforeSuccess=sumif(OutcomeCount, Outcome == \"Failure\"), StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), make_list(Outcome, 128), make_set(Computer, 128), make_set(IpAddress, 128) by SessionStartedUtc, Account",
    "detection": "multiplefailedfollowedbysuccess.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend IpAddress = tostring(set_IpAddress), Computer = tostring(set_Computer)",
    "detection": "multiplefailedfollowedbysuccess.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend IpAddress = tostring(set_IpAddress), Computer = tostring(set_Computer)",
    "detection": "multiplefailedfollowedbysuccess.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp=StartTime, NTDomain = split(Account, '\\\\', 0)[0], Name = split(Account, '\\\\', 1)[0], HostName = tostring(split(Computer, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.'))",
    "detection": "multiplefailedfollowedbysuccess.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp=StartTime, NTDomain = split(Account, '\\\\', 0)[0], Name = split(Account, '\\\\', 1)[0], HostName = tostring(split(Computer, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.'))",
    "detection": "multiplefailedfollowedbysuccess.yaml",
    "field": "ntdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp=StartTime, NTDomain = split(Account, '\\\\', 0)[0], Name = split(Account, '\\\\', 1)[0], HostName = tostring(split(Computer, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.'))",
    "detection": "multiplefailedfollowedbysuccess.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp=StartTime, NTDomain = split(Account, '\\\\', 0)[0], Name = split(Account, '\\\\', 1)[0], HostName = tostring(split(Computer, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.'))",
    "detection": "multiplefailedfollowedbysuccess.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp=StartTime, NTDomain = split(Account, '\\\\', 0)[0], Name = split(Account, '\\\\', 1)[0], HostName = tostring(split(Computer, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.'))",
    "detection": "multiplefailedfollowedbysuccess.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Message, SourceUserID, FileHash, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Message, SourceUserID, FileHash, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Message, SourceUserID, FileHash, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "sourceuserid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Message, SourceUserID, FileHash, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Message, SourceUserID, FileHash, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, FileHashCustomEntity = 'SHA256', Account = SourceUserID",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, FileHashCustomEntity = 'SHA256', Account = SourceUserID",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, FileHashCustomEntity = 'SHA256', Account = SourceUserID",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend EvData = parse_xml(EventData)",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "evdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventDetail = EvData.DataItem.EventData.Data",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Image = EventDetail.[4].[\"#text\"],  CommandLine = EventDetail.[10].[\"#text\"], Hashes = tostring(EventDetail.[17].[\"#text\"])",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Image = EventDetail.[4].[\"#text\"],  CommandLine = EventDetail.[10].[\"#text\"], Hashes = tostring(EventDetail.[17].[\"#text\"])",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Image = EventDetail.[4].[\"#text\"],  CommandLine = EventDetail.[10].[\"#text\"], Hashes = tostring(EventDetail.[17].[\"#text\"])",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "hashes",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Hashes = extract_all(@\"(?P<key>\\w+)=(?P<value>[a-zA-Z0-9]+)\", dynamic([\"key\",\"value\"]), Hashes)",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "hashes",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Hashes = column_ifexists(\"Hashes\", \"\"), CommandLine = column_ifexists(\"CommandLine\", \"\")",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "hashes",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Hashes = column_ifexists(\"Hashes\", \"\"), CommandLine = column_ifexists(\"CommandLine\", \"\")",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "source",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "hashes",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Type = strcat(Type, \": \", Source)",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), FileHashCustomEntity = tostring(Hashes)",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), FileHashCustomEntity = tostring(Hashes)",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), FileHashCustomEntity = tostring(Hashes)",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), FileHashCustomEntity = tostring(Hashes)",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), FileHashCustomEntity = tostring(Hashes)",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "actiontype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "initiatingprocessaccountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "initiatingprocessaccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "initiatingprocesscommandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "initiatingprocessfolderpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "initiatingprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "initiatingprocessparentfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "initiatingprocessfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "initiatingprocesssha256",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "algorithmcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "actiontype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "initiatingprocessaccountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "initiatingprocessaccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "initiatingprocesscommandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "initiatingprocessfolderpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "initiatingprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "initiatingprocessparentfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "initiatingprocessfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "initiatingprocesssha256",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "algorithmcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "actiontype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "initiatingprocessaccountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "initiatingprocessaccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "initiatingprocesscommandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "initiatingprocessfolderpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "initiatingprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "initiatingprocessparentfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "initiatingprocessfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "initiatingprocesssha256",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "algorithmcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "hiveransomwarejuly2022.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = SourceUserID, Computer = DeviceName, IPAddress = SourceIP",
    "detection": "thalliumiocs.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = SourceUserID, Computer = DeviceName, IPAddress = SourceIP",
    "detection": "thalliumiocs.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = SourceUserID, Computer = DeviceName, IPAddress = SourceIP",
    "detection": "thalliumiocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DNSName = Name",
    "detection": "thalliumiocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPAddress = ClientIP",
    "detection": "thalliumiocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DNSName = DnsQuery",
    "detection": "thalliumiocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPAddress = SrcIpAddr",
    "detection": "thalliumiocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPAddress = RemoteIp",
    "detection": "thalliumiocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DNSName = Request_Name",
    "detection": "thalliumiocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPAddress = ClientIP",
    "detection": "thalliumiocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DNSName = DestinationHost",
    "detection": "thalliumiocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPAddress = SourceHost",
    "detection": "thalliumiocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IPAddress",
    "detection": "thalliumiocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IPAddress",
    "detection": "thalliumiocs.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IPAddress",
    "detection": "thalliumiocs.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, IPCustomEntity = IPAddress",
    "detection": "thalliumiocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0530-july2022.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0530-july2022.yaml",
    "field": "actiontype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0530-july2022.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0530-july2022.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0530-july2022.yaml",
    "field": "initiatingprocessaccountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0530-july2022.yaml",
    "field": "initiatingprocessaccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0530-july2022.yaml",
    "field": "initiatingprocesscommandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0530-july2022.yaml",
    "field": "initiatingprocessfolderpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0530-july2022.yaml",
    "field": "initiatingprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0530-july2022.yaml",
    "field": "initiatingprocessparentfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0530-july2022.yaml",
    "field": "initiatingprocessfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0530-july2022.yaml",
    "field": "initiatingprocesssha256",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0530-july2022.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0530-july2022.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName,  InitiatingProcessSHA256, Type, AccountName, SHA256",
    "detection": "dev-0530-july2022.yaml",
    "field": "sha256",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = AccountName, Computer = DeviceName,  CommandLine = InitiatingProcessCommandLine, FileHash = case(InitiatingProcessSHA256 in (sha256Hashes), \"InitiatingProcessSHA256\", SHA256 in (sha256Hashes), \"SHA256\", \"No Match\")",
    "detection": "dev-0530-july2022.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = AccountName, Computer = DeviceName,  CommandLine = InitiatingProcessCommandLine, FileHash = case(InitiatingProcessSHA256 in (sha256Hashes), \"InitiatingProcessSHA256\", SHA256 in (sha256Hashes), \"SHA256\", \"No Match\")",
    "detection": "dev-0530-july2022.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = AccountName, Computer = DeviceName,  CommandLine = InitiatingProcessCommandLine, FileHash = case(InitiatingProcessSHA256 in (sha256Hashes), \"InitiatingProcessSHA256\", SHA256 in (sha256Hashes), \"SHA256\", \"No Match\")",
    "detection": "dev-0530-july2022.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = AccountName, Computer = DeviceName,  CommandLine = InitiatingProcessCommandLine, FileHash = case(InitiatingProcessSHA256 in (sha256Hashes), \"InitiatingProcessSHA256\", SHA256 in (sha256Hashes), \"SHA256\", \"No Match\")",
    "detection": "dev-0530-july2022.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = case(FileHash == \"InitiatingProcessSHA256\", InitiatingProcessSHA256, FileHash == \"SHA256\", SHA256, \"No Match\")",
    "detection": "dev-0530-july2022.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = case(FileHash == \"InitiatingProcessSHA256\", InitiatingProcessSHA256, FileHash == \"SHA256\", SHA256, \"No Match\")",
    "detection": "dev-0530-july2022.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = case(FileHash == \"InitiatingProcessSHA256\", InitiatingProcessSHA256, FileHash == \"SHA256\", SHA256, \"No Match\")",
    "detection": "dev-0530-july2022.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = case(FileHash == \"InitiatingProcessSHA256\", InitiatingProcessSHA256, FileHash == \"SHA256\", SHA256, \"No Match\")",
    "detection": "dev-0530-july2022.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = InitiatingProcessFileName, FileHashCustomEntity = case(FileHash == \"InitiatingProcessSHA256\", InitiatingProcessSHA256, FileHash == \"SHA256\", SHA256, \"No Match\")",
    "detection": "dev-0530-july2022.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, EventID, CommandLine",
    "detection": "dev-0530-july2022.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, EventID, CommandLine",
    "detection": "dev-0530-july2022.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, EventID, CommandLine",
    "detection": "dev-0530-july2022.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, EventID, CommandLine",
    "detection": "dev-0530-july2022.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, EventID, CommandLine",
    "detection": "dev-0530-july2022.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, EventID, CommandLine",
    "detection": "dev-0530-july2022.yaml",
    "field": "newprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, EventID, CommandLine",
    "detection": "dev-0530-july2022.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, EventID, CommandLine",
    "detection": "dev-0530-july2022.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, NewProcessName, ParentProcessName, Account, NewProcessId, Type, EventID, CommandLine",
    "detection": "dev-0530-july2022.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = NewProcessName",
    "detection": "dev-0530-july2022.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = NewProcessName",
    "detection": "dev-0530-july2022.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = NewProcessName",
    "detection": "dev-0530-july2022.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = Account, ProcessCustomEntity = NewProcessName",
    "detection": "dev-0530-july2022.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "dev-0530-july2022.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "dev-0530-july2022.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "dev-0530-july2022.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "dev-0530-july2022.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "dev-0530-july2022.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "dev-0530-july2022.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "dev-0530-july2022.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "dev-0530-july2022.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "dev-0530-july2022.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "dev-0530-july2022.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "dev-0530-july2022.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "dev-0530-july2022.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, FileHashCustomEntity = tostring(FileHash)",
    "detection": "dev-0530-july2022.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, FileHashCustomEntity = tostring(FileHash)",
    "detection": "dev-0530-july2022.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, FileHashCustomEntity = tostring(FileHash)",
    "detection": "dev-0530-july2022.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = Account, HostCustomEntity = Computer, FileHashCustomEntity = tostring(FileHash)",
    "detection": "dev-0530-july2022.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend EvData = parse_xml(EventData)",
    "detection": "dev-0530-july2022.yaml",
    "field": "evdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventDetail = EvData.DataItem.EventData.Data",
    "detection": "dev-0530-july2022.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Image = EventDetail.[4].[\"#text\"],  CommandLine = EventDetail.[10].[\"#text\"], Hashes = tostring(EventDetail.[17].[\"#text\"])",
    "detection": "dev-0530-july2022.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Image = EventDetail.[4].[\"#text\"],  CommandLine = EventDetail.[10].[\"#text\"], Hashes = tostring(EventDetail.[17].[\"#text\"])",
    "detection": "dev-0530-july2022.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Image = EventDetail.[4].[\"#text\"],  CommandLine = EventDetail.[10].[\"#text\"], Hashes = tostring(EventDetail.[17].[\"#text\"])",
    "detection": "dev-0530-july2022.yaml",
    "field": "hashes",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Hashes = extract_all(@\"(?P<key>\\w+)=(?P<value>[a-zA-Z0-9]+)\", dynamic([\"key\",\"value\"]), Hashes)",
    "detection": "dev-0530-july2022.yaml",
    "field": "hashes",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Hashes = column_ifexists(\"Hashes\", \"\"), CommandLine = column_ifexists(\"CommandLine\", \"\")",
    "detection": "dev-0530-july2022.yaml",
    "field": "hashes",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Hashes = column_ifexists(\"Hashes\", \"\"), CommandLine = column_ifexists(\"CommandLine\", \"\")",
    "detection": "dev-0530-july2022.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "dev-0530-july2022.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "dev-0530-july2022.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "dev-0530-july2022.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "dev-0530-july2022.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "dev-0530-july2022.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "dev-0530-july2022.yaml",
    "field": "source",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "dev-0530-july2022.yaml",
    "field": "hashes",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "dev-0530-july2022.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "dev-0530-july2022.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Type = strcat(Type, \": \", Source)",
    "detection": "dev-0530-july2022.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), FileHashCustomEntity = tostring(Hashes)",
    "detection": "dev-0530-july2022.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), FileHashCustomEntity = tostring(Hashes)",
    "detection": "dev-0530-july2022.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), FileHashCustomEntity = tostring(Hashes)",
    "detection": "dev-0530-july2022.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), FileHashCustomEntity = tostring(Hashes)",
    "detection": "dev-0530-july2022.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), FileHashCustomEntity = tostring(Hashes)",
    "detection": "dev-0530-july2022.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "dev-0530-july2022.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "dev-0530-july2022.yaml",
    "field": "actiontype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "dev-0530-july2022.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "dev-0530-july2022.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "dev-0530-july2022.yaml",
    "field": "initiatingprocessaccountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "dev-0530-july2022.yaml",
    "field": "initiatingprocessaccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "dev-0530-july2022.yaml",
    "field": "initiatingprocesscommandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "dev-0530-july2022.yaml",
    "field": "initiatingprocessfolderpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "dev-0530-july2022.yaml",
    "field": "initiatingprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "dev-0530-july2022.yaml",
    "field": "initiatingprocessparentfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "dev-0530-july2022.yaml",
    "field": "initiatingprocessfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "dev-0530-july2022.yaml",
    "field": "initiatingprocesssha256",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "dev-0530-july2022.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "dev-0530-july2022.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "dev-0530-july2022.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "dev-0530-july2022.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "dev-0530-july2022.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "dev-0530-july2022.yaml",
    "field": "algorithmcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "dev-0530-july2022.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "dev-0530-july2022.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "dev-0530-july2022.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SenderIPv4, AccountCustomEntity = SenderFromAddress",
    "detection": "dev-0530-july2022.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SenderIPv4, AccountCustomEntity = SenderFromAddress",
    "detection": "dev-0530-july2022.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SenderIPv4, AccountCustomEntity = SenderFromAddress",
    "detection": "dev-0530-july2022.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case(SourceIP in (IPList), \"SourceIP\", DestinationIP in (IPList), \"DestinationIP\", \"Message\")",
    "detection": "dev-0530-july2022.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch , FileHash",
    "detection": "dev-0530-july2022.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch , FileHash",
    "detection": "dev-0530-july2022.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch , FileHash",
    "detection": "dev-0530-july2022.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch , FileHash",
    "detection": "dev-0530-july2022.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch , FileHash",
    "detection": "dev-0530-july2022.yaml",
    "field": "deviceproduct",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch , FileHash",
    "detection": "dev-0530-july2022.yaml",
    "field": "deviceaction",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch , FileHash",
    "detection": "dev-0530-july2022.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch , FileHash",
    "detection": "dev-0530-july2022.yaml",
    "field": "protocol",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch , FileHash",
    "detection": "dev-0530-july2022.yaml",
    "field": "sourceport",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch , FileHash",
    "detection": "dev-0530-july2022.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch , FileHash",
    "detection": "dev-0530-july2022.yaml",
    "field": "deviceaddress",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch , FileHash",
    "detection": "dev-0530-july2022.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch , FileHash",
    "detection": "dev-0530-july2022.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by SourceIP, DestinationIP, DeviceProduct, DeviceAction, Message, Protocol, SourcePort, DestinationPort, DeviceAddress, DeviceName, IPMatch , FileHash",
    "detection": "dev-0530-july2022.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"IP in Message Field\")",
    "detection": "dev-0530-july2022.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"IP in Message Field\")",
    "detection": "dev-0530-july2022.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = SourceIPAddress , AccountCustomEntity = Account",
    "detection": "dev-0530-july2022.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = SourceIPAddress , AccountCustomEntity = Account",
    "detection": "dev-0530-july2022.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = SourceIPAddress , AccountCustomEntity = Account",
    "detection": "dev-0530-july2022.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, IPCustomEntity = IPAddress",
    "detection": "dev-0530-july2022.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, IPCustomEntity = IPAddress",
    "detection": "dev-0530-july2022.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, IPCustomEntity = IPAddress",
    "detection": "dev-0530-july2022.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, IPCustomEntity = IPAddress",
    "detection": "dev-0530-july2022.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, IPCustomEntity = IPAddress",
    "detection": "dev-0530-july2022.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserPrincipalName, IPCustomEntity = IPAddress",
    "detection": "dev-0530-july2022.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = cIP, HostCustomEntity = Computer, AccountCustomEntity = csUserName",
    "detection": "dev-0530-july2022.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = cIP, HostCustomEntity = Computer, AccountCustomEntity = csUserName",
    "detection": "dev-0530-july2022.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = cIP, HostCustomEntity = Computer, AccountCustomEntity = csUserName",
    "detection": "dev-0530-july2022.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = cIP, HostCustomEntity = Computer, AccountCustomEntity = csUserName",
    "detection": "dev-0530-july2022.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = CallerIpAddress, AccountCustomEntity = Caller",
    "detection": "dev-0530-july2022.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = CallerIpAddress, AccountCustomEntity = Caller",
    "detection": "dev-0530-july2022.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = CallerIpAddress, AccountCustomEntity = Caller",
    "detection": "dev-0530-july2022.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SourceIpAddress, AccountCustomEntity = UserIdentityUserName",
    "detection": "dev-0530-july2022.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SourceIpAddress, AccountCustomEntity = UserIdentityUserName",
    "detection": "dev-0530-july2022.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SourceIpAddress, AccountCustomEntity = UserIdentityUserName",
    "detection": "dev-0530-july2022.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName",
    "detection": "dev-0530-july2022.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName",
    "detection": "dev-0530-july2022.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName",
    "detection": "dev-0530-july2022.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIP = DestinationHost",
    "detection": "dev-0530-july2022.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SourceHost",
    "detection": "dev-0530-july2022.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIP = DestinationHost",
    "detection": "dev-0530-july2022.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SourceHost",
    "detection": "dev-0530-july2022.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SubjectAccount = Account, SubjectUserName, SubjectDomainName, SubjectUserSid, Process, ProcessId, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SubjectAccount = Account, SubjectUserName, SubjectDomainName, SubjectUserSid, Process, ProcessId, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SubjectAccount = Account, SubjectUserName, SubjectDomainName, SubjectUserSid, Process, ProcessId, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "subjectaccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SubjectAccount = Account, SubjectUserName, SubjectDomainName, SubjectUserSid, Process, ProcessId, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SubjectAccount = Account, SubjectUserName, SubjectDomainName, SubjectUserSid, Process, ProcessId, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SubjectAccount = Account, SubjectUserName, SubjectDomainName, SubjectUserSid, Process, ProcessId, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "subjectusersid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SubjectAccount = Account, SubjectUserName, SubjectDomainName, SubjectUserSid, Process, ProcessId, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SubjectAccount = Account, SubjectUserName, SubjectDomainName, SubjectUserSid, Process, ProcessId, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "processid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SubjectAccount = Account, SubjectUserName, SubjectDomainName, SubjectUserSid, Process, ProcessId, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SubjectAccount = Account, SubjectUserName, SubjectDomainName, SubjectUserSid, Process, ProcessId, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SubjectAccount = Account, SubjectUserName, SubjectDomainName, SubjectUserSid, Process, ProcessId, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SubjectAccount = Account, SubjectUserName, SubjectDomainName, SubjectUserSid, Process, ProcessId, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "_resourceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend NewProcessName = tostring(EventData.NewProcessName)",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Process=tostring(split(NewProcessName, '\\\\')[-1])",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend CommandLine = tostring(EventData.CommandLine)",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectAccount =  strcat(EventData.SubjectDomainName,\"\\\\\", EventData.SubjectUserName)",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "subjectaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend ParentProcessName = tostring(EventData.ParentProcessName)",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SubjectAccount, SubjectUserName = tostring(EventData.SubjectUserName), SubjectDomainName = tostring(EventData.SubjectDomainName), SubjectUserSid = tostring(EventData.SubjectUserSid), Process, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SubjectAccount, SubjectUserName = tostring(EventData.SubjectUserName), SubjectDomainName = tostring(EventData.SubjectDomainName), SubjectUserSid = tostring(EventData.SubjectUserSid), Process, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SubjectAccount, SubjectUserName = tostring(EventData.SubjectUserName), SubjectDomainName = tostring(EventData.SubjectDomainName), SubjectUserSid = tostring(EventData.SubjectUserSid), Process, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "subjectaccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SubjectAccount, SubjectUserName = tostring(EventData.SubjectUserName), SubjectDomainName = tostring(EventData.SubjectDomainName), SubjectUserSid = tostring(EventData.SubjectUserSid), Process, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SubjectAccount, SubjectUserName = tostring(EventData.SubjectUserName), SubjectDomainName = tostring(EventData.SubjectDomainName), SubjectUserSid = tostring(EventData.SubjectUserSid), Process, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SubjectAccount, SubjectUserName = tostring(EventData.SubjectUserName), SubjectDomainName = tostring(EventData.SubjectDomainName), SubjectUserSid = tostring(EventData.SubjectUserSid), Process, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "subjectusersid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SubjectAccount, SubjectUserName = tostring(EventData.SubjectUserName), SubjectDomainName = tostring(EventData.SubjectDomainName), SubjectUserSid = tostring(EventData.SubjectUserSid), Process, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SubjectAccount, SubjectUserName = tostring(EventData.SubjectUserName), SubjectDomainName = tostring(EventData.SubjectDomainName), SubjectUserSid = tostring(EventData.SubjectUserSid), Process, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SubjectAccount, SubjectUserName = tostring(EventData.SubjectUserName), SubjectDomainName = tostring(EventData.SubjectDomainName), SubjectUserSid = tostring(EventData.SubjectUserSid), Process, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SubjectAccount, SubjectUserName = tostring(EventData.SubjectUserName), SubjectDomainName = tostring(EventData.SubjectDomainName), SubjectUserSid = tostring(EventData.SubjectUserSid), Process, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, SubjectAccount, SubjectUserName = tostring(EventData.SubjectUserName), SubjectDomainName = tostring(EventData.SubjectDomainName), SubjectUserSid = tostring(EventData.SubjectUserSid), Process, NewProcessName, CommandLine, ParentProcessName, _ResourceId",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "_resourceid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "nobelium-suspiciousrundll32exec.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Message, SourceUserID, RequestURL, DestinationHostName, Type, SourceIP, DestinationIP, DNSName",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Message, SourceUserID, RequestURL, DestinationHostName, Type, SourceIP, DestinationIP, DNSName",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Message, SourceUserID, RequestURL, DestinationHostName, Type, SourceIP, DestinationIP, DNSName",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "sourceuserid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Message, SourceUserID, RequestURL, DestinationHostName, Type, SourceIP, DestinationIP, DNSName",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "requesturl",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Message, SourceUserID, RequestURL, DestinationHostName, Type, SourceIP, DestinationIP, DNSName",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "destinationhostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Message, SourceUserID, RequestURL, DestinationHostName, Type, SourceIP, DestinationIP, DNSName",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Message, SourceUserID, RequestURL, DestinationHostName, Type, SourceIP, DestinationIP, DNSName",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Message, SourceUserID, RequestURL, DestinationHostName, Type, SourceIP, DestinationIP, DNSName",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Message, SourceUserID, RequestURL, DestinationHostName, Type, SourceIP, DestinationIP, DNSName",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = SourceUserID, UrlCustomEntity = RequestURL , IPCustomEntity = DestinationIP, DNSCustomEntity = DNSName",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = SourceUserID, UrlCustomEntity = RequestURL , IPCustomEntity = DestinationIP, DNSCustomEntity = DNSName",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = SourceUserID, UrlCustomEntity = RequestURL , IPCustomEntity = DestinationIP, DNSCustomEntity = DNSName",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "urlcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = SourceUserID, UrlCustomEntity = RequestURL , IPCustomEntity = DestinationIP, DNSCustomEntity = DNSName",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = SourceUserID, UrlCustomEntity = RequestURL , IPCustomEntity = DestinationIP, DNSCustomEntity = DNSName",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "dnscustomentity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, IPAddresses, Name, ClientIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, IPAddresses, Name, ClientIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, IPAddresses, Name, ClientIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "ipaddresses",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, IPAddresses, Name, ClientIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, IPAddresses, Name, ClientIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, IPAddresses, Name, ClientIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DNSName = Name, Host = Computer",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DNSName = Name, Host = Computer",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "host",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Host, DNSCustomEntity = DNSName, IPCustomEntity = IPAddresses",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Host, DNSCustomEntity = DNSName, IPCustomEntity = IPAddresses",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Host, DNSCustomEntity = DNSName, IPCustomEntity = IPAddresses",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "dnscustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Host, DNSCustomEntity = DNSName, IPCustomEntity = IPAddresses",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Direction, RemoteDnsCanonicalNames, ProcessName, SourceIp, DestinationIp, DestinationPort, DNSName,BytesSent, BytesReceived, RemoteCountry, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Direction, RemoteDnsCanonicalNames, ProcessName, SourceIp, DestinationIp, DestinationPort, DNSName,BytesSent, BytesReceived, RemoteCountry, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Direction, RemoteDnsCanonicalNames, ProcessName, SourceIp, DestinationIp, DestinationPort, DNSName,BytesSent, BytesReceived, RemoteCountry, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "direction",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Direction, RemoteDnsCanonicalNames, ProcessName, SourceIp, DestinationIp, DestinationPort, DNSName,BytesSent, BytesReceived, RemoteCountry, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "remotednscanonicalnames",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Direction, RemoteDnsCanonicalNames, ProcessName, SourceIp, DestinationIp, DestinationPort, DNSName,BytesSent, BytesReceived, RemoteCountry, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Direction, RemoteDnsCanonicalNames, ProcessName, SourceIp, DestinationIp, DestinationPort, DNSName,BytesSent, BytesReceived, RemoteCountry, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Direction, RemoteDnsCanonicalNames, ProcessName, SourceIp, DestinationIp, DestinationPort, DNSName,BytesSent, BytesReceived, RemoteCountry, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Direction, RemoteDnsCanonicalNames, ProcessName, SourceIp, DestinationIp, DestinationPort, DNSName,BytesSent, BytesReceived, RemoteCountry, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "destinationport",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Direction, RemoteDnsCanonicalNames, ProcessName, SourceIp, DestinationIp, DestinationPort, DNSName,BytesSent, BytesReceived, RemoteCountry, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Direction, RemoteDnsCanonicalNames, ProcessName, SourceIp, DestinationIp, DestinationPort, DNSName,BytesSent, BytesReceived, RemoteCountry, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "bytessent",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Direction, RemoteDnsCanonicalNames, ProcessName, SourceIp, DestinationIp, DestinationPort, DNSName,BytesSent, BytesReceived, RemoteCountry, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "bytesreceived",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Direction, RemoteDnsCanonicalNames, ProcessName, SourceIp, DestinationIp, DestinationPort, DNSName,BytesSent, BytesReceived, RemoteCountry, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "remotecountry",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Direction, RemoteDnsCanonicalNames, ProcessName, SourceIp, DestinationIp, DestinationPort, DNSName,BytesSent, BytesReceived, RemoteCountry, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIp, HostCustomEntity = Computer, ProcessCustomEntity = ProcessName, DNSCustomEntity = DNSName",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIp, HostCustomEntity = Computer, ProcessCustomEntity = ProcessName, DNSCustomEntity = DNSName",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIp, HostCustomEntity = Computer, ProcessCustomEntity = ProcessName, DNSCustomEntity = DNSName",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIp, HostCustomEntity = Computer, ProcessCustomEntity = ProcessName, DNSCustomEntity = DNSName",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = DestinationIp, HostCustomEntity = Computer, ProcessCustomEntity = ProcessName, DNSCustomEntity = DNSName",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "dnscustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EvData = parse_xml(EventData)",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "evdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventDetail = EvData.DataItem.EventData.Data",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = tostring(EventDetail.[9].[\"#text\"]), DestinationIP = tostring(EventDetail.[14].[\"#text\"]), Image = EventDetail.[4].[\"#text\"]",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = tostring(EventDetail.[9].[\"#text\"]), DestinationIP = tostring(EventDetail.[14].[\"#text\"]), Image = EventDetail.[4].[\"#text\"]",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIP = tostring(EventDetail.[9].[\"#text\"]), DestinationIP = tostring(EventDetail.[14].[\"#text\"]), Image = EventDetail.[4].[\"#text\"]",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Image, UserName, Computer, EventDetail, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Image, UserName, Computer, EventDetail, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Image, UserName, Computer, EventDetail, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "destinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Image, UserName, Computer, EventDetail, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Image, UserName, Computer, EventDetail, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Image, UserName, Computer, EventDetail, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Image, UserName, Computer, EventDetail, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, SourceIP, DestinationIP, Image, UserName, Computer, EventDetail, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), HostCustomEntity = Computer , IPCustomEntity = DestinationIP",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), HostCustomEntity = Computer , IPCustomEntity = DestinationIP",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), HostCustomEntity = Computer , IPCustomEntity = DestinationIP",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), HostCustomEntity = Computer , IPCustomEntity = DestinationIP",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), HostCustomEntity = Computer , IPCustomEntity = DestinationIP",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, LocalIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, LocalIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "actiontype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, LocalIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, LocalIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, LocalIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocessaccountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, LocalIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocessaccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, LocalIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocesscommandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, LocalIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocessfolderpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, LocalIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, LocalIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocessparentfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, LocalIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocessfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, LocalIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "remoteip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, LocalIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "remoteurl",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, LocalIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "localip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RemoteIP, RemoteUrl, LocalIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName, UrlCustomEntity =RemoteUrl",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName, UrlCustomEntity =RemoteUrl",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName, UrlCustomEntity =RemoteUrl",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = RemoteIP, HostCustomEntity = DeviceName, UrlCustomEntity =RemoteUrl",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "urlcustomentity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,Resource, msg_s, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,Resource, msg_s, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,Resource, msg_s, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "msg_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,Resource, msg_s, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = Request_Name, IPCustomEntity = ClientIP",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = Request_Name, IPCustomEntity = ClientIP",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = Request_Name, IPCustomEntity = ClientIP",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,Resource, msg_s",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,Resource, msg_s",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,Resource, msg_s",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "msg_s",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = DestinationHost, IPCustomEntity = SourceHost",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = DestinationHost, IPCustomEntity = SourceHost",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, DNSName = DestinationHost, IPCustomEntity = SourceHost",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend EvData = parse_xml(EventData)",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "evdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventDetail = EvData.DataItem.EventData.Data",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Image = EventDetail.[4].[\"#text\"],  CommandLine = EventDetail.[10].[\"#text\"]",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Image = EventDetail.[4].[\"#text\"],  CommandLine = EventDetail.[10].[\"#text\"]",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, SHA256, CommandLine, Image",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, SHA256, CommandLine, Image",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, SHA256, CommandLine, Image",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, SHA256, CommandLine, Image",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, SHA256, CommandLine, Image",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, SHA256, CommandLine, Image",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "source",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, SHA256, CommandLine, Image",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "sha256",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, SHA256, CommandLine, Image",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, SHA256, CommandLine, Image",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Type = strcat(Type, \": \", Source)",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = SHA256",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = SHA256",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = SHA256",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = SHA256",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = SHA256",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "algorithmcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = SHA256",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "actiontype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocessaccountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocessaccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocesscommandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocessfolderpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocessparentfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocessfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocesssha256",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "folderpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = InitiatingProcessSHA256",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = InitiatingProcessSHA256",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = InitiatingProcessSHA256",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = InitiatingProcessSHA256",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = InitiatingProcessSHA256",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "algorithmcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = InitiatingProcessSHA256",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "actiontype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocessaccountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocessaccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocesscommandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocessfolderpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocessparentfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocessfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "requestaccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "requestsourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocesssha256",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "folderpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, RequestAccountName, RequestSourceIP, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = RequestAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = InitiatingProcessSHA256",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = RequestAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = InitiatingProcessSHA256",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = RequestAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = InitiatingProcessSHA256",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = RequestAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = InitiatingProcessSHA256",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = RequestAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = InitiatingProcessSHA256",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "algorithmcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = RequestAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = InitiatingProcessSHA256",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "actiontype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocessaccountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocessaccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocesscommandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocessfolderpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocessparentfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocessfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "initiatingprocesssha256",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "folderpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, FolderPath, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend CommandLine = InitiatingProcessCommandLine",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = InitiatingProcessSHA256",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = InitiatingProcessSHA256",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = InitiatingProcessSHA256",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = InitiatingProcessSHA256",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = InitiatingProcessSHA256",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "algorithmcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = InitiatingProcessSHA256",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserAgent, Operation, RecordType, UserId, ClientIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserAgent, Operation, RecordType, UserId, ClientIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserAgent, Operation, RecordType, UserId, ClientIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserAgent, Operation, RecordType, UserId, ClientIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "recordtype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserAgent, Operation, RecordType, UserId, ClientIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserAgent, Operation, RecordType, UserId, ClientIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, UserAgent, Operation, RecordType, UserId, ClientIP, Type",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = ClientIP, AccountCustomEntity = UserId",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = ClientIP, AccountCustomEntity = UserId",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = ClientIP, AccountCustomEntity = UserId",
    "detection": "zincoctober2022-ip-domain-hash-ioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName, NewProcessName,",
    "detection": "malware-in-recyclebin.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName, NewProcessName,",
    "detection": "malware-in-recyclebin.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName, NewProcessName,",
    "detection": "malware-in-recyclebin.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName, NewProcessName,",
    "detection": "malware-in-recyclebin.yaml",
    "field": "accountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName, NewProcessName,",
    "detection": "malware-in-recyclebin.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend CommandLine = tostring(EventData.CommandLine)",
    "detection": "malware-in-recyclebin.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectUserName = tostring(EventData.SubjectUserName)",
    "detection": "malware-in-recyclebin.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectDomainName = tostring(EventData.SubjectDomainName)",
    "detection": "malware-in-recyclebin.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend NewProcessName = tostring(EventData.NewProcessName)",
    "detection": "malware-in-recyclebin.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend ParentProcessName = tostring(EventData.ParentProcessName)",
    "detection": "malware-in-recyclebin.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Process=tostring(split(NewProcessName, '\\\\')[-1])",
    "detection": "malware-in-recyclebin.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName, NewProcessName,",
    "detection": "malware-in-recyclebin.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName, NewProcessName,",
    "detection": "malware-in-recyclebin.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName, NewProcessName,",
    "detection": "malware-in-recyclebin.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName, NewProcessName,",
    "detection": "malware-in-recyclebin.yaml",
    "field": "accountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName, NewProcessName,",
    "detection": "malware-in-recyclebin.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTimeUtc = TimeGenerated, Computer, Account, NewProcessName, FileName, CommandLine, ParentProcessName",
    "detection": "malware-in-recyclebin.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTimeUtc = TimeGenerated, Computer, Account, NewProcessName, FileName, CommandLine, ParentProcessName",
    "detection": "malware-in-recyclebin.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTimeUtc = TimeGenerated, Computer, Account, NewProcessName, FileName, CommandLine, ParentProcessName",
    "detection": "malware-in-recyclebin.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTimeUtc = TimeGenerated, Computer, Account, NewProcessName, FileName, CommandLine, ParentProcessName",
    "detection": "malware-in-recyclebin.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTimeUtc = TimeGenerated, Computer, Account, NewProcessName, FileName, CommandLine, ParentProcessName",
    "detection": "malware-in-recyclebin.yaml",
    "field": "filename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTimeUtc = TimeGenerated, Computer, Account, NewProcessName, FileName, CommandLine, ParentProcessName",
    "detection": "malware-in-recyclebin.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTimeUtc = TimeGenerated, Computer, Account, NewProcessName, FileName, CommandLine, ParentProcessName",
    "detection": "malware-in-recyclebin.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = iif(Computer has '.',substring(Computer,0,indexof(Computer,'.')),Computer) , DnsDomain = iif(Computer has '.',substring(Computer,indexof(Computer,'.')+1),'')",
    "detection": "malware-in-recyclebin.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = iif(Computer has '.',substring(Computer,0,indexof(Computer,'.')),Computer) , DnsDomain = iif(Computer has '.',substring(Computer,indexof(Computer,'.')+1),'')",
    "detection": "malware-in-recyclebin.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize count() by IPAddress",
    "detection": "aad-pavpn-correlation.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SourceIP = extract(\"Login from: ([^,]+)\", 1, Message)",
    "detection": "aad-pavpn-correlation.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend Reason = \"Multiple failed AAD logins from SourceIP\"",
    "detection": "aad-pavpn-correlation.yaml",
    "field": "reason",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend User = extract('User name: ([^,]+)', 1, Message)",
    "detection": "aad-pavpn-correlation.yaml",
    "field": "user",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend ClientOS = extract('Client OS version: ([^,\\\"]+)', 1, Message)",
    "detection": "aad-pavpn-correlation.yaml",
    "field": "clientos",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend Location = extract('Source region: ([^,]{2})',1, Message)",
    "detection": "aad-pavpn-correlation.yaml",
    "field": "location",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, Reason, SourceIP, User, ClientOS, Location, Message, DeviceName, ReceiptTime, DeviceVendor, DeviceEventClassID, Computer, FileName",
    "detection": "aad-pavpn-correlation.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, Reason, SourceIP, User, ClientOS, Location, Message, DeviceName, ReceiptTime, DeviceVendor, DeviceEventClassID, Computer, FileName",
    "detection": "aad-pavpn-correlation.yaml",
    "field": "reason",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, Reason, SourceIP, User, ClientOS, Location, Message, DeviceName, ReceiptTime, DeviceVendor, DeviceEventClassID, Computer, FileName",
    "detection": "aad-pavpn-correlation.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, Reason, SourceIP, User, ClientOS, Location, Message, DeviceName, ReceiptTime, DeviceVendor, DeviceEventClassID, Computer, FileName",
    "detection": "aad-pavpn-correlation.yaml",
    "field": "user",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, Reason, SourceIP, User, ClientOS, Location, Message, DeviceName, ReceiptTime, DeviceVendor, DeviceEventClassID, Computer, FileName",
    "detection": "aad-pavpn-correlation.yaml",
    "field": "clientos",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, Reason, SourceIP, User, ClientOS, Location, Message, DeviceName, ReceiptTime, DeviceVendor, DeviceEventClassID, Computer, FileName",
    "detection": "aad-pavpn-correlation.yaml",
    "field": "location",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, Reason, SourceIP, User, ClientOS, Location, Message, DeviceName, ReceiptTime, DeviceVendor, DeviceEventClassID, Computer, FileName",
    "detection": "aad-pavpn-correlation.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, Reason, SourceIP, User, ClientOS, Location, Message, DeviceName, ReceiptTime, DeviceVendor, DeviceEventClassID, Computer, FileName",
    "detection": "aad-pavpn-correlation.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, Reason, SourceIP, User, ClientOS, Location, Message, DeviceName, ReceiptTime, DeviceVendor, DeviceEventClassID, Computer, FileName",
    "detection": "aad-pavpn-correlation.yaml",
    "field": "receipttime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, Reason, SourceIP, User, ClientOS, Location, Message, DeviceName, ReceiptTime, DeviceVendor, DeviceEventClassID, Computer, FileName",
    "detection": "aad-pavpn-correlation.yaml",
    "field": "devicevendor",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, Reason, SourceIP, User, ClientOS, Location, Message, DeviceName, ReceiptTime, DeviceVendor, DeviceEventClassID, Computer, FileName",
    "detection": "aad-pavpn-correlation.yaml",
    "field": "deviceeventclassid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, Reason, SourceIP, User, ClientOS, Location, Message, DeviceName, ReceiptTime, DeviceVendor, DeviceEventClassID, Computer, FileName",
    "detection": "aad-pavpn-correlation.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "    | project TimeGenerated, Reason, SourceIP, User, ClientOS, Location, Message, DeviceName, ReceiptTime, DeviceVendor, DeviceEventClassID, Computer, FileName",
    "detection": "aad-pavpn-correlation.yaml",
    "field": "filename",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "    | extend timestamp = TimeGenerated",
    "detection": "aad-pavpn-correlation.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize make_set(DstIpAddr,100) by DstPortNumber",
    "detection": "networkportsweepfromexternalnetwork.yaml",
    "field": "dstportnumber",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Message, SourceUserID, FileHash, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Message, SourceUserID, FileHash, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "message",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Message, SourceUserID, FileHash, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "sourceuserid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Message, SourceUserID, FileHash, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Message, SourceUserID, FileHash, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, FileHashCustomEntity = 'SHA256', Account = SourceUserID",
    "detection": "tarraskhashioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, FileHashCustomEntity = 'SHA256', Account = SourceUserID",
    "detection": "tarraskhashioc.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, FileHashCustomEntity = 'SHA256', Account = SourceUserID",
    "detection": "tarraskhashioc.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "tarraskhashioc.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "tarraskhashioc.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "tarraskhashioc.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "tarraskhashioc.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = ActorUsername, Computer = DvcHostname, IPAddress = SrcIpAddr, CommandLine = ActingProcessCommandLine, FileHash = TargetFileSHA256",
    "detection": "tarraskhashioc.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "tarraskhashioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "tarraskhashioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "tarraskhashioc.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "tarraskhashioc.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "tarraskhashioc.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "tarraskhashioc.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project Type, TimeGenerated, Computer, Account, IPAddress, CommandLine, FileHash",
    "detection": "tarraskhashioc.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend EvData = parse_xml(EventData)",
    "detection": "tarraskhashioc.yaml",
    "field": "evdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventDetail = EvData.DataItem.EventData.Data",
    "detection": "tarraskhashioc.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Image = EventDetail.[4].[\"#text\"],  CommandLine = EventDetail.[10].[\"#text\"], Hashes = tostring(EventDetail.[17].[\"#text\"])",
    "detection": "tarraskhashioc.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Image = EventDetail.[4].[\"#text\"],  CommandLine = EventDetail.[10].[\"#text\"], Hashes = tostring(EventDetail.[17].[\"#text\"])",
    "detection": "tarraskhashioc.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Image = EventDetail.[4].[\"#text\"],  CommandLine = EventDetail.[10].[\"#text\"], Hashes = tostring(EventDetail.[17].[\"#text\"])",
    "detection": "tarraskhashioc.yaml",
    "field": "hashes",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Hashes = extract_all(@\"(?P<key>\\w+)=(?P<value>[a-zA-Z0-9]+)\", dynamic([\"key\",\"value\"]), Hashes)",
    "detection": "tarraskhashioc.yaml",
    "field": "hashes",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Hashes = column_ifexists(\"Hashes\", \"\"), CommandLine = column_ifexists(\"CommandLine\", \"\")",
    "detection": "tarraskhashioc.yaml",
    "field": "hashes",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Hashes = column_ifexists(\"Hashes\", \"\"), CommandLine = column_ifexists(\"CommandLine\", \"\")",
    "detection": "tarraskhashioc.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "tarraskhashioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "tarraskhashioc.yaml",
    "field": "eventdetail",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "tarraskhashioc.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "tarraskhashioc.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "tarraskhashioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "tarraskhashioc.yaml",
    "field": "source",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "tarraskhashioc.yaml",
    "field": "hashes",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "tarraskhashioc.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, EventDetail, UserName, Computer, Type, Source, Hashes, CommandLine, Image",
    "detection": "tarraskhashioc.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Type = strcat(Type, \": \", Source)",
    "detection": "tarraskhashioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), FileHashCustomEntity = tostring(Hashes)",
    "detection": "tarraskhashioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), FileHashCustomEntity = tostring(Hashes)",
    "detection": "tarraskhashioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), FileHashCustomEntity = tostring(Hashes)",
    "detection": "tarraskhashioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), FileHashCustomEntity = tostring(Hashes)",
    "detection": "tarraskhashioc.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = Computer , AccountCustomEntity = UserName, ProcessCustomEntity = tostring(split(Image, '\\\\', -1)[-1]), FileHashCustomEntity = tostring(Hashes)",
    "detection": "tarraskhashioc.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "actiontype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "initiatingprocessaccountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "initiatingprocessaccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "initiatingprocesscommandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "initiatingprocessfolderpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "initiatingprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "initiatingprocessparentfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "initiatingprocessfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "initiatingprocesssha256",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "tarraskhashioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "tarraskhashioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "tarraskhashioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "tarraskhashioc.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "tarraskhashioc.yaml",
    "field": "algorithmcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "tarraskhashioc.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "tarraskhashioc.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "tarraskhashioc.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "actiontype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "initiatingprocessaccountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "initiatingprocessaccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "initiatingprocesscommandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "initiatingprocessfolderpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "initiatingprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "initiatingprocessparentfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "initiatingprocessfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "initiatingprocesssha256",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "tarraskhashioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "tarraskhashioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "tarraskhashioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "tarraskhashioc.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "tarraskhashioc.yaml",
    "field": "algorithmcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "tarraskhashioc.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "tarraskhashioc.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "tarraskhashioc.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "actiontype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "initiatingprocessaccountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "initiatingprocessaccountname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "initiatingprocesscommandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "initiatingprocessfolderpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "initiatingprocessid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "initiatingprocessparentfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "initiatingprocessfilename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "initiatingprocesssha256",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, ActionType, DeviceId, DeviceName, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessParentFileName, InitiatingProcessFileName, InitiatingProcessSHA256, Type",
    "detection": "tarraskhashioc.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "tarraskhashioc.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "tarraskhashioc.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "tarraskhashioc.yaml",
    "field": "accountcustomentity",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "tarraskhashioc.yaml",
    "field": "processcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "tarraskhashioc.yaml",
    "field": "algorithmcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "tarraskhashioc.yaml",
    "field": "filehashcustomentity",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "tarraskhashioc.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, HostCustomEntity = DeviceName , AccountCustomEntity = InitiatingProcessAccountName, ProcessCustomEntity = InitiatingProcessFileName, AlgorithmCustomEntity = \"SHA256\", FileHashCustomEntity = tostring(InitiatingProcessSHA256),  CommandLine = InitiatingProcessCommandLine,Image = InitiatingProcessFolderPath",
    "detection": "tarraskhashioc.yaml",
    "field": "image",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend _parsedIntiatedByUser = parse_json(tostring(InitiatedBy.user))",
    "detection": "mfadisable.yaml",
    "field": "_parsedintiatedbyuser",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend _parsedIntiatedByApp = parse_json(tostring(InitiatedBy.app))",
    "detection": "mfadisable.yaml",
    "field": "_parsedintiatedbyapp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPAddress = tostring(_parsedIntiatedByUser.ipAddress)",
    "detection": "mfadisable.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend InitiatedByUser = iff(isnotempty(tostring(_parsedIntiatedByUser.userPrincipalName)),",
    "detection": "mfadisable.yaml",
    "field": "initiatedbyuser",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Targetprop = todynamic(TargetResources)",
    "detection": "mfadisable.yaml",
    "field": "targetprop",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetUser = tostring(Targetprop[0].userPrincipalName)",
    "detection": "mfadisable.yaml",
    "field": "targetuser",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by User = TargetUser, InitiatedByUser , Operation = OperationName , CorrelationId, IPAddress, Category, Source = SourceSystem , AADTenantId, Type",
    "detection": "mfadisable.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by User = TargetUser, InitiatedByUser , Operation = OperationName , CorrelationId, IPAddress, Category, Source = SourceSystem , AADTenantId, Type",
    "detection": "mfadisable.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by User = TargetUser, InitiatedByUser , Operation = OperationName , CorrelationId, IPAddress, Category, Source = SourceSystem , AADTenantId, Type",
    "detection": "mfadisable.yaml",
    "field": "initiatedbyuser",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by User = TargetUser, InitiatedByUser , Operation = OperationName , CorrelationId, IPAddress, Category, Source = SourceSystem , AADTenantId, Type",
    "detection": "mfadisable.yaml",
    "field": "correlationid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by User = TargetUser, InitiatedByUser , Operation = OperationName , CorrelationId, IPAddress, Category, Source = SourceSystem , AADTenantId, Type",
    "detection": "mfadisable.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by User = TargetUser, InitiatedByUser , Operation = OperationName , CorrelationId, IPAddress, Category, Source = SourceSystem , AADTenantId, Type",
    "detection": "mfadisable.yaml",
    "field": "category",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by User = TargetUser, InitiatedByUser , Operation = OperationName , CorrelationId, IPAddress, Category, Source = SourceSystem , AADTenantId, Type",
    "detection": "mfadisable.yaml",
    "field": "aadtenantid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by User = TargetUser, InitiatedByUser , Operation = OperationName , CorrelationId, IPAddress, Category, Source = SourceSystem , AADTenantId, Type",
    "detection": "mfadisable.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend _parsedRequestParameters = parse_json(RequestParameters)",
    "detection": "mfadisable.yaml",
    "field": "_parsedrequestparameters",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend InstanceProfileName = tostring(_parsedRequestParameters.InstanceProfileName)",
    "detection": "mfadisable.yaml",
    "field": "instanceprofilename",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetUser = tostring(_parsedRequestParameters.userName)",
    "detection": "mfadisable.yaml",
    "field": "targetuser",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by User = TargetUser, Source = EventSource , Operation = EventName , TenantorInstance_Detail = InstanceProfileName, IPAddress = SourceIpAddress",
    "detection": "mfadisable.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated) by User = TargetUser, Source = EventSource , Operation = EventName , TenantorInstance_Detail = InstanceProfileName, IPAddress = SourceIpAddress",
    "detection": "mfadisable.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, UserName = tostring(split(User, '@', 0)[0]), UPNSuffix = tostring(split(User, '@', 1)[0])",
    "detection": "mfadisable.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, UserName = tostring(split(User, '@', 0)[0]), UPNSuffix = tostring(split(User, '@', 1)[0])",
    "detection": "mfadisable.yaml",
    "field": "username",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTimeUtc, UserName = tostring(split(User, '@', 0)[0]), UPNSuffix = tostring(split(User, '@', 1)[0])",
    "detection": "mfadisable.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend MessageIP = extract(IPRegex, 0, Message)",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "messageip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend RequestURLIP = extract(IPRegex, 0, Message)",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "requesturlip",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case(SourceIP in (IPList), \"SourceIP\", DestinationIP in (IPList), \"DestinationIP\", MessageIP in (IPList), \"Message\", RequestURLIP in (IPList), \"RequestUrl\", \"NoMatch\")",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP,IPMatch == \"Message\", MessageIP,",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP,IPMatch == \"Message\", MessageIP,",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP,IPMatch == \"Message\", MessageIP,",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP,IPMatch == \"Message\", MessageIP,",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = DnsResponseName, DNSName = DnsQuery, Host = Dvc",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "destinationipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = DnsResponseName, DNSName = DnsQuery, Host = Dvc",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = DnsResponseName, DNSName = DnsQuery, Host = Dvc",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "host",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SrcIpAddr, HostCustomEntity = Host),",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = DnsResponseName, DNSName = DnsQuery, Host = Dvc",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "destinationipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = DnsResponseName, DNSName = DnsQuery, Host = Dvc",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = DnsResponseName, DNSName = DnsQuery, Host = Dvc",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "host",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SrcIpAddr, HostCustomEntity = Host),",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = DstIpAddr, DNSName = tostring(parse_url(Url)[\"Host\"]), Host = Dvc",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "destinationipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = DstIpAddr, DNSName = tostring(parse_url(Url)[\"Host\"]), Host = Dvc",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DestinationIPAddress = DstIpAddr, DNSName = tostring(parse_url(Url)[\"Host\"]), Host = Dvc",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "host",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated, IPCustomEntity = SrcIpAddr, HostCustomEntity = Host),",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPMatch = case( SourceIp in (IPList), \"SourceIP\", DestinationIp in (IPList), \"DestinationIP\", \"None\")",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "ipmatch",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIp, IPMatch == \"DestinationIP\", DestinationIp, \"None\"), Host = Computer),",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIp, IPMatch == \"DestinationIP\", DestinationIp, \"None\"), Host = Computer),",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIPAddress = ClientIP, Account = UserId",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend SourceIPAddress = ClientIP, Account = UserId",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated , IPCustomEntity = SourceIPAddress , AccountCustomEntity = Account),",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DNSName = DestinationHost",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SourceHost",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,Resource, msg_s, Type",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,Resource, msg_s, Type",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,Resource, msg_s, Type",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "msg_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated,Resource, msg_s, Type",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DNSName = Request_Name",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = ClientIP",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DNSName = Fqdn",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SourceIp",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend DNSName = QueryName",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend IPCustomEntity = SourceIp",
    "detection": "phosphorusmarch2019iocs.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Reason = case( (OldSd has ';;;SY' and NewSd !has ';;;SY'), 'System Account is removed', (OldSd has_any (FullAccess) and NewSd has_any (ReadAccess)) , 'System permission has been changed to read from full access', (OldSd has_any (FullAccess) and NewSd has_any (DenyAccess)), 'System account has been given denied permission', 'None')",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "reason",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account,  ProcessName, ProcessId, ObjectName, EventData, Activity, HandleId, SubjectLogonId, OldSd, NewSd , Reason",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account,  ProcessName, ProcessId, ObjectName, EventData, Activity, HandleId, SubjectLogonId, OldSd, NewSd , Reason",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account,  ProcessName, ProcessId, ObjectName, EventData, Activity, HandleId, SubjectLogonId, OldSd, NewSd , Reason",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account,  ProcessName, ProcessId, ObjectName, EventData, Activity, HandleId, SubjectLogonId, OldSd, NewSd , Reason",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account,  ProcessName, ProcessId, ObjectName, EventData, Activity, HandleId, SubjectLogonId, OldSd, NewSd , Reason",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "processid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account,  ProcessName, ProcessId, ObjectName, EventData, Activity, HandleId, SubjectLogonId, OldSd, NewSd , Reason",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "objectname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account,  ProcessName, ProcessId, ObjectName, EventData, Activity, HandleId, SubjectLogonId, OldSd, NewSd , Reason",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "eventdata",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account,  ProcessName, ProcessId, ObjectName, EventData, Activity, HandleId, SubjectLogonId, OldSd, NewSd , Reason",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account,  ProcessName, ProcessId, ObjectName, EventData, Activity, HandleId, SubjectLogonId, OldSd, NewSd , Reason",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "handleid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account,  ProcessName, ProcessId, ObjectName, EventData, Activity, HandleId, SubjectLogonId, OldSd, NewSd , Reason",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "subjectlogonid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account,  ProcessName, ProcessId, ObjectName, EventData, Activity, HandleId, SubjectLogonId, OldSd, NewSd , Reason",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "oldsd",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account,  ProcessName, ProcessId, ObjectName, EventData, Activity, HandleId, SubjectLogonId, OldSd, NewSd , Reason",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "newsd",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account,  ProcessName, ProcessId, ObjectName, EventData, Activity, HandleId, SubjectLogonId, OldSd, NewSd , Reason",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "reason",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ProcessName = tostring(split(NewProcessName, '\\\\')[-1])",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "accountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "processnamefullpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "eventsourcename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ObjectType = tostring(EventData.ObjectType)",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "objecttype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ObjectName = tostring(EventData.ObjectName)",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "objectname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend OldSd = tostring(EventData.OldSd)",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "oldsd",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend NewSd = tostring(EventData.NewSd)",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "newsd",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Reason = case( (OldSd has ';;;SY' and NewSd !has ';;;SY'), 'System Account is removed', (OldSd has_any (FullAccess) and NewSd has_any (ReadAccess)) , 'System permission has been changed to read from full access', (OldSd has_any (FullAccess) and NewSd has_any (DenyAccess)), 'System account has been given denied permission', 'None')",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "reason",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account =  strcat(tostring(EventData.SubjectDomainName),\"\\\\\", tostring(EventData.SubjectUserName))",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend ProcessName = tostring(EventData.ProcessName)",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend ProcessId = tostring(EventData.ProcessId)",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "processid",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Activity= \"4670 - Permissions on an object were changed.\"",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HandleId = tostring(EventData.HandleId)",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "handleid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend  SubjectLogonId = tostring(EventData.SubjectLogonId)",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "subjectlogonid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account,  ProcessName, ProcessId, ObjectName, EventData, Activity, HandleId, SubjectLogonId, OldSd, NewSd , Reason",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account,  ProcessName, ProcessId, ObjectName, EventData, Activity, HandleId, SubjectLogonId, OldSd, NewSd , Reason",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account,  ProcessName, ProcessId, ObjectName, EventData, Activity, HandleId, SubjectLogonId, OldSd, NewSd , Reason",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account,  ProcessName, ProcessId, ObjectName, EventData, Activity, HandleId, SubjectLogonId, OldSd, NewSd , Reason",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account,  ProcessName, ProcessId, ObjectName, EventData, Activity, HandleId, SubjectLogonId, OldSd, NewSd , Reason",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "processid",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account,  ProcessName, ProcessId, ObjectName, EventData, Activity, HandleId, SubjectLogonId, OldSd, NewSd , Reason",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "objectname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account,  ProcessName, ProcessId, ObjectName, EventData, Activity, HandleId, SubjectLogonId, OldSd, NewSd , Reason",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "eventdata",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account,  ProcessName, ProcessId, ObjectName, EventData, Activity, HandleId, SubjectLogonId, OldSd, NewSd , Reason",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account,  ProcessName, ProcessId, ObjectName, EventData, Activity, HandleId, SubjectLogonId, OldSd, NewSd , Reason",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "handleid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account,  ProcessName, ProcessId, ObjectName, EventData, Activity, HandleId, SubjectLogonId, OldSd, NewSd , Reason",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "subjectlogonid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account,  ProcessName, ProcessId, ObjectName, EventData, Activity, HandleId, SubjectLogonId, OldSd, NewSd , Reason",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "oldsd",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account,  ProcessName, ProcessId, ObjectName, EventData, Activity, HandleId, SubjectLogonId, OldSd, NewSd , Reason",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "newsd",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account,  ProcessName, ProcessId, ObjectName, EventData, Activity, HandleId, SubjectLogonId, OldSd, NewSd , Reason",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "reason",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend NewProcessName = tostring(EventData.NewProcessName)",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend ProcessName = tostring(split(NewProcessName, '\\\\')[-1])",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend CommandLine = tostring(EventData.CommandLine)",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend  Account =  strcat(tostring(EventData.SubjectDomainName),\"\\\\\", tostring(EventData.SubjectUserName))",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend  AccountDomain = tostring(EventData.AccountDomain)",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "accountdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend  Activity=\"4688 - A new process has been created.\"",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend  EventSourceName=Provider",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "eventsourcename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "accountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "processnamefullpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "eventsourcename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName, ProcessNameFullPath = NewProcessName, EventID, Activity, CommandLine, EventSourceName, Type",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = iff(isnotempty(InitiatingProcessAccountUpn), InitiatingProcessAccountUpn, InitiatingProcessAccountName), Computer = DeviceName",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account = iff(isnotempty(InitiatingProcessAccountUpn), InitiatingProcessAccountUpn, InitiatingProcessAccountName), Computer = DeviceName",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName = InitiatingProcessFileName, ProcessNameFullPath = FolderPath, Activity = ActionType, CommandLine = InitiatingProcessCommandLine, Type, InitiatingProcessParentFileName",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName = InitiatingProcessFileName, ProcessNameFullPath = FolderPath, Activity = ActionType, CommandLine = InitiatingProcessCommandLine, Type, InitiatingProcessParentFileName",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName = InitiatingProcessFileName, ProcessNameFullPath = FolderPath, Activity = ActionType, CommandLine = InitiatingProcessCommandLine, Type, InitiatingProcessParentFileName",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName = InitiatingProcessFileName, ProcessNameFullPath = FolderPath, Activity = ActionType, CommandLine = InitiatingProcessCommandLine, Type, InitiatingProcessParentFileName",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "accountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName = InitiatingProcessFileName, ProcessNameFullPath = FolderPath, Activity = ActionType, CommandLine = InitiatingProcessCommandLine, Type, InitiatingProcessParentFileName",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "processname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName = InitiatingProcessFileName, ProcessNameFullPath = FolderPath, Activity = ActionType, CommandLine = InitiatingProcessCommandLine, Type, InitiatingProcessParentFileName",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "processnamefullpath",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName = InitiatingProcessFileName, ProcessNameFullPath = FolderPath, Activity = ActionType, CommandLine = InitiatingProcessCommandLine, Type, InitiatingProcessParentFileName",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName = InitiatingProcessFileName, ProcessNameFullPath = FolderPath, Activity = ActionType, CommandLine = InitiatingProcessCommandLine, Type, InitiatingProcessParentFileName",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName = InitiatingProcessFileName, ProcessNameFullPath = FolderPath, Activity = ActionType, CommandLine = InitiatingProcessCommandLine, Type, InitiatingProcessParentFileName",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, AccountDomain, ProcessName = InitiatingProcessFileName, ProcessNameFullPath = FolderPath, Activity = ActionType, CommandLine = InitiatingProcessCommandLine, Type, InitiatingProcessParentFileName",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "initiatingprocessparentfilename",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Account, \"\\\\\")[0]), AccountNTDomain = tostring(split(Account, \"\\\\\")[1])",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Account, \"\\\\\")[0]), AccountNTDomain = tostring(split(Account, \"\\\\\")[1])",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "accountntdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "securityserviceregistryaclmodification.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "emailentity-paloalto.yaml",
    "field": "latestindicatortime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "emailentity-paloalto.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend DestinationUserID = tolower(DestinationUserID)",
    "detection": "emailentity-paloalto.yaml",
    "field": "destinationuserid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend CommonSecurityLog_TimeGenerated = TimeGenerated",
    "detection": "emailentity-paloalto.yaml",
    "field": "commonsecuritylog_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize CommonSecurityLog_TimeGenerated = arg_max(CommonSecurityLog_TimeGenerated, *) by IndicatorId, DestinationUserID",
    "detection": "emailentity-paloalto.yaml",
    "field": "commonsecuritylog_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize CommonSecurityLog_TimeGenerated = arg_max(CommonSecurityLog_TimeGenerated, *) by IndicatorId, DestinationUserID",
    "detection": "emailentity-paloalto.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize CommonSecurityLog_TimeGenerated = arg_max(CommonSecurityLog_TimeGenerated, *) by IndicatorId, DestinationUserID",
    "detection": "emailentity-paloalto.yaml",
    "field": "destinationuserid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project CommonSecurityLog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient,",
    "detection": "emailentity-paloalto.yaml",
    "field": "commonsecuritylog_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project CommonSecurityLog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient,",
    "detection": "emailentity-paloalto.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project CommonSecurityLog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient,",
    "detection": "emailentity-paloalto.yaml",
    "field": "activitygroupnames",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project CommonSecurityLog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient,",
    "detection": "emailentity-paloalto.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project CommonSecurityLog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient,",
    "detection": "emailentity-paloalto.yaml",
    "field": "threattype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project CommonSecurityLog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient,",
    "detection": "emailentity-paloalto.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project CommonSecurityLog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient,",
    "detection": "emailentity-paloalto.yaml",
    "field": "expirationdatetime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project CommonSecurityLog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient,",
    "detection": "emailentity-paloalto.yaml",
    "field": "confidencescore",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project CommonSecurityLog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient,",
    "detection": "emailentity-paloalto.yaml",
    "field": "emailsendername",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project CommonSecurityLog_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient,",
    "detection": "emailentity-paloalto.yaml",
    "field": "emailrecipient",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = CommonSecurityLog_TimeGenerated",
    "detection": "emailentity-paloalto.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AccountName = SourceUserID, DeviceName, IPAddress = SourceIP",
    "detection": "strontiumjuly2019iocs.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "  | extend AccountName = SourceUserID, DeviceName, IPAddress = SourceIP",
    "detection": "strontiumjuly2019iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend IPAddress = SrcIpAddr, DeviceName = Dvc",
    "detection": "strontiumjuly2019iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend IPAddress = SrcIpAddr, DeviceName = Dvc",
    "detection": "strontiumjuly2019iocs.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend IPAddress = RemoteIp, DeviceName = Computer",
    "detection": "strontiumjuly2019iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend IPAddress = RemoteIp, DeviceName = Computer",
    "detection": "strontiumjuly2019iocs.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend DNSName = DestinationHost",
    "detection": "strontiumjuly2019iocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend IPAddress = SourceHost",
    "detection": "strontiumjuly2019iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "  | project TimeGenerated,Resource, msg_s, Type",
    "detection": "strontiumjuly2019iocs.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project TimeGenerated,Resource, msg_s, Type",
    "detection": "strontiumjuly2019iocs.yaml",
    "field": "resource",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project TimeGenerated,Resource, msg_s, Type",
    "detection": "strontiumjuly2019iocs.yaml",
    "field": "msg_s",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "  | project TimeGenerated,Resource, msg_s, Type",
    "detection": "strontiumjuly2019iocs.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend DNSName = Request_Name",
    "detection": "strontiumjuly2019iocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend IPAddress = ClientIP",
    "detection": "strontiumjuly2019iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend DNSName = Fqdn",
    "detection": "strontiumjuly2019iocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend IPAddress = SourceIp",
    "detection": "strontiumjuly2019iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "  | extend DNSName = QueryName",
    "detection": "strontiumjuly2019iocs.yaml",
    "field": "dnsname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend IPAddress = SourceIp",
    "detection": "strontiumjuly2019iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "    | extend IPAddress=IpAddr, DeviceName=Hostname, AccountName = tostring(split(User, \"@\")[0]), AccountDomain = tostring(split(User, \"@\")[1])",
    "detection": "strontiumjuly2019iocs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "    | extend IPAddress=IpAddr, DeviceName=Hostname, AccountName = tostring(split(User, \"@\")[0]), AccountDomain = tostring(split(User, \"@\")[1])",
    "detection": "strontiumjuly2019iocs.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend IPAddress=IpAddr, DeviceName=Hostname, AccountName = tostring(split(User, \"@\")[0]), AccountDomain = tostring(split(User, \"@\")[1])",
    "detection": "strontiumjuly2019iocs.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend IPAddress=IpAddr, DeviceName=Hostname, AccountName = tostring(split(User, \"@\")[0]), AccountDomain = tostring(split(User, \"@\")[1])",
    "detection": "strontiumjuly2019iocs.yaml",
    "field": "accountdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "strontiumjuly2019iocs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(DeviceName, \".\")[0]), DomainIndex = toint(indexof(DeviceName, '.'))",
    "detection": "strontiumjuly2019iocs.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(DeviceName, \".\")[0]), DomainIndex = toint(indexof(DeviceName, '.'))",
    "detection": "strontiumjuly2019iocs.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(DeviceName, DomainIndex + 1), DeviceName)",
    "detection": "strontiumjuly2019iocs.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "    | extend Status = todynamic(Status), LocationDetails = todynamic(LocationDetails))",
    "detection": "emailentity-signinlogs.yaml",
    "field": "status",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend Status = todynamic(Status), LocationDetails = todynamic(LocationDetails))",
    "detection": "emailentity-signinlogs.yaml",
    "field": "locationdetails",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend UserPrincipalName = tolower(UserPrincipalName)",
    "detection": "emailentity-signinlogs.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Status = todynamic(Status), LocationDetails = todynamic(LocationDetails)",
    "detection": "emailentity-signinlogs.yaml",
    "field": "status",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Status = todynamic(Status), LocationDetails = todynamic(LocationDetails)",
    "detection": "emailentity-signinlogs.yaml",
    "field": "locationdetails",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend StatusCode = tostring(Status.errorCode), StatusDetails = tostring(Status.additionalDetails)",
    "detection": "emailentity-signinlogs.yaml",
    "field": "statuscode",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend StatusCode = tostring(Status.errorCode), StatusDetails = tostring(Status.additionalDetails)",
    "detection": "emailentity-signinlogs.yaml",
    "field": "statusdetails",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend State = tostring(LocationDetails.state), City = tostring(LocationDetails.city), Region = tostring(LocationDetails.countryOrRegion)",
    "detection": "emailentity-signinlogs.yaml",
    "field": "state",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend State = tostring(LocationDetails.state), City = tostring(LocationDetails.city), Region = tostring(LocationDetails.countryOrRegion)",
    "detection": "emailentity-signinlogs.yaml",
    "field": "city",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend State = tostring(LocationDetails.state), City = tostring(LocationDetails.city), Region = tostring(LocationDetails.countryOrRegion)",
    "detection": "emailentity-signinlogs.yaml",
    "field": "region",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SigninLogs_TimeGenerated = TimeGenerated);",
    "detection": "emailentity-signinlogs.yaml",
    "field": "signinlogs_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "emailentity-signinlogs.yaml",
    "field": "latestindicatortime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "emailentity-signinlogs.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SigninLogs_TimeGenerated = arg_max(SigninLogs_TimeGenerated, *) by IndicatorId, UserPrincipalName",
    "detection": "emailentity-signinlogs.yaml",
    "field": "signinlogs_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SigninLogs_TimeGenerated = arg_max(SigninLogs_TimeGenerated, *) by IndicatorId, UserPrincipalName",
    "detection": "emailentity-signinlogs.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SigninLogs_TimeGenerated = arg_max(SigninLogs_TimeGenerated, *) by IndicatorId, UserPrincipalName",
    "detection": "emailentity-signinlogs.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, NetworkIP, NetworkDestinationIP, NetworkSourceIP, Type",
    "detection": "emailentity-signinlogs.yaml",
    "field": "signinlogs_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, NetworkIP, NetworkDestinationIP, NetworkSourceIP, Type",
    "detection": "emailentity-signinlogs.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, NetworkIP, NetworkDestinationIP, NetworkSourceIP, Type",
    "detection": "emailentity-signinlogs.yaml",
    "field": "activitygroupnames",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, NetworkIP, NetworkDestinationIP, NetworkSourceIP, Type",
    "detection": "emailentity-signinlogs.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, NetworkIP, NetworkDestinationIP, NetworkSourceIP, Type",
    "detection": "emailentity-signinlogs.yaml",
    "field": "threattype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, NetworkIP, NetworkDestinationIP, NetworkSourceIP, Type",
    "detection": "emailentity-signinlogs.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, NetworkIP, NetworkDestinationIP, NetworkSourceIP, Type",
    "detection": "emailentity-signinlogs.yaml",
    "field": "expirationdatetime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, NetworkIP, NetworkDestinationIP, NetworkSourceIP, Type",
    "detection": "emailentity-signinlogs.yaml",
    "field": "confidencescore",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, NetworkIP, NetworkDestinationIP, NetworkSourceIP, Type",
    "detection": "emailentity-signinlogs.yaml",
    "field": "emailsendername",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, NetworkIP, NetworkDestinationIP, NetworkSourceIP, Type",
    "detection": "emailentity-signinlogs.yaml",
    "field": "emailrecipient",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, NetworkIP, NetworkDestinationIP, NetworkSourceIP, Type",
    "detection": "emailentity-signinlogs.yaml",
    "field": "emailsourcedomain",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, NetworkIP, NetworkDestinationIP, NetworkSourceIP, Type",
    "detection": "emailentity-signinlogs.yaml",
    "field": "emailsourceipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, NetworkIP, NetworkDestinationIP, NetworkSourceIP, Type",
    "detection": "emailentity-signinlogs.yaml",
    "field": "emailsubject",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, NetworkIP, NetworkDestinationIP, NetworkSourceIP, Type",
    "detection": "emailentity-signinlogs.yaml",
    "field": "filehashvalue",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, NetworkIP, NetworkDestinationIP, NetworkSourceIP, Type",
    "detection": "emailentity-signinlogs.yaml",
    "field": "filehashtype",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, NetworkIP, NetworkDestinationIP, NetworkSourceIP, Type",
    "detection": "emailentity-signinlogs.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, NetworkIP, NetworkDestinationIP, NetworkSourceIP, Type",
    "detection": "emailentity-signinlogs.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, NetworkIP, NetworkDestinationIP, NetworkSourceIP, Type",
    "detection": "emailentity-signinlogs.yaml",
    "field": "appdisplayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, NetworkIP, NetworkDestinationIP, NetworkSourceIP, Type",
    "detection": "emailentity-signinlogs.yaml",
    "field": "statuscode",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, NetworkIP, NetworkDestinationIP, NetworkSourceIP, Type",
    "detection": "emailentity-signinlogs.yaml",
    "field": "statusdetails",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, NetworkIP, NetworkDestinationIP, NetworkSourceIP, Type",
    "detection": "emailentity-signinlogs.yaml",
    "field": "networkip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, NetworkIP, NetworkDestinationIP, NetworkSourceIP, Type",
    "detection": "emailentity-signinlogs.yaml",
    "field": "networkdestinationip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, NetworkIP, NetworkDestinationIP, NetworkSourceIP, Type",
    "detection": "emailentity-signinlogs.yaml",
    "field": "networksourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SigninLogs_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, IPAddress, UserPrincipalName, AppDisplayName, StatusCode, StatusDetails, NetworkIP, NetworkDestinationIP, NetworkSourceIP, Type",
    "detection": "emailentity-signinlogs.yaml",
    "field": "type",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserPrincipalName, '@', 0)[0]), UPNSuffix = tostring(split(UserPrincipalName, '@', 1)[0])",
    "detection": "emailentity-signinlogs.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserPrincipalName, '@', 0)[0]), UPNSuffix = tostring(split(UserPrincipalName, '@', 1)[0])",
    "detection": "emailentity-signinlogs.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = SigninLogs_TimeGenerated",
    "detection": "emailentity-signinlogs.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostCustomEntity = DeviceName, timestamp=TimeGenerated),",
    "detection": "sunspotlogfile.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostCustomEntity = Computer, timestamp=TimeGenerated),",
    "detection": "sunspotlogfile.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostCustomEntity = DvcHostname, timestamp=TimeGenerated",
    "detection": "sunspotlogfile.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostCustomEntity = DvcHostname, timestamp=TimeGenerated",
    "detection": "sunspotlogfile.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend GroupAddedTo = TargetUserName, AddingAccount = Account",
    "detection": "useraccountadd-removed.yaml",
    "field": "groupaddedto",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend GroupAddedTo = TargetUserName, AddingAccount = Account",
    "detection": "useraccountadd-removed.yaml",
    "field": "addingaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend  AccountAdded_GroupAddedTo_AddingAccount = strcat(AccountAdded, \"||\", GroupAddedTo, \"||\", AddingAccount )",
    "detection": "useraccountadd-removed.yaml",
    "field": "accountadded_groupaddedto_addingaccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AccountAdded_GroupAddedTo_AddingAccount, AccountAddedTime = TimeGenerated",
    "detection": "useraccountadd-removed.yaml",
    "field": "accountadded_groupaddedto_addingaccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AccountAdded_GroupAddedTo_AddingAccount, AccountAddedTime = TimeGenerated",
    "detection": "useraccountadd-removed.yaml",
    "field": "accountaddedtime",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetSid = tostring(EventData.TargetSid)",
    "detection": "useraccountadd-removed.yaml",
    "field": "targetsid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetUserName = tostring(EventData.TargetUserName)",
    "detection": "useraccountadd-removed.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AddingAccount =  strcat(tostring(EventData.SubjectDomainName),\"\\\\\", tostring(EventData.SubjectUserName))",
    "detection": "useraccountadd-removed.yaml",
    "field": "addingaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend GroupAddedTo = TargetUserName",
    "detection": "useraccountadd-removed.yaml",
    "field": "groupaddedto",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend  AccountAdded_GroupAddedTo_AddingAccount = strcat(AccountAdded, \"||\", GroupAddedTo, \"||\", AddingAccount )",
    "detection": "useraccountadd-removed.yaml",
    "field": "accountadded_groupaddedto_addingaccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AccountAdded_GroupAddedTo_AddingAccount, AccountAddedTime = TimeGenerated",
    "detection": "useraccountadd-removed.yaml",
    "field": "accountadded_groupaddedto_addingaccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AccountAdded_GroupAddedTo_AddingAccount, AccountAddedTime = TimeGenerated",
    "detection": "useraccountadd-removed.yaml",
    "field": "accountaddedtime",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend GroupRemovedFrom = TargetUserName, RemovingAccount = Account",
    "detection": "useraccountadd-removed.yaml",
    "field": "groupremovedfrom",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend GroupRemovedFrom = TargetUserName, RemovingAccount = Account",
    "detection": "useraccountadd-removed.yaml",
    "field": "removingaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountRemoved_GroupRemovedFrom_RemovingAccount = strcat(AccountRemoved, \"||\", GroupRemovedFrom, \"||\", RemovingAccount)",
    "detection": "useraccountadd-removed.yaml",
    "field": "accountremoved_groupremovedfrom_removingaccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AccountRemoved_GroupRemovedFrom_RemovingAccount, AccountRemovedTime = TimeGenerated, Computer, AccountRemoved = tolower(AccountRemoved),",
    "detection": "useraccountadd-removed.yaml",
    "field": "accountremoved_groupremovedfrom_removingaccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AccountRemoved_GroupRemovedFrom_RemovingAccount, AccountRemovedTime = TimeGenerated, Computer, AccountRemoved = tolower(AccountRemoved),",
    "detection": "useraccountadd-removed.yaml",
    "field": "accountremovedtime",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AccountRemoved_GroupRemovedFrom_RemovingAccount, AccountRemovedTime = TimeGenerated, Computer, AccountRemoved = tolower(AccountRemoved),",
    "detection": "useraccountadd-removed.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project AccountRemoved_GroupRemovedFrom_RemovingAccount, AccountRemovedTime = TimeGenerated, Computer, AccountRemoved = tolower(AccountRemoved),",
    "detection": "useraccountadd-removed.yaml",
    "field": "accountremoved",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetSid = tostring(EventData.TargetSid)",
    "detection": "useraccountadd-removed.yaml",
    "field": "targetsid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetUserName = tostring(EventData.TargetUserName)",
    "detection": "useraccountadd-removed.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend RemovingAccount =  strcat(tostring(EventData.SubjectDomainName),\"\\\\\", tostring(EventData.SubjectUserName))",
    "detection": "useraccountadd-removed.yaml",
    "field": "removingaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend GroupRemovedFrom = TargetUserName",
    "detection": "useraccountadd-removed.yaml",
    "field": "groupremovedfrom",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountRemoved_GroupRemovedFrom_RemovingAccount = strcat(AccountRemoved, \"||\", GroupRemovedFrom, \"||\", RemovingAccount)",
    "detection": "useraccountadd-removed.yaml",
    "field": "accountremoved_groupremovedfrom_removingaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend RemovedAccountLogonId= tostring(EventData.SubjectLogonId)",
    "detection": "useraccountadd-removed.yaml",
    "field": "removedaccountlogonid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend TargetDomainName = tostring(EventData.TargetDomainName)",
    "detection": "useraccountadd-removed.yaml",
    "field": "targetdomainname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project AccountRemoved_GroupRemovedFrom_RemovingAccount, AccountRemovedTime = TimeGenerated, Computer, AccountRemoved = tolower(AccountRemoved),",
    "detection": "useraccountadd-removed.yaml",
    "field": "accountremoved_groupremovedfrom_removingaccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AccountRemoved_GroupRemovedFrom_RemovingAccount, AccountRemovedTime = TimeGenerated, Computer, AccountRemoved = tolower(AccountRemoved),",
    "detection": "useraccountadd-removed.yaml",
    "field": "accountremovedtime",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project AccountRemoved_GroupRemovedFrom_RemovingAccount, AccountRemovedTime = TimeGenerated, Computer, AccountRemoved = tolower(AccountRemoved),",
    "detection": "useraccountadd-removed.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project AccountRemoved_GroupRemovedFrom_RemovingAccount, AccountRemovedTime = TimeGenerated, Computer, AccountRemoved = tolower(AccountRemoved),",
    "detection": "useraccountadd-removed.yaml",
    "field": "accountremoved",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend DurationinSecondAfter_Removed = datetime_diff ('second', AccountRemovedTime, AccountAddedTime)",
    "detection": "useraccountadd-removed.yaml",
    "field": "durationinsecondafter_removed",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "useraccountadd-removed.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "useraccountadd-removed.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "useraccountadd-removed.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend RemovedAccountName = tostring(split(AccountRemoved, @\"\\\")[1]), RemovedAccountNTDomain = tostring(split(AccountRemoved, @\"\\\")[0])",
    "detection": "useraccountadd-removed.yaml",
    "field": "removedaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend RemovedAccountName = tostring(split(AccountRemoved, @\"\\\")[1]), RemovedAccountNTDomain = tostring(split(AccountRemoved, @\"\\\")[0])",
    "detection": "useraccountadd-removed.yaml",
    "field": "removedaccountntdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend RemovingAccountName = tostring(split(RemovingAccount, @\"\\\")[1]), RemovingAccountNTDomain = tostring(split(RemovingAccount, @\"\\\")[0])",
    "detection": "useraccountadd-removed.yaml",
    "field": "removingaccountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend RemovingAccountName = tostring(split(RemovingAccount, @\"\\\")[1]), RemovingAccountNTDomain = tostring(split(RemovingAccount, @\"\\\")[0])",
    "detection": "useraccountadd-removed.yaml",
    "field": "removingaccountntdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventDataParsed = parse_xml(EventData)",
    "detection": "gaincodeexecutionadfsviasmb.yaml",
    "field": "eventdataparsed",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectLogonId = tostring(EventDataParsed.EventData.Data[3][\"#text\"])",
    "detection": "gaincodeexecutionadfsviasmb.yaml",
    "field": "subjectlogonid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, Computer, EventID, RelativeTargetName",
    "detection": "gaincodeexecutionadfsviasmb.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, Computer, EventID, RelativeTargetName",
    "detection": "gaincodeexecutionadfsviasmb.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, Computer, EventID, RelativeTargetName",
    "detection": "gaincodeexecutionadfsviasmb.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, Computer, EventID, RelativeTargetName",
    "detection": "gaincodeexecutionadfsviasmb.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Account, Computer, EventID, RelativeTargetName",
    "detection": "gaincodeexecutionadfsviasmb.yaml",
    "field": "relativetargetname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "gaincodeexecutionadfsviasmb.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "gaincodeexecutionadfsviasmb.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "gaincodeexecutionadfsviasmb.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "gaincodeexecutionadfsviasmb.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Account, @'\\')[1]), AccountNTDomain = tostring(split(Account, @'\\')[0])",
    "detection": "gaincodeexecutionadfsviasmb.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(Account, @'\\')[1]), AccountNTDomain = tostring(split(Account, @'\\')[0])",
    "detection": "gaincodeexecutionadfsviasmb.yaml",
    "field": "accountntdomain",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count() by IPAddress",
    "detection": "aadawsconsolecorrelation.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend LoginResult = tostring(parse_json(ResponseElements).ConsoleLogin)",
    "detection": "aadawsconsolecorrelation.yaml",
    "field": "loginresult",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Reason = \"Multiple failed AAD logins from IP address\"",
    "detection": "aadawsconsolecorrelation.yaml",
    "field": "reason",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend MFAUsed = tostring(parse_json(AdditionalEventData).MFAUsed)",
    "detection": "aadawsconsolecorrelation.yaml",
    "field": "mfaused",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend User = iif(isempty(UserIdentityUserName), UserIdentityType, UserIdentityUserName)",
    "detection": "aadawsconsolecorrelation.yaml",
    "field": "user",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Reason, LoginResult, EventTypeName, UserIdentityType, User, AWSRegion, SourceIpAddress, UserAgent, MFAUsed",
    "detection": "aadawsconsolecorrelation.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Reason, LoginResult, EventTypeName, UserIdentityType, User, AWSRegion, SourceIpAddress, UserAgent, MFAUsed",
    "detection": "aadawsconsolecorrelation.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Reason, LoginResult, EventTypeName, UserIdentityType, User, AWSRegion, SourceIpAddress, UserAgent, MFAUsed",
    "detection": "aadawsconsolecorrelation.yaml",
    "field": "reason",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Reason, LoginResult, EventTypeName, UserIdentityType, User, AWSRegion, SourceIpAddress, UserAgent, MFAUsed",
    "detection": "aadawsconsolecorrelation.yaml",
    "field": "loginresult",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Reason, LoginResult, EventTypeName, UserIdentityType, User, AWSRegion, SourceIpAddress, UserAgent, MFAUsed",
    "detection": "aadawsconsolecorrelation.yaml",
    "field": "eventtypename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Reason, LoginResult, EventTypeName, UserIdentityType, User, AWSRegion, SourceIpAddress, UserAgent, MFAUsed",
    "detection": "aadawsconsolecorrelation.yaml",
    "field": "useridentitytype",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Reason, LoginResult, EventTypeName, UserIdentityType, User, AWSRegion, SourceIpAddress, UserAgent, MFAUsed",
    "detection": "aadawsconsolecorrelation.yaml",
    "field": "user",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Reason, LoginResult, EventTypeName, UserIdentityType, User, AWSRegion, SourceIpAddress, UserAgent, MFAUsed",
    "detection": "aadawsconsolecorrelation.yaml",
    "field": "awsregion",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Reason, LoginResult, EventTypeName, UserIdentityType, User, AWSRegion, SourceIpAddress, UserAgent, MFAUsed",
    "detection": "aadawsconsolecorrelation.yaml",
    "field": "sourceipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Reason, LoginResult, EventTypeName, UserIdentityType, User, AWSRegion, SourceIpAddress, UserAgent, MFAUsed",
    "detection": "aadawsconsolecorrelation.yaml",
    "field": "useragent",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated) by Reason, LoginResult, EventTypeName, UserIdentityType, User, AWSRegion, SourceIpAddress, UserAgent, MFAUsed",
    "detection": "aadawsconsolecorrelation.yaml",
    "field": "mfaused",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTime",
    "detection": "aadawsconsolecorrelation.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "urlentity-paloalto.yaml",
    "field": "latestindicatortime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "urlentity-paloalto.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend IngestionTime = ingestion_time()",
    "detection": "urlentity-paloalto.yaml",
    "field": "ingestiontime",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend PA_Url = columnifexists(\"RequestURL\", \"None\")",
    "detection": "urlentity-paloalto.yaml",
    "field": "pa_url",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend PA_Url = iif(isempty(PA_Url), extract(\"([^\\\"]+)\", 1, tolower(AdditionalExtensions)), trim('\"', PA_Url))",
    "detection": "urlentity-paloalto.yaml",
    "field": "pa_url",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend PA_Url = iif(PA_Url !startswith \"http://\" and ApplicationProtocol !~ \"ssl\", strcat('http://', PA_Url), iif(PA_Url !startswith \"https://\" and ApplicationProtocol =~ \"ssl\", strcat('https://', PA_Url), PA_Url))",
    "detection": "urlentity-paloalto.yaml",
    "field": "pa_url",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "  | extend CommonSecurityLog_TimeGenerated = TimeGenerated",
    "detection": "urlentity-paloalto.yaml",
    "field": "commonsecuritylog_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, DeviceAction, SourceIP, CommonSecurityLog_TimeGenerated, PA_Url, DeviceName",
    "detection": "urlentity-paloalto.yaml",
    "field": "latestindicatortime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, DeviceAction, SourceIP, CommonSecurityLog_TimeGenerated, PA_Url, DeviceName",
    "detection": "urlentity-paloalto.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, DeviceAction, SourceIP, CommonSecurityLog_TimeGenerated, PA_Url, DeviceName",
    "detection": "urlentity-paloalto.yaml",
    "field": "activitygroupnames",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, DeviceAction, SourceIP, CommonSecurityLog_TimeGenerated, PA_Url, DeviceName",
    "detection": "urlentity-paloalto.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, DeviceAction, SourceIP, CommonSecurityLog_TimeGenerated, PA_Url, DeviceName",
    "detection": "urlentity-paloalto.yaml",
    "field": "threattype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, DeviceAction, SourceIP, CommonSecurityLog_TimeGenerated, PA_Url, DeviceName",
    "detection": "urlentity-paloalto.yaml",
    "field": "expirationdatetime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, DeviceAction, SourceIP, CommonSecurityLog_TimeGenerated, PA_Url, DeviceName",
    "detection": "urlentity-paloalto.yaml",
    "field": "confidencescore",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, DeviceAction, SourceIP, CommonSecurityLog_TimeGenerated, PA_Url, DeviceName",
    "detection": "urlentity-paloalto.yaml",
    "field": "deviceaction",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, DeviceAction, SourceIP, CommonSecurityLog_TimeGenerated, PA_Url, DeviceName",
    "detection": "urlentity-paloalto.yaml",
    "field": "sourceip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, DeviceAction, SourceIP, CommonSecurityLog_TimeGenerated, PA_Url, DeviceName",
    "detection": "urlentity-paloalto.yaml",
    "field": "commonsecuritylog_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, DeviceAction, SourceIP, CommonSecurityLog_TimeGenerated, PA_Url, DeviceName",
    "detection": "urlentity-paloalto.yaml",
    "field": "pa_url",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project LatestIndicatorTime, Description, ActivityGroupNames, IndicatorId, ThreatType, ExpirationDateTime, ConfidenceScore, DeviceAction, SourceIP, CommonSecurityLog_TimeGenerated, PA_Url, DeviceName",
    "detection": "urlentity-paloalto.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = CommonSecurityLog_TimeGenerated, IPCustomEntity = SourceIP, HostCustomEntity = DeviceName, URLCustomEntity = PA_Url",
    "detection": "urlentity-paloalto.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = CommonSecurityLog_TimeGenerated, IPCustomEntity = SourceIP, HostCustomEntity = DeviceName, URLCustomEntity = PA_Url",
    "detection": "urlentity-paloalto.yaml",
    "field": "ipcustomentity",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = CommonSecurityLog_TimeGenerated, IPCustomEntity = SourceIP, HostCustomEntity = DeviceName, URLCustomEntity = PA_Url",
    "detection": "urlentity-paloalto.yaml",
    "field": "hostcustomentity",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = CommonSecurityLog_TimeGenerated, IPCustomEntity = SourceIP, HostCustomEntity = DeviceName, URLCustomEntity = PA_Url",
    "detection": "urlentity-paloalto.yaml",
    "field": "urlcustomentity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend FileHashValue = toupper(FileHashValue)",
    "detection": "filehashentity-securityevent.yaml",
    "field": "filehashvalue",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "filehashentity-securityevent.yaml",
    "field": "latestindicatortime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "filehashentity-securityevent.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend SecurityEvent_TimeGenerated = TimeGenerated, Event = EventID, FileHash = toupper(FileHash)",
    "detection": "filehashentity-securityevent.yaml",
    "field": "securityevent_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend SecurityEvent_TimeGenerated = TimeGenerated, Event = EventID, FileHash = toupper(FileHash)",
    "detection": "filehashentity-securityevent.yaml",
    "field": "event",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend SecurityEvent_TimeGenerated = TimeGenerated, Event = EventID, FileHash = toupper(FileHash)",
    "detection": "filehashentity-securityevent.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "      | extend SecurityEvent_TimeGenerated = TimeGenerated, Event = EventID, FileHash = toupper(EventData.FileHash)",
    "detection": "filehashentity-securityevent.yaml",
    "field": "securityevent_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend SecurityEvent_TimeGenerated = TimeGenerated, Event = EventID, FileHash = toupper(EventData.FileHash)",
    "detection": "filehashentity-securityevent.yaml",
    "field": "event",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "      | extend SecurityEvent_TimeGenerated = TimeGenerated, Event = EventID, FileHash = toupper(EventData.FileHash)",
    "detection": "filehashentity-securityevent.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SecurityEvent_TimeGenerated = arg_max(SecurityEvent_TimeGenerated, *) by IndicatorId, FileHash",
    "detection": "filehashentity-securityevent.yaml",
    "field": "securityevent_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SecurityEvent_TimeGenerated = arg_max(SecurityEvent_TimeGenerated, *) by IndicatorId, FileHash",
    "detection": "filehashentity-securityevent.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize SecurityEvent_TimeGenerated = arg_max(SecurityEvent_TimeGenerated, *) by IndicatorId, FileHash",
    "detection": "filehashentity-securityevent.yaml",
    "field": "filehash",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project SecurityEvent_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "filehashentity-securityevent.yaml",
    "field": "securityevent_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SecurityEvent_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "filehashentity-securityevent.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SecurityEvent_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "filehashentity-securityevent.yaml",
    "field": "activitygroupnames",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SecurityEvent_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "filehashentity-securityevent.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SecurityEvent_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "filehashentity-securityevent.yaml",
    "field": "threattype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SecurityEvent_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "filehashentity-securityevent.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SecurityEvent_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "filehashentity-securityevent.yaml",
    "field": "expirationdatetime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project SecurityEvent_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore,",
    "detection": "filehashentity-securityevent.yaml",
    "field": "confidencescore",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend NTDomain = tostring(split(Account, '\\\\', 0)[0]), Name = tostring(split(Account, '\\\\', 1)[0])",
    "detection": "filehashentity-securityevent.yaml",
    "field": "ntdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend NTDomain = tostring(split(Account, '\\\\', 0)[0]), Name = tostring(split(Account, '\\\\', 1)[0])",
    "detection": "filehashentity-securityevent.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.'))",
    "detection": "filehashentity-securityevent.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(Computer, '.'), 1, -1), '.'))",
    "detection": "filehashentity-securityevent.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = SecurityEvent_TimeGenerated",
    "detection": "filehashentity-securityevent.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project creationTime = TimeGenerated, CreateEventID = EventID, CreateActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "creationtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project creationTime = TimeGenerated, CreateEventID = EventID, CreateActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "createeventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project creationTime = TimeGenerated, CreateEventID = EventID, CreateActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "createactivity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project creationTime = TimeGenerated, CreateEventID = EventID, CreateActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SubjectUserSid = tostring(EventData.SubjectUserSid)",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "subjectusersid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend AccountType=case(EventData.SubjectUserName endswith \"$\" or SubjectUserSid in (\"S-1-5-18\", \"S-1-5-19\", \"S-1-5-20\"), \"Machine\", isempty(SubjectUserSid), \"\", \"User\")",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SubjectAccount = strcat(tostring(EventData.SubjectDomainName),\"\\\\\", tostring(EventData.SubjectUserName))",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "subjectaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SubjectDomainName = tostring(EventData.SubjectDomainName), SubjectUserName = tostring(EventData.SubjectUserName)",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SubjectDomainName = tostring(EventData.SubjectDomainName), SubjectUserName = tostring(EventData.SubjectUserName)",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TargetAccount = strcat(EventData.TargetDomainName,\"\\\\\", EventData.TargetUserName)",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "targetaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TargetSid = tostring(EventData.TargetSid)",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "targetsid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend UserPrincipalName = tostring(EventData.UserPrincipalName)",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend Activity = \"4720 - A user account was created.\"",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TargetUserName = tostring(EventData.TargetUserName), TargetDomainName = tostring(EventData.TargetDomainName)",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TargetUserName = tostring(EventData.TargetUserName), TargetDomainName = tostring(EventData.TargetDomainName)",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "targetdomainname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project creationTime = TimeGenerated, CreateEventID = EventID, CreateActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "creationtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project creationTime = TimeGenerated, CreateEventID = EventID, CreateActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "createeventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project creationTime = TimeGenerated, CreateEventID = EventID, CreateActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "createactivity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project creationTime = TimeGenerated, CreateEventID = EventID, CreateActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "    | project deletionTime = TimeGenerated, DeleteEventID = EventID, DeleteActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "deletiontime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project deletionTime = TimeGenerated, DeleteEventID = EventID, DeleteActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "deleteeventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project deletionTime = TimeGenerated, DeleteEventID = EventID, DeleteActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "deleteactivity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project deletionTime = TimeGenerated, DeleteEventID = EventID, DeleteActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SubjectUserSid = tostring(EventData.SubjectUserSid)",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "subjectusersid",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SubjectAccount = strcat(tostring(EventData.SubjectDomainName),\"\\\\\", tostring(EventData.SubjectUserName))",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "subjectaccount",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend AccountType=case(SubjectAccount endswith \"$\" or SubjectUserSid in (\"S-1-5-18\", \"S-1-5-19\", \"S-1-5-20\"), \"Machine\", isempty(SubjectUserSid), \"\", \"User\")",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SubjectDomainName = tostring(EventData.SubjectDomainName), SubjectUserName = tostring(EventData.SubjectUserName)",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend SubjectDomainName = tostring(EventData.SubjectDomainName), SubjectUserName = tostring(EventData.SubjectUserName)",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TargetSid = tostring(EventData.TargetSid)",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "targetsid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend UserPrincipalName = tostring(EventData.UserPrincipalName)",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend Activity = \"4726 - A user account was deleted.\"",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TargetUserName = tostring(EventData.TargetUserName), TargetDomainName = tostring(EventData.TargetDomainName)",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "targetusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TargetUserName = tostring(EventData.TargetUserName), TargetDomainName = tostring(EventData.TargetDomainName)",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "targetdomainname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "    | extend TargetAccount = strcat(EventData.TargetDomainName,\"\\\\\", EventData.TargetUserName)",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "targetaccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "    | project deletionTime = TimeGenerated, DeleteEventID = EventID, DeleteActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "deletiontime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project deletionTime = TimeGenerated, DeleteEventID = EventID, DeleteActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "deleteeventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project deletionTime = TimeGenerated, DeleteEventID = EventID, DeleteActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "deleteactivity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "    | project deletionTime = TimeGenerated, DeleteEventID = EventID, DeleteActivity = Activity, Computer = toupper(Computer),",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend TimeDelta = deletionTime - creationTime",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "timedelta",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeDelta, creationTime, CreateEventID, CreateActivity, Computer, TargetAccount, TargetSid, UserPrincipalName, AccountUsedToCreate, SIDofAccountUsedToCreate,",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "timedelta",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeDelta, creationTime, CreateEventID, CreateActivity, Computer, TargetAccount, TargetSid, UserPrincipalName, AccountUsedToCreate, SIDofAccountUsedToCreate,",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "creationtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeDelta, creationTime, CreateEventID, CreateActivity, Computer, TargetAccount, TargetSid, UserPrincipalName, AccountUsedToCreate, SIDofAccountUsedToCreate,",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "createeventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeDelta, creationTime, CreateEventID, CreateActivity, Computer, TargetAccount, TargetSid, UserPrincipalName, AccountUsedToCreate, SIDofAccountUsedToCreate,",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "createactivity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeDelta, creationTime, CreateEventID, CreateActivity, Computer, TargetAccount, TargetSid, UserPrincipalName, AccountUsedToCreate, SIDofAccountUsedToCreate,",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeDelta, creationTime, CreateEventID, CreateActivity, Computer, TargetAccount, TargetSid, UserPrincipalName, AccountUsedToCreate, SIDofAccountUsedToCreate,",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "targetaccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeDelta, creationTime, CreateEventID, CreateActivity, Computer, TargetAccount, TargetSid, UserPrincipalName, AccountUsedToCreate, SIDofAccountUsedToCreate,",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "targetsid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeDelta, creationTime, CreateEventID, CreateActivity, Computer, TargetAccount, TargetSid, UserPrincipalName, AccountUsedToCreate, SIDofAccountUsedToCreate,",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "userprincipalname",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeDelta, creationTime, CreateEventID, CreateActivity, Computer, TargetAccount, TargetSid, UserPrincipalName, AccountUsedToCreate, SIDofAccountUsedToCreate,",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "accountusedtocreate",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeDelta, creationTime, CreateEventID, CreateActivity, Computer, TargetAccount, TargetSid, UserPrincipalName, AccountUsedToCreate, SIDofAccountUsedToCreate,",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "sidofaccountusedtocreate",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "useraccountcreateddeleted-10m.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName, FileName = Process, CommandLine, ParentProcessName",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName, FileName = Process, CommandLine, ParentProcessName",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName, FileName = Process, CommandLine, ParentProcessName",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName, FileName = Process, CommandLine, ParentProcessName",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "accountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName, FileName = Process, CommandLine, ParentProcessName",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "filename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName, FileName = Process, CommandLine, ParentProcessName",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName, FileName = Process, CommandLine, ParentProcessName",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend CommandLine = tostring(EventData.CommandLine)",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectUserName = tostring(EventData.SubjectUserName)",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectDomainName = tostring(EventData.SubjectDomainName)",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend NewProcessName = tostring(EventData.NewProcessName)",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend FileName=tostring(split(NewProcessName, '\\\\')[-1])",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "filename",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend ParentProcessName = tostring(EventData.ParentProcessName)",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName, CommandLine, ParentProcessName",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName, CommandLine, ParentProcessName",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName, CommandLine, ParentProcessName",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName, CommandLine, ParentProcessName",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "accountdomain",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName, CommandLine, ParentProcessName",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account = SubjectUserName, AccountDomain = SubjectDomainName, CommandLine, ParentProcessName",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), CountToday = count() by Computer, Account, AccountDomain, FileName, CommandLine, ParentProcessName",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), CountToday = count() by Computer, Account, AccountDomain, FileName, CommandLine, ParentProcessName",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), CountToday = count() by Computer, Account, AccountDomain, FileName, CommandLine, ParentProcessName",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "counttoday",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), CountToday = count() by Computer, Account, AccountDomain, FileName, CommandLine, ParentProcessName",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), CountToday = count() by Computer, Account, AccountDomain, FileName, CommandLine, ParentProcessName",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), CountToday = count() by Computer, Account, AccountDomain, FileName, CommandLine, ParentProcessName",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "accountdomain",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), CountToday = count() by Computer, Account, AccountDomain, FileName, CommandLine, ParentProcessName",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "filename",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), CountToday = count() by Computer, Account, AccountDomain, FileName, CommandLine, ParentProcessName",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), CountToday = count() by Computer, Account, AccountDomain, FileName, CommandLine, ParentProcessName",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = iif(Computer has '.',substring(Computer,0,indexof(Computer,'.')),Computer) , DnsDomain = iif(Computer has '.',substring(Computer,indexof(Computer,'.')+1),'')",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = iif(Computer has '.',substring(Computer,0,indexof(Computer,'.')),Computer) , DnsDomain = iif(Computer has '.',substring(Computer,indexof(Computer,'.')+1),'')",
    "detection": "execute-base64-decodedpayload.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend alertData = parse_json(Entities)",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "alertdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend FileName = tostring(alertData.Name), Directory = tostring(alertData.Directory);",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "filename",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend FileName = tostring(alertData.Name), Directory = tostring(alertData.Directory);",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "directory",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project HostName = tostring(alertData.HostName), DnsDomain = tostring(alertData.DnsDomain), SystemAlertId",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project HostName = tostring(alertData.HostName), DnsDomain = tostring(alertData.DnsDomain), SystemAlertId",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project HostName = tostring(alertData.HostName), DnsDomain = tostring(alertData.DnsDomain), SystemAlertId",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "systemalertid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, FileName, Directory, HostName, DnsDomain;",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, FileName, Directory, HostName, DnsDomain;",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "filename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, FileName, Directory, HostName, DnsDomain;",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "directory",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, FileName, Directory, HostName, DnsDomain;",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend splitUriStem = split(csUriStem, \"/\")",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "splituristem",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend FileName = splitUriStem[-1], HostName = sComputerName",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "filename",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend FileName = splitUriStem[-1], HostName = sComputerName",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), RequestUserAgents=make_set(csUserAgent), ReqestMethods=make_set(csMethod), RequestStatusCodes=make_set(scStatus), RequestCookies=make_set(csCookie), RequestReferers=make_set(csReferer), RequestQueryStrings=make_set(csUriQuery) by AttackerIP=cIP, SiteName=sSiteName, ShellLocation=csUriStem, tostring(FileName), HostName",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), RequestUserAgents=make_set(csUserAgent), ReqestMethods=make_set(csMethod), RequestStatusCodes=make_set(scStatus), RequestCookies=make_set(csCookie), RequestReferers=make_set(csReferer), RequestQueryStrings=make_set(csUriQuery) by AttackerIP=cIP, SiteName=sSiteName, ShellLocation=csUriStem, tostring(FileName), HostName",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), RequestUserAgents=make_set(csUserAgent), ReqestMethods=make_set(csMethod), RequestStatusCodes=make_set(scStatus), RequestCookies=make_set(csCookie), RequestReferers=make_set(csReferer), RequestQueryStrings=make_set(csUriQuery) by AttackerIP=cIP, SiteName=sSiteName, ShellLocation=csUriStem, tostring(FileName), HostName",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "requestuseragents",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), RequestUserAgents=make_set(csUserAgent), ReqestMethods=make_set(csMethod), RequestStatusCodes=make_set(scStatus), RequestCookies=make_set(csCookie), RequestReferers=make_set(csReferer), RequestQueryStrings=make_set(csUriQuery) by AttackerIP=cIP, SiteName=sSiteName, ShellLocation=csUriStem, tostring(FileName), HostName",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "reqestmethods",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), RequestUserAgents=make_set(csUserAgent), ReqestMethods=make_set(csMethod), RequestStatusCodes=make_set(scStatus), RequestCookies=make_set(csCookie), RequestReferers=make_set(csReferer), RequestQueryStrings=make_set(csUriQuery) by AttackerIP=cIP, SiteName=sSiteName, ShellLocation=csUriStem, tostring(FileName), HostName",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "requeststatuscodes",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), RequestUserAgents=make_set(csUserAgent), ReqestMethods=make_set(csMethod), RequestStatusCodes=make_set(scStatus), RequestCookies=make_set(csCookie), RequestReferers=make_set(csReferer), RequestQueryStrings=make_set(csUriQuery) by AttackerIP=cIP, SiteName=sSiteName, ShellLocation=csUriStem, tostring(FileName), HostName",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "requestcookies",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), RequestUserAgents=make_set(csUserAgent), ReqestMethods=make_set(csMethod), RequestStatusCodes=make_set(scStatus), RequestCookies=make_set(csCookie), RequestReferers=make_set(csReferer), RequestQueryStrings=make_set(csUriQuery) by AttackerIP=cIP, SiteName=sSiteName, ShellLocation=csUriStem, tostring(FileName), HostName",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "requestreferers",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), RequestUserAgents=make_set(csUserAgent), ReqestMethods=make_set(csMethod), RequestStatusCodes=make_set(scStatus), RequestCookies=make_set(csCookie), RequestReferers=make_set(csReferer), RequestQueryStrings=make_set(csUriQuery) by AttackerIP=cIP, SiteName=sSiteName, ShellLocation=csUriStem, tostring(FileName), HostName",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "requestquerystrings",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize count(), StartTime=min(TimeGenerated), EndTime=max(TimeGenerated), RequestUserAgents=make_set(csUserAgent), ReqestMethods=make_set(csMethod), RequestStatusCodes=make_set(scStatus), RequestCookies=make_set(csCookie), RequestReferers=make_set(csReferer), RequestQueryStrings=make_set(csUriQuery) by AttackerIP=cIP, SiteName=sSiteName, ShellLocation=csUriStem, tostring(FileName), HostName",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, AttackerIP, RequestUserAgents, Computer = HostName, SiteName, ShellLocation, ReqestMethods, RequestStatusCodes, RequestCookies, RequestReferers, RequestQueryStrings, RequestCount = count_",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, AttackerIP, RequestUserAgents, Computer = HostName, SiteName, ShellLocation, ReqestMethods, RequestStatusCodes, RequestCookies, RequestReferers, RequestQueryStrings, RequestCount = count_",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, AttackerIP, RequestUserAgents, Computer = HostName, SiteName, ShellLocation, ReqestMethods, RequestStatusCodes, RequestCookies, RequestReferers, RequestQueryStrings, RequestCount = count_",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "attackerip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, AttackerIP, RequestUserAgents, Computer = HostName, SiteName, ShellLocation, ReqestMethods, RequestStatusCodes, RequestCookies, RequestReferers, RequestQueryStrings, RequestCount = count_",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "requestuseragents",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, AttackerIP, RequestUserAgents, Computer = HostName, SiteName, ShellLocation, ReqestMethods, RequestStatusCodes, RequestCookies, RequestReferers, RequestQueryStrings, RequestCount = count_",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, AttackerIP, RequestUserAgents, Computer = HostName, SiteName, ShellLocation, ReqestMethods, RequestStatusCodes, RequestCookies, RequestReferers, RequestQueryStrings, RequestCount = count_",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "sitename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, AttackerIP, RequestUserAgents, Computer = HostName, SiteName, ShellLocation, ReqestMethods, RequestStatusCodes, RequestCookies, RequestReferers, RequestQueryStrings, RequestCount = count_",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "shelllocation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, AttackerIP, RequestUserAgents, Computer = HostName, SiteName, ShellLocation, ReqestMethods, RequestStatusCodes, RequestCookies, RequestReferers, RequestQueryStrings, RequestCount = count_",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "reqestmethods",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, AttackerIP, RequestUserAgents, Computer = HostName, SiteName, ShellLocation, ReqestMethods, RequestStatusCodes, RequestCookies, RequestReferers, RequestQueryStrings, RequestCount = count_",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "requeststatuscodes",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, AttackerIP, RequestUserAgents, Computer = HostName, SiteName, ShellLocation, ReqestMethods, RequestStatusCodes, RequestCookies, RequestReferers, RequestQueryStrings, RequestCount = count_",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "requestcookies",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, AttackerIP, RequestUserAgents, Computer = HostName, SiteName, ShellLocation, ReqestMethods, RequestStatusCodes, RequestCookies, RequestReferers, RequestQueryStrings, RequestCount = count_",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "requestreferers",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, AttackerIP, RequestUserAgents, Computer = HostName, SiteName, ShellLocation, ReqestMethods, RequestStatusCodes, RequestCookies, RequestReferers, RequestQueryStrings, RequestCount = count_",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "requestquerystrings",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, AttackerIP, RequestUserAgents, Computer = HostName, SiteName, ShellLocation, ReqestMethods, RequestStatusCodes, RequestCookies, RequestReferers, RequestQueryStrings, RequestCount = count_",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "requestcount",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "maliciousalertlinkedwebrequests.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend EventData = parse_xml(EventData).EventData.Data",
    "detection": "startstophealthservice.yaml",
    "field": "eventdata",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key = tostring(column_ifexists('@Name', \"\")), Value = column_ifexists('#text', \"\")",
    "detection": "startstophealthservice.yaml",
    "field": "key",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Key = tostring(column_ifexists('@Name', \"\")), Value = column_ifexists('#text', \"\")",
    "detection": "startstophealthservice.yaml",
    "field": "value",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ObjectServer = column_ifexists('ObjectServer', \"\"), ObjectType = column_ifexists('ObjectType', \"\"), ObjectName = column_ifexists('ObjectName', \"\")",
    "detection": "startstophealthservice.yaml",
    "field": "objectserver",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ObjectServer = column_ifexists('ObjectServer', \"\"), ObjectType = column_ifexists('ObjectType', \"\"), ObjectName = column_ifexists('ObjectName', \"\")",
    "detection": "startstophealthservice.yaml",
    "field": "objecttype",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ObjectServer = column_ifexists('ObjectServer', \"\"), ObjectType = column_ifexists('ObjectType', \"\"), ObjectName = column_ifexists('ObjectName', \"\")",
    "detection": "startstophealthservice.yaml",
    "field": "objectname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, TargetAccount, IpAddress,TargetLogonId, ObjectServer, ObjectType, ObjectName",
    "detection": "startstophealthservice.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, TargetAccount, IpAddress,TargetLogonId, ObjectServer, ObjectType, ObjectName",
    "detection": "startstophealthservice.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, TargetAccount, IpAddress,TargetLogonId, ObjectServer, ObjectType, ObjectName",
    "detection": "startstophealthservice.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, TargetAccount, IpAddress,TargetLogonId, ObjectServer, ObjectType, ObjectName",
    "detection": "startstophealthservice.yaml",
    "field": "targetaccount",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, TargetAccount, IpAddress,TargetLogonId, ObjectServer, ObjectType, ObjectName",
    "detection": "startstophealthservice.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, TargetAccount, IpAddress,TargetLogonId, ObjectServer, ObjectType, ObjectName",
    "detection": "startstophealthservice.yaml",
    "field": "targetlogonid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, TargetAccount, IpAddress,TargetLogonId, ObjectServer, ObjectType, ObjectName",
    "detection": "startstophealthservice.yaml",
    "field": "objectserver",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, TargetAccount, IpAddress,TargetLogonId, ObjectServer, ObjectType, ObjectName",
    "detection": "startstophealthservice.yaml",
    "field": "objecttype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, Computer, Account, TargetAccount, IpAddress,TargetLogonId, ObjectServer, ObjectType, ObjectName",
    "detection": "startstophealthservice.yaml",
    "field": "objectname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "startstophealthservice.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(Computer, \".\")[0]), DomainIndex = toint(indexof(Computer, '.'))",
    "detection": "startstophealthservice.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(Computer, DomainIndex + 1), Computer)",
    "detection": "startstophealthservice.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(TargetAccount, @'\\')[1]), AccountNTDomain = tostring(split(TargetAccount, @'\\')[0])",
    "detection": "startstophealthservice.yaml",
    "field": "accountname",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend AccountName = tostring(split(TargetAccount, @'\\')[1]), AccountNTDomain = tostring(split(TargetAccount, @'\\')[0])",
    "detection": "startstophealthservice.yaml",
    "field": "accountntdomain",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = TimeGenerated",
    "detection": "startstophealthservice.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), EventCount = count() by Computer, Account, EventID, Activity",
    "detection": "securityeventlogcleared.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), EventCount = count() by Computer, Account, EventID, Activity",
    "detection": "securityeventlogcleared.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), EventCount = count() by Computer, Account, EventID, Activity",
    "detection": "securityeventlogcleared.yaml",
    "field": "eventcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), EventCount = count() by Computer, Account, EventID, Activity",
    "detection": "securityeventlogcleared.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), EventCount = count() by Computer, Account, EventID, Activity",
    "detection": "securityeventlogcleared.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), EventCount = count() by Computer, Account, EventID, Activity",
    "detection": "securityeventlogcleared.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), EventCount = count() by Computer, Account, EventID, Activity",
    "detection": "securityeventlogcleared.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Account =  strcat(tostring(EventData.SubjectDomainName),\"\\\\\", tostring(EventData.SubjectUserName))",
    "detection": "securityeventlogcleared.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend Activity= \"1102 - The audit log was cleared.\"",
    "detection": "securityeventlogcleared.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), EventCount = count() by Computer, Account, EventID, Activity",
    "detection": "securityeventlogcleared.yaml",
    "field": "starttimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), EventCount = count() by Computer, Account, EventID, Activity",
    "detection": "securityeventlogcleared.yaml",
    "field": "endtimeutc",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), EventCount = count() by Computer, Account, EventID, Activity",
    "detection": "securityeventlogcleared.yaml",
    "field": "eventcount",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), EventCount = count() by Computer, Account, EventID, Activity",
    "detection": "securityeventlogcleared.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), EventCount = count() by Computer, Account, EventID, Activity",
    "detection": "securityeventlogcleared.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), EventCount = count() by Computer, Account, EventID, Activity",
    "detection": "securityeventlogcleared.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTimeUtc = min(TimeGenerated), EndTimeUtc = max(TimeGenerated), EventCount = count() by Computer, Account, EventID, Activity",
    "detection": "securityeventlogcleared.yaml",
    "field": "activity",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name=tostring(split(Account, \"@\")[0]), UPNSuffix=tostring(split(Account, \"@\")[1])",
    "detection": "securityeventlogcleared.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name=tostring(split(Account, \"@\")[0]), UPNSuffix=tostring(split(Account, \"@\")[1])",
    "detection": "securityeventlogcleared.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = iif(Computer has '.',substring(Computer,0,indexof(Computer,'.')),Computer) , DnsDomain = iif(Computer has '.',substring(Computer,indexof(Computer,'.')+1),'')",
    "detection": "securityeventlogcleared.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = iif(Computer has '.',substring(Computer,0,indexof(Computer,'.')),Computer) , DnsDomain = iif(Computer has '.',substring(Computer,indexof(Computer,'.')+1),'')",
    "detection": "securityeventlogcleared.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend encodedCommand = iff(encodedCommand has \" \", tostring(split(encodedCommand, \" \")[0]), encodedCommand)",
    "detection": "powershell-empire.yaml",
    "field": "encodedcommand",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend decodedCommand = translate('\\0','', base64_decode_tostring(substring(encodedCommand, 0, strlen(encodedCommand) -  (strlen(encodedCommand) %8)))), encodedCommand, CommandLine , strlen(encodedCommand)",
    "detection": "powershell-empire.yaml",
    "field": "decodedcommand",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend EfectiveCommand = iff(isnotempty(encodedCommand), decodedCommand, CommandLine)",
    "detection": "powershell-empire.yaml",
    "field": "efectivecommand",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, Computer, SubjectUserName, SubjectDomainName, FileName = Process, EfectiveCommand, decodedCommand, encodedCommand, CommandLine, ParentProcessName",
    "detection": "powershell-empire.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, Computer, SubjectUserName, SubjectDomainName, FileName = Process, EfectiveCommand, decodedCommand, encodedCommand, CommandLine, ParentProcessName",
    "detection": "powershell-empire.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, Computer, SubjectUserName, SubjectDomainName, FileName = Process, EfectiveCommand, decodedCommand, encodedCommand, CommandLine, ParentProcessName",
    "detection": "powershell-empire.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, Computer, SubjectUserName, SubjectDomainName, FileName = Process, EfectiveCommand, decodedCommand, encodedCommand, CommandLine, ParentProcessName",
    "detection": "powershell-empire.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, Computer, SubjectUserName, SubjectDomainName, FileName = Process, EfectiveCommand, decodedCommand, encodedCommand, CommandLine, ParentProcessName",
    "detection": "powershell-empire.yaml",
    "field": "filename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, Computer, SubjectUserName, SubjectDomainName, FileName = Process, EfectiveCommand, decodedCommand, encodedCommand, CommandLine, ParentProcessName",
    "detection": "powershell-empire.yaml",
    "field": "efectivecommand",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, Computer, SubjectUserName, SubjectDomainName, FileName = Process, EfectiveCommand, decodedCommand, encodedCommand, CommandLine, ParentProcessName",
    "detection": "powershell-empire.yaml",
    "field": "decodedcommand",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, Computer, SubjectUserName, SubjectDomainName, FileName = Process, EfectiveCommand, decodedCommand, encodedCommand, CommandLine, ParentProcessName",
    "detection": "powershell-empire.yaml",
    "field": "encodedcommand",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, Computer, SubjectUserName, SubjectDomainName, FileName = Process, EfectiveCommand, decodedCommand, encodedCommand, CommandLine, ParentProcessName",
    "detection": "powershell-empire.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, Computer, SubjectUserName, SubjectDomainName, FileName = Process, EfectiveCommand, decodedCommand, encodedCommand, CommandLine, ParentProcessName",
    "detection": "powershell-empire.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = split(Computer, '.', 0)[0], DnsDomain = strcat_array(array_slice(split(Computer, '.'), 1, -1), '.')",
    "detection": "powershell-empire.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = split(Computer, '.', 0)[0], DnsDomain = strcat_array(array_slice(split(Computer, '.'), 1, -1), '.')",
    "detection": "powershell-empire.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ParentProcessName = tostring(EventData.ParentProcessName)",
    "detection": "powershell-empire.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend CommandLine = tostring(EventData.CommandLine)",
    "detection": "powershell-empire.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend encodedCommand = iff(encodedCommand has \" \", tostring(split(encodedCommand, \" \")[0]), encodedCommand)",
    "detection": "powershell-empire.yaml",
    "field": "encodedcommand",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend decodedCommand = translate('\\0','', base64_decode_tostring(substring(encodedCommand, 0, strlen(encodedCommand) -  (strlen(encodedCommand) %8)))), encodedCommand, CommandLine , strlen(encodedCommand)",
    "detection": "powershell-empire.yaml",
    "field": "decodedcommand",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend EfectiveCommand = iff(isnotempty(encodedCommand), decodedCommand, CommandLine)",
    "detection": "powershell-empire.yaml",
    "field": "efectivecommand",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectUserName = tostring(EventData.SubjectUserName)",
    "detection": "powershell-empire.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "EXTEND",
    "line": "| extend SubjectDomainName = tostring(EventData.SubjectDomainName)",
    "detection": "powershell-empire.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend NewProcessName = tostring(EventData.NewProcessName)",
    "detection": "powershell-empire.yaml",
    "field": "newprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend Process=tostring(split(NewProcessName, '\\\\')[-1])",
    "detection": "powershell-empire.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, Computer, SubjectUserName, SubjectDomainName, FileName = Process, EfectiveCommand, decodedCommand, encodedCommand, CommandLine, ParentProcessName",
    "detection": "powershell-empire.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, Computer, SubjectUserName, SubjectDomainName, FileName = Process, EfectiveCommand, decodedCommand, encodedCommand, CommandLine, ParentProcessName",
    "detection": "powershell-empire.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, Computer, SubjectUserName, SubjectDomainName, FileName = Process, EfectiveCommand, decodedCommand, encodedCommand, CommandLine, ParentProcessName",
    "detection": "powershell-empire.yaml",
    "field": "subjectusername",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, Computer, SubjectUserName, SubjectDomainName, FileName = Process, EfectiveCommand, decodedCommand, encodedCommand, CommandLine, ParentProcessName",
    "detection": "powershell-empire.yaml",
    "field": "subjectdomainname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, Computer, SubjectUserName, SubjectDomainName, FileName = Process, EfectiveCommand, decodedCommand, encodedCommand, CommandLine, ParentProcessName",
    "detection": "powershell-empire.yaml",
    "field": "filename",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, Computer, SubjectUserName, SubjectDomainName, FileName = Process, EfectiveCommand, decodedCommand, encodedCommand, CommandLine, ParentProcessName",
    "detection": "powershell-empire.yaml",
    "field": "efectivecommand",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, Computer, SubjectUserName, SubjectDomainName, FileName = Process, EfectiveCommand, decodedCommand, encodedCommand, CommandLine, ParentProcessName",
    "detection": "powershell-empire.yaml",
    "field": "decodedcommand",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, Computer, SubjectUserName, SubjectDomainName, FileName = Process, EfectiveCommand, decodedCommand, encodedCommand, CommandLine, ParentProcessName",
    "detection": "powershell-empire.yaml",
    "field": "encodedcommand",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, Computer, SubjectUserName, SubjectDomainName, FileName = Process, EfectiveCommand, decodedCommand, encodedCommand, CommandLine, ParentProcessName",
    "detection": "powershell-empire.yaml",
    "field": "commandline",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project timestamp = TimeGenerated, Computer, SubjectUserName, SubjectDomainName, FileName = Process, EfectiveCommand, decodedCommand, encodedCommand, CommandLine, ParentProcessName",
    "detection": "powershell-empire.yaml",
    "field": "parentprocessname",
    "classification": "process"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = split(Computer, '.', 0)[0], DnsDomain = strcat_array(array_slice(split(Computer, '.'), 1, -1), '.')",
    "detection": "powershell-empire.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = split(Computer, '.', 0)[0], DnsDomain = strcat_array(array_slice(split(Computer, '.'), 1, -1), '.')",
    "detection": "powershell-empire.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), CountToday = count() by EventID, Account, LogonTypeName, SubStatus, AccountType, Computer, WorkstationName, IpAddress, Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), CountToday = count() by EventID, Account, LogonTypeName, SubStatus, AccountType, Computer, WorkstationName, IpAddress, Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), CountToday = count() by EventID, Account, LogonTypeName, SubStatus, AccountType, Computer, WorkstationName, IpAddress, Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "counttoday",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), CountToday = count() by EventID, Account, LogonTypeName, SubStatus, AccountType, Computer, WorkstationName, IpAddress, Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), CountToday = count() by EventID, Account, LogonTypeName, SubStatus, AccountType, Computer, WorkstationName, IpAddress, Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), CountToday = count() by EventID, Account, LogonTypeName, SubStatus, AccountType, Computer, WorkstationName, IpAddress, Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "logontypename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), CountToday = count() by EventID, Account, LogonTypeName, SubStatus, AccountType, Computer, WorkstationName, IpAddress, Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "substatus",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), CountToday = count() by EventID, Account, LogonTypeName, SubStatus, AccountType, Computer, WorkstationName, IpAddress, Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), CountToday = count() by EventID, Account, LogonTypeName, SubStatus, AccountType, Computer, WorkstationName, IpAddress, Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), CountToday = count() by EventID, Account, LogonTypeName, SubStatus, AccountType, Computer, WorkstationName, IpAddress, Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "workstationname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), CountToday = count() by EventID, Account, LogonTypeName, SubStatus, AccountType, Computer, WorkstationName, IpAddress, Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(TimeGenerated), EndTime = max(TimeGenerated), CountToday = count() by EventID, Account, LogonTypeName, SubStatus, AccountType, Computer, WorkstationName, IpAddress, Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize CountPrev7day = count() by EventID, Account, LogonTypeName, SubStatus, AccountType, Computer, WorkstationName, IpAddress",
    "detection": "excessivelogonfailures.yaml",
    "field": "countprev7day",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize CountPrev7day = count() by EventID, Account, LogonTypeName, SubStatus, AccountType, Computer, WorkstationName, IpAddress",
    "detection": "excessivelogonfailures.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize CountPrev7day = count() by EventID, Account, LogonTypeName, SubStatus, AccountType, Computer, WorkstationName, IpAddress",
    "detection": "excessivelogonfailures.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize CountPrev7day = count() by EventID, Account, LogonTypeName, SubStatus, AccountType, Computer, WorkstationName, IpAddress",
    "detection": "excessivelogonfailures.yaml",
    "field": "logontypename",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize CountPrev7day = count() by EventID, Account, LogonTypeName, SubStatus, AccountType, Computer, WorkstationName, IpAddress",
    "detection": "excessivelogonfailures.yaml",
    "field": "substatus",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize CountPrev7day = count() by EventID, Account, LogonTypeName, SubStatus, AccountType, Computer, WorkstationName, IpAddress",
    "detection": "excessivelogonfailures.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize CountPrev7day = count() by EventID, Account, LogonTypeName, SubStatus, AccountType, Computer, WorkstationName, IpAddress",
    "detection": "excessivelogonfailures.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize CountPrev7day = count() by EventID, Account, LogonTypeName, SubStatus, AccountType, Computer, WorkstationName, IpAddress",
    "detection": "excessivelogonfailures.yaml",
    "field": "workstationname",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "    | summarize CountPrev7day = count() by EventID, Account, LogonTypeName, SubStatus, AccountType, Computer, WorkstationName, IpAddress",
    "detection": "excessivelogonfailures.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend Reason = case(",
    "detection": "excessivelogonfailures.yaml",
    "field": "reason",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend WorkstationName = iff(WorkstationName == \"-\" or isempty(WorkstationName), Computer , WorkstationName)",
    "detection": "excessivelogonfailures.yaml",
    "field": "workstationname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, EventID, Account, LogonTypeName, SubStatus, Reason, AccountType, Computer, WorkstationName, IpAddress, CountToday, CountPrev7day, Avg7Day = round(CountPrev7day*1.00/7,2), Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, EventID, Account, LogonTypeName, SubStatus, Reason, AccountType, Computer, WorkstationName, IpAddress, CountToday, CountPrev7day, Avg7Day = round(CountPrev7day*1.00/7,2), Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, EventID, Account, LogonTypeName, SubStatus, Reason, AccountType, Computer, WorkstationName, IpAddress, CountToday, CountPrev7day, Avg7Day = round(CountPrev7day*1.00/7,2), Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "eventid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, EventID, Account, LogonTypeName, SubStatus, Reason, AccountType, Computer, WorkstationName, IpAddress, CountToday, CountPrev7day, Avg7Day = round(CountPrev7day*1.00/7,2), Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "account",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, EventID, Account, LogonTypeName, SubStatus, Reason, AccountType, Computer, WorkstationName, IpAddress, CountToday, CountPrev7day, Avg7Day = round(CountPrev7day*1.00/7,2), Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "logontypename",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, EventID, Account, LogonTypeName, SubStatus, Reason, AccountType, Computer, WorkstationName, IpAddress, CountToday, CountPrev7day, Avg7Day = round(CountPrev7day*1.00/7,2), Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "substatus",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, EventID, Account, LogonTypeName, SubStatus, Reason, AccountType, Computer, WorkstationName, IpAddress, CountToday, CountPrev7day, Avg7Day = round(CountPrev7day*1.00/7,2), Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "reason",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, EventID, Account, LogonTypeName, SubStatus, Reason, AccountType, Computer, WorkstationName, IpAddress, CountToday, CountPrev7day, Avg7Day = round(CountPrev7day*1.00/7,2), Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "accounttype",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, EventID, Account, LogonTypeName, SubStatus, Reason, AccountType, Computer, WorkstationName, IpAddress, CountToday, CountPrev7day, Avg7Day = round(CountPrev7day*1.00/7,2), Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, EventID, Account, LogonTypeName, SubStatus, Reason, AccountType, Computer, WorkstationName, IpAddress, CountToday, CountPrev7day, Avg7Day = round(CountPrev7day*1.00/7,2), Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "workstationname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, EventID, Account, LogonTypeName, SubStatus, Reason, AccountType, Computer, WorkstationName, IpAddress, CountToday, CountPrev7day, Avg7Day = round(CountPrev7day*1.00/7,2), Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "ipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, EventID, Account, LogonTypeName, SubStatus, Reason, AccountType, Computer, WorkstationName, IpAddress, CountToday, CountPrev7day, Avg7Day = round(CountPrev7day*1.00/7,2), Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "counttoday",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, EventID, Account, LogonTypeName, SubStatus, Reason, AccountType, Computer, WorkstationName, IpAddress, CountToday, CountPrev7day, Avg7Day = round(CountPrev7day*1.00/7,2), Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "countprev7day",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, EventID, Account, LogonTypeName, SubStatus, Reason, AccountType, Computer, WorkstationName, IpAddress, CountToday, CountPrev7day, Avg7Day = round(CountPrev7day*1.00/7,2), Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "avg7day",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project StartTime, EndTime, EventID, Account, LogonTypeName, SubStatus, Reason, AccountType, Computer, WorkstationName, IpAddress, CountToday, CountPrev7day, Avg7Day = round(CountPrev7day*1.00/7,2), Process",
    "detection": "excessivelogonfailures.yaml",
    "field": "process",
    "classification": "process"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(StartTime), EndTime = max(EndTime), Computer = make_set(Computer,128), IpAddressList = make_set(IpAddress,128), sum(CountToday), sum(CountPrev7day), avg(Avg7Day)",
    "detection": "excessivelogonfailures.yaml",
    "field": "starttime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(StartTime), EndTime = max(EndTime), Computer = make_set(Computer,128), IpAddressList = make_set(IpAddress,128), sum(CountToday), sum(CountPrev7day), avg(Avg7Day)",
    "detection": "excessivelogonfailures.yaml",
    "field": "endtime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(StartTime), EndTime = max(EndTime), Computer = make_set(Computer,128), IpAddressList = make_set(IpAddress,128), sum(CountToday), sum(CountPrev7day), avg(Avg7Day)",
    "detection": "excessivelogonfailures.yaml",
    "field": "computer",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize StartTime = min(StartTime), EndTime = max(EndTime), Computer = make_set(Computer,128), IpAddressList = make_set(IpAddress,128), sum(CountToday), sum(CountPrev7day), avg(Avg7Day)",
    "detection": "excessivelogonfailures.yaml",
    "field": "ipaddresslist",
    "classification": "network"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTime, NTDomain = tostring(split(Account, '\\\\', 0)[0]), Name = tostring(split(Account, '\\\\', 1)[0]), HostName = tostring(split(WorkstationName, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(WorkstationName, '.'), 1, -1), '.'))",
    "detection": "excessivelogonfailures.yaml",
    "field": "timestamp",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTime, NTDomain = tostring(split(Account, '\\\\', 0)[0]), Name = tostring(split(Account, '\\\\', 1)[0]), HostName = tostring(split(WorkstationName, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(WorkstationName, '.'), 1, -1), '.'))",
    "detection": "excessivelogonfailures.yaml",
    "field": "ntdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTime, NTDomain = tostring(split(Account, '\\\\', 0)[0]), Name = tostring(split(Account, '\\\\', 1)[0]), HostName = tostring(split(WorkstationName, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(WorkstationName, '.'), 1, -1), '.'))",
    "detection": "excessivelogonfailures.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTime, NTDomain = tostring(split(Account, '\\\\', 0)[0]), Name = tostring(split(Account, '\\\\', 1)[0]), HostName = tostring(split(WorkstationName, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(WorkstationName, '.'), 1, -1), '.'))",
    "detection": "excessivelogonfailures.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = StartTime, NTDomain = tostring(split(Account, '\\\\', 0)[0]), Name = tostring(split(Account, '\\\\', 1)[0]), HostName = tostring(split(WorkstationName, '.', 0)[0]), DnsDomain = tostring(strcat_array(array_slice(split(WorkstationName, '.'), 1, -1), '.'))",
    "detection": "excessivelogonfailures.yaml",
    "field": "dnsdomain",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend DeviceName = tolower(DeviceName)",
    "detection": "solorigate-defender-detections.yaml",
    "field": "devicename",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend ThreatName = tostring(parse_json(ExtendedProperties).ThreatName)",
    "detection": "solorigate-defender-detections.yaml",
    "field": "threatname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DisplayName, ThreatName, CompromisedEntity, PublicIP, MachineGroup, AlertSeverity, Description, LoggedOnUsers, DeviceId, TenantId",
    "detection": "solorigate-defender-detections.yaml",
    "field": "timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DisplayName, ThreatName, CompromisedEntity, PublicIP, MachineGroup, AlertSeverity, Description, LoggedOnUsers, DeviceId, TenantId",
    "detection": "solorigate-defender-detections.yaml",
    "field": "displayname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DisplayName, ThreatName, CompromisedEntity, PublicIP, MachineGroup, AlertSeverity, Description, LoggedOnUsers, DeviceId, TenantId",
    "detection": "solorigate-defender-detections.yaml",
    "field": "threatname",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DisplayName, ThreatName, CompromisedEntity, PublicIP, MachineGroup, AlertSeverity, Description, LoggedOnUsers, DeviceId, TenantId",
    "detection": "solorigate-defender-detections.yaml",
    "field": "compromisedentity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DisplayName, ThreatName, CompromisedEntity, PublicIP, MachineGroup, AlertSeverity, Description, LoggedOnUsers, DeviceId, TenantId",
    "detection": "solorigate-defender-detections.yaml",
    "field": "publicip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DisplayName, ThreatName, CompromisedEntity, PublicIP, MachineGroup, AlertSeverity, Description, LoggedOnUsers, DeviceId, TenantId",
    "detection": "solorigate-defender-detections.yaml",
    "field": "machinegroup",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DisplayName, ThreatName, CompromisedEntity, PublicIP, MachineGroup, AlertSeverity, Description, LoggedOnUsers, DeviceId, TenantId",
    "detection": "solorigate-defender-detections.yaml",
    "field": "alertseverity",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DisplayName, ThreatName, CompromisedEntity, PublicIP, MachineGroup, AlertSeverity, Description, LoggedOnUsers, DeviceId, TenantId",
    "detection": "solorigate-defender-detections.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DisplayName, ThreatName, CompromisedEntity, PublicIP, MachineGroup, AlertSeverity, Description, LoggedOnUsers, DeviceId, TenantId",
    "detection": "solorigate-defender-detections.yaml",
    "field": "loggedonusers",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DisplayName, ThreatName, CompromisedEntity, PublicIP, MachineGroup, AlertSeverity, Description, LoggedOnUsers, DeviceId, TenantId",
    "detection": "solorigate-defender-detections.yaml",
    "field": "deviceid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project TimeGenerated, DisplayName, ThreatName, CompromisedEntity, PublicIP, MachineGroup, AlertSeverity, Description, LoggedOnUsers, DeviceId, TenantId",
    "detection": "solorigate-defender-detections.yaml",
    "field": "tenantid",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(CompromisedEntity, \".\")[0]), DomainIndex = toint(indexof(CompromisedEntity, '.'))",
    "detection": "solorigate-defender-detections.yaml",
    "field": "hostname",
    "classification": "host"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostName = tostring(split(CompromisedEntity, \".\")[0]), DomainIndex = toint(indexof(CompromisedEntity, '.'))",
    "detection": "solorigate-defender-detections.yaml",
    "field": "domainindex",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend HostNameDomain = iff(DomainIndex != -1, substring(CompromisedEntity, DomainIndex + 1), CompromisedEntity)",
    "detection": "solorigate-defender-detections.yaml",
    "field": "hostnamedomain",
    "classification": "host"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "emailentity-officeactivity.yaml",
    "field": "latestindicatortime",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize LatestIndicatorTime = arg_max(TimeGenerated, *) by IndicatorId",
    "detection": "emailentity-officeactivity.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize OfficeActivity_TimeGenerated = arg_max(OfficeActivity_TimeGenerated, *) by IndicatorId, UserId",
    "detection": "emailentity-officeactivity.yaml",
    "field": "officeactivity_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize OfficeActivity_TimeGenerated = arg_max(OfficeActivity_TimeGenerated, *) by IndicatorId, UserId",
    "detection": "emailentity-officeactivity.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "SUMMARY",
    "line": "| summarize OfficeActivity_TimeGenerated = arg_max(OfficeActivity_TimeGenerated, *) by IndicatorId, UserId",
    "detection": "emailentity-officeactivity.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, UserId, ClientIP, Operation, UserType, RecordType, OfficeWorkload, Parameters",
    "detection": "emailentity-officeactivity.yaml",
    "field": "officeactivity_timegenerated",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, UserId, ClientIP, Operation, UserType, RecordType, OfficeWorkload, Parameters",
    "detection": "emailentity-officeactivity.yaml",
    "field": "description",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, UserId, ClientIP, Operation, UserType, RecordType, OfficeWorkload, Parameters",
    "detection": "emailentity-officeactivity.yaml",
    "field": "activitygroupnames",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, UserId, ClientIP, Operation, UserType, RecordType, OfficeWorkload, Parameters",
    "detection": "emailentity-officeactivity.yaml",
    "field": "indicatorid",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, UserId, ClientIP, Operation, UserType, RecordType, OfficeWorkload, Parameters",
    "detection": "emailentity-officeactivity.yaml",
    "field": "threattype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, UserId, ClientIP, Operation, UserType, RecordType, OfficeWorkload, Parameters",
    "detection": "emailentity-officeactivity.yaml",
    "field": "url",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, UserId, ClientIP, Operation, UserType, RecordType, OfficeWorkload, Parameters",
    "detection": "emailentity-officeactivity.yaml",
    "field": "expirationdatetime",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, UserId, ClientIP, Operation, UserType, RecordType, OfficeWorkload, Parameters",
    "detection": "emailentity-officeactivity.yaml",
    "field": "confidencescore",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, UserId, ClientIP, Operation, UserType, RecordType, OfficeWorkload, Parameters",
    "detection": "emailentity-officeactivity.yaml",
    "field": "emailsendername",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, UserId, ClientIP, Operation, UserType, RecordType, OfficeWorkload, Parameters",
    "detection": "emailentity-officeactivity.yaml",
    "field": "emailrecipient",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, UserId, ClientIP, Operation, UserType, RecordType, OfficeWorkload, Parameters",
    "detection": "emailentity-officeactivity.yaml",
    "field": "emailsourcedomain",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, UserId, ClientIP, Operation, UserType, RecordType, OfficeWorkload, Parameters",
    "detection": "emailentity-officeactivity.yaml",
    "field": "emailsourceipaddress",
    "classification": "network"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, UserId, ClientIP, Operation, UserType, RecordType, OfficeWorkload, Parameters",
    "detection": "emailentity-officeactivity.yaml",
    "field": "emailsubject",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, UserId, ClientIP, Operation, UserType, RecordType, OfficeWorkload, Parameters",
    "detection": "emailentity-officeactivity.yaml",
    "field": "filehashvalue",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, UserId, ClientIP, Operation, UserType, RecordType, OfficeWorkload, Parameters",
    "detection": "emailentity-officeactivity.yaml",
    "field": "filehashtype",
    "classification": "process"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, UserId, ClientIP, Operation, UserType, RecordType, OfficeWorkload, Parameters",
    "detection": "emailentity-officeactivity.yaml",
    "field": "userid",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, UserId, ClientIP, Operation, UserType, RecordType, OfficeWorkload, Parameters",
    "detection": "emailentity-officeactivity.yaml",
    "field": "clientip",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, UserId, ClientIP, Operation, UserType, RecordType, OfficeWorkload, Parameters",
    "detection": "emailentity-officeactivity.yaml",
    "field": "operation",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, UserId, ClientIP, Operation, UserType, RecordType, OfficeWorkload, Parameters",
    "detection": "emailentity-officeactivity.yaml",
    "field": "usertype",
    "classification": "user"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, UserId, ClientIP, Operation, UserType, RecordType, OfficeWorkload, Parameters",
    "detection": "emailentity-officeactivity.yaml",
    "field": "recordtype",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, UserId, ClientIP, Operation, UserType, RecordType, OfficeWorkload, Parameters",
    "detection": "emailentity-officeactivity.yaml",
    "field": "officeworkload",
    "classification": "unknown"
  },
  {
    "type": "PROJECT",
    "line": "| project OfficeActivity_TimeGenerated, Description, ActivityGroupNames, IndicatorId, ThreatType, Url, ExpirationDateTime, ConfidenceScore, EmailSenderName, EmailRecipient, EmailSourceDomain, EmailSourceIpAddress, EmailSubject, FileHashValue, FileHashType, UserId, ClientIP, Operation, UserType, RecordType, OfficeWorkload, Parameters",
    "detection": "emailentity-officeactivity.yaml",
    "field": "parameters",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserId, '@', 0)[0]), UPNSuffix = tostring(split(UserId, '@', 1)[0])",
    "detection": "emailentity-officeactivity.yaml",
    "field": "name",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend Name = tostring(split(UserId, '@', 0)[0]), UPNSuffix = tostring(split(UserId, '@', 1)[0])",
    "detection": "emailentity-officeactivity.yaml",
    "field": "upnsuffix",
    "classification": "unknown"
  },
  {
    "type": "EXTEND",
    "line": "| extend timestamp = OfficeActivity_TimeGenerated",
    "detection": "emailentity-officeactivity.yaml",
    "field": "timestamp",
    "classification": "unknown"
  }
]